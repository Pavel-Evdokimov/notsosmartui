csui.define("csui/behaviors/item.name/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/behaviors/item.name/impl/nls/root/lang",{"nameErrorEmptyValue":"This is a required field.","nameErrorMaxLegthExceed":"Name cannot be longer than 248 characters.","nameErrorContainSemiColon":"Name cannot contain a colon.","error":"Unable to complete this request. Please try again later.","nameExists":"An item with the name '{name}' already exists.","renameTitle":"Rename","addFolderTitle":"Add folder"}),csui.define("csui/behaviors/item.name/item.name.behavior",["csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/utils/base","csui/models/version","csui/models/namequery","csui/utils/commands","i18n!csui/behaviors/item.name/impl/nls/lang"],function(e,i,t,s,n,o,l,r,a){return s.Behavior.extend({"ui":{"inputName":".title-input","saveButton":".cs-add-button"},"events":{"click @ui.name":"onClickName","click @ui.nameInput":"cancelEvent","keyup @ui.nameInput":"onKeyReleased","paste @ui.inputName":"mouseRightCicked","cut @ui.inputName":"mouseRightCicked","blur @ui.nameInput":"onBlurNameInput","mousedown @ui.nameEditCancelIcon":"cancelNameEdit","click @ui.nameEditCancelIcon":"cancelEvent","click @ui.nameEditDiv":"cancelEvent"},"constructor":function(e,t){s.Behavior.prototype.constructor.apply(this,arguments),this._nameSchema=i.extend({"required":!0,"readonly":!1},this.options.nameSchema),this.view=t,this.view.ItemNameBehavior=this,this.listenTo(this.view.model||this.view.options.model,"change:name",this.toggleButton)},"updateNameSchema":function(e){this._nameSchema=i.extend({"required":!0,"readonly":!1},e),this.toggleButton()},"toggleButton":function(e){if(this.ui&&this.ui.inputName&&this.ui.inputName.val){var i=this.ui.inputName.val().trim(),t=!0;this._isEditMode()&&!this._isCopyMoveAction()||(t=this._nameSchema.required&&0==i.length,this.view.trigger("update:button",{"disabled":t}))}},"_isEditMode":function(){return void 0!==this.view.model.get("id")},"_isCopyMoveAction":function(){return"copy"===this.view.model.get("action")||"move"},"mouseRightCicked":function(e){var i=this;setTimeout(function(){i.toggleButton(e)},100)},"onBeforeDestroy":function(){this.view._nodeIconView&&this.view._nodeIconView.destroy(),this.view.dropdownMenuView&&(this.view.cancelEventsToViewsPropagation(this.view.dropdownMenuView),this.view.dropdownMenuView.destroy())},"onKeyInView":function(t){if(!this.view.readonly){var s=t||window.event;if(9===s.keyCode&&""===this.getInputBoxValue())return s.preventDefault(),s.stopPropagation(),this.validate(""),void setTimeout(i.bind(function(){this.view.ui.nameInput.focus()},this),100);if(27===s.keyCode)return void this.cancelNameEdit(s);if(32===s.keyCode||13===s.keyCode){var o=!!(this.view.dropdownMenuView&&this.view.dropdownMenuView.$el.find(s.target).length>0),l=13===s.keyCode?200:0,r=s.target||s.srcElement;o?(s.preventDefault(),s.stopPropagation(),n.isMozilla()||n.isEdge()?e(r).click():setTimeout(function(){e(r).click()},l)):!0!==this.view.editing&&(s.preventDefault(),s.stopPropagation(),setTimeout(i.bind(function(){this._toggleEditMode(!0)},this),l))}}},"setEditModeFocus":function(){this.view.readonly||setTimeout(i.bind(function(){this.view.ui.nameInput instanceof Object&&(this._toggleEditMode(!0),this.view.ui.nameInput.focus(),this.view.ui.nameInput[0].select())},this),500)},"showInlineError":function(e){this.view.ui.titleError.attr("title",e),this.view.ui.titleError.text(e),this.view.ui.titleError.attr("role","alert")},"clearInlineError":function(){this.view.ui.titleError.attr("title",""),this.view.ui.titleError.text(""),this.view.ui.titleError.removeAttr("role")},"validateInputName":function(i){var t=e.Deferred(),s=!0;if(this.view.readonly)return this.clearInlineError(),!0;var n=void 0===i?this.getValue():i;n=n.trim();var o=this;return this._isValidName(n).done(function(e){e?(o._displayInlineError(n,e),s=!1,t.resolve(s)):(o.clearInlineError(),t.resolve(s))}).fail(function(){t.reject()}),t.promise()},"validate":function(e){if(this.view.readonly)return this.clearInlineError(),!0;var i=void 0===e?this.getValue():e;return i=i.trim(),i.length<1?(this.showInlineError(a.nameErrorEmptyValue),!1):i.length>248?(this.showInlineError(a.nameErrorMaxLegthExceed),!1):i.indexOf(":")>=0?(this.showInlineError(a.nameErrorContainSemiColon),!1):(this.clearInlineError(),!0)},"_isValidName":function(i){var t=!0,s=e.Deferred();if(i&&i.length<=248&&-1===i.indexOf(":")){var n=this.view.model,o=n.parent||this.view.options.container;return!o||o.get("id")&&-1!==o.get("id")?this.checkNameExists(i).done(function(e,i,n){null===e.results[0].id&&(t=!1),s.resolve(t)}).fail(s.reject):s.resolve(!1),s.promise()}return s.resolve(t),s.promise()},"checkNameExists":function(i){var t=this.view.model,s=t.parent||this.view.options.container,n=s.connector,o=e.Deferred();return new l(null,{"container":s,"connector":n}).runQuery(s.get("id"),[i]).done(o.resolve).fail(o.reject),o.promise()},"_displayInlineError":function(e,i){var t;e.length<1?t=a.nameErrorEmptyValue:e.length>248?t=a.nameErrorMaxLegthExceed:-1!==e.indexOf(":")?t=a.nameErrorContainSemiColon:i&&(t=a.nameExists.replace("{name}",e)),this.showInlineError(t)},"getValue":function(){return this.view.ui.name.text()},"getInputBoxValue":function(){return this.view.modelHasEmptyName&&!0!==this.view.inputBoxNameChange?"":this.view.ui.nameInput.val()},"setValue":function(e){this.view.ui.name.text(e),this.view.ui.name.attr("title",e)},"setInputBoxValue":function(e){e||(e=""),this.view.ui.nameInput.val(e)},"_toggleEditMode":function(e,i){if(void 0===i&&(i=!0),this.view.readonly&&(e=!1),e){if(this._isEditingEnabled()){this.view.editing=!0,this.view.ui.name.addClass("binf-hidden"),this.view.ui.contextMenuDiv&&this.view.ui.contextMenuDiv.addClass("binf-hidden"),this.view.ui.nameEditDiv.removeClass("binf-hidden"),i&&this.view.ui.nameInput.focus();var t=this.view.ui.nameInput[0],s=t.value,n=s?s.length:0;t.selectionEnd=0,144===this.view.model.get("type")&&s.lastIndexOf(".")>0&&s.lastIndexOf(".")<s.length-1&&(n=s.lastIndexOf(".")),t.selectionEnd=n,0===s.length&&(this.view.ui.nameInput[0].placeholder=this.view.placeHolderName),this.view.trigger("changed:editmode",this.view.editing)}}else this.view.$el.is(":visible")&&(this.view.editing=!1,this.view.ui.nameEditDiv.addClass("binf-hidden"),this.view.ui.name.removeClass("binf-hidden"),i&&this.view.ui.name.focus(),this.view.ui.contextMenuDiv&&this.view.ui.contextMenuDiv.removeClass("binf-hidden"),this.view.trigger("changed:editmode",this.view.editing))},"_isEditing":function(){return this.view.editing},"_isEditingEnabled":function(){if(this.view.readonly)return!1;if(void 0===this.view.model.get("id"))return!0;var e=r.get("Rename");return e&&e.enabled({"nodes":new t.Collection([this.view.model]),"context":this.view.options.context})},"onClickName":function(e){this.view.readonly||(e.preventDefault(),e.stopPropagation(),this.view.options.model instanceof o||this._toggleEditMode(!0))},"cancelEvent":function(e){e.preventDefault(),e.stopPropagation()},"onKeyReleased":function(e){this.view.readonly||(this.view.options&&"create"===this.view.options.mode||(e.preventDefault(),e.stopPropagation(),27===e.keyCode?this.cancelNameEdit(e):13===e.keyCode?this.view.options.originatingView&&i.isFunction(this.view.options.originatingView._validateAndSave)?this.view.options.originatingView._validateAndSave():this.view._validateAndSave():""===this.getInputBoxValue()&&(this.view.ui.nameInput[0].placeholder=this.view.placeHolderName?this.view.placeHolderName:"",this.view.inputBoxNameChange=!1)),this.toggleButton(e))},"onBlurNameInput":function(e){if(!this.view.readonly){if(e.preventDefault(),e.stopPropagation(),!0===this.view.cancelEdit)return void(this.view.cancelEdit=!1);this.view.modelHasEmptyName&&!0!==this.view.inputBoxNameChange?(this.setInputBoxValue(this.placeHolderName),this.validate("")):this.view.options.originatingView&&i.isFunction(this.view.options.originatingView._validateAndSave)?this.view.options.originatingView._validateAndSave():this.view._validateAndSave()}},"cancelNameEdit":function(e){this.view.readonly||(e.preventDefault(),e.stopPropagation(),this.cancelEdit=!0,this.clearInlineError(),this.view.inputBoxNameChange=!this.view.modelHasEmptyName,this.view.modelHasEmptyName&&!0!==this.view.inputBoxNameChange?(this.setInputBoxValue(""),this.validate(""),this.toggleButton(e)):(this.setInputBoxValue(this.getValue()),this._toggleEditMode(!1),this.toggleButton()))},"_getErrorMessageFromResponse":function(i){var t;if(i&&i.responseJSON&&i.responseJSON.error)t=i.responseJSON.error,n.MessageHelper.hasMessages()&&n.MessageHelper.reset();else if(n.MessageHelper.hasMessages()){var s=n.MessageHelper.toHtml();n.MessageHelper.reset(),t=e(s).text()}return t}})}),csui.define("hbs!csui/controls/table.rowselection.toolbar/impl/right.toolbar",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"1":function(e,i,t,s){var n;return'  <div class="csui-condensed-header-toggle-container">\r\n    <button type="button" class="csui-condensed-header-toggle"\r\n            title="'+this.escapeExpression((n=null!=(n=i.toggleCondensedHeaderTooltip||(null!=e?e.toggleCondensedHeaderTooltip:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"toggleCondensedHeaderTooltip","hash":{}}):n))+'" aria-label="'+this.escapeExpression((n=null!=(n=i.toggleCondensedHeaderTooltip||(null!=e?e.toggleCondensedHeaderTooltip:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"toggleCondensedHeaderTooltip","hash":{}}):n))+'">\r\n      <span class="icon icon-condensed-header"></span>\r\n    </button>\r\n  </div>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){var n;return null!=(n=i.if.call(e,null!=e?e.showCondensedHeaderToggle:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?n:""}});return t.registerPartial("csui_controls_table.rowselection.toolbar_impl_right.toolbar",s),s}),csui.define("csui/controls/table.rowselection.toolbar/impl/nls/localized.strings",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/table.rowselection.toolbar/impl/nls/root/localized.strings",{"showCondensedHeaderTooltip":"Show header","hideCondensedHeaderTooltip":"Hide header"}),csui.define("css!csui/controls/table.rowselection.toolbar/impl/right.toolbar",[],function(){}),csui.define("csui/controls/table.rowselection.toolbar/impl/right.toolbar.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/controls/mixins/view.events.propagation/view.events.propagation.mixin","csui/behaviors/keyboard.navigation/tabable.region.behavior","hbs!csui/controls/table.rowselection.toolbar/impl/right.toolbar","i18n!csui/controls/table.rowselection.toolbar/impl/nls/localized.strings","css!csui/controls/table.rowselection.toolbar/impl/right.toolbar"],function(e,i,t,s,n,o,l){"use strict";var r=t.ItemView.extend({"className":"csui-right-toolbar-view","template":o,"templateHelpers":function(){return{"showCondensedHeaderToggle":this.options.showCondensedHeaderToggle,"toggleCondensedHeaderTooltip":l.showCondensedHeaderTooltip}},"behaviors":{"TabableRegion":{"behaviorClass":n}},"ui":{"condensedHeaderToggleButton":".csui-condensed-header-toggle","condensedHeaderToggleIcon":".icon-condensed-header"},"events":{"keydown":"onKeyInView","click .csui-condensed-header-toggle-container":"onClickCondensedHeaderToggle"},"constructor":function(e){e||(e={}),t.ItemView.prototype.constructor.call(this,e),this._toolbarVisible=!1},"onRender":function(){this.delegateEvents()},"onToolbarActivity":function(e,i){this._toolbarVisible=e,this.options.showCondensedHeaderToggle&&(this.ui.condensedHeaderToggleButton.attr("tabindex",e?"0":"-1"),i?(this.ui.condensedHeaderToggleIcon.addClass("icon-rotate180"),this.ui.condensedHeaderToggleButton.attr("aria-label",l.hideCondensedHeaderTooltip),this.ui.condensedHeaderToggleButton.attr("title",l.hideCondensedHeaderTooltip)):(this.ui.condensedHeaderToggleIcon.removeClass("icon-rotate180"),this.ui.condensedHeaderToggleButton.attr("aria-label",l.showCondensedHeaderTooltip),this.ui.condensedHeaderToggleButton.attr("title",l.showCondensedHeaderTooltip)))},"onClickCondensedHeaderToggle":function(e){this.trigger("toggle:condensed:header"),this.ui.condensedHeaderToggleButton.focus()},"currentlyFocusedElement":function(){return this._toolbarVisible?this.ui.condensedHeaderToggleButton:i()},"onKeyInView":function(e){32!==e.keyCode&&13!==e.keyCode||(e.preventDefault(),e.stopPropagation(),i(e.target).click())}});return e.extend(r.prototype,s),r}),csui.define("hbs!csui/controls/table.rowselection.toolbar/impl/table.rowselection.toolbar",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){return'<div class="csui-toolbar-region"></div>\r\n<div class="csui-right-toolbar-region"></div>\r\n'}});return t.registerPartial("csui_controls_table.rowselection.toolbar_impl_table.rowselection.toolbar",s),s}),csui.define("css!csui/controls/table.rowselection.toolbar/impl/table.rowselection.toolbar",[],function(){}),csui.define("csui/controls/table.rowselection.toolbar/table.rowselection.toolbar.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/utils/base","csui/controls/toolbar/toolitems.filtered.model","csui/controls/toolbar/toolbar.command.controller","csui/controls/toolbar/toolbar.view","csui/controls/toolbar/delayed.toolbar.view","csui/controls/table.rowselection.toolbar/impl/right.toolbar.view","csui/behaviors/keyboard.navigation/tabable.region.behavior","csui/controls/mixins/global.alert/global.alert.mixin","hbs!csui/controls/table.rowselection.toolbar/impl/table.rowselection.toolbar","css!csui/controls/table.rowselection.toolbar/impl/table.rowselection.toolbar"],function(e,i,t,s,n,o,l,r,a,c,u,d,h){"use strict";var p=s.LayoutView.extend({"template":h,"className":"csui-table-rowselection-toolbar-view","regions":{"toolbarRegion":".csui-toolbar-region","rightToolbarRegion":".csui-right-toolbar-region"},"events":{"keydown":"onKey"},"behaviors":{"TabableRegion":{"behaviorClass":u}},"currentlyFocusedElement":function(){return e(this._focusableElements[this._focusedToolbarItemIndex])},"constructor":function(e){e||(e={}),s.LayoutView.prototype.constructor.apply(this,arguments),this._focusedToolbarItemIndex=0},"initialize":function(e){var t={"nodes":e.selectedChildren,"context":e.context,"collection":e.collection,"container":e.collection.node};this._commandController=e.toolbarCommandController||new l({"commands":e.commands}),this._filteredToolItemsCollection=new o(e.toolItemFactory,{"status":t,"commands":this._commandController.commands,"delayedActions":e.collection.delayedActions,"mask":e.toolbarItemsMask});var s=i.extend({"originatingView":e.originatingView,"collection":this._filteredToolItemsCollection,"toolbarName":"tableHeader"},e.toolItemFactory.options,{"role":"menu"});e.collection.delayedActions?this._toolbarView=new a(s):this._toolbarView=new r(s),this.listenTo(this._toolbarView,"childview:toolitem:action",this._toolbarItemClicked),this.listenTo(this._toolbarView,"render render:lazy:actions",function(){this._updateCounts(),this._focusableElements.length&&(this._focusedToolbarItemIndex=0,this._moveTabindexToFocusedElement())}),this._rightToolbarView=new c(e),this.listenTo(this._rightToolbarView,"toggle:condensed:header",function(){this.trigger("toggle:condensed:header")}),this.listenTo(this,"toolbar:activity",function(e,i){this._rightToolbarView.triggerMethod("toolbar:activity",e,i)}),this.listenTo(this._commandController,"before:execute:command",function(e){this._toolbarView.trigger("before:execute:command",e)}),this.listenTo(this._commandController,"after:execute:command",function(e){this._toolbarView.trigger("after:execute:command",e)}),this.listenTo(this,"render",function(){this.toolbarRegion.show(this._toolbarView),this.rightToolbarRegion.show(this._rightToolbarView)}),this.listenTo(this,"dom:refresh",function(){this._toolbarView.triggerMethod("dom:refresh"),this._rightToolbarView.triggerMethod("dom:refresh")})},"_toolbarItemClicked":function(e,i){var t={"context":this.options.context,"nodes":this.options.selectedChildren,"container":this.options.collection.node,"collection":this.options.collection,"originatingView":this.options.originatingView,"toolItemView":e};this._commandController.toolitemClicked(i.toolItem,t)},"onKey":function(e){switch(e.keyCode){case 37:this._updateCounts(),this._focusedToolbarItemIndex>0?--this._focusedToolbarItemIndex>=this._visibleToolitemsCount&&(this._focusedToolbarItemIndex=this._visibleToolitemsCount-1):this._focusedToolbarItemIndex=0,this._moveTabindexToFocusedElement(),this._moveFocus(),e.preventDefault(),e.stopPropagation();break;case 39:this._updateCounts(),this._focusedToolbarItemIndex<this._visibleToolitemsCount-1?this._focusedToolbarItemIndex++:this._focusedToolbarItemIndex=this._visibleToolitemsCount-1,this._moveTabindexToFocusedElement(),this._moveFocus(),e.preventDefault(),e.stopPropagation()}},"_updateCounts":function(){this._focusableElements=n.findFocusables(this._toolbarView.el),this._visibleToolitemsCount=this._toolbarView.getVisibleToolitemsCount()},"_moveTabindexToFocusedElement":function(){for(var e=0;e<this._focusableElements.length;e++)e===this._focusedToolbarItemIndex?this._focusableElements[e].setAttribute("tabindex","0"):this._focusableElements[e].setAttribute("tabindex","-1")},"_moveFocus":function(){this.trigger("changed:focus"),this._toolbarView&&this._toolbarView.setFocusByIndex(this._focusedToolbarItemIndex)}});return i.extend(p.prototype,d),p}),csui.define("css!csui/behaviors/table.rowselection.toolbar/impl/table.rowselection.toolbar",[],function(){}),csui.define("csui/behaviors/table.rowselection.toolbar/table.rowselection.toolbar.behavior",["csui/lib/underscore","csui/lib/marionette","csui/controls/table.rowselection.toolbar/table.rowselection.toolbar.view","csui/lib/jquery.redraw","css!csui/behaviors/table.rowselection.toolbar/impl/table.rowselection.toolbar"],function(e,i,t){"use strict";function s(i,t,s){if(null!=i){var n=i[t];return e.isFunction(n)?i[t].call(s):n}}var n=/\baccessibleTable\b(?:=([^&]*)?)?/i.exec(location.search);return n=n&&"false"!==n[1],i.Behavior.extend({"initialize":function(){this.listenTo(this.view,{"before:render":this.setToolbar,"render":this.renderToolbar})},"setToolbar":function(){if(this.toolbarRegion=this.view[s(this.options,"toolbarRegionName",this.view)]||this.view.toolbarRegion,this.toolbarRegion&&this.view.tableView){var i=s(this.options,"visibleClassName",this.view)||"csui-rowselection-toolbar-visible",o=s(this.options,"toolbarViewOptions",this.view);this.toolbarView=new t(e.extend({"toolItemFactory":this.view.options.toolbarItems.tableHeaderToolbar,"toolbarItemsMask":this.view.options.toolbarItemsMasks.toolbars.tableHeaderToolbar,"toolbarCommandController":this.view.commandController,"commands":this.view.defaultActionController.commands,"selectedChildren":this.view.tableView.selectedChildren,"container":this.view.collection.node,"context":this.view.options.context,"originatingView":this.view,"collection":this.view.collection},o)),this.listenTo(this.view.tableView.selectedChildren,"reset",function(){var e=this.toolbarRegion.$el;this.view.tableView.selectedChildren.length>0?e.hasClass(i)||(n?e.removeClass("binf-hidden").addClass("csui-no-animation").addClass(i):e.removeClass("binf-hidden").redraw().addClass(i)):e.hasClass(i)&&(n?e.addClass("binf-hidden").addClass("csui-no-animation").removeClass(i):e.one("transitionend",function(){e.addClass("binf-hidden")}).removeClass(i)),this.toolbarView&&this.toolbarView.triggerMethod("dom:refresh")})}},"renderToolbar":function(){this.toolbarRegion&&this.toolbarView&&(this.toolbarRegion.show(this.toolbarView),this.toolbarRegion.$el.addClass("binf-hidden"))}})}),csui.define("csui/controls/dialog/impl/footer.view",["csui/lib/marionette","csui/behaviors/keyboard.navigation/tabable.region.behavior"],function(e,i){var t=e.ItemView.extend({"tagName":"button","className":"binf-btn","template":!1,"triggers":{"click":"click"},"behaviors":{"TabableRegion":{"behaviorClass":i}},"constructor":function(i){e.View.prototype.constructor.apply(this,arguments)},"isTabable":function(){return this.$el.is(":not(:disabled)")&&this.$el.is(":not(:hidden)")},"currentlyFocusedElement":function(){return-1===this.$el.prop("tabindex")&&this.$el.prop("tabindex",0),this.$el},"onRender":function(){var e=this.$el,i=this.model.attributes;e.text(i.label),e.addClass(i.default?"binf-btn-primary cs-add-button":"binf-btn-default"),i.toolTip&&e.attr("title",i.toolTip),i.separate&&e.addClass("cs-separate"),this.updateButton(i)},"updateButton":function(e){var i=this.$el;e||(e={}),void 0!==e.hidden&&(e.hidden?i.addClass("binf-hidden"):i.removeClass("binf-hidden")),void 0!==e.disabled&&i.prop("disabled",e.disabled)}});return e.CollectionView.extend({"childView":t,"constructor":function(i){e.CollectionView.prototype.constructor.apply(this,arguments)},"onDomRefresh":function(){this.children.each(function(e){e.trigger("dom:refresh")})},"getButtons":function(){return this.children.toArray()},"updateButton":function(e,i){var s=this.collection.get(e);s?this.children.findByModel(s).updateButton(i):t.updateButton(this.$('[data-cs-id="'+e+'"]'),i)}})}),csui.define("hbs!csui/controls/dialog/impl/dialog.header",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"1":function(e,i,t,s){var n,o;return(null!=(n=i.if.call(e,null!=e?e.actionIconLeft:e,{"name":"if","hash":{},"fn":this.program(2,s,0),"inverse":this.noop}))?n:"")+(null!=(n=i.if.call(e,null!=e?e.iconLeft:e,{"name":"if","hash":{},"fn":this.program(4,s,0),"inverse":this.program(6,s,0)}))?n:"")+'    <h2 class="tile-title binf-modal-title csui-heading">'+this.escapeExpression((o=null!=(o=i.title||(null!=e?e.title:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"title","hash":{}}):o))+'</h2>\r\n  </div>\r\n\r\n    <div class="cs-header-control"></div>\r\n\r\n    <div class="cs-close" title="'+this.escapeExpression((o=null!=(o=i.dialogCloseButtonTooltip||(null!=e?e.dialogCloseButtonTooltip:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"dialogCloseButtonTooltip","hash":{}}):o))+'"\r\n         tabindex="0" aria-label="'+this.escapeExpression((o=null!=(o=i.dialogCloseAria||(null!=e?e.dialogCloseAria:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"dialogCloseAria","hash":{}}):o))+'" role="button">\r\n      <div class="icon circular '+this.escapeExpression((o=null!=(o=i.iconRight||(null!=e?e.iconRight:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"iconRight","hash":{}}):o))+'"></div>\r\n    </div>\r\n\r\n'},"2":function(e,i,t,s){var n;return'    <span class="tile-type-action-icon cs-icon-left '+this.escapeExpression((n=null!=(n=i.actionIconLeft||(null!=e?e.actionIconLeft:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"actionIconLeft","hash":{}}):n))+'" tabindex="0"></span>\r\n'},"4":function(e,i,t,s){var n;return'    <span class="tile-type-icon cs-icon-left '+this.escapeExpression((n=null!=(n=i.iconLeft||(null!=e?e.iconLeft:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"iconLeft","hash":{}}):n))+'"></span>\r\n    <div class="tile-title">\r\n'},"6":function(e,i,t,s){var n;return null!=(n=i.if.call(e,null!=e?e.imageLeftUrl:e,{"name":"if","hash":{},"fn":this.program(7,s,0),"inverse":this.program(9,s,0)}))?n:""},"7":function(e,i,t,s){var n;return'        <div class="tile-type-image '+this.escapeExpression((n=null!=(n=i.imageLeftClass||(null!=e?e.imageLeftClass:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"imageLeftClass","hash":{}}):n))+'">\r\n          <span class="tile-type-icon tile-type-icon-img">\r\n           <img src="'+this.escapeExpression((n=null!=(n=i.imageLeftUrl||(null!=e?e.imageLeftUrl:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"imageLeftUrl","hash":{}}):n))+'" alt="" aria-hidden="true">\r\n          </span>\r\n        </div>\r\n      <div class="tile-title">\r\n'},"9":function(e,i,t,s){return'      <div class="tile-title cs-text-only">\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){var n;return null!=(n=i.if.call(e,null!=e?e.expandedHeader:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?n:""}});return t.registerPartial("csui_controls_dialog_impl_dialog.header",s),s}),csui.define("csui/controls/dialog/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/dialog/impl/nls/root/lang",{"dialogCloseButtonTooltip":"Close","dialogCloseAria":"Close dialog"}),csui.define("css!csui/controls/dialog/impl/dialog",[],function(){}),csui.define("csui/controls/dialog/impl/header.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/behaviors/keyboard.navigation/tabable.region.behavior","hbs!csui/controls/dialog/impl/dialog.header","i18n!csui/controls/dialog/impl/nls/lang","css!csui/controls/dialog/impl/dialog"],function(e,i,t,s,n,o){return t.ItemView.extend({"template":n,"behaviors":{"TabableRegion":{"behaviorClass":s}},"ui":{"headerControl":".cs-header-control"},"events":{"keydown":"onKeyInView"},"templateHelpers":function(){return{"iconLeft":this.options.iconLeft,"actionIconLeft":this.options.actionIconLeft,"imageLeftUrl":this.options.imageLeftUrl,"imageLeftClass":this.options.imageLeftClass,"title":this.options.title,"iconRight":this.options.iconRight||"cs-icon-cross","expandedHeader":this.options.expandedHeader,"dialogCloseButtonTooltip":o.dialogCloseButtonTooltip,"dialogCloseAria":o.dialogCloseAria}},"constructor":function(e){t.View.prototype.constructor.apply(this,arguments)},"isTabable":function(){return this.$("*[tabindex]").length>0},"currentlyFocusedElement":function(e){var t=this.$("*[tabindex]");return t.length&&t.prop("tabindex",0),e&&e.shiftKey?i(t[t.length-1]):i(t[0])&&i(t[0]).focus()},"onLastTabElement":function(e,i){return e&&i.target===this.$("*[tabindex]")[0]},"onKeyInView":function(e){var t=e.keyCode;13!==t&&32!==t||i(e.target).click()},"onRender":function(){var i=this.options.headers||[];i.length&&e.each(i,function(e){var i=this._renderHeader(e);this.$el.append(i)},this);var t=this.options.headerControl;t&&(this.ui.headerControl.append(t.$el),t.render(),t.trigger("dom:refresh")),this.options.actionIconLeft&&this._adjustTitleCSS()},"onDomRefresh":function(){var e=this.options.headerControl;e&&(e.triggerMethod("dom:refresh"),e.triggerMethod("after:show"))},"_renderHeader":function(e){var t=i('<div class="modal-header-item"></div>').text(e.label);return e.class&&t.addClass(e.class),t},"_adjustTitleCSS":function(e){this.$el.find("div.tile-title").addClass("tile-action-icon-tittle")}})}),csui.define("hbs!csui/controls/dialog/impl/dialog",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"1":function(e,i,t,s){var n;return'      <div class="binf-modal-body cs-dialog cs-dialog-bodymessage">'+this.escapeExpression((n=null!=(n=i.bodyMessage||(null!=e?e.bodyMessage:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"bodyMessage","hash":{}}):n))+"</div>\r\n"},"3":function(e,i,t,s){return'      <div class="binf-modal-body"></div>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){var n,o;return'<div class="binf-modal-dialog '+this.escapeExpression((o=null!=(o=i.binfDialogSizeClassName||(null!=e?e.binfDialogSizeClassName:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"binfDialogSizeClassName","hash":{}}):o))+'" role="dialog" aria-modal="true" aria-hidden="false">\r\n  <div class="binf-modal-content" >\r\n    <div class="tile-header binf-modal-header"></div>\r\n'+(null!=(n=i.if.call(e,null!=e?e.bodyMessage:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.program(3,s,0)}))?n:"")+'    <div class="binf-modal-footer binf-hidden"></div>\r\n  </div>\r\n</div>\r\n'}});return t.registerPartial("csui_controls_dialog_impl_dialog",s),s}),csui.define("csui/controls/dialog/dialog.view",["module","csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/controls/mixins/layoutview.events.propagation/layoutview.events.propagation.mixin","csui/behaviors/keyboard.navigation/tabables.behavior","csui/controls/dialog/impl/footer.view","csui/controls/dialog/impl/header.view","hbs!csui/controls/dialog/impl/dialog","csui/utils/non-emptying.region/non-emptying.region","csui/utils/log","i18n","css!csui/controls/dialog/impl/dialog","csui/lib/binf/js/binf"],function(e,i,t,s,n,o,l,r,a,c,u,d,h){d=d(e.id);var p=n.LayoutView.extend({"className":function(){var e="cs-dialog binf-modal binf-fade";return this.options.className&&(e+=" "+i.result(this.options,"className")),e},"attributes":{"tabindex":"-1","aria-hidden":"true"},"template":c,"behaviors":{"TabablesBehavior":{"behaviorClass":l,"recursiveNavigation":!0,"containTabFocus":!0}},"regions":{"body":".binf-modal-body","header":".binf-modal-header","footer":".binf-modal-footer"},"ui":{"header":".binf-modal-header","footer":".binf-modal-footer","body":".binf-modal-body"},"events":{"hide.binf.modal":"onHiding","hidden.binf.modal":"onHidden","click .cs-close":"onClickClose","shown.binf.modal":"onShown","keyup":"onKeyInView","setCurrentTabFocus":"setCurrentTabFocus","tabNextRegion":"tabNextRegion","click .tile-type-action-icon":"onClickActionIcon"},"templateHelpers":function(){var e="";return!!this.options.fullSize&&(e="binf-modal-full"),!!this.options.largeSize&&(e="binf-modal-lg"),!!this.options.midSize&&(e="binf-modal-md"),{"binfDialogSizeClassName":e,"bodyMessage":this.options.bodyMessage}},"constructor":function(){n.LayoutView.prototype.constructor.apply(this,arguments),this.listenToOnce(this,"before:hide",l.popTabableHandler),this.propagateEventsToRegions(),this.options.headerControl},"onKeyInView":function(e){27!==e.keyCode||e.isDefaultPrevented()||this.destroy()},"setCurrentTabFocus":function(){this.focusOnLastRegion=!0,this.$el.focus()},"tabNextRegion":function(){this.trigger("changed:focus")},"show":function(){var e=t.fn.binf_modal.getDefaultContainer();return new u({"el":e}).show(this),this},"onRender":function(){this.$el.addClass(p.prototype.className.call(this)).attr({"tabindex":0,"aria-label":this.options.dialogTxtAria||this.options.title||"","role":"region"}),this._renderHeader(),this.options.view&&this.body.show(this.options.view),this._renderFooter()},"onShow":function(){t(window).scrollTop(0),this.$el.binf_modal({"backdrop":"static","keyboard":!1,"paddingWhenOverflowing":!1})},"kill":function(){return p.__super__.destroy.apply(this,arguments),this._scrollToBegin(),!0},"destroy":function(){return this.$el.is(":visible")?this.$el.binf_modal("hide"):p.__super__.destroy.apply(this,arguments),this._scrollToBegin(),this},"updateButton":function(e,i){var t=this.footerView;if(!t.updateButton)throw new Error("Dialog footer does not support button updating.");t.updateButton(e,i)},"showView":function(e){this.body.show(e),e.triggerMethod("after:show")},"onShown":function(){this.options.view&&this.options.view.triggerMethod&&(this.options.view.triggerMethod("dom:refresh"),this.options.view.triggerMethod("after:show")),this.headerView&&this.headerView.triggerMethod&&(this.headerView.triggerMethod("dom:refresh"),this.headerView.triggerMethod("after:show")),this.footerView&&this.footerView.triggerMethod&&(this.footerView.triggerMethod("dom:refresh"),this.footerView.triggerMethod("after:show"))},"onHiding":function(){this.triggerMethod("before:hide")},"onHidden":function(){this.triggerMethod("hide"),this.destroy()},"onClickClose":function(e){e.preventDefault(),e.stopPropagation(),this.destroy()},"onClickActionIcon":function(e){this.options.view.trigger("click:actionIcon")},"onClickButton":function(e){var i=e.model.attributes;i.click&&i.click({"dialog":this,"button":this.$el,"buttonAttributes":i}),i.close&&this.destroy()},"_scrollToBegin":function(){if(!0===h.settings.rtl){var e=t("body").width();t("body").scrollLeft(e)
}else t("body").scrollLeft(0)},"_renderHeader":function(){var e=this.headerView=this.options.headerView,i=void 0!==this.options.standardHeader?this.options.standardHeader:!this.options.template;if(e)this.header.show(e);else{var t={"iconLeft":this.options.iconLeft,"actionIconLeft":this.options.actionIconLeft,"imageLeftUrl":this.options.imageLeftUrl,"imageLeftClass":this.options.imageLeftClass,"title":this.options.title,"iconRight":this.options.iconRight||"cs-icon-cross","headers":this.options.headers,"headerControl":this.options.headerControl,"expandedHeader":i,"el":this.ui.header[0]};e=this.headerView=new a(t),e.render(),this.header.attachView(e),this.headerView.trigger("dom:refresh")}},"_renderFooter":function(){var e=this.footerView=this.options.footerView;if(e)this.ui.footer.removeClass("binf-hidden"),this.footer.show(e);else{var i=this.options.buttons||[];i.length&&this.ui.footer.removeClass("binf-hidden"),e=this.footerView=new r({"collection":new s.Collection(i),"el":this.ui.footer[0]}),this.listenTo(e,"childview:click",this.onClickButton),e.render(),this.footer.attachView(e)}}});return i.extend(p.prototype,o),p}),csui.define("csui/controls/conflict.resolver/impl/conflict.dialog/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/conflict.resolver/impl/conflict.dialog/impl/nls/root/lang",{"conflictCount":"{0} Conflicts","oneConflict":"1 Conflict","upload":"Upload","cancel":"Cancel","inputPlaceHolder":"Enter filename","nameConflict":"This file already exists.","nameConflictVersionAria":"A file {0} already exists. Add a new version","nameConflictRenameAria":"A file {0} already exists. Rename","nameConflictSkipAria":"A file {0} already exists. Skip","rename":"Rename","addVersion":"Add version","skip":"Skip","conflict":"Conflict","cancelUpload":"Cancel Upload","renamed":"Renamed","undo":"Undo","undoAria":"File {0} has state {1}. Undo","retry":"Retry","serverError":"File(s) not uploaded due to server error."}),csui.define("hbs!csui/controls/conflict.resolver/impl/conflict.dialog/impl/conflict.item/conflict.item",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"1":function(e,i,t,s){var n;return'          <div class="csui-msg" title="'+this.escapeExpression((n=null!=(n=i["conflict-error-msg"]||(null!=e?e["conflict-error-msg"]:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"conflict-error-msg","hash":{}}):n))+'">'+this.escapeExpression((n=null!=(n=i["conflict-error-msg"]||(null!=e?e["conflict-error-msg"]:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"conflict-error-msg","hash":{}}):n))+"</div>\r\n"},"3":function(e,i,t,s){var n,o;return(null!=(n=i.unless.call(e,null!=e?e.excludeAddVersion:e,{"name":"unless","hash":{},"fn":this.program(4,s,0),"inverse":this.noop}))?n:"")+'    <button type="button" class="binf-btn btn-rename conflict-field '+this.escapeExpression((o=null!=(o=i.multiRowClass||(null!=e?e.multiRowClass:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"multiRowClass","hash":{}}):o))+'" aria-label="'+this.escapeExpression((o=null!=(o=i.renameAria||(null!=e?e.renameAria:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"renameAria","hash":{}}):o))+'" tabindex="0"\r\n            title="'+this.escapeExpression((o=null!=(o=i.rename||(null!=e?e.rename:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"rename","hash":{}}):o))+'" data-cs-id="rename">'+this.escapeExpression((o=null!=(o=i.rename||(null!=e?e.rename:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"rename","hash":{}}):o))+"</button>\r\n"},"4":function(e,i,t,s){var n;return'      <button type="button" class="binf-btn btn-version conflict-field" aria-label="'+this.escapeExpression((n=null!=(n=i.versionAria||(null!=e?e.versionAria:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"versionAria","hash":{}}):n))+'" tabindex="0" title="'+this.escapeExpression((n=null!=(n=i.version||(null!=e?e.version:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"version","hash":{}}):n))+'"\r\n            data-cs-id="version">'+this.escapeExpression((n=null!=(n=i.version||(null!=e?e.version:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"version","hash":{}}):n))+"</button>\r\n"},"6":function(e,i,t,s){var n;return null!=(n=i.if.call(e,null!=e?e.noServerError:e,{"name":"if","hash":{},"fn":this.program(7,s,0),"inverse":this.noop}))?n:""},"7":function(e,i,t,s){var n;return'      <button type="button" class="binf-btn btn-undo '+this.escapeExpression((n=null!=(n=i.multiRowClass||(null!=e?e.multiRowClass:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"multiRowClass","hash":{}}):n))+'" aria-label="'+this.escapeExpression((n=null!=(n=i.undoAria||(null!=e?e.undoAria:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"undoAria","hash":{}}):n))+'" tabindex="0" title="'+this.escapeExpression((n=null!=(n=i.undo||(null!=e?e.undo:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"undo","hash":{}}):n))+'">'+this.escapeExpression((n=null!=(n=i.undo||(null!=e?e.undo:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"undo","hash":{}}):n))+"</button>\r\n"},"9":function(e,i,t,s){var n;return null!=(n=i.if.call(e,null!=e?e.multiConflicts:e,{"name":"if","hash":{},"fn":this.program(10,s,0),"inverse":this.noop}))?n:""},"10":function(e,i,t,s){var n;return null!=(n=i.if.call(e,null!=e?e.statusNotSkip:e,{"name":"if","hash":{},"fn":this.program(11,s,0),"inverse":this.noop}))?n:""},"11":function(e,i,t,s){var n;return'        <span class="cs-icon circle_delete conflict-field" tabindex="0" title="'+this.escapeExpression((n=null!=(n=i.skip||(null!=e?e.skip:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"skip","hash":{}}):n))+'" aria-label="'+this.escapeExpression((n=null!=(n=i.skipAria||(null!=e?e.skipAria:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"skipAria","hash":{}}):n))+'" role="button"></span>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){var n,o;return'\r\n<span class="csui-icon csui-status-icon '+this.escapeExpression((o=null!=(o=i["status-icon"]||(null!=e?e["status-icon"]:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"status-icon","hash":{}}):o))+' " aria-hidden="true"></span>\r\n\r\n\r\n      <div class="csui-icon '+this.escapeExpression((o=null!=(o=i["file-icon"]||(null!=e?e["file-icon"]:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"file-icon","hash":{}}):o))+'" aria-hidden="true"></div>\r\n\r\n\r\n      <div class="csui-description">\r\n        <div class="csui-name">\r\n          <span class="folder-name conflict-field '+this.escapeExpression((o=null!=(o=i["status-ok"]||(null!=e?e["status-ok"]:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"status-ok","hash":{}}):o))+'" title="'+this.escapeExpression((o=null!=(o=i.name||(null!=e?e.name:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"name","hash":{}}):o))+'">'+this.escapeExpression((o=null!=(o=i.name||(null!=e?e.name:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"name","hash":{}}):o))+'</span>\r\n          <input class="binf-form-control cs-input rename-field binf-hidden" placeholder="'+this.escapeExpression((o=null!=(o=i.inputPlaceHolder||(null!=e?e.inputPlaceHolder:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"inputPlaceHolder","hash":{}}):o))+'" tabindex="-1">\r\n          <span class="csui-undo edit-cancel inline-edit-icon  rename-field binf-hidden" tabindex="-1" title="'+this.escapeExpression((o=null!=(o=i.cancel||(null!=e?e.cancel:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"cancel","hash":{}}):o))+'"></span>\r\n        </div>\r\n'+(null!=(n=i.if.call(e,null!=e?e.conflict:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?n:"")+'      </div>\r\n\r\n    <div class="csui-status conflict-field '+this.escapeExpression((o=null!=(o=i["status-ok"]||(null!=e?e["status-ok"]:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"status-ok","hash":{}}):o))+'" title="'+this.escapeExpression((o=null!=(o=i.status||(null!=e?e.status:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"status","hash":{}}):o))+'">'+this.escapeExpression((o=null!=(o=i.status||(null!=e?e.status:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"status","hash":{}}):o))+'</div>\r\n\r\n\r\n\r\n<div class="csui-button-container" style="'+this.escapeExpression((o=null!=(o=i.resolvedStyle||(null!=e?e.resolvedStyle:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"resolvedStyle","hash":{}}):o))+'">\r\n'+(null!=(n=i.if.call(e,null!=e?e.conflict:e,{"name":"if","hash":{},"fn":this.program(3,s,0),"inverse":this.program(6,s,0)}))?n:"")+"\r\n\r\n"+(null!=(n=i.if.call(e,null!=e?e.noServerError:e,{"name":"if","hash":{},"fn":this.program(9,s,0),"inverse":this.noop}))?n:"")+'\r\n\r\n<div class=\'csui-internal-placeholder rename-field binf-hidden\'>\r\n  <div class="csui-progress-container binf-hidden">\r\n    <div class="loader">\r\n      <div class="inner-border"></div>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n</div>\r\n'}});return t.registerPartial("csui_controls_conflict.resolver_impl_conflict.dialog_impl_conflict.item_conflict.item",s),s}),csui.define("css!csui/controls/conflict.resolver/impl/conflict.dialog/impl/conflict.item/conflict.item",[],function(){}),csui.define("css!csui/controls/conflict.resolver/impl/conflict.dialog/impl/conflict.item/progress.wheel",[],function(){}),csui.define("csui/controls/conflict.resolver/impl/conflict.dialog/impl/conflict.item/conflict.item.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/utils/nodesprites","csui/models/namequery","i18n!csui/controls/conflict.resolver/impl/conflict.dialog/impl/nls/lang","csui/controls/progressblocker/blocker","csui/utils/base","csui/utils/log","hbs!csui/controls/conflict.resolver/impl/conflict.dialog/impl/conflict.item/conflict.item","css!csui/controls/conflict.resolver/impl/conflict.dialog/impl/conflict.item/conflict.item","css!csui/controls/conflict.resolver/impl/conflict.dialog/impl/conflict.item/progress.wheel","css!csui/controls/globalmessage/globalmessage_icons"],function(e,i,t,s,n,o,l,r,a,c){return t.ItemView.extend({"constructor":function(s){if(t.ItemView.call(this,s),this._onDynamicPlacment=e.bind(this._setDynamicPlacement,this),i(window).bind("resize.app",this._onDynamicPlacment),!this.model.get("newName")){var n=this.model.get("name");this.model.set("newName",n)}this.blockKeyUp=!1},"ui":{"inputField":"input","fileDescription":".csui-description","versionBtn":".btn-version","renameBtn":".btn-rename","cancelIcon":".circle_delete","progressWheel":".csui-progress-container","errorMessage":".csui-msg","statusText":".csui-status","cancelEdit":".edit-cancel","conflictFields":".conflict-field","renameFields":".rename-field"},"triggers":{"click @ui.versionBtn":"click:version","mouseleave":"hide:cancel","click @ui.cancelEdit":"cancel:input"},"events":{"click @ui.renameBtn":"onRename","focusout @ui.renameFields":"_queryName","click @ui.cancelIcon":"onCancelUpload","keydown @ui.cancelIcon":"onCancelUpload","click .btn-undo":"undo","mouseenter":"onHover","focus *[tabindex]":"onFocus","keydown":"onKeyInView","keyup":"onKeyUp","mousedown @ui.cancelEdit":"onMouseDownCancel"},"tagName":"div","className":"binf-list-group-item","template":c,"templateHelpers":function(){var i=this.options.multiConflicts&&"skip"!==this.model.status?"":"no-cancel-icon",t=this.model.get("newName");return{"file-icon":this.getMimeTypeIcon(),"name":t,"conflict-error-msg":o.nameConflict,"conflict":!this.model.status,"status":this.getStatus(),"excludeAddVersion":this.model.excludeAddVersion||!1===this.model.get("versioned"),"version":o.addVersion,"versionAria":e.str.sformat(o.nameConflictVersionAria,t),"rename":o.rename,"renameAria":e.str.sformat(o.nameConflictRenameAria,t),"skip":o.skip,"skipAria":e.str.sformat(o.nameConflictSkipAria,t),"multiConflicts":this.options.multiConflicts,"multiRowClass":i,"undo":o.undo,"undoAria":e.str.sformat(o.undoAria,t,this.getStatus()),"status-ok":this.getResolveStatus(),"status-icon":this.getStatusIcon(),"cancel":o.cancel,"inputPlaceHolder":o.inputPlaceHolder,"statusNotSkip":"skip"!==this.model.status,"noServerError":"serverError"!==this.model.status,"resolvedStyle":this.resolvedStyle}},"onKeyInView":function(e){var t=e.keyCode,s=i(e.target),n=!0;switch(t){case 9:s.hasClass("cs-input")&&(e.preventDefault(),n=!1);break;case 27:s.hasClass("cs-input")&&(this.escapePressed=!0,this.blockKeyUp=!0,this.onCancelInput(),this.setFocusInView(),n=!1);break;case 32:case 13:s.hasClass("cs-input")&&13===t&&(this._queryName(),n=!1)}return n},"onKeyUp":function(e){27===e.keyCode&&this.blockKeyUp&&(e.stopPropagation(),this.blockKeyUp=!1)},"onFocus":function(e){this.trigger("item:focus",e.target)},"setFocusInView":function(){this.$el.find("input:not([disabled]),  button:not([disabled])").filter(":visible")[0].focus()},"getStatus":function(){switch(this.model.status){case"renamed":return o.renamed;case"skip":return o.skip;case"version":return o.addVersion;case"serverError":return o.serverError}return o.conflict},"getStatusIcon":function(){var e="csui-icon-notification-warning";switch(this.model.status){case"version":case"renamed":case"skip":e="csui-icon-notification-success";break;case"serverError":e="category_delete"}return e},"getMimeTypeIcon":function(){var e;return e=void 0===this.model.get("mime_type")&&void 0!==this.model.get("file")?this.model.get("file").type:null!==this.model.get("mime_type")?this.model.get("mime_type"):this.model.get("type"),this.model.set("mime_type",e),s.findClassByNode(this.model)},"getResolveStatus":function(){var e="";switch(this.model.status){case"version":case"renamed":case"skip":e="ok";break;case"serverError":e="error"}return e},"onDestroy":function(){i(window).unbind("resize.app",this._onDynamicPlacment)},"onClickVersion":function(e){this.model.status="version",this.model.set("newVersion",!0),this.setResolveStatus(!0),this.render()},"onRename":function(e){e.preventDefault(),e.stopPropagation();var i=this.model.get("newName");this.ui.inputField.val(i),this.ui.conflictFields.addClass("binf-hidden"),this.ui.renameFields.removeClass("binf-hidden"),this.ui.inputField.focus(),this.ui.fileDescription.addClass("edit-mode"),this.$el.addClass("edit-mode"),this.$el.find(".csui-status-icon").addClass("edit-mode")},"onCancelInput":function(){this.render()},"onCancelUpload":function(e){void 0!==e.keyCode&&32!==e.keyCode&&13!==e.keyCode||(e.stopPropagation(),e.preventDefault(),this.options.removeItemList[this.model.get("id")]=this.model,this.previousState=this.model.status,this.model.status="skip",this.setResolveStatus(!0),this.render())},"setResolveStatus":function(e){this._resolved&&!e&&this.trigger("resolved",!1),!this._resolved&&e&&this.trigger("resolved",!0),this._resolved=e},"onHover":function(){this.resolvedStyle||(this.resolvedStyle="width:"+i(".csui-button-container").width()+"px;"),this.ui.cancelIcon.addClass("binf-show")},"onHideCancel":function(){this.ui.cancelIcon.removeClass("binf-show")},"onRender":function(){this.model.get("first")&&this.$el.addClass("no-border"),this._setDynamicPlacement(),this.mouseDownCancel=!1,this.escapePressed=!1},"undo":function(e){e.preventDefault(),e.stopPropagation();var i=this.model.get("id");this.model.status=this.previousState,this.previousState?(delete this.options.removeItemList[i],this.previousState=void 0):(this.oldName&&this.model.set("newName",this.oldName),this.oldId&&this.model.set("id",this.oldId),this.oldName=this.Id=void 0,this.model.set("newVersion",void 0),delete this.options.removeItemList[i],this.model.status=void 0,this.setResolveStatus(!1)),this.render()},"_queryName":function(){var e=this.ui.inputField.val(),i=this.model.get("newName");e=e&&e.trim(),!e||e===i||this.mouseDownCancel||this.escapePressed?this.escapePressed?this.escapePressed=!1:(this.onCancelInput(),this.mouseDownCancel=!1):(this.oldName=i,this.oldId=this.model.get("id"),this.model.set("id",void 0),this.model.set("newName",e),this.ui.progressWheel.removeClass("binf-hidden"),this._runNameQuery([{"name":e}]))},"onMouseDownCancel":function(e){this.mouseDownCancel=!0,e.stopPropagation()},"_runNameQuery":function(e){var i=this;new n({"containerId":this.options.parentId},{"connector":this.options.connector}).queryNames(e).done(function(e,t){t&&t.length>0?i._resetConflictStatus(t):i._setRenameStatus()}).fail(function(e){i.ui.progressWheel.addClass("binf-hidden"),i._processServerError(e)})},"_processServerError":function(e){this.options.removeItemList[this.model.get("id")]=this.model,this.model.status="serverError",this.$el.removeClass("edit-mode"),this._setErrorMsg(e),this.setResolveStatus(!0),this.render()},"_setErrorMsg":function(e){var i=(o.serverError,"Conflict.Item.View: Server returned error during name query");e&&(i=new r.RequestErrorMessage(e)),a.error(i)&&console.error(a.last)},"_setRenameStatus":function(){this.model.status="renamed",this.$el.removeClass("edit-mode"),this.setResolveStatus(!0),this.render()},"_resetConflictStatus":function(e){this.model.set("id",e[0].id),this.render()},"_setDynamicPlacement":function(){i(window).width()-176<600?(this.$el.addClass("sm"),this.ui.statusText.addClass("sm"),this.ui.fileDescription.addClass("sm")):(this.$el.removeClass("sm"),this.ui.statusText.removeClass("sm"),this.ui.fileDescription.removeClass("sm"))}})}),csui.define("csui/controls/conflict.resolver/impl/conflict.dialog/impl/conflict.list.navigation",["csui/lib/jquery","csui/behaviors/keyboard.navigation/tabable.region.behavior"],function(e,i){"use strict";return{"currentlyFocusedElement":function(e){e="object"==typeof e?e.shiftKey:e;var i=this.$("button[tabindex=-1]");return i.length&&(i.prop("tabindex",0),this.$(".circle_delete").prop("tabindex",0)),e?this.$("[tabindex]:visible").last():this.$("[tabindex]:visible").first()},"onKeyInView":function(i){var t=i.keyCode,s=e(i.target),n=!1;switch(t){case 39:case 37:if(s.hasClass("cs-input"))return!0;this.navigateLeftRight(t);break;case 38:case 40:this.navigateUpDown(t);break;default:n=!0}return n},"navigateUpDown":function(i){var t,s,n,o,l=this.focusedElement,r=l.hasClass("btn-version")?".btn-version":l.hasClass("btn-rename")||l.hasClass("btn-undo")?".btn-rename, .btn-undo":".circle_delete",a=this.collection.length;if(38===i&&this.activeChildIndex>0){for(s=this.activeChildIndex-1;s>=0;s--)if(n=this.children.findByIndex(s),o=n.$(r),o.length>0){t=s;break}}else if(40===i&&this.activeChildIndex<a-1)for(s=this.activeChildIndex+1;s<a;s++)if(n=this.children.findByIndex(s),o=n.$(r),o.length>0){t=s;break}void 0!==t&&(this.$(".csui-focus").removeClass("csui-focus"),e(this.children.findByIndex(t).$(r)).focus())},"navigateLeftRight":function(i){var t,s=this.activeChildView.$("[tabindex=0]"),n=this._getActiveIndex(s);void 0!==n&&(37===i&&n>0?t=n-1:39===i&&n<s.length-1&&(t=n+1),void 0!==t&&e(s[t]).focus())},"onLastTabElement":function(t){var s=void 0===this.activeElementIndex?0:this.activeElementIndex,n=(this.children.findByIndex(s),this.$("[tabindex=0]")),o=n.length-1;if(n.length){var l=t?n[0]:n[o];return this.$(".csui-focus").removeClass("csui-focus"),e(l).hasClass(i.accessibilityActiveElementClass)}return!0},"setItemFocus":function(t,s){this.activeChildView=t,this.$(".csui-focus").removeClass("csui-focus"),t.$el.addClass("csui-focus"),this.focusedElement&&this.focusedElement.removeClass(i.accessibilityActiveElementClass),this.focusedElement=e(s),this.focusedElement.addClass(i.accessibilityActiveElementClass),this.activeChildIndex=t.model.index},"clearTabFocus":function(){}}}),csui.define("csui/controls/conflict.resolver/impl/conflict.dialog/impl/conflict.list.view",["csui/lib/underscore","csui/lib/jquery","csui/utils/base","csui/controls/list/simplelist.view","csui/controls/conflict.resolver/impl/conflict.dialog/impl/conflict.item/conflict.item.view","csui/behaviors/keyboard.navigation/tabable.region.behavior","csui/controls/conflict.resolver/impl/conflict.dialog/impl/conflict.list.navigation"],function(e,i,t,s,n,o,l){var r=s.extend({"childView":n,"childEvents":{"resolved":"trackResolved","item:focus":"setItemFocus"},"events":{"keydown":"onKeyInView","mouseenter":"clearTabFocus"},"behaviors":{"TabableRegionBehavior":{"behaviorClass":o}},"constructor":function(t){t||(t={}),s.prototype.constructor.apply(this,arguments),this.multiList=t.numConflicts>1,this.removeItemList=[],this.listenToOnce(this,"mouseenter",this.onUpdateScroll),this._onSetContaintListHeight=e.bind(this._setContainerListHeight,this),i(window).bind("resize.app",this._onSetContaintListHeight)},"childViewOptions":function(){return{"multiConflicts":this.multiList,"connector":this.options.connector,"parentId":this.options.parentId,"removeItemList":this.options.removeItemList}},"onDomRefresh":function(){this._setContainerListHeight()},"onUpdateScroll":function(){this.triggerMethod("update:scrollbar",this)},"onDestroy":function(){i(window).unbind("resize.app",this._onSetContaintListHeight)},"trackResolved":function(){var e=arguments[1];this.options.trackResolved(e)},"_setContainerListHeight":function(){var e=.9*i(window).height()-100-60-130+"px";this.$el.find(".cs-content").css("max-height",e)},"_getActiveIndex":function(e){for(var t=e.length-1,s=0;s<=t;s++)if(i(e[s]).hasClass(o.accessibilityActiveElementClass))return s}});return e.extend(r.prototype,l),r}),csui.define("css!csui/controls/conflict.resolver/impl/conflict.dialog/impl/conflict.dialog",[],function(){}),csui.define("csui/controls/conflict.resolver/impl/conflict.dialog/conflict.dialog",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/controls/dialog/dialog.view","i18n!csui/controls/conflict.resolver/impl/conflict.dialog/impl/nls/lang","csui/utils/log","csui/controls/list/simplelist.view","csui/controls/conflict.resolver/impl/conflict.dialog/impl/conflict.item/conflict.item.view","csui/controls/conflict.resolver/impl/conflict.dialog/impl/conflict.list.view","css!csui/controls/conflict.resolver/impl/conflict.dialog/impl/conflict.dialog"],function(e,i,t,s,n,o,l,r,a){"use strict";function c(t){this.options=t||{},this.deferred=i.Deferred(),this.removeItemList={},this._resolveCount=this.options.conflictFiles.length,this.deferred.then(e.bind(this.destroy,this),e.bind(this.destroy,this))}return e.extend(c.prototype,t.Events,{"destroy":function(){this._view.destroy(),this._view.off(),this._dialog.destroy()},"show":function(){var e=this.options.conflictFiles;return e[0].first=!0,this._view=this._getListView(e),this._dialog=this._createDialog(e),this._view.$el.hover(function(){i(".cs-content").trigger("scroll")}),this.deferred},"_createDialog":function(i){var t=this.options,o=this,l=i.length>1?n.conflictCount:n.oneConflict,r=e.str.sformat(l,i.length),a=new s({"standardHeader":!1,"view":this._view,"className":"csui-conflict-dialog csui-individual","attributes":{"data-backdrop":"static"},"headers":[{"id":"h1","label":this.options.h1Label,"class":"csui-numUploads"},{"id":"h2","label":r,"class":"csui-numConflicts"}],"buttons":[{"id":"upload","label":t.actionBtnLabel,"toolTip":t.actionBtnLabel,"disabled":!0,"click":function(){a.destroy(),o._resolutionComplete()}},{"id":"cancel","label":n.cancel,"toolTip":n.cancel,"click":function(){a.destroy(),o.cancel()}}],"dialogTxtAria":this.options.h1Label+". "+r});return a.on("hide",function(){a.off(),this.cancel()},this),a.show(),a},"_getListView":function(e){var i=this;return new a({"data":{"items":e},"numConflicts":e.length,"removeItemList":this.removeItemList,"connector":this.options.connector,"parentId":this.options.parentId,"trackResolved":function(e){i.trackResolved(e)}})},"cancel":function(){return this.deferred.reject(),!0},"trackResolved":function(t){var s=i(".csui-conflict-dialog.csui-individual .csui-numConflicts");t?0==--this._resolveCount&&this._dialog.updateButton("upload",{"disabled":!1}):(this._resolveCount++,this._dialog.updateButton("upload",{"disabled":!0}));var o=this._resolveCount>1||0===this._resolveCount?n.conflictCount:n.oneConflict;return s.text(e.str.sformat(o,this._resolveCount)),!0},"_resolutionComplete":function(){return this.deferred.resolve(this._view.collection.models,this.removeItemList),!0}}),c.version="1.0",c}),csui.define("hbs!csui/controls/conflict.resolver/impl/collection.conflicts/collection.conflicts",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){var n;return'<span id="csui-collection-conflicts-title"\r\n      class="csui-collection-conflicts-title">'+this.escapeExpression((n=null!=(n=i.conflictsItemsTitle||(null!=e?e.conflictsItemsTitle:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"conflictsItemsTitle","hash":{}}):n))+'</span>\r\n<ul id="csui-collection-conflict-items" class="csui-collection-conflict-items"></ul>\r\n'}});return t.registerPartial("csui_controls_conflict.resolver_impl_collection.conflicts_collection.conflicts",s),s}),csui.define("hbs!csui/controls/conflict.resolver/impl/collection.conflicts/collection.conflict.item",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){var n;return'<span class="csui-type-icon '+this.escapeExpression((n=null!=(n=i.icon||(null!=e?e.icon:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"icon","hash":{}}):n))+'" /><span class="item-name">'+this.escapeExpression((n=null!=(n=i.conflictsItemsName||(null!=e?e.conflictsItemsName:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"conflictsItemsName","hash":{}}):n))+"</span>\r\n"}});return t.registerPartial("csui_controls_conflict.resolver_impl_collection.conflicts_collection.conflict.item",s),s}),csui.define("csui/controls/conflict.resolver/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/conflict.resolver/impl/nls/root/lang",{"batchMessage":"These files already exist. How do you want to proceed?","skipConflicts":"Skip conflicts","resolveIndividual":"Resolve individually","conflictCount":"{0} Conflicts","upload":"Upload","cancel":"Cancel","addVersion":"Add version","conflictsItemsHeader":"Listed items will not be added"}),csui.define("css!csui/controls/conflict.resolver/impl/collection.conflicts/conflicts.dialog",[],function(){}),csui.define("csui/controls/conflict.resolver/impl/collection.conflicts/collection.conflicts.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","hbs!csui/controls/conflict.resolver/impl/collection.conflicts/collection.conflicts","hbs!csui/controls/conflict.resolver/impl/collection.conflicts/collection.conflict.item","csui/controls/node-type.icon/node-type.icon.view","i18n!csui/controls/conflict.resolver/impl/nls/lang","csui/controls/tile/behaviors/perfect.scrolling.behavior","css!csui/controls/conflict.resolver/impl/collection.conflicts/conflicts.dialog"],function(e,i,t,s,n,o,l,r){"use strict";var a=t.ItemView.extend({"tagName":"li","template":n,"className":"csui-conflict-item","templateHelpers":function(){return{"conflictsItemsName":this.model.get("name")}},"constructor":function(e){e||(e={}),t.ItemView.prototype.constructor.call(this,e)},"onRender":function(){this._nodeIconView=new o({"el":this.$(".csui-type-icon").get(0),"node":this.model.node}),this._nodeIconView.render()}});return t.CompositeView.extend({"template":s,"className":"csui-conflicts-items-data","childView":a,"childViewContainer":"#csui-collection-conflict-items","ui":{"conflictItems":"#csui-collection-conflict-items"},"templateHelpers":function(){return{"conflictsItemsTitle":l.conflictsItemsHeader}},"behaviors":{"PerfectScrolling":{"behaviorClass":r,"contentParent":"ul.csui-collection-conflict-items","suppressScrollX":!0,"scrollYMarginOffset":15}},"constructor":function(s){s||(s={}),this.collection=s.collection||{},t.CompositeView.prototype.constructor.apply(this,arguments),this._onSetContaintListHeight=e.bind(this._setContainerListHeight,this),i(window).bind("resize.app",this._onSetContaintListHeight)},"onDomRefresh":function(){this._setContainerListHeight()},"_setContainerListHeight":function(){var e=.9*i(window).height()-100-60-112+"px";i(".csui-collection-conflict-items").css("max-height",e)},"onDestroy":function(){i(window).unbind("resize.app",this._onSetContaintListHeight)}})}),csui.define("css!csui/controls/conflict.resolver/impl/conflict.resolver",[],function(){}),csui.define("csui/controls/conflict.resolver/conflict.resolver",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/controls/dialog/dialog.view","i18n!csui/controls/conflict.resolver/impl/nls/lang","csui/utils/log","csui/controls/conflict.resolver/impl/conflict.dialog/conflict.dialog","csui/models/namequery","csui/utils/base","csui/models/fileuploads","css!csui/controls/conflict.resolver/impl/conflict.resolver"],function(e,i,t,s,n,o,l,r,a,c){"use strict";function u(t){this.options=t||{},this.deferred=i.Deferred(),this.container=t.container,this.actionBtnLabel=t.actionBtnLabel||n.upload,this.excludeAddVersion=t.excludeAddVersion||!1,this.files=t.files instanceof c?t.files:new c(t.files),this.deferred.then(e.bind(this.destroy,this),e.bind(this.destroy,this))}return e.extend(u.prototype,{"destroy":function(){this._dialog&&this._dialog.destroy()},"run":function(i){var t=this;return e.extend(this.options,i),this.queryNames(this.files).done(function(e,i){t._resolveConflicts(e,i)}).fail(function(e){var i=t.getMsgResponse(e);t.deferred.reject(new Error(i))}),this.deferred.promise()},"queryNames":function(e){var t=i.Deferred();return new r({"containerId":this.container.get("id")},{"connector":this.container.connector}).queryNames(e).done(function(e,i){t.resolve(e,i)}).fail(function(e){var i=new a.Error(e);t.reject(i)}),t},"getMsgResponse":function(e){var i=n.fileNameQueryFailed;return e&&(i=new a.RequestErrorMessage(e),i=i.message),i},"showBatchResolve":function(e){var t=i.Deferred(),s=n.batchMessage,o=[{"id":"versions","label":n.addVersion,"toolTip":n.addVersion,"click":function(e){t.resolve("versions",e.dialog)}},{"id":"skip","label":n.skipConflicts,"toolTip":n.skipConflicts,"click":function(e){t.resolve("skip",e.dialog)}},{"id":"individual","label":n.resolveIndividual,"toolTip":n.resolveIndividual,"click":function(e){t.resolve("individual",e.dialog)}}];return this.excludeAddVersion&&o.shift(),this._createDialog("csui-conflict-dialog csui-batch",e,o,s),t},"showIndividualResolve":function(i){var t,s=this;return e.each(i,function(e){e.excludeAddVersion=s.excludeAddVersion}),t=this._conflictDialog=new l({"parentId":this.container.get("id"),"connector":this.container.connector,"totalNumFiles":this.options.files.length,"conflictFiles":i,"actionBtnLabel":this.actionBtnLabel,"h1Label":this.options.h1Label}),t.show().done(function(e,i){s._removeDeletedFiles(i),s._returnFiles()}).fail(function(){s.deferred.reject({"userAction":"cancelResolveNamingConflicts"})}),t},"_createDialog":function(i,t,o,l,r){var a=e.str.sformat(n.conflictCount,t.length),c=this.options.h1Label+". "+a+". "+l,u=this._dialog=new s({"bodyMessage":l,"standardHeader":!1,"view":r,"className":i,"attributes":{"data-backdrop":"static"},"headers":[{"id":"h1","label":this.options.h1Label,"class":"csui-numUploads"},{"id":"h2","label":a,"class":"csui-numConflicts"}],"buttons":o,"dialogTxtAria":c});return u.listenTo(u,"hide",e.bind(this.deferred.reject,this)),u.show(),u},"_resolveConflicts":function(e,i){var t=this;return this.nonConflictFiles=e,i&&i.length>0?i.length>1?this.showBatchResolve(i).then(function(e,s){switch(s.kill(),e){case"versions":t._addVersions(i),t._returnFiles();break;case"individual":t.showIndividualResolve(i);break;case"skip":t._removeConnflicts(i),t._returnFiles()}}):this.showIndividualResolve(i):this.deferred.resolve(this.options.files,i.length>0),!0},"_returnFiles":function(){if(this.options.files.length&&this.options.files instanceof c)this.deferred.resolve(this.files);else if(this.files.length){var i=[]
;e.each(this.files.models,function(e){i.push(e.attributes)}),this.deferred.resolve(i)}else this.deferred.reject()},"_removeConnflicts":function(i){var t=this.files;e.each(i,function(e){t.remove(e)})},"_addVersions":function(i){e.each(i,function(e){e.set("newVersion",!0)})},"_removeDeletedFiles":function(i){e.each(i,function(e){this.files.remove(e)},this)},"_getArrayOfFileNames":function(i){var t=[];return e.each(i,function(e){var i=e.newName||e.name;t.push({"name":i})}),t}}),u.version="1.0",u}),csui.define("csui/controls/draganddrop/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/draganddrop/impl/nls/root/lang",{"defaultDropMessage":"Drop your file(s) into {0}","singleFileDropMessage":"Drop file to upload it to:<br> {0}","MultipleFilesDropMessage":"Drop files to upload them to: <br> {0}","versionDropMessage":"Add version to {0}.","dropNotPermitted":"No files can be dropped here.","dropInvalid":"Only files can be dropped here.","noFiles":"No files were dropped.","addTypeDenied":"Cannot add documents to {0}.","addVersionDeniedForReservedItem":"Unable to add version to reserved item.","addVersionDenied":"Unable to add version to {0}. You do not have permission.","dialogTitle":"Add version","dialogTemplate":"Add new version to {0}?"}),csui.define("csui/controls/fileupload/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/fileupload/impl/nls/root/lang",{"uploadCounts":"Uploading {0} files","uploadCount":"Uploading 1 file","OneFileSuccessfullyUploaded":"{0} file was successfully uploaded.","AllFilesSuccessfullyUploaded":"{0} files were successfully uploaded.","over500Items":"Cannot add more than 500 items.","invalidFileList":"Invalid file list","fileNameQueryFailed":"File name query failed - reason unknown.","MessageVersionAdded":"Version added","pageLeavingWarning":"If you leave the page now, pending files will not be uploaded."}),csui.define("csui/controls/fileupload/impl/fileupload.collection",["require","module","csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/utils/log","i18n!csui/controls/fileupload/impl/nls/lang","csui/controls/fileupload/impl/upload.controller","csui/models/fileuploads","csui/controls/globalmessage/globalmessage","csui/controls/conflict.resolver/conflict.resolver","csui/dialogs/modal.alert/modal.alert","csui/utils/page.leaving.blocker"],function(e,i,t,s,n,o,l,r,a,c,u,d,h){"use strict";var p=n.Model.extend({"defaults":{"parentCollection":null,"container":null},"constructor":function(e,i){e||(e={}),n.Model.prototype.constructor.call(this,e,i);var t=this.container=this.get("container"),s=this.get("parentCollection");this.uploadFiles=new a,this.controller=new r({"container":t}),s&&(this.originalCollectionUrl=s.url(),this.listenTo(s,"reset",this._stopCollectionUpdate),this.listenTo(s.node,"request",this._stopCollectionUpdate)),this._uploadCounts={"failed":0,"success":0,"complete":0}},"close":function(){return this.onDestroy(),this.trigger("destroy"),!0},"onDestroy":function(){return this.uploadView&&this.uploadView.destroy(),!0},"onUploadFileAdded":function(e){e.promise().done(s.bind(this.onFileUploadProcessed,this)).fail(s.bind(this.onFileUploadFailed,this))},"addFilesToUpload":function(e,i){var t=this;if(this._validateFileList(e)){var n=this.setBlocker();return this.addFilesToUploadCollection(e,i),this.resolveNamingConflicts(i).then(s.bind(this.checkAndHandleRequiredMetadata,this,i)).then(s.bind(this.addToUpload,this)).fail(function(e){e&&(e.error?c.showMessage("error",e.error.message):e.userAction&&"cancelAddOneItemWithRequiredMetadata"===e.userAction?t.trigger("metadata:cancelled"):e.userAction&&"closeMetadataActionView"===e.userAction?t.trigger("metadata:closed"):e.userAction&&"cancelResolveNamingConflicts"===e.userAction&&t.trigger("resolve:naming:conflicts:cancelled"))}).always(function(){n&&n.unblockActions(),t.close()}),!0}return this.close(),!1},"addFilesToUploadCollection":function(e,i){s.each(e,function(e){var t=e,s=t.container||i&&i.container||this.container,n=i&&i.collection||this.get("parentCollection");t.file&&(e=t.file);var o=t.newName||e.newName;this.uploadFiles.add({"file":e,"newName":o,"name":o||e.name,"extended_data":t.data||{},"collection":n,"subType":this.get("addableType")},{"container":s,"connector":s.connector,"enforcedRequiredAttrs":!0})},this)},"setBlocker":function(){var e=this.get("originatingView");return e&&e.blockActions||(e=void 0),e&&e.blockActions(),e},"resolveNamingConflicts":function(e){var i=this.uploadFiles;if(e&&e.skipResolveNamingConflicts){var n=t.Deferred();return s.each(i.models,s.bind(function(e){console.log(e),"version"===this.status&&(e.attributes.id=this.itemId,e.attributes.newVersion=!0)},this)),n.resolve(i)}var o=1===i.length?l.uploadCount:l.uploadCounts;return new u({"h1Label":s.str.sformat(o,i.length),"container":e&&e.container||this.container,"files":i}).run()},"_validateFileList":function(e){if(!e||0===e.length)return o.debug("No upload files selected")&&console.log(o.last),!1;var i=e[0];return!!(i.name||i.file&&i.file.name||i.get&&i.get("name"))||(c.showMessage("error",l.invalidFileList),!1)},"checkAndHandleRequiredMetadata":function(e,i){var s=this,n=t.Deferred();return csui.require(["csui/widgets/metadata/metadata.add.document.controller"],function(t){(new t).addItemsRequiredMetadata(i,{"container":e&&e.container||s.container,"addableType":144,"context":s.get("context")}).then(function(){return i}).done(n.resolve).fail(n.reject)},function(e){o.warn("Failed to load MetadataAddDocumentController. {0}",e)&&console.warn(o.last),n.reject(e)}),n.promise()},"addToUpload":function(e){if(e&&e.length>0){var i;s.each(e.models,function(e){if(!e.get("id")||e.get("newName")||e.get("newVersion")){var t=e.get("newName")||e.get("file").name;if(e.set("mime_type",e.get("file").type),o.debug("Object was added - {0}",t)&&console.log(o.last),!i){i=!0;var s=this.get("pageLeavingWarning")||l.pageLeavingWarning;h.enable(s)}this.controller.scheduleFileForUpload(e),this.onUploadFileAdded(e)}else o.debug("Object was skipped - {0}",e.name)},this)}else o.debug("No files were upload. All have naming conflict")&&console.log(o.last);this.showProgress(e)},"onFileUploadProcessed":function(e){if(!this.stopParentUpdate){var i=e.get("collection"),s=this.get("parentCollection");if(i||(i=s),i!==s||s&&s.url()==this.originalCollectionUrl){!e.get("newVersion")&&(e.node.isLocallyCreated=!0,i.unshift(e.node),t(".csui-new-item").closest("tbody").scrollTop(0))}}this._increaseUploadCount("success")},"onFileUploadFailed":function(e,i){this._increaseUploadCount("failed")},"showProgress":function(e){this.uploadView&&this.uploadView.destroy();var i={"originatingView":this.get("originatingView")};c.showFileUploadProgress(e,i)},"_stopCollectionUpdate":function(){this.stopParentUpdate=!1},"_increaseUploadCount":function(e){var i=this.uploadFiles.length,t=this._uploadCounts;if("failed"===e?t.failed++:t.success++,++t.complete===i&&(h.disable(),0===t.failed)){c.hideFileUploadProgress();var n=1===i?l.OneFileSuccessfullyUploaded:l.AllFilesSuccessfullyUploaded;c.showMessage("success",s.str.sformat(n,i))}this.close()}});return n.Collection.extend({"model":p})}),csui.define("csui/controls/fileupload/fileupload",["module","csui/lib/underscore","csui/lib/backbone","csui/controls/fileupload/impl/fileupload.collection"],function(e,i,t,s){"use strict";return{"newUpload":function(e,t){e||(e={}),t||(t={}),i.extend(t,{"parentCollection":e.collection,"container":e.container?e.container.clone():void 0,"originatingView":e.originatingView,"context":e.context||t&&t.context}),this.collection||(this.collection=new s);var n=this.collection.add(t);return n.listenToOnce(n,"destroy",function(){this.collection.remove(n)},this),n}}}),csui.define("csui/utils/dragndrop.supported.subtypes",["csui-ext!csui/utils/dragndrop.supported.subtypes"],function(e,i){"use strict";var t=[0,202,751,30205,144];return i&&t.concat(i),t}),csui.define("hbs!csui/controls/draganddrop/impl/draganddrop",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){var n;return'\r\n  <span class="csui-messageBox">'+this.escapeExpression((n=null!=(n=i.message||(null!=e?e.message:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"message","hash":{}}):n))+"</span>\r\n"}});return t.registerPartial("csui_controls_draganddrop_impl_draganddrop",s),s}),csui.define("css!csui/controls/draganddrop/impl/draganddrop",[],function(){}),csui.define("csui/controls/draganddrop/draganddrop.view",["module","csui/lib/jquery","csui/lib/underscore","csui/lib/marionette","csui/lib/backbone","csui/utils/log","i18n!csui/controls/draganddrop/impl/nls/lang","csui/controls/globalmessage/globalmessage","csui/controls/fileupload/fileupload","csui/dialogs/modal.alert/modal.alert","csui/utils/dragndrop.supported.subtypes","csui/utils/base","hbs!csui/controls/draganddrop/impl/draganddrop","css!csui/controls/draganddrop/impl/draganddrop","csui/lib/jquery.when.all"],function(e,i,t,s,n,o,l,r,a,c,u,d,h){var p=t.defaults({},e.config(),{"detectLeaveDelay":10});return s.ItemView.extend({"template":h,"className":"csui-dropMessage","ui":{"message":".csui-messageBox"},"templateHelpers":function(){return{"message":this._getDropPossibleMessage()}},"constructor":function(e){s.ItemView.prototype.constructor.call(this,e),this.collection=e.collection,this.container=e.container,this.addableTypes=e.addableTypes,this.wantDragAndDrop=!0,this.context=e.context,this.visible=!1,this.highlightedTarget=e.highlightedTarget,this.originatingView=e.originatingView,this.listenTo(this.options.container,"change:name",this._resetMessage)},"setDragParentView":function(e,s){return this._parentEl=t.isString(s)&&e.$(s)||void 0!==s.length&&s||s&&i(s)||e.$el,this.render(),e.csuiDropMessage||(e.csuiDropMessage=this.$el,this._parentEl.append(e.csuiDropMessage)),this.parentView=e,this.shouldDragAndDrop()&&(this.disable(),this._setDragEvents()),!0},"onDestroy":function(){this.shouldDragAndDrop()&&this._parentEl&&this._parentEl.off("dragover",this.dragOver).off("dragleave",this.dragLeave).off("drop",this.dragDrop)},"stopListeningDragEvent":function(e,t){i(e)&&t&&i(e).off("dragover",t.dragOver).off("dragleave",t.dragLeave).off("drop",t.dragDrop)},"_setDragEvents":function(){this.dragOver=t.bind(this.onOverView,this),this.dragLeave=t.bind(this.onLeaveView,this),this.dragDrop=t.bind(this.onDropView,this),this._parentEl.on("dragover",this.dragOver).on("dragleave",this.dragLeave).on("drop",this.dragDrop)},"getSupportedSubType":function(){return{"type":144,"type_name":"Document"}},"enable":function(e){if(this.visible||(!1!==e&&this.trigger("drag:over"),this.parentView.csuiDropMessage.show(),this.visible=!0),this.canAdd()){var i=this.getSupportedSubType();this.options.addableType=i.type,this.options.addableTypeName=i.type_name}},"disable":function(e){this.trigger("drag:leave",this,{"highlightedTarget":this.highlightedTarget}),e&&"dragleave"===e.type?e.relatedTarget?this.parentView.$el.find(".drag-over").length||i("div.csui-dropMessage").length&&i("div.csui-dropMessage")[0].className!==e.relatedTarget.className&&(this.parentView.csuiDropMessage.hide(),this.visible=!1):this.parentView.$el.find(".drag-over").length||(this.parentView.csuiDropMessage.hide(),this.visible=!1):(this.parentView.csuiDropMessage.hide(),this.visible=!1)},"shouldDragAndDrop":function(){var e=!1,i=document.createElement("div");return window.File&&window.FileReader&&window.FileList&&window.Blob&&("draggable"in i||"ondragstart"in i&&"ondrop"in i)&&(e=!0),e&&this.wantDragAndDrop},"canAdd":function(){return!!(this.addableTypes&&this.addableTypes.length&&this.addableTypes.get(144))||!this.addableTypes},"isDndSupportedContainer":function(e){return-1!==i.inArray(e.get("type"),u)},"onOverView":function(e){if(e.preventDefault(),e.stopPropagation(),i(e.target).closest(".csui-thumbnail-overview-container .binf-popover").length)return!1;this.leaveViewTimeout?(clearTimeout(this.leaveViewTimeout),this.leaveViewTimeout=void 0):this.enable(!1);var s=e.originalEvent&&e.originalEvent.dataTransfer,n=s.items,o=n&&n.length&&t.all(n,function(e){return"file"===e.kind}),r=s&&s.types,a=r&&r.length&&t.any(r,function(e){return"files"===e.toLowerCase()}),c=l.dropInvalid;if(this.valid=n&&o||a,!this.canAdd()){var u=this.isDndSupportedContainer(this.originatingView.container);this.valid=u&&this.options.isSupportedRowView,c=l.dropNotPermitted}n&&n.length>1&&144===this.container.get("type")?(this.currentRowHighlightedTarget||(this.currentRowHighlightedTarget=this.highlightedTarget,this.highlightedTarget=void 0),this.originatingView.addableTypes&&!this.originatingView.addableTypes.get(144)&&(this.valid=!1)):this.currentRowHighlightedTarget&&(this.highlightedTarget=this.currentRowHighlightedTarget,this.currentRowHighlightedTarget=void 0),this.valid&&this._resetMessage({"items":n}),this.overViewTimeout||(this.overViewTimeout=setTimeout(t.bind(function(){this.overViewTimeout=void 0,this.valid?(this.parentView.csuiDropMessage.hasClass("csui-disabled")&&this.parentView.csuiDropMessage.removeClass("csui-disabled"),this.trigger("drag:over",this,{"disabled":!1,"highlightedTarget":this.highlightedTarget}),this.parentView.csuiDropMessage.show(),this.visible=!0):(!this.parentView.csuiDropMessage.hasClass("csui-disabled")&&this.parentView.csuiDropMessage.addClass("csui-disabled"),this.parentView.csuiDropMessage.html(c),this.parentView.csuiDropMessage.show(),this.visible=!0,this.trigger("drag:over",this,{"disabled":!0}))},this),p.detectLeaveDelay))},"onLeaveView":function(e){e.preventDefault(),e.stopPropagation(),this.leaveViewTimeout||(this.leaveViewTimeout=setTimeout(t.bind(function(){this.leaveViewTimeout=void 0,this.disable(e)},this),p.detectLeaveDelay)),this.overViewTimeout&&(clearTimeout(this.overViewTimeout),this.overViewTimeout=void 0)},"onDropView":function(e){e.preventDefault(),e.stopPropagation(),this.overViewTimeout&&(clearTimeout(this.overViewTimeout),this.overViewTimeout=void 0);var i=this,s=e.originalEvent&&e.originalEvent.dataTransfer||{"files":e.originalEvent&&e.originalEvent.target&&e.originalEvent.target.files||[]};this._selectFiles(s).always(function(e){if(e=t.reject(e,function(e){return e instanceof Error}),e.length)if(i.canAdd()||i.isDndSupportedContainer(i.options.originatingView.container)&&i.options.isSupportedRowView){var s={};if(s={"container":144===i.container.get("type")?i.options.originatingView.container:i.container,"context":i.context,"originatingView":i.options.originatingView},i.options.isSupportedRowView&&144!==i.container.get("type")||(s.collection=i.collection),1===e.length&&144===i.container.get("type")){var n=i.container.get("name");i.container.fetch().done(function(){i.container.actions.findWhere({"signature":"addversion"})?c.confirmQuestion(t.str.sformat(l.dialogTemplate,n),l.dialogTitle,{}).done(function(t){i._addVersionToFile(s,e)}):i.container.get("reserved")?r.showMessage("warning",t.str.sformat(l.addVersionDeniedForReservedItem)):r.showMessage("warning",t.str.sformat(l.addVersionDenied,n))}).fail(function(e){if(e){var i=new d.Error(e);r.showMessage("error",i.message)}})}else{var o=a.newUpload(s,i.options);o.addFilesToUpload(e)}}else{var u=i.container.get("name");r.showMessage("error",t.str.sformat(l.addTypeDenied,u))}else r.showMessage("error",l.noFiles)}),this.disable()},"_addVersionToFile":function(e,i){var t=a.newUpload(e);t.status="version",t.itemId=this.container.get("id"),t.addFilesToUpload(i,{"skipResolveNamingConflicts":!0})},"_selectFiles":function(e){function s(e){var t,s=new FileReader,n=i.Deferred();s.addEventListener("load",function(){n.resolve(e),t=!0,s.abort()}),s.addEventListener("error",function(){if(!t){var i=new Error("No file");i.file=e,n.reject(i)}});try{s.readAsArrayBuffer(e)}catch(i){var o=new Error(i.message);o.file=e,n.reject(o)}return n.promise()}var n=!1,o=!1,l=e.items,r=l&&l.length&&t.chain(l).map(function(e){var i=e.webkitGetAsEntry&&e.webkitGetAsEntry();if(i&&i.isFile)return n=!0,e.getAsFile();o=!0}).compact().value()||e.files;if(n){var a=o?"reject":"resolve";return i.Deferred()[a](r).promise()}return r=e.files,r?i.whenAll.apply(i,t.map(r,s)).then(function(e){return e},function(e){return i.Deferred().reject(e).promise()}):i.Deferred().reject([]).promise()},"_resetMessage":function(e){if(this._isRendered){var i=this.parentView.csuiDropMessage;i&&i.length&&i.html(this._getDropPossibleMessage(e))}},"_getDropPossibleMessage":function(e){var i=e&&e.items,s=i&&i.length,n=s&&s>1&&144===this.container.get("type")?this.originatingView.container.get("name"):this.container.get("name"),o="";return n&&(o=t.str.sformat(function(){return s&&s>1?l.MultipleFilesDropMessage:s?l.singleFileDropMessage:l.defaultDropMessage}(),n)),o}})}),csui.define("csui/controls/fileupload/impl/addversion.controller",["csui/lib/underscore","csui/lib/jquery","i18n!csui/controls/fileupload/impl/nls/lang","csui/controls/fileupload/impl/upload.controller","csui/models/fileupload","csui/controls/globalmessage/globalmessage","csui/models/fileuploads"],function(e,i,t,s,n,o,l){"use strict";function r(e){this.view=e.view,this.selectedNode=e.selectedNode,this.uploadController=new s}return e.extend(r.prototype,{"uploadFile":function(i){this._blockActions();var s=new n({"file":i},{"node":this.selectedNode}),r=new l([s]);return this.uploadController.scheduleFileForUpload(s),o.showFileUploadProgress(r),s.promise().always(e.bind(this._unblockActions,this)).done(function(e){o.hideFileUploadProgress(),o.showMessage("success",t.MessageVersionAdded)})},"_blockActions":function(){this.view&&this.view.blockActions&&this.view.blockActions()},"_unblockActions":function(){this.view&&this.view.unblockActions&&this.view.unblockActions()}}),r}),csui.define("csui/controls/pagination/impl/keyevent.navigation",["csui/lib/underscore","csui/lib/jquery","csui/utils/base"],function(e,i,t){"use strict";return{"isTabable":function(){if(t.isVisibleInWindowViewport(this.ui.pageSizeMenu)&&t.isVisibleInWindowViewport(this.ui.navPagingMenu))return!0},"currentlyFocusedElement":function(){return this.getActiveChild()},"accActivateTabableRegion":function(){this.activateChild(!0)},"onKeyInView":function(e){var i=e.keyCode;this.getActiveChild();switch(this.activeChild||(this.activeChild=this.ui.dropDownMenu),i){case 32:case 13:if(this.activeChild===this.ui.dropDownMenu)return!0;this.executeAction(this.activeChild);break;case 39:var t=this._getNextActiveChild();this.setNextActiveChild(t);break;case 37:var s=this._getPrevActiveChild();this.setNextActiveChild(s);break;case 38:if(this.activeChild===this.ui.dropDownMenu)return!0;this._pageUp();break;case 33:this._pageUp();break;case 40:if(this.activeChild===this.ui.dropDownMenu)return!0;this._pageDown();break;case 34:this._pageDown();break;case 36:this._activateHomeElem();break;case 35:this._activateEndElem()}},"executeAction":function(e){if(e){var i=e.attr("data-pageid"),t=e.attr("data-slidepage");if(t){var s=parseInt(t,10);this.slidePageMenu(s),this.activeChild=this.ui.navPagingMenu.find("a").first(),this.activateChild(!0,this.activeChild)}else if(i){var n=parseInt(i,10);this.changePage(n),this.activeChild.removeClass("csui-acc-focusable-active")}}},"activateChild":function(e,i){i||(i=this.getActiveChild()),e?(i.addClass("csui-acc-focusable-active"),i.focus()):i.removeClass("csui-acc-focusable-active")},"setActiveChild":function(e){this.activeChild=e},"getActiveChild":function(){return this.activeChild||(this.activeChild=this.ui.dropDownMenu),this.activeChild},"setNextActiveChild":function(e){e!==this.activeChild&&(this.activateChild(!1,this.activeChild),this.activateChild(!0,e),this.activeChild=e)},"resetActiveChild":function(){var e=this.activeChild;if(this.activateChild(!1),this.activeChild=null,e){var i=e.attr("data-pageid"),t=e.attr("data-slidepage");if(i)this.activeChild=this._updatedChildPosition(i,e);else if(t&&this.numSlideMenus>1){var s=e.parent().prev();s=s.length>0?s.find("a"):e.parent().next().find("a"),i=s.attr("data-pageid"),this.activeChild=this._updatedChildPosition(i,s)}}this.activeChild||(this.activeChild=this.ui.dropDownMenu)},"_updatedChildPosition":function(t,s){if(t=parseInt(t,10),this.totalCount>this.pageSize){var n=this.numPages-1;t=t>n?n:t;var o=Math.floor(t/this.pageTabsPerMenu);return o>0&&this._initializePageTabMenu(!0,!0,o),t+="",s=e.find(this.ui.navPagingMenu.find("a"),function(e){return i(e).attr("data-pageid")===t}),i(s)}return null},"_getPrevActiveChild":function(){var e=this.ui.dropDownMenu,i=this.activeChild;if(i===this.ui.dropDownMenu)e=this.ui.navPagingMenu.find("a").last();else{var t=i.attr("data-pageid"),s=i.attr("data-slidepage");if(t||s){var n=i.parent().prev().find("a");n.length>0&&(e=n)}}return e},"_getNextActiveChild":function(){var e=this.ui.dropDownMenu,i=this.activeChild;if(i===this.ui.dropDownMenu)e=this.ui.navPagingMenu.find("a").first();else{var t=i.attr("data-pageid"),s=i.attr("data-slidepage");if(t||s){var n=i.parent().next().find("a");n.length>0&&(e=n)}}return e},"_activateHomeElem":function(){this.activeChild=this.ui.dropDownMenu,this.activateChild(!0,this.activeChild)},"_activateEndElem":function(){this.activeChild=this._getLastElem(),this.activateChild(!0,this.activeChild)},"_getLastElem":function(){return this.ui.navPagingMenu.find("a").last()},"_pageUp":function(){var e=this.ui.navPagingMenu.find("a").last();this._page(e)},"_page":function(e){e.attr("data-slidepage")&&(this.activateChild(!1,this.activeChild),this.activeChild=e,this.executeAction(this.activeChild))},"_pageDown":function(){var e=this.ui.navPagingMenu.find("a").first();this._page(e)}}}),csui.define("csui/controls/pagination/nls/localized.strings",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/pagination/nls/root/localized.strings",{"PageNavBarAboutItems":"About {0} items"}),csui.define("csui/controls/pagination/impl/nls/localized.strings",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/pagination/impl/nls/root/localized.strings",{"PageNavBarTotalItems":"{0} items","PageNavBarSingleItem":"1 item","PageNavBarItemsPerPage":"{0} per page","PageNavBarShowAll":"Show all","PageNTotalsAria":"Showing page {0} of {1}, {2} items overall","ShowPageNAria":"Show page {0}","PreviousPagesAria":"Show previous pages","NextPagesAria":"Show next pages","SinglePageTotalsAria":"Showing {0} items","PageSizeMenuAria":"Select page size, currently {0}","PageSizeChoiceAria":"Pagination, show {0} per page","PaginationLandmarkAria":"Pagination"}),csui.define("hbs!csui/controls/pagination/impl/nodespagination",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){var n;return'<div class="csui-total-container-items">'+this.escapeExpression((n=null!=(n=i.totalItems||(null!=e?e.totalItems:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"totalItems","hash":{}}):n))+'</div>\r\n<div class="binf-nav expanded-pager pager-filter csui-pagesize-menu">\r\n  <div class="binf-dropdown csui-dropdown">\r\n    <a href="" class="binf-dropdown-toggle"  data-binf-toggle="dropdown" role="button" aria-expanded="false" tabindex="0" aria-label="'+this.escapeExpression((n=null!=(n=i.pageSizeMenuAria||(null!=e?e.pageSizeMenuAria:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"pageSizeMenuAria","hash":{}}):n))+'">\r\n      <div class="csui-pageSize">'+this.escapeExpression((n=null!=(n=i.itemsPerPage||(null!=e?e.itemsPerPage:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"itemsPerPage","hash":{}}):n))+'</div>\r\n      <div class="csui-icon icon-expandArrowDown"></div>\r\n    </a>\r\n    <ul class="binf-dropdown-menu binf-dropdown-menu-right csui-dropdown-list" role="menu">\r\n    </ul>\r\n  </div>\r\n</div>\r\n\r\n<div class="csui-pagination">\r\n  <div class="csui-paging-navbar">\r\n    <ul class="binf-hidden">\r\n      <li class="csui-overflow"></li>\r\n    </ul>\r\n  </div>\r\n</div>\r\n'}});return t.registerPartial("csui_controls_pagination_impl_nodespagination",s),s}),csui.define("css!csui/controls/pagination/impl/nodespagination",[],function(){}),csui.define("csui/controls/pagination/nodespagination.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/marionette","csui/utils/log","csui/behaviors/keyboard.navigation/tabable.region.behavior","csui/controls/pagination/impl/keyevent.navigation","csui/controls/mixins/global.alert/global.alert.mixin","i18n!csui/controls/pagination/nls/localized.strings","i18n!csui/controls/pagination/impl/nls/localized.strings","hbs!csui/controls/pagination/impl/nodespagination","css!csui/controls/pagination/impl/nodespagination"],function(e,i,t,s,n,o,l,r,a,c){"use strict";var u=t.ItemView.extend({"template":c,"className":"csui-pager","ui":{"totalCount":"> .csui-total-container-items","pageSizeMenu":"> .csui-pagesize-menu","dropDownMenu":"> .csui-pagesize-menu > .csui-dropdown > .binf-dropdown-toggle","dropDownList":"> .csui-pagesize-menu .csui-dropdown-list","navPagingMenu":"> .csui-pagination > .csui-paging-navbar","dropDownListItem":"> .csui-pagesize-menu ul.csui-dropdown-list a"},"templateHelpers":function(){var e=this._getTotalCount(),t=this.pageSize&&this.pageSize>0?this.pageSize:30;return this.pageTotalAria=e<=t?i.str.sformat(a.SinglePageTotalsAria,e):i.str.sformat(a.PageNTotalsAria,this.currentPageNum,1+Math.floor(e/t),e),this.nextPagesAria=a.NextPagesAria,this.previousPagesAria=a.PreviousPagesAria,{"totalItems":this._getTotalDisplayCount(),"itemsPerPage":i.str.sformat(a.PageNavBarItemsPerPage,this.pageSize),"pageSizeMenuAria":i.str.sformat(a.PageSizeMenuAria,this.pageSize)}},"events":{"keyup @ui.dropDownListItem":"resetPageSizeKeyUp","click .csui-pagesize-menu ul.csui-dropdown-list a":"resetPageSize","click .csui-paging-navbar > ul > li:not(.csui-overflow) > a":"onChangePage","click .csui-pagination  li.csui-overflow > a":"onSlidePageMenu","keydown":"onKeyInView"},"behaviors":{"TabableRegion":{"behaviorClass":n}},"constructor":function(s){s||(s={}),s.pageSize||(s.pageSize=30),t.ItemView.prototype.constructor.call(this,s),this.addPaging=!0,this.currentPageNum=1,this.ddList=this.defaultDDList=s.defaultDDList||[30,50,100],this.skipCollectionRequest=!1,this.skipPaginationUpdateRequest=!!s.skipPaginationUpdateRequest,this.pageSize=this.selectedPageSize=this.options.pageSize,this.rendered=!1,this.pageTotalAriaLast=void 0,this.pageTotalTimeoutHandle=void 0,this.collection&&(this.collection.setLimit(0,this.options.pageSize,!1),this.listenTo(this.collection,"reset",this.collectionChange),this.listenTo(this.collection,"add",this._maintainPageSize),this.listenTo(this.collection,"remove",this._maintainPageSize),this.collection.node&&this.listenTo(this.collection.node,"change:id",this.nodeChange)),this.onWinRefresh=i.bind(this.windowRefresh,this),e(window).bind("resize.app",this.onWinRefresh),this.prepareForGlobalAlert()},"onDestroy":function(){e(window).unbind("resize.app",this.onWinRefresh)},"windowRefresh":function(){this._isRendered&&(this._initializePageTabMenu(!1,!0),this.resetActiveChild())},"collectionChange":function(){var e=this.$el.find(".csui-paging-navbar ul");this.totalCount=0,e.empty(),e.remove(),"setPageSize"!==this.lastAction&&this._reCalculatePageSizes(),this.lastAction="",this.render()},"nodeChange":function(){this.pageSize=this.selectedPageSize=this.options.pageSize,this.totalCount=0,this.resetRenderFlags(),this.resetCollection(0,this.pageSize,!1),this._isRendered&&this.setActiveChild(this.ui.dropDownMenu)},"resetRenderFlags":function(){this.addPaging=!0},"onChangePage":function(i){i.preventDefault(),i.stopPropagation();var t=e(i.currentTarget),s=parseInt(t.attr("data-pageid"),10);this.changePage(s),this.setActiveChild(t)},"changePage":function(e){var i=this.pageSize;this.currentPageNum=e+1;var t=e*i;this.collection.pagination=this.addPaging,this.collection.trigger("new:page"),this.resetCollection(t,i,!0),this.templateHelpers()},"resetCollection":function(e,i,t){this.collection.setLimit(e,i,t)},"resetPageSizeKeyUp":function(e){return 32===e.keyCode&&this.resetPageSize(e),!0},"resetPageSize":function(i){i.preventDefault(),i.stopPropagation(),this.collection.pagination=this.addPaging;var t=parseInt(e(i.currentTarget).attr("data-pagesize"),10);this.setPageSize(t,!0)},"setPageSize":function(e,i){this.pageSize=this.selectedPageSize=e,this.skipCollectionRequest||!i?this.skipCollectionRequest=!1:(this.rendered=!1,this.resetCollection(0,e,i)),this.lastAction="setPageSize",this.currentPageNum=1},"_setPageTotalAria":function(){this.pageTotalAria!=this.pageTotalAriaLast&&(this.$el.parent().children(".binf-sr-only").html(this.pageTotalAria),this.pageTotalAriaLast=this.pageTotalAria,this.pageTotalTimeoutHandle=void 0)},"onRender":function(){var e=this.collection,i=this.$el.parent().children(".binf-sr-only");i&&i.length||this.$el.before('<div class="binf-sr-only" aria-live="polite"></div>'),this._validCollection(e)?(this.pageSize=this.pageSize>this.options.pageSize&&this.pageSize>this.totalCount?this.totalCount:this.pageSize,this.rendered=!0,this.$el.removeClass("binf-hidden"),this._initializeDDList(),this.pageTotalTimeoutHandle&&clearTimeout(this.pageTotalTimeoutHandle),this.pageTotalTimeoutHandle=setTimeout(this._setPageTotalAria.bind(this),1200)):(this.$el.addClass("binf-hidden"),this.pageTotalTimeoutHandle||(this.pageTotalTimeoutHandle=setTimeout(this._setPageTotalAria.bind(this),2400))),this.trigger("render:complete")},"onDomRefresh":function(){if(this._validCollection(this.collection)&&this.rendered){var e=this.totalCount;e>this.options.pageSize?(this._setPageSizeMenu(),e>this.pageSize&&this._initializePageTabMenu(!0,!0)):this._showTotalOnly(),this.resetActiveChild()}},"hidePaging":function(){return this.$el.find(".csui-pagination").addClass("binf-hidden"),!0},"onSlidePageMenu":function(i){i.preventDefault(),i.stopPropagation();var t=parseInt(e(i.currentTarget).attr("data-slidepage"),10);this.slidePageMenu(t)},"slidePageMenu":function(e){var i=this.$el;this._initializePageTabMenu(!0,!0,e),i.find(".csui-pages-"+e).addClass("csui-slide")},"getDDList":function(e){for(var i=this.defaultDDList,t=i.length,s=[],n=0;n<t;n++){if(i[n]>=e){s.push(e);break}s.push(i[n])}return s},"_getOverflowIconWidth":function(){if(!this.overFlowIcon||0===this.overFlowIcon){var e=this.$el.find(".csui-paging-navbar > ul > li.csui-overflow");this.overFlowIcon=parseInt(e.css("width"),10)}return this.overFlowIcon},"_getPageTabMinWidth":function(){if(!this.pageTabMinWidth||0===this.pageTabMinWidth){var e=this.$el.find(".csui-paging-navbar > ul > li");this.pageTabMinWidth=parseInt(e.css("min-width"),10),e=null}return this.pageTabMinWidth=64,this.pageTabMinWidth},"_initializeDDList":function(){this.ddList=this.getDDList(this.totalCount)},"_validCollection":function(e){var i=!1,t=this.totalCount;if(e){var n=this._getTotalCount(e);this.totalCount=t&&t<n?t:n,n&&n>0&&(i=!0)}else s.error("Pagination won't be rendered (collection is not set)")&&console.error(s.last);return i},"_showTotalOnly":function(){this.$el.parent().removeAttr("role"),this.$el.find(".csui-pagesize-menu").addClass("binf-hidden"),this.$el.find(".csui-pagination").addClass("binf-hidden"),this.$el.find(".csui-total-container-items").addClass("csui-pagination-top-bottom-padding"),this.triggerMethod("tabable:not",this)},"_getTotalDisplayCount":function(){var e=this.collection,t=this._getTotalCount(),s="";return t>0&&(s=1===t?a.PageNavBarSingleItem:t===e.skipCount+e.length?a.PageNavBarTotalItems:r.PageNavBarAboutItems,s=i.str.sformat(s,t)),s},"_setPageSizeMenu":function(){var e=this.totalCount;e>this.options.pageSize&&(this.ddList.length>1?(this._addPageSizeOptions(e),this.ui.pageSizeMenu.removeClass("binf-hidden")):this.ui.pageSizeMenu.addClass("binf-hidden"))},"_addPageSizeOptions":function(e){var t="",s=[],n=this.ddList,o=this.pageSize;this.ui.dropDownList[0].innerHTML="";for(var l=n.length-1;l>=0;l--){
var r=n[l],c=r===e?a.PageNavBarShowAll:i.str.sformat(a.PageNavBarItemsPerPage,r),u=i.str.sformat(a.PageSizeChoiceAria,r),d=r===o?"csui-select":"",h=r===o?' aria-current="true" ':"",p='<li role="menuitem"><a href="#" class="'+d+'" data-pagesize='+r+h+' aria-label="'+u+'"><span class="csui-pagination-checked icon-listview-checkmark"></span>'+c+"</a></li>";s.push(p),t+=p}return this.ui.dropDownList.append(t),!0},"_initializePageTabMenu":function(e,i,t){this.$el.parent().attr("role","navigation").attr("aria-label",a.PaginationLandmarkAria);var s=this._getPageTabMinWidth(),n=this._getOverflowIconWidth();this._setPageTabMenu(s,n,e,i,t)},"_setPageTabMenu":function(e,i,t,s,n){var o=this.numPages=Math.ceil(this.totalCount/this.pageSize),l=this._getPageTabsPerSlideMenu(e,i,o);this.numSlideMenus=Math.ceil(o/l),(t||l!==this.pageTabsPerMenu)&&(this.pageTabsPerMenu=l,s&&this.ui.navPagingMenu.html(""),this._addSideMenu(this.numSlideMenus,l,o,s,n))},"_getPageTabsPerSlideMenu":function(e,i,t){var s=this.ui.navPagingMenu.width(),n=Math.floor(s/e);return n<t&&(n=Math.floor((s-i)/e),(n=2*n<t?n-1:n)<=0&&(n=1)),n},"_addSideMenu":function(i,t,s,n,o){var l=this.ui.navPagingMenu,r=this.collection.skipCount,a=this.totalCount,c=this.pageSize,u=r>a?s-1:r/c;o=null==o?Math.floor(u/t):o;var d=o*t,h="",p=e('<ul class="binf-nav expanded-pager pager-tabs csui-pages csui-pages-'+o+'"></ul>');o>0&&(h+='<li class="csui-overflow"><a href="#" tabindex="-1" class="csui-overflow-left" data-slidePage="'+(o-1)+'" aria-label="'+this.previousPagesAria+'" title="'+this.previousPagesAria+'"><span class="csui-icon goto_previous_page"></span></a></li>'),h+=this._addPageTabs(d,u,t,s),n&&p.addClass("csui-active"),o<i-1&&(h+='<li class="csui-overflow"><a href="#" tabindex="-1" class="csui-overflow-right" data-slidePage="'+(o+1)+'" aria-label="'+this.nextPagesAria+'" title="'+this.nextPagesAria+'"><span class="csui-icon goto_next_page"></span></a></li>'),o===i-1?this.$el.find(".csui-pagination").find(".csui-paging-navbar").addClass("csui-last-slidePage"):this.$el.find(".csui-pagination").find(".csui-paging-navbar").removeClass("csui-last-slidePage"),p.append(h),l.html(p)},"_addPageTabs":function(e,t,s,n){for(var o=e+s>=n?n:e+s,l="",r=e;r<o;r++){var c=r+1;l+='<li><a href="#" tabindex="-1" class="',r===t&&(l+='csui-activePage" aria-current="page');var u=i.str.sformat(a.ShowPageNAria,c);l+='" data-pageid="'+r+'" aria-label="'+u+'" title="'+u+'"><span>'+c+"</span></a></li>"}return l},"_reCalculatePageSizes":function(){this._calculateSelectPageSize(),this._reCalculatePageSize()},"_calculateSelectPageSize":function(){var e=this.selectedPageSize,t=this._getTotalCount(),s=this.defaultDDList;this.selectedPageSize=i.indexOf(s,e)>-1?e:e>=t?t:i.find(s,function(i){return e<i})},"_reCalculatePageSize":function(){var e=this.options.pageSize,i=this._getTotalCount();this.pageSize=0===i?e:this.selectedPageSize>i?i:this.selectedPageSize},"_maintainPageSize":function(e,i,t){return e.get("csuiIsSelected")&&e.set("csuiIsSelected",!1),this._updateTotalCount(t),this.resetRenderFlags(),this._initializeDDList(!1),!this.skipPaginationUpdateRequest&&this.collection.models.length>this.selectedPageSize?(this.stopListening(this.collection,"remove"),this.collection.pop(),this.listenTo(this.collection,"remove",this._maintainPageSize)):this.skipPaginationUpdateRequest&&this.collection.allModels&&this.collection.allModels.length===this.collection.skipCount&&(this.collection.skipCount=this.collection.skipCount-this.collection.topCount),this.skipCollectionRequest=!0,this._reCalculatePageSizes(),this.render(),!0},"_getTotalCount":function(e){var i=0;return e||(e=this.collection),e&&(i=e.filteredCount,null==i&&(i=e.totalCount),null==i&&(i=e.length)),i},"_updateTotalCount":function(e){var i=e.add?1:-1;this.totalCount+=i,null!=this.collection.filteredCount&&(this.collection.filteredCount+=i),null!=this.collection.totalCount&&(this.collection.totalCount+=i)}});return i.extend(u.prototype,o),i.extend(u.prototype,l),u}),csui.define("hbs!csui/controls/tableactionbar/impl/tableactionbar",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){return'<ul class="tile-nav binf-nav binf-nav-pills" role="menu"></ul>\r\n'}});return t.registerPartial("csui_controls_tableactionbar_impl_tableactionbar",s),s}),csui.define("hbs!csui/controls/tableactionbar/impl/lazy.loading.template",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){return'<li role="menuitem" class="csui-loading-parent-wrapper binf-disabled csui-disbaled">\r\n  <span class="csui-loading-dots-wrapper">\r\n    <span class="csui-loading-dot"></span>\r\n    <span class="csui-loading-dot"></span>\r\n    <span class="csui-loading-dot"></span>\r\n  </span>\r\n</li>'}});return t.registerPartial("csui_controls_tableactionbar_impl_lazy.loading.template",s),s}),csui.define("css!csui/controls/tableactionbar/impl/tableactionbar",[],function(){}),csui.define("csui/controls/tableactionbar/tableactionbar.view",["module","csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/utils/log","csui/utils/base","i18n","csui/controls/toolbar/toolitem.model","csui/controls/toolbar/toolitem.view","csui/controls/toolbar/toolbar.view","csui/models/nodes","csui/controls/toolbar/toolitems.filtered.model","csui/controls/toolbar/toolbar.state.behavior","csui/utils/commandhelper","csui/utils/commands","hbs!csui/controls/tableactionbar/impl/tableactionbar","hbs!csui/controls/tableactionbar/impl/lazy.loading.template","csui/controls/tile/behaviors/perfect.scrolling.behavior","css!csui/controls/tableactionbar/impl/tableactionbar"],function(e,i,t,s,n,o,l,r,a,c,u,d,h,p,m,f,g,b,v){"use strict";var w=n.CompositeView.extend({"className":"csui-table-actionbar","template":g,"childView":c,"childViewOptions":function(e){return{"model":e,"command":this.commands&&this.commands.findWhere({"signature":e.get("signature")})}},"childViewContainer":"ul","behaviors":{"ToolbarState":{"behaviorClass":p}},"constructor":function(e){this.container=e.container,this.containerCollection=e.containerCollection,this.originatingView=e.originatingView,this.commandExecutionOptions=e.commandExecutionOptions,e.status||(e.status={});var s=i.defaults(e.status,{"nodes":new d([e.model]),"container":this.container,"context":this.originatingView.context});this.commands=e.commands||f,e.collection=new h(e.collection,{"status":s,"commands":this.commands,"delayedActions":e.delayedActions,"mask":e.toolItemsMask}),n.CompositeView.prototype.constructor.apply(this,arguments),this.model.nonPromotedActionCommands&&this.model.nonPromotedActionCommands.length&&e.collection.length<=1&&this.actionState.set("state","loading"),e.el&&t(e.el).addClass(i.result(this,"className"))},"isEmpty":function(e){return this.collection.length<=1},"onBeforeDestroy":function(){this.originatingView=null,this.collection.stopListening()},"onBeforeRenderCollection":function(){this.destroyChildren(),this.$childViewContainer&&this.$childViewContainer.empty()},"onRenderCollection":function(){this._adjusted=!1,l.isVisibleInWindowViewport(this.$el)&&this._layoutButtons()},"onRender":function(){this.options.inlineBarStyle&&this.$el.addClass(this.options.inlineBarStyle),this._isBlocked&&this.$el.addClass("binf-disabled")},"onShow":function(){this._layoutButtons()},"_layoutButtons":function(){var e=this.options.delayedActions;if(!e||!e.fetching&&!e.error){if(this._adjusted)return!0;this._adjusting=!0;var t=this.model,s=!!t&&!!t.get("csuiLazyActionsRetrieved"),n=!!t.isLocallyCreated,o=i.sortBy(this.children.toArray(),"cid");o=o.filter(function(e){return e instanceof c}),this.actionbarOptions={"toolItemCounter":0,"cntItemsFit":0,"index":0,"dropDownMenuEl":void 0,"separatorView":void 0},this.enabledNonPomotedCommands=!1!==t.collection.enableNonPromotedCommands||t.collection.enableNonPromotedCommands,o.length>1?(this.firstOffsetY=this.children.first().$el.offset().top,i.each(o,i.bind(function(e,i){this.actionbarOptions.index=i,this._wrapToolItemView(e)},this)),t&&!s&&t.nonPromotedActionCommands&&this.enabledNonPomotedCommands&&t.nonPromotedActionCommands.length&&!n?this.$childViewContainer.find(".binf-dropdown").length?this.$childViewContainer.find(".binf-dropdown ul").append(b):(this.actionbarOptions.toolItemCounter===this.options.maxItemsShown&&this.$childViewContainer.find("li:last").length>0&&this.$childViewContainer.find("li:last").addClass("csui-actionbar-hide-child"),this.$childViewContainer.append(b),this._renderLazyActions().always(i.bind(function(){this._checkInlineActionBarShouldAlive()},this))):this._checkInlineActionBarShouldAlive()):t&&!s&&t.nonPromotedActionCommands&&t.nonPromotedActionCommands.length&&!n&&this.enabledNonPomotedCommands?this._renderLazyActions().always(i.bind(function(){this._checkInlineActionBarShouldAlive()},this)):this._checkInlineActionBarShouldAlive(),this._adjusting=!1,this._adjusted=!0}},"_checkInlineActionBarShouldAlive":function(){this.actionbarOptions.cntItemsFit<2&&1!==this.options.maxItemsShown&&this.destroy()},"_wrapToolItemView":function(e){if(e instanceof c){var i=e.model.isSeparator();if(i||this.actionbarOptions.toolItemCounter++,this.actionbarOptions.dropDownMenuEl)i&&this.actionbarOptions.index+1===this.children.length||(e.renderTextOnly(),e.$el.attr("role","menuitem"),this.actionbarOptions.dropDownMenuEl.append(e.$el));else if(i)this.actionbarOptions.separatorView=e;else{var t=e.$el.offset().top;t!==this.firstOffsetY||this.actionbarOptions.toolItemCounter>this.options.maxItemsShown?this.actionbarOptions.prevToolItemView?(this.actionbarOptions.prevToolItemView.$el.attr("role","menuitem"),this.actionbarOptions.dropDownMenuEl=this._wrapWithDropDown(this.actionbarOptions.prevToolItemView,e,this.actionbarOptions.separatorView)):this.actionbarOptions.dropDownMenuEl=this._wrapWithDropDown(e.$el,e):this.actionbarOptions.cntItemsFit++,this.actionbarOptions.prevToolItemView=e}}},"_renderLazyActions":function(){var e=this,s=this.model,n=t.Deferred();return!!s&&s.setEnabledLazyActionCommands(!0).done(i.bind(function(){var t=new h(e.options.collection.unfilteredModels,{"status":e.options.status,"commands":e.commands,"delayedActions":e.model.delayedActions,"mask":e.options.toolItemsMask}),s=e.$childViewContainer.find(".csui-loading-parent-wrapper");s.length?s.animate("width: 0",300,function(){e.$childViewContainer.find(".csui-actionbar-hide-child").removeClass("csui-actionbar-hide-child"),s.addClass("binf-hidden"),e.actionbarOptions.toolItemCounter<e.options.maxItemsShown&&s.addClass("binf-maxtoolitems-not-reached"),e.collection.models.length!==t.models.length&&i.filter(t.models,function(i){if(!0===e.isDestroyed||e._isDestroyed)e.children=void 0;else{var t=i.get("signature");if(!e.collection.find({"signature":t})){e.actionbarOptions.index++;var s=e.addChild(i,c,e.actionbarOptions.index);e._wrapToolItemView(s)}}}),n.resolve()}):(!0===e.isDestroyed||e._isDestroyed?e.children=void 0:e.collection.refilter(),n.resolve())}),e).fail(function(){e.$childViewContainer.find(".csui-loading-parent-wrapper").remove(),e.$childViewContainer.find(".csui-actionbar-hide-child").removeClass("csui-actionbar-hide-child"),n.reject()}),n.promise()},"_wrapWithDropDown":function(e,s,n){e.renderTextOnly(),e.$el.wrap('<li class="binf-dropdown"><ul class="binf-dropdown-menu" role="menu"></ul></li>');var o=this._makeDropDown();this.$el.find("li.binf-dropdown").prepend(o);var a=this.$el.find("li.binf-dropdown > a.binf-dropdown-toggle");a.bind("binf.dropdown.before.show",i.bind(function(){t(this.nextElementSibling).addClass("binf-invisible");var e=this.model,i=!!e.get("csuiLazyActionsRetrieved"),s=!!e.isLocallyCreated;e&&!i&&e.nonPromotedActionCommands&&e.nonPromotedActionCommands.length&&!s&&this.enabledNonPomotedCommands&&this._renderLazyActions()},this));var c=s._parent;c.listenTo(c,"destroy",function(){t(".csui-zero-zindex").removeClass("csui-zero-zindex")});var u=this;a.bind("binf.dropdown.after.show",function(){var e=t(this).closest(".csui-perfect-scrolling").length>0?".csui-perfect-scrolling":".csui-normal-scrolling",i=(t(this).closest(e),t(this).nextAll(".binf-dropdown-menu"));l.autoAlignDropDowns(t(this),i,!1,i,l.isIE11());var s={};if(r.settings.rtl?s.right=parseFloat(i.css("right"))+t(this).outerWidth()-i.width():s.left=i[0].offsetLeft+t(this).outerWidth()-i.width(),"auto"===i.prop("style").top){if(s.maxHeight=Math.floor(window.innerHeight-(window.innerHeight-i.closest(".binf-dropdown").offset().top))-5,u.model.get("csuiDelayedActionsRetrieved")&&!u.model.get("csuiLazyActionsRetrieved")&&u.model.nonPromotedActionCommands&&u.model.nonPromotedActionCommands.length&&u.enabledNonPomotedCommands){var n=i.closest(".binf-dropdown"),o=t(n).find(".csui-loading-parent-wrapper");o.length&&o.remove(),n.addClass("csui-actionbar-hide-child"),i.closest(".csui-table-actionbar .binf-nav").append(b)}t("#breadcrumb-wrap").length>0&&(t("#breadcrumb-wrap").addClass("csui-zero-zindex"),t(".csui-navbar.binf-navbar.binf-navbar-default").addClass("csui-zero-zindex"),t(".csui-search-tool-container").length>0&&t(".csui-search-tool-container").addClass("csui-zero-zindex"))}else s.maxHeight=Math.floor(window.innerHeight-i.closest(".binf-dropdown").offset().top)-i.closest(".binf-dropdown").height()-5,t("#breadcrumb-wrap").length>0&&(t("#breadcrumb-wrap").removeClass("csui-zero-zindex"),t(".csui-navbar.binf-navbar.binf-navbar-default").removeClass("csui-zero-zindex"),t(".csui-search-tool-container").length>0&&t(".csui-search-tool-container").removeClass("csui-zero-zindex"));i.css(s);var a;u.usePerfectScrollbar()?(i.addClass("csui-perfect-scrolling"),i.perfectScrollbar({"suppressScrollX":!0,"includePadding":!0}),a=i.closest(".binf-dropdown").closest(".csui-perfect-scrolling.ps-container")):a=i.closest(".binf-dropdown").scrollParent(),a.bind("scroll.csui.inline.actions",function(e){!i.is(":hidden")&&i.binf_dropdown("toggle"),t(e.target).unbind("scroll.csui.inline.actions")})});var d=this.$el.find("li.binf-dropdown>ul.binf-dropdown-menu");return n&&(n.renderTextOnly(),d.append(n.$el)),s.renderTextOnly(),s.$el.attr("role","menuitem"),d.append(s.$el),d},"_makeDropDown":function(){var e='<a role="button" href="#" tabindex="-1" class="binf-dropdown-toggle" data-binf-toggle="dropdown" aria-expanded="false"';return this.options.dropDownText?e+=' title="'+this.options.dropDownText+'" aria-label="'+this.options.dropDownText+'">':e+=">",this.options.dropDownIcon?e+='<span class="'+this.options.dropDownIcon+'"></span>':this.options.dropDownText&&(e+=this.options.dropDownText),e+="</a>"},"_setBlocked":function(e,i){var t=this;this._blockedTimer=setTimeout(function(){!1===t._isBlocked&&t.$el.removeClass("binf-disabled"),t._blockedTimer=void 0},500),this._isBlocked=!0,e.get("selfBlockOnly")?i.$el.find("a").addClass("binf-disabled"):this.$el.addClass("binf-disabled")},"_setUnblocked":function(e,i){this._isBlocked=!1,this._blockedTimer||(e.get("selfBlockOnly")?i.$el.find("a").removeClass("binf-disabled"):this.$el.removeClass("binf-disabled"))},"onChildviewToolitemAction":function(e,t){var n=this,o=t.toolItem.get("signature"),l=this.commands.findWhere({"signature":o}),r=i.defaults(this.options.status,{"nodes":new d([this.model]),"container":this.container,"originatingView":this.originatingView,"context":this.originatingView.context});r.collection=this.containerCollection,r.data=t.toolItem.get("commandData")||{};var a={"status":r,"commandSignature":o};this.trigger("before:execute:command",a),this._setBlocked(l,e),s.trigger("closeToggleAction");var c=l.execute(r,this.commandExecutionOptions);m.handleExecutionResults(c,{"command":l,"suppressSuccessMessage":r.suppressSuccessMessage,"suppressFailMessage":r.suppressFailMessage,"customError":this.options.customError}).done(function(e){l.allowCollectionRefetch&&n.options.originatingView.collection.totalCount>n.options.originatingView.collection.topCount&&n.options.originatingView.collection.fetch()}).always(function(){n._setUnblocked(l,e),n.trigger("after:execute:command",a)})},"usePerfectScrollbar":function(){return v.usePerfectScrollbar()}});return w.version="1.0",w}),csui.define("hbs!csui/controls/item.title/impl/name/name",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){var n;return'<div class="csui-item-name-readonly title csui-acc-focusable" title="'+this.escapeExpression((n=null!=(n=i.name||(null!=e?e.name:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"name","hash":{}}):n))+'" role="button"\r\n     aria-expanded="false">\r\n  <h2 class="csui-item-name-block">'+this.escapeExpression((n=null!=(n=i.name||(null!=e?e.name:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"name","hash":{}}):n))+'</h2>\r\n</div>\r\n<div class="csui-item-name-edit title-edit-div">\r\n  <input class="title-input" placeholder="'+this.escapeExpression((n=null!=(n=i.placeholderName||(null!=e?e.placeholderName:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"placeholderName","hash":{}}):n))+'" type="text" value="'+this.escapeExpression((n=null!=(n=i.name||(null!=e?e.name:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"name","hash":{}}):n))+'"\r\n         title="'+this.escapeExpression((n=null!=(n=i.edit_name_tooltip||(null!=e?e.edit_name_tooltip:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"edit_name_tooltip","hash":{}}):n))+'">\r\n  <span class="csui-undo edit-cancel inline-edit-icon" title="'+this.escapeExpression((n=null!=(n=i.cancel_edit_name_tooltip||(null!=e?e.cancel_edit_name_tooltip:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"cancel_edit_name_tooltip","hash":{}}):n))+'"></span>\r\n  <div class="csui-item-name-error title-error binf-text-danger" title=""></div>\r\n</div>'}});return t.registerPartial("csui_controls_item.title_impl_name_name",s),s}),csui.define("csui/controls/item.title/impl/nls/localized.strings",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/item.title/impl/nls/root/localized.strings",{"editNameTooltip":"Edit Name","cancelEditNameTooltip":"Cancel Name edit","placeHolderName":"Enter name","showMore":"Show more","showMoreAria":"Show more commands"}),csui.define("css!csui/controls/item.title/impl/name/name",[],function(){}),csui.define("csui/controls/item.title/impl/name/name.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/utils/log","hbs!csui/controls/item.title/impl/name/name","i18n!csui/controls/item.title/impl/nls/localized.strings","csui/utils/commandhelper","csui/behaviors/item.name/item.name.behavior","csui/utils/contexts/factories/ancestors","csui/controls/mixins/view.events.propagation/view.events.propagation.mixin","css!csui/controls/item.title/impl/name/name"],function(e,i,t,s,n,o,l,r,a,c,u){var d=s.ItemView.extend({"className":"csui-item-name","template":o,"templateHelpers":function(){return{"name":this.model.get("name"),"edit_name_tooltip":l.editNameTooltip,"cancel_edit_name_tooltip":l.cancelEditNameTooltip,"placeholderName":l.placeHolderName}},"ui":{"name":".csui-item-name-readonly","nameReadonly":".csui-item-name-readonly","nameEdit":".csui-item-name-edit","nameEditDiv":".csui-item-name-edit","nameInput":".csui-item-name-edit>input","inputName":".csui-item-name-edit>input","nameEditCancelIcon":".csui-item-name-edit>.edit-cancel","titleError":".csui-item-name-error"},"modelEvents":{"change":"render"},"events":{"keydown":"onKeyInView"},"behaviors":{"ItemName":{"behaviorClass":a}},"constructor":function(e){e||(e={}),s.ItemView.prototype.constructor.call(this,e)},"onRender":function(){this.editing=!1,this.ui.nameEdit.addClass("binf-hidden")},"_validateAndSave":function(){var e=this.model.get("name"),i=this.getInputBoxValue();if(i=i.trim(),e!==i){if(!0===this.validate(i)){var t=this;this.setInputBoxValue(i),this.setValue(i),t._blockActions();var s={"name":i},o=this.options.context,l=t.options.model;l.save(s,{"wait":!0,"patch":!0,"silent":!!s.name}).then(function(){l.fetch().done(function(e){o&&o.trigger("current:folder:changed",l),t._unblockActions(),t.options.originatingView.unblockActions()}).fail(function(e){t._unblockActions();var i=t._getErrorMessageFromResponse(e);n.error("Saving failed. ",i)&&console.error(i)}),t._toggleEditMode(!1)}).fail(function(i){t._unblockActions();var s=t._getErrorMessageFromResponse(i);t.setValue(e),t._toggleEditMode(!0),t.showInlineError(s)})}}else this.clearInlineError(),this._toggleEditMode(!1)},"_blockActions":function(){var e=this.options.originatingView;e&&e.blockActions&&e.blockActions()},"_unblockActions":function(){var e=this.options.originatingView;e&&e.unblockActions&&e.unblockActions()},"onKeyInView":function(e){return this.ItemNameBehavior.onKeyInView(e)},"_toggleEditMode":function(e){this.ItemNameBehavior._toggleEditMode(e)},"onClickName":function(e){return this.ItemNameBehavior.onClickName(e)},"getValue":function(){return this.ItemNameBehavior.getValue()},"setValue":function(e){return this.ItemNameBehavior.setValue(e)},"getInputBoxValue":function(){return this.ItemNameBehavior.getInputBoxValue()},"setInputBoxValue":function(e){return this.ItemNameBehavior.setInputBoxValue(e)},"validate":function(e){return this.ItemNameBehavior.validate(e)},"setEditModeFocus":function(){return this.ItemNameBehavior.setEditModeFocus()},"showInlineError":function(e){return this.ItemNameBehavior.showInlineError(e)},"clearInlineError":function(){return this.ItemNameBehavior.clearInlineError()},"_getErrorMessageFromResponse":function(e){return this.ItemNameBehavior._getErrorMessageFromResponse(e)}});return i.extend(d.prototype,u),d}),csui.define("hbs!csui/controls/item.title/impl/dropdown.menu/dropdown.menu",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"1":function(e,i,t,s){var n;return'  <div class="binf-dropdown">\r\n    <button id="'+this.escapeExpression((n=null!=(n=i.btnId||(null!=e?e.btnId:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"btnId","hash":{}}):n))+'" type="button" class="binf-btn binf-dropdown-toggle csui-acc-focusable"\r\n            data-binf-toggle="dropdown" aria-haspopup="true" aria-expanded="false"\r\n            aria-label="'+this.escapeExpression((n=null!=(n=i.showMoreAria||(null!=e?e.showMoreAria:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"showMoreAria","hash":{}}):n))+'" title="'+this.escapeExpression((n=null!=(n=i.showMoreTooltip||(null!=e?e.showMoreTooltip:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"showMoreTooltip","hash":{}}):n))+'">\r\n      <span class="csui-button-icon icon-expandArrowDown" title="'+this.escapeExpression((n=null!=(n=i.showMoreTooltip||(null!=e?e.showMoreTooltip:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"showMoreTooltip","hash":{}}):n))+'">\r\n      </span>\r\n    </button>\r\n    <ul class="binf-dropdown-menu" role="menu"></ul>\r\n  </div>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){var n;return null!=(n=i.if.call(e,null!=e?e.hasCommands:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?n:""}});return t.registerPartial("csui_controls_item.title_impl_dropdown.menu_dropdown.menu",s),s}),csui.define("css!csui/controls/item.title/impl/dropdown.menu/dropdown.menu",[],function(){}),csui.define("csui/controls/item.title/impl/dropdown.menu/dropdown.menu.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/controls/toolbar/toolitem.view","csui/models/nodes","csui/controls/toolbar/toolitems.filtered.model","csui/behaviors/keyboard.navigation/tabable.region.behavior","csui/behaviors/dropdown.menu/dropdown.menu.behavior","csui/utils/commands","hbs!csui/controls/item.title/impl/dropdown.menu/dropdown.menu","i18n!csui/controls/item.title/impl/nls/localized.strings","css!csui/controls/item.title/impl/dropdown.menu/dropdown.menu"],function(e,i,t,s,n,o,l,r,a,c,u,d){"use strict";return s.CompositeView.extend({"className":"csui-item-title-dropdown-menu","template":u,"templateHelpers":function(){return{"hasCommands":!!this.collection.length,"btnId":i.uniqueId("dropdownMenuButton"),"showMoreTooltip":d.showMore,"showMoreAria":d.showMoreAria}},"childView":n,"childViewContainer":"ul.binf-dropdown-menu","childViewOptions":function(e){return{"command":this.collection.commands&&this.collection.commands.findWhere({"signature":e.get("signature")}),"role":"menuitem"}},"ui":{"dropdownToggle":".binf-dropdown-toggle"},"behaviors":{"TabableRegionBehavior":{"behaviorClass":r},"DropdownMenuBehavior":{"behaviorClass":a}},"constructor":function(n){n.collection=new l(n.toolItems,{"status":this._createCommandStatus(n),"commands":this.commands,"mask":n.toolItemsMask}),n.reorderOnSort=!0,s.CompositeView.prototype.constructor.apply(this,arguments),i.defaults(this.options,n.toolItems.options),this.commands=n.commands||c,n.el&&e(n.el).addClass(i.result(this,"className")),this.listenTo(this,"childview:toolitem:action",this._triggerMenuItemAction).listenTo(this.model,"sync",this.render).listenTo(this,"close:menu",this._closeToggle).listenTo(t,"closeToggleAction",this._closeToggle).listenTo(this.model,"change",this.render),this.model.delayedActions&&this.listenTo(this.model.delayedActions,"request",this._hide).listenTo(this.model.delayedActions,"sync error",this._show),this.model.actions&&this.listenTo(this.model.actions,"update",this.render)},"_createCommandStatus":function(e){return{"nodes":new o([e.model]),"container":e.model,"context":e.context}},"_updateCollectionStatus":function(){var e=this._createCommandStatus(this.options);this.options.collection.setStatus(e)},"onBeforeRender":function(){this._updateCollectionStatus()},"onRender":function(){this.model.delayedActions&&this.model.delayedActions.fetching&&this._hide(),this.ui.dropdownToggle.binf_dropdown(),this.delegateEvents()},"currentlyFocusedElement":function(){return e(this.ui.dropdownToggle)},"_hide":function(){this.$el.addClass("binf-invisible")},"_show":function(){this.$el.removeClass("binf-invisible")},"_closeToggle":function(){this.ui.dropdownToggle.parent().hasClass("binf-open")&&this.ui.dropdownToggle.binf_dropdown("toggle"),this.ui.dropdownToggle.attr("aria-expanded","false")},"_triggerMenuItemAction":function(e,t){this.ui.dropdownToggle.binf_dropdown("toggle");var s=t.toolItem.get("signature"),n=this.commands.findWhere({"signature":s});if("Rename"===s)setTimeout(i.bind(function(){this.trigger("rename",this)},this),200);else{var l={"context":this.options.context,"nodes":new o([this.model]),"container":this.model,"originatingView":this.options.originatingView};n&&n.enabled(l)&&n.execute(l)}}})}),csui.define("hbs!csui/controls/item.title/impl/item.title",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){return'<div class="csui-item-title-icon"></div>\r\n<div class="csui-item-title-name"></div>\r\n<div class="csui-item-title-menu" role="menuitem"></div>\r\n'}});return t.registerPartial("csui_controls_item.title_impl_item.title",s),s}),csui.define("css!csui/controls/item.title/impl/item.title",[],function(){}),csui.define("csui/controls/item.title/item.title.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/utils/log","csui/controls/node-type.icon/node-type.icon.view","csui/controls/item.title/impl/name/name.view","csui/controls/item.title/impl/dropdown.menu/dropdown.menu.view","hbs!csui/controls/item.title/impl/item.title","css!csui/controls/item.title/impl/item.title"],function(e,i,t,s,n,o,l,r,a){"use strict";return s.LayoutView.extend({"className":"csui-item-title","template":a,"ui":{"icon":".csui-item-title-icon","name":".csui-item-title-name","menu":".csui-item-title-menu"},"regions":{"iconRegion":"@ui.icon","nameRegion":"@ui.name","menuRegion":"@ui.menu"},"constructor":function(e){e||(e={}),s.LayoutView.prototype.constructor.call(this,e)},"initialize":function(){this.iconView=new o({"node":this.options.model}),this.nameView=new l({"context":this.options.context,"model":this.options.model,"originatingView":this.options.originatingView}),this.menuView=new r({"context":this.options.context,"model":this.options.model,"originatingView":this.options.originatingView,"toolItems":this.options.toolItems,"toolItemsMask":this.options.toolItemsMask,"commands":this.options.commands}),this.listenTo(this.menuView,"rename",function(){this.nameView._toggleEditMode.call(this.nameView,!0)}),this.listenTo(this.nameView,"changed:editmode",function(e){e?this.ui.menu.addClass("binf-hidden"):this.ui.menu.removeClass("binf-hidden")})},"onRender":function(){this.iconRegion.show(this.iconView),this.nameRegion.show(this.nameView),this.menuRegion.show(this.menuView)},"onShow":function(){i.each(this.regionManager._regions,function(e){e.currentView&&e.currentView.triggerMethod("show")})},"onAfterShow":function(){i.each(this.regionManager._regions,function(e){e.currentView&&e.currentView.triggerMethod("after:show")})},"closeMenu":function(){this.menuView&&this.menuView.trigger("close:menu")}})}),csui.define("csui/controls/table/table.columns",["csui/lib/backbone"],function(e){var i=e.Model.extend({"idAttribute":"key","defaults":{"key":null,"sequence":0}}),t=e.Collection.extend({"model":i,"comparator":"sequence","getColumnKeys":function(){return this.pluck("key")},"deepClone":function(){return new t(this.map(function(e){return e.attributes}))}});return new t([{"key":"type","sequence":2,"permanentColumn":!0},{"key":"name","sequence":3,"permanentColumn":!0,"isNaming":!0},{"key":"reserved","sequence":4,"title":"State","noTitleInHeader":!0},{"key":"wnd_comments","sequence":900,"noTitleInHeader":!0,"permanentColumn":!0},{"key":"favorite","sequence":910,"noTitleInHeader":!0,"permanentColumn":!0}])}),csui.define("csui/lib/jquery.dataTables/js/jquery.dataTables",["csui/lib/jquery"],function(e){return function(i,t,s){!function(n){"use strict";e&&!e.fn.dataTable&&function(e){function n(i){var t,s,o="a aa ai ao as b fn i m o s ",l={};e.each(i,function(e,r){(t=e.match(/^([^A-Z]+?)([A-Z])/))&&-1!==o.indexOf(t[1]+" ")&&(s=e.replace(t[0],t[2].toLowerCase()),l[s]=e,"o"===t[1]&&n(i[e]))}),i._hungarianMap=l}function o(i,t,l){i._hungarianMap||n(i);var r;e.each(t,function(n,a){(r=i._hungarianMap[n])===s||!l&&t[r]!==s||("o"===r.charAt(0)?(t[r]||(t[r]={}),e.extend(!0,t[r],t[n]),o(i[r],t[r],l)):t[r]=t[n])})}function l(e){var i=Ke.defaults.oLanguage,t=e.sZeroRecords;!e.sEmptyTable&&t&&"No data available in table"===i.sEmptyTable&&Ne(e,e,"sZeroRecords","sEmptyTable"),!e.sLoadingRecords&&t&&"Loading..."===i.sLoadingRecords&&Ne(e,e,"sZeroRecords","sLoadingRecords"),e.sInfoThousands&&(e.sThousands=e.sInfoThousands);var s=e.sDecimal;s&&Ge(s)}function r(e){vi(e,"ordering","bSort"),vi(e,"orderMulti","bSortMulti"),vi(e,"orderClasses","bSortClasses"),vi(e,"orderCellsTop","bSortCellsTop"),vi(e,"order","aaSorting"),vi(e,"orderFixed","aaSortingFixed"),vi(e,"paging","bPaginate"),vi(e,"pagingType","sPaginationType"),vi(e,"pageLength","iDisplayLength"),vi(e,"searching","bFilter");var i=e.aoSearchCols;if(i)for(var t=0,s=i.length;t<s;t++)i[t]&&o(Ke.models.oSearch,i[t])}function a(e){vi(e,"orderable","bSortable"),vi(e,"orderData","aDataSort"),vi(e,"orderSequence","asSorting"),vi(e,"orderDataType","sortDataType")}function c(i){var t=i.oBrowser,s=e("<div/>").css({"position":"absolute","top":0,"left":0,"height":1,"width":1,"overflow":"hidden"}).append(e("<div/>").css({"position":"absolute","top":1,"left":1,"width":100,"overflow":"scroll"}).append(e('<div class="test"/>').css({"width":"100%","height":10}))).appendTo("body"),n=s.find(".test");t.bScrollOversize=100===n[0].offsetWidth,t.bScrollbarLeft=1!==n.offset().left,s.remove()}function u(e,i,t,n,o,l){var r,a=n,c=!1;for(t!==s&&(r=t,c=!0);a!==o;)e.hasOwnProperty(a)&&(r=c?i(r,e[a],a,e):e[a],c=!0,a+=l);return r}function d(i,s){
var n=Ke.defaults.column,o=i.aoColumns.length,l=e.extend({},Ke.models.oColumn,n,{"nTh":s||t.createElement("th"),"sTitle":n.sTitle?n.sTitle:s?s.innerHTML:"","aDataSort":n.aDataSort?n.aDataSort:[o],"mData":n.mData?n.mData:o,"idx":o});i.aoColumns.push(l);var r=i.aoPreSearchCols;r[o]=e.extend({},Ke.models.oSearch,r[o]),h(i,o,null)}function h(i,t,n){var l=i.aoColumns[t],r=i.oClasses,c=e(l.nTh);if(!l.sWidthOrig){l.sWidthOrig=c.attr("width")||null;var u=(c.attr("style")||"").match(/width:\s*(\d+[pxem%]+)/);u&&(l.sWidthOrig=u[1])}n!==s&&null!==n&&(a(n),o(Ke.defaults.column,n),n.mDataProp===s||n.mData||(n.mData=n.mDataProp),n.sType&&(l._sManualType=n.sType),n.className&&!n.sClass&&(n.sClass=n.className),e.extend(l,n),Ne(l,n,"sWidth","sWidthOrig"),"number"==typeof n.iDataSort&&(l.aDataSort=[n.iDataSort]),Ne(l,n,"aDataSort"));var d=l.mData,h=I(d),p=l.mRender?I(l.mRender):null,m=function(e){return"string"==typeof e&&-1!==e.indexOf("@")};l._bAttrSrc=e.isPlainObject(d)&&(m(d.sort)||m(d.type)||m(d.filter)),l.fnGetData=function(e,i,t){var n=h(e,i,s,t);return p&&i?p(n,i,e,t):n},l.fnSetData=function(e,i,t){return V(d)(e,i,t)},"number"!=typeof d&&(i._rowReadObject=!0),i.oFeatures.bSort||(l.bSortable=!1,c.addClass(r.sSortableNone));var f=-1!==e.inArray("asc",l.asSorting),g=-1!==e.inArray("desc",l.asSorting);l.bSortable&&(f||g)?f&&!g?(l.sSortingClass=r.sSortableAsc,l.sSortingClassJUI=r.sSortJUIAscAllowed):!f&&g?(l.sSortingClass=r.sSortableDesc,l.sSortingClassJUI=r.sSortJUIDescAllowed):(l.sSortingClass=r.sSortable,l.sSortingClassJUI=r.sSortJUI):(l.sSortingClass=r.sSortableNone,l.sSortingClassJUI="")}function p(e){if(!1!==e.oFeatures.bAutoWidth){var i=e.aoColumns;ve(e);for(var t=0,s=i.length;t<s;t++)i[t].nTh.style.width=i[t].sWidth}var n=e.oScroll;""===n.sY&&""===n.sX||ge(e),He(e,null,"column-sizing",[e])}function m(e,i){var t=b(e,"bVisible");return"number"==typeof t[i]?t[i]:null}function f(i,t){var s=b(i,"bVisible"),n=e.inArray(t,s);return-1!==n?n:null}function g(e){return b(e,"bVisible").length}function b(i,t){var s=[];return e.map(i.aoColumns,function(e,i){e[t]&&s.push(i)}),s}function v(e){var i,t,n,o,l,r,a,c,u,d=e.aoColumns,h=e.aoData,p=Ke.ext.type.detect;for(i=0,t=d.length;i<t;i++)if(a=d[i],u=[],!a.sType&&a._sManualType)a.sType=a._sManualType;else if(!a.sType){for(n=0,o=p.length;n<o;n++){for(l=0,r=h.length;l<r&&(u[l]===s&&(u[l]=x(e,l,i,"type")),(c=p[n](u[l],e))||n===p.length-1)&&"html"!==c;l++);if(c){a.sType=c;break}}a.sType||(a.sType="string")}}function w(i,t,n,o){var l,r,a,c,u,h,p,m=i.aoColumns;if(t)for(l=t.length-1;l>=0;l--){p=t[l];var f=p.targets!==s?p.targets:p.aTargets;for(e.isArray(f)||(f=[f]),a=0,c=f.length;a<c;a++)if("number"==typeof f[a]&&f[a]>=0){for(;m.length<=f[a];)d(i);o(f[a],p)}else if("number"==typeof f[a]&&f[a]<0)o(m.length+f[a],p);else if("string"==typeof f[a])for(u=0,h=m.length;u<h;u++)("_all"==f[a]||e(m[u].nTh).hasClass(f[a]))&&o(u,p)}if(n)for(l=0,r=n.length;l<r;l++)o(l,n[l])}function y(i,t,s,n){var o=i.aoData.length,l=e.extend(!0,{},Ke.models.oRow,{"src":s?"dom":"data"});l._aData=t,i.aoData.push(l);for(var r=i.aoColumns,a=0,c=r.length;a<c;a++)s&&k(i,o,a,x(i,o,a)),r[a].sType=null;return i.aiDisplayMaster.push(o),!s&&i.oFeatures.bDeferRender||P(i,o,s,n),o}function _(i,t){var s;return t instanceof e||(t=e(t)),t.map(function(e,t){return s=F(i,t),y(i,s.data,t,s.cells)})}function C(e,i){return i._DT_RowIndex!==s?i._DT_RowIndex:null}function T(i,t,s){return e.inArray(s,i.aoData[t].anCells)}function x(e,i,t,n){var o=e.iDraw,l=e.aoColumns[t],r=e.aoData[i]._aData,a=l.sDefaultContent,c=l.fnGetData(r,n,{"settings":e,"row":i,"col":t});if(c===s)return e.iDrawError!=o&&null===a&&(Be(e,0,"Requested unknown parameter "+("function"==typeof l.mData?"{function}":"'"+l.mData+"'")+" for row "+i,4),e.iDrawError=o),a;if(c!==r&&null!==c||null===a){if("function"==typeof c)return c.call(r)}else c=a;return null===c&&"display"==n?"":c}function k(e,i,t,s){var n=e.aoColumns[t],o=e.aoData[i]._aData;n.fnSetData(o,s,{"settings":e,"row":i,"col":t})}function S(i){return e.map(i.match(/(\\.|[^\.])+/g),function(e){return e.replace(/\\./g,".")})}function I(i){if(e.isPlainObject(i)){var t={};return e.each(i,function(e,i){i&&(t[e]=I(i))}),function(e,i,n,o){var l=t[i]||t._;return l!==s?l(e,i,n,o):e}}if(null===i)return function(e){return e};if("function"==typeof i)return function(e,t,s,n){return i(e,t,s,n)};if("string"!=typeof i||-1===i.indexOf(".")&&-1===i.indexOf("[")&&-1===i.indexOf("("))return function(e,t){return e[i]};var n=function(e,i,t){var o,l,r,a;if(""!==t)for(var c=S(t),u=0,d=c.length;u<d;u++){if(o=c[u].match(wi),l=c[u].match(yi),o){c[u]=c[u].replace(wi,""),""!==c[u]&&(e=e[c[u]]),r=[],c.splice(0,u+1),a=c.join(".");for(var h=0,p=e.length;h<p;h++)r.push(n(e[h],i,a));var m=o[0].substring(1,o[0].length-1);e=""===m?r:r.join(m);break}if(l)c[u]=c[u].replace(yi,""),e=e[c[u]]();else{if(null===e||e[c[u]]===s)return s;e=e[c[u]]}}return e};return function(e,t){return n(e,t,i)}}function V(i){if(e.isPlainObject(i))return V(i._);if(null===i)return function(){};if("function"==typeof i)return function(e,t,s){i(e,"set",t,s)};if("string"!=typeof i||-1===i.indexOf(".")&&-1===i.indexOf("[")&&-1===i.indexOf("("))return function(e,t){e[i]=t};var t=function(e,i,n){for(var o,l,r,a,c,u=S(n),d=u[u.length-1],h=0,p=u.length-1;h<p;h++){if(l=u[h].match(wi),r=u[h].match(yi),l){u[h]=u[h].replace(wi,""),e[u[h]]=[],o=u.slice(),o.splice(0,h+1),c=o.join(".");for(var m=0,f=i.length;m<f;m++)a={},t(a,i[m],c),e[u[h]].push(a);return}r&&(u[h]=u[h].replace(yi,""),e=e[u[h]](i)),null!==e[u[h]]&&e[u[h]]!==s||(e[u[h]]={}),e=e[u[h]]}d.match(yi)?e=e[d.replace(yi,"")](i):e[d.replace(wi,"")]=i};return function(e,s){return t(e,s,i)}}function A(e){return hi(e.aoData,"_aData")}function M(e){e.aoData.length=0,e.aiDisplayMaster.length=0,e.aiDisplay.length=0}function E(e,i,t){for(var n=-1,o=0,l=e.length;o<l;o++)e[o]==i?n=o:e[o]>i&&e[o]--;-1!=n&&t===s&&e.splice(n,1)}function D(e,i,t,n){var o,l,r=e.aoData[i],a=function(t,s){for(;t.childNodes.length;)t.removeChild(t.firstChild);t.innerHTML=x(e,i,s,"display")};if("dom"!==t&&(t&&"auto"!==t||"dom"!==r.src)){var c=r.anCells;if(c)if(n!==s)a(c[n],n);else for(o=0,l=c.length;o<l;o++)a(c[o],o)}else r._aData=F(e,r,n,n===s?s:r._aData).data;r._aSortData=null,r._aFilterData=null;var u=e.aoColumns;if(n!==s)u[n].sType=null;else{for(o=0,l=u.length;o<l;o++)u[o].sType=null;R(r)}}function F(i,t,n,o){var l,r,a,c=[],u=t.firstChild,d=0,h=i.aoColumns,p=i._rowReadObject;o=o||p?{}:[];var m=function(e,i){if("string"==typeof e){var t=e.indexOf("@");if(-1!==t){var s=e.substring(t+1);V(e)(o,i.getAttribute(s))}}},f=function(i){if(n===s||n===d)if(r=h[d],a=e.trim(i.innerHTML),r&&r._bAttrSrc){var t=V(r.mData._);t(o,a),m(r.mData.sort,i),m(r.mData.type,i),m(r.mData.filter,i)}else p?(r._setter||(r._setter=V(r.mData)),r._setter(o,a)):o[d]=a;d++};if(u)for(;u;)l=u.nodeName.toUpperCase(),"TD"!=l&&"TH"!=l||(f(u),c.push(u)),u=u.nextSibling;else{c=t.anCells;for(var g=0,b=c.length;g<b;g++)f(c[g])}return{"data":o,"cells":c}}function P(e,i,s,n){var o,l,r,a,c,u=e.aoData[i],d=u._aData,h=[];if(null===u.nTr){for(o=s||t.createElement("tr"),u.nTr=o,u.anCells=h,o._DT_RowIndex=i,R(u),a=0,c=e.aoColumns.length;a<c;a++)r=e.aoColumns[a],l=s?n[a]:t.createElement(r.sCellType),h.push(l),s&&!r.mRender&&r.mData===a||(l.innerHTML=x(e,i,a,"display")),r.sClass&&(l.className+=" "+r.sClass),r.bVisible&&!s?o.appendChild(l):!r.bVisible&&s&&l.parentNode.removeChild(l),r.fnCreatedCell&&r.fnCreatedCell.call(e.oInstance,l,x(e,i,a),d,i,a);He(e,"aoRowCreatedCallback",null,[o,d,i])}}function R(i){var t=i.nTr,s=i._aData;if(t){if(s.DT_RowId&&(t.id=s.DT_RowId),s.DT_RowClass){var n=s.DT_RowClass.split(" ");i.__rowc=i.__rowc?bi(i.__rowc.concat(n)):n,e(t).removeClass(i.__rowc.join(" ")).addClass(s.DT_RowClass)}s.DT_RowData&&e(t).data(s.DT_RowData)}}function B(i){var t,s,n,o,l,r=i.nTHead,a=i.nTFoot,c=0===e("th, td",r).length,u=i.oClasses,d=i.aoColumns;for(c&&(o=e("<tr/>").appendTo(r)),t=0,s=d.length;t<s;t++)l=d[t],n=e(l.nTh).addClass(l.sClass),c&&n.appendTo(o),i.oFeatures.bSort&&(n.addClass(l.sSortingClass),!1!==l.bSortable&&(n.attr("tabindex",i.iTabIndex).attr("aria-controls",i.sTableId),Me(i,l.nTh,t))),l.sTitle!=n.html()&&n.html(l.sTitle),Ue(i,"header")(i,n,l,u);if(c&&H(i.aoHeader,r),e(r).find(">tr>th, >tr>td").addClass(u.sHeaderTH),e(a).find(">tr>th, >tr>td").addClass(u.sFooterTH),null!==a){var h=i.aoFooter[0];for(t=0,s=h.length;t<s;t++)l=d[t],l.nTf=h[t].cell,l.sClass&&e(l.nTf).addClass(l.sClass)}}function N(i,t,n){var o,l,r,a,c,u,d,h,p,m=[],f=[],g=i.aoColumns.length;if(t){for(n===s&&(n=!1),o=0,l=t.length;o<l;o++){for(m[o]=t[o].slice(),m[o].nTr=t[o].nTr,r=g-1;r>=0;r--)i.aoColumns[r].bVisible||n||m[o].splice(r,1);f.push([])}for(o=0,l=m.length;o<l;o++){if(d=m[o].nTr)for(;u=d.firstChild;)d.removeChild(u);for(r=0,a=m[o].length;r<a;r++)if(h=1,p=1,f[o][r]===s){for(d.appendChild(m[o][r].cell),f[o][r]=1;m[o+h]!==s&&m[o][r].cell==m[o+h][r].cell;)f[o+h][r]=1,h++;for(;m[o][r+p]!==s&&m[o][r].cell==m[o][r+p].cell;){for(c=0;c<h;c++)f[o+c][r+p]=1;p++}var b=e(m[o][r].cell);1!==h&&b.attr("rowspan",h),1!==p&&b.attr("colspan",p)}}}}function L(i){var t=He(i,"aoPreDrawCallback","preDraw",[i]);if(-1!==e.inArray(!1,t))return void me(i,!1);var n=[],o=0,l=i.asStripeClasses,r=l.length,a=(i.aoOpenRows.length,i.oLanguage),c=i.iInitDisplayStart,u="ssp"==je(i),d=i.aiDisplay;i.bDrawing=!0,c!==s&&-1!==c&&(i._iDisplayStart=u?c:c>=i.fnRecordsDisplay()?0:c,i.iInitDisplayStart=-1);var h=i._iDisplayStart,p=i.fnDisplayEnd();if(i.bDeferLoading)i.bDeferLoading=!1,i.iDraw++,me(i,!1);else if(u){if(!i.bDestroying&&!j(i))return}else i.iDraw++;if(0!==d.length)for(var m=u?0:h,f=u?i.aoData.length:p,b=m;b<f;b++){var v=d[b],w=i.aoData[v];null===w.nTr&&P(i,v);var y=w.nTr;if(0!==r){var _=l[o%r];w._sRowStripe!=_&&(e(y).removeClass(w._sRowStripe).addClass(_),w._sRowStripe=_)}He(i,"aoRowCallback",null,[y,w._aData,o,b]),n.push(y),o++}else{var C=a.sZeroRecords;1==i.iDraw&&"ajax"==je(i)?C=a.sLoadingRecords:a.sEmptyTable&&0===i.fnRecordsTotal()&&(C=a.sEmptyTable),n[0]=e("<tr/>",{"class":r?l[0]:""}).append(e("<td />",{"style":"vertical-align: top;","colSpan":g(i),"class":i.oClasses.sRowEmpty}).html(C))[0]}He(i,"aoHeaderCallback","header",[e(i.nTHead).children("tr")[0],A(i),h,p,d]),He(i,"aoFooterCallback","footer",[e(i.nTFoot).children("tr")[0],A(i),h,p,d]);var T=e(i.nTBody);T.children().detach(),T.append(e(n)),He(i,"aoDrawCallback","draw",[i]),i.bSorted=!1,i.bFiltered=!1,i.bDrawing=!1}function O(e,i){var t=e.oFeatures,s=t.bSort,n=t.bFilter;s&&Ie(e),n?J(e,e.oPreviousSearch):e.aiDisplay=e.aiDisplayMaster.slice(),!0!==i&&(e._iDisplayStart=0),e._drawHold=i,L(e),e._drawHold=!1}function $(i){var t=i.oClasses,s=e(i.nTable),n=e("<div/>").insertBefore(s),o=i.oFeatures,l=e("<div/>",{"id":i.sTableId+"_wrapper","class":t.sWrapper+(i.nTFoot?"":" "+t.sNoFooter)});i.nHolding=n[0],i.nTableWrapper=l[0],i.nTableReinsertBefore=i.nTable.nextSibling;for(var r,a,c,u,d,h,p=i.sDom.split(""),m=0;m<p.length;m++){if(r=null,"<"==(a=p[m])){if(c=e("<div/>")[0],"'"==(u=p[m+1])||'"'==u){for(d="",h=2;p[m+h]!=u;)d+=p[m+h],h++;if("H"==d?d=t.sJUIHeader:"F"==d&&(d=t.sJUIFooter),-1!=d.indexOf(".")){var f=d.split(".");c.id=f[0].substr(1,f[0].length-1),c.className=f[1]}else"#"==d.charAt(0)?c.id=d.substr(1,d.length-1):c.className=d;m+=h}l.append(c),l=e(c)}else if(">"==a)l=l.parent();else if("l"==a&&o.bPaginate&&o.bLengthChange)r=ue(i);else if("f"==a&&o.bFilter)r=K(i);else if("r"==a&&o.bProcessing)r=pe(i);else if("t"==a)r=fe(i);else if("i"==a&&o.bInfo)r=ne(i);else if("p"==a&&o.bPaginate)r=de(i);else if(0!==Ke.ext.feature.length)for(var g=Ke.ext.feature,b=0,v=g.length;b<v;b++)if(a==g[b].cFeature){r=g[b].fnInit(i);break}if(r){var w=i.aanFeatures;w[a]||(w[a]=[]),w[a].push(r),l.append(r)}}n.replaceWith(l)}function H(i,t){var s,n,o,l,r,a,c,u,d,h,p,m=e(t).children("tr");for(i.splice(0,i.length),o=0,a=m.length;o<a;o++)i.push([]);for(o=0,a=m.length;o<a;o++)for(s=m[o],u=0,n=s.firstChild;n;){if("TD"==n.nodeName.toUpperCase()||"TH"==n.nodeName.toUpperCase())for(d=1*n.getAttribute("colspan"),h=1*n.getAttribute("rowspan"),d=d&&0!==d&&1!==d?d:1,h=h&&0!==h&&1!==h?h:1,c=function(e,i,t){for(var s=e[i];s[t];)t++;return t}(i,o,u),p=1===d,r=0;r<d;r++)for(l=0;l<h;l++)i[o+l][c+r]={"cell":n,"unique":p},i[o+l].nTr=s;n=n.nextSibling}}function z(e,i,t){var s=[];t||(t=e.aoHeader,i&&(t=[],H(t,i)));for(var n=0,o=t.length;n<o;n++)for(var l=0,r=t[n].length;l<r;l++)!t[n][l].unique||s[l]&&e.bSortCellsTop||(s[l]=t[n][l].cell);return s}function U(i,t,s){if(He(i,"aoServerParams","serverParams",[t]),t&&e.isArray(t)){var n={},o=/(.*?)\[\]$/;e.each(t,function(e,i){var t=i.name.match(o);if(t){var s=t[0];n[s]||(n[s]=[]),n[s].push(i.value)}else n[i.name]=i.value}),t=n}var l,r=i.ajax,a=i.oInstance;if(e.isPlainObject(r)&&r.data){l=r.data;var c=e.isFunction(l)?l(t):l;t=e.isFunction(l)&&c?c:e.extend(!0,t,c),delete r.data}var u={"data":t,"success":function(e){var t=e.error||e.sError;t&&i.oApi._fnLog(i,0,t),i.json=e,He(i,null,"xhr",[i,e]),s(e)},"dataType":"json","cache":!1,"type":i.sServerMethod,"error":function(e,t,s){var n=i.oApi._fnLog;"parsererror"==t?n(i,0,"Invalid JSON response",1):4===e.readyState&&n(i,0,"Ajax error",7),me(i,!1)}};i.oAjaxData=t,He(i,null,"preXhr",[i,t]),i.fnServerData?i.fnServerData.call(a,i.sAjaxSource,e.map(t,function(e,i){return{"name":i,"value":e}}),s,i):i.sAjaxSource||"string"==typeof r?i.jqXHR=e.ajax(e.extend(u,{"url":r||i.sAjaxSource})):e.isFunction(r)?i.jqXHR=r.call(a,t,s,i):(i.jqXHR=e.ajax(e.extend(u,r)),r.data=l)}function j(e){return!e.bAjaxDataGet||(e.iDraw++,me(e,!0),U(e,q(e),function(i){G(e,i)}),!1)}function q(i){var t,s,n,o,l=i.aoColumns,r=l.length,a=i.oFeatures,c=i.oPreviousSearch,u=i.aoPreSearchCols,d=[],h=Se(i),p=i._iDisplayStart,m=!1!==a.bPaginate?i._iDisplayLength:-1,f=function(e,i){d.push({"name":e,"value":i})};f("sEcho",i.iDraw),f("iColumns",r),f("sColumns",hi(l,"sName").join(",")),f("iDisplayStart",p),f("iDisplayLength",m);var g={"draw":i.iDraw,"columns":[],"order":[],"start":p,"length":m,"search":{"value":c.sSearch,"regex":c.bRegex}};for(t=0;t<r;t++)n=l[t],o=u[t],s="function"==typeof n.mData?"function":n.mData,g.columns.push({"data":s,"name":n.sName,"searchable":n.bSearchable,"orderable":n.bSortable,"search":{"value":o.sSearch,"regex":o.bRegex}}),f("mDataProp_"+t,s),a.bFilter&&(f("sSearch_"+t,o.sSearch),f("bRegex_"+t,o.bRegex),f("bSearchable_"+t,n.bSearchable)),a.bSort&&f("bSortable_"+t,n.bSortable);a.bFilter&&(f("sSearch",c.sSearch),f("bRegex",c.bRegex)),a.bSort&&(e.each(h,function(e,i){g.order.push({"column":i.col,"dir":i.dir}),f("iSortCol_"+e,i.col),f("sSortDir_"+e,i.dir)}),f("iSortingCols",h.length));var b=Ke.ext.legacy.ajax;return null===b?i.sAjaxSource?d:g:b?d:g}function G(e,i){var t=function(e,t){return i[e]!==s?i[e]:i[t]},n=t("sEcho","draw"),o=t("iTotalRecords","recordsTotal"),l=t("iTotalDisplayRecords","recordsFiltered");if(n){if(1*n<e.iDraw)return;e.iDraw=1*n}M(e),e._iRecordsTotal=parseInt(o,10),e._iRecordsDisplay=parseInt(l,10);for(var r=W(e,i),a=0,c=r.length;a<c;a++)y(e,r[a]);e.aiDisplay=e.aiDisplayMaster.slice(),e.bAjaxDataGet=!1,L(e),e._bInitComplete||ae(e,i),e.bAjaxDataGet=!0,me(e,!1)}function W(i,t){var n=e.isPlainObject(i.ajax)&&i.ajax.dataSrc!==s?i.ajax.dataSrc:i.sAjaxDataProp;return"data"===n?t.aaData||t[n]:""!==n?I(n)(t):t}function K(i){var s=i.oClasses,n=i.sTableId,o=i.oLanguage,l=i.oPreviousSearch,r=i.aanFeatures,a='<input type="search" class="'+s.sFilterInput+'"/>',c=o.sSearch;c=c.match(/_INPUT_/)?c.replace("_INPUT_",a):c+a;var u=e("<div/>",{"id":r.f?null:n+"_filter","class":s.sFilter}).append(e("<label/>").append(c)),d=function(){var e=(r.f,this.value?this.value:"");e!=l.sSearch&&(J(i,{"sSearch":e,"bRegex":l.bRegex,"bSmart":l.bSmart,"bCaseInsensitive":l.bCaseInsensitive}),i._iDisplayStart=0,L(i))},h=null!==i.searchDelay?i.searchDelay:"ssp"===je(i)?400:0,p=e("input",u).val(l.sSearch).attr("placeholder",o.sSearchPlaceholder).bind("keyup.DT search.DT input.DT paste.DT cut.DT",h?we(d,h):d).bind("keypress.DT",function(e){if(13==e.keyCode)return!1}).attr("aria-controls",n);return e(i.nTable).on("search.dt.DT",function(e,s){if(i===s)try{p[0]!==t.activeElement&&p.val(l.sSearch)}catch(e){}}),u[0]}function J(e,i,t){var n=e.oPreviousSearch,o=e.aoPreSearchCols,l=function(e){n.sSearch=e.sSearch,n.bRegex=e.bRegex,n.bSmart=e.bSmart,n.bCaseInsensitive=e.bCaseInsensitive},r=function(e){return e.bEscapeRegex!==s?!e.bEscapeRegex:e.bRegex};if(v(e),"ssp"!=je(e)){Q(e,i.sSearch,t,r(i),i.bSmart,i.bCaseInsensitive),l(i);for(var a=0;a<o.length;a++)Z(e,o[a].sSearch,a,r(o[a]),o[a].bSmart,o[a].bCaseInsensitive);X(e)}else l(i);e.bFiltered=!0,He(e,null,"search",[e])}function X(e){for(var i,t,s=Ke.ext.search,n=e.aiDisplay,o=0,l=s.length;o<l;o++){for(var r=[],a=0,c=n.length;a<c;a++)t=n[a],i=e.aoData[t],s[o](e,i._aFilterData,t,i._aData,a)&&r.push(t);n.length=0,n.push.apply(n,r)}}function Z(e,i,t,s,n,o){if(""!==i)for(var l,r=e.aiDisplay,a=Y(i,s,n,o),c=r.length-1;c>=0;c--)l=e.aoData[r[c]]._aFilterData[t],a.test(l)||r.splice(c,1)}function Q(e,i,t,s,n,o){var l,r,a,c=Y(i,s,n,o),u=e.oPreviousSearch.sSearch,d=e.aiDisplayMaster;if(0!==Ke.ext.search.length&&(t=!0),r=ie(e),i.length<=0)e.aiDisplay=d.slice();else for((r||t||u.length>i.length||0!==i.indexOf(u)||e.bSorted)&&(e.aiDisplay=d.slice()),l=e.aiDisplay,a=l.length-1;a>=0;a--)c.test(e.aoData[l[a]]._sFilterRow)||l.splice(a,1)}function Y(i,t,s,n){if(i=t?i:ee(i),s){i="^(?=.*?"+e.map(i.match(/"[^"]+"|[^ ]+/g)||"",function(e){if('"'===e.charAt(0)){var i=e.match(/^"(.*)"$/);e=i?i[1]:e}return e.replace('"',"")}).join(")(?=.*?")+").*$"}return new RegExp(i,n?"i":"")}function ee(e){return e.replace(ni,"\\$1")}function ie(e){var i,t,s,n,o,l,r,a,c=e.aoColumns,u=Ke.ext.type.search,d=!1;for(t=0,n=e.aoData.length;t<n;t++)if(a=e.aoData[t],!a._aFilterData){for(l=[],s=0,o=c.length;s<o;s++)i=c[s],i.bSearchable?(r=x(e,t,s,"filter"),u[i.sType]&&(r=u[i.sType](r)),null===r&&(r=""),"string"!=typeof r&&r.toString&&(r=r.toString())):r="",r.indexOf&&-1!==r.indexOf("&")&&(_i.innerHTML=r,r=Ci?_i.textContent:_i.innerText),r.replace&&(r=r.replace(/[\r\n]/g,"")),l.push(r);a._aFilterData=l,a._sFilterRow=l.join("  "),d=!0}return d}function te(e){return{"search":e.sSearch,"smart":e.bSmart,"regex":e.bRegex,"caseInsensitive":e.bCaseInsensitive}}function se(e){return{"sSearch":e.search,"bSmart":e.smart,"bRegex":e.regex,"bCaseInsensitive":e.caseInsensitive}}function ne(i){var t=i.sTableId,s=i.aanFeatures.i,n=e("<div/>",{"class":i.oClasses.sInfo,"id":s?null:t+"_info"});return s||(i.aoDrawCallback.push({"fn":oe,"sName":"information"}),n.attr("role","status").attr("aria-live","polite"),e(i.nTable).attr("aria-describedby",t+"_info")),n[0]}function oe(i){var t=i.aanFeatures.i;if(0!==t.length){var s=i.oLanguage,n=i._iDisplayStart+1,o=i.fnDisplayEnd(),l=i.fnRecordsTotal(),r=i.fnRecordsDisplay(),a=r?s.sInfo:s.sInfoEmpty;r!==l&&(a+=" "+s.sInfoFiltered),a+=s.sInfoPostFix,a=le(i,a);var c=s.fnInfoCallback;null!==c&&(a=c.call(i.oInstance,i,n,o,l,r,a)),e(t).html(a)}}function le(e,i){var t=e.fnFormatNumber,s=e._iDisplayStart+1,n=e._iDisplayLength,o=e.fnRecordsDisplay(),l=-1===n;return i.replace(/_START_/g,t.call(e,s)).replace(/_END_/g,t.call(e,e.fnDisplayEnd())).replace(/_MAX_/g,t.call(e,e.fnRecordsTotal())).replace(/_TOTAL_/g,t.call(e,o)).replace(/_PAGE_/g,t.call(e,l?1:Math.ceil(s/n))).replace(/_PAGES_/g,t.call(e,l?1:Math.ceil(o/n)))}function re(e){var i,t,s,n=e.iInitDisplayStart,o=e.aoColumns,l=e.oFeatures;if(!e.bInitialised)return void setTimeout(function(){re(e)},200);for($(e),B(e),N(e,e.aoHeader),N(e,e.aoFooter),me(e,!0),l.bAutoWidth&&ve(e),i=0,t=o.length;i<t;i++)s=o[i],s.sWidth&&(s.nTh.style.width=xe(s.sWidth));O(e);var r=je(e);"ssp"!=r&&("ajax"==r?U(e,[],function(t){var s=W(e,t);for(i=0;i<s.length;i++)y(e,s[i]);e.iInitDisplayStart=n,O(e),me(e,!1),ae(e,t)},e):(me(e,!1),ae(e)))}function ae(e,i){e._bInitComplete=!0,i&&p(e),He(e,"aoInitComplete","init",[e,i])}function ce(e,i){var t=parseInt(i,10);e._iDisplayLength=t,ze(e),He(e,null,"length",[e,t])}function ue(i){for(var t=i.oClasses,s=i.sTableId,n=i.aLengthMenu,o=e.isArray(n[0]),l=o?n[0]:n,r=o?n[1]:n,a=e("<select/>",{"name":s+"_length","aria-controls":s,"class":t.sLengthSelect}),c=0,u=l.length;c<u;c++)a[0][c]=new Option(r[c],l[c]);var d=e("<div><label/></div>").addClass(t.sLength);return i.aanFeatures.l||(d[0].id=s+"_length"),d.children().append(i.oLanguage.sLengthMenu.replace("_MENU_",a[0].outerHTML)),e("select",d).val(i._iDisplayLength).bind("change.DT",function(t){ce(i,e(this).val()),L(i)}),e(i.nTable).bind("length.dt.DT",function(t,s,n){i===s&&e("select",d).val(n)}),d[0]}function de(i){var t=i.sPaginationType,s=Ke.ext.pager[t],n="function"==typeof s,o=function(e){L(e)},l=e("<div/>").addClass(i.oClasses.sPaging+t)[0],r=i.aanFeatures;return n||s.fnInit(i,l,o),r.p||(l.id=i.sTableId+"_paginate",i.aoDrawCallback.push({"fn":function(e){if(n){var i,t,l=e._iDisplayStart,a=e._iDisplayLength,c=e.fnRecordsDisplay(),u=-1===a,d=u?0:Math.ceil(l/a),h=u?1:Math.ceil(c/a),p=s(d,h);for(i=0,t=r.p.length;i<t;i++)Ue(e,"pageButton")(e,r.p[i],i,p,d,h)}else s.fnUpdate(e,o)},"sName":"pagination"})),l}function he(e,i,t){var s=e._iDisplayStart,n=e._iDisplayLength,o=e.fnRecordsDisplay();0===o||-1===n?s=0:"number"==typeof i?(s=i*n)>o&&(s=0):"first"==i?s=0:"previous"==i?(s=n>=0?s-n:0)<0&&(s=0):"next"==i?s+n<o&&(s+=n):"last"==i?s=Math.floor((o-1)/n)*n:Be(e,0,"Unknown paging action: "+i,5);var l=e._iDisplayStart!==s;return e._iDisplayStart=s,l&&(He(e,null,"page",[e]),t&&L(e)),l}function pe(i){return e("<div/>",{"id":i.aanFeatures.r?null:i.sTableId+"_processing","class":i.oClasses.sProcessing}).html(i.oLanguage.sProcessing).insertBefore(i.nTable)[0]}function me(i,t){i.oFeatures.bProcessing&&e(i.aanFeatures.r).css("display",t?"block":"none"),He(i,null,"processing",[i,t])}function fe(i){var t=e(i.nTable),s=i.oScroll;if(""===s.sX&&""===s.sY)return i.nTable;var n=s.sX,o=s.sY,l=i.oClasses,r=t.children("caption"),a=r.length?r[0]._captionSide:null,c=e(t[0].cloneNode(!1)),u=e(t[0].cloneNode(!1)),d=t.children("tfoot"),h="<div/>",p=function(e){return e?xe(e):null};s.sX&&"100%"===t.attr("width")&&t.removeAttr("width"),d.length||(d=null);var m=e(h,{"class":l.sScrollWrapper}).append(e(h,{"class":l.sScrollHead}).css({"overflow":"hidden","position":"relative","border":0,"width":n?p(n):"100%"}).append(e(h,{"class":l.sScrollHeadInner}).css({"box-sizing":"content-box","width":s.sXInner||"100%"}).append(c.removeAttr("id").css("margin-left",0).append("top"===a?r:null).append(t.children("thead"))))).append(e(h,{"class":l.sScrollBody}).css({"overflow":"auto","height":p(o),"width":p(n)}).append(t));d&&m.append(e(h,{"class":l.sScrollFoot}).css({"overflow":"hidden","border":0,"width":n?p(n):"100%"}).append(e(h,{"class":l.sScrollFootInner}).append(u.removeAttr("id").css("margin-left",0).append("bottom"===a?r:null).append(t.children("tfoot")))));var f=m.children(),g=f[0],b=f[1],v=d?f[2]:null;return n&&e(b).scroll(function(e){var i=this.scrollLeft;g.scrollLeft=i,d&&(v.scrollLeft=i)}),i.nScrollHead=g,i.nScrollBody=b,i.nScrollFoot=v,i.aoDrawCallback.push({"fn":ge,"sName":"scrolling"}),m[0]}function ge(i){var t,s,n,o,l,r,a,c,u,d=i.oScroll,h=d.sX,p=d.sXInner,f=d.sY,g=d.iBarWidth,b=e(i.nScrollHead),v=b[0].style,w=b.children("div"),y=w[0].style,_=w.children("table"),C=i.nScrollBody,T=e(C),x=C.style,k=e(i.nScrollFoot),S=k.children("div"),I=S.children("table"),V=e(i.nTHead),A=e(i.nTable),M=A[0],E=M.style,D=i.nTFoot?e(i.nTFoot):null,F=i.oBrowser,P=F.bScrollOversize,R=[],B=[],N=[],L=function(e){var i=e.style;i.paddingTop="0",i.paddingBottom="0",i.borderTopWidth="0",i.borderBottomWidth="0",i.height=0};if(A.children("thead, tfoot").remove(),l=V.clone().prependTo(A),t=V.find("tr"),n=l.find("tr"),l.find("th, td").removeAttr("tabindex"),D&&(r=D.clone().prependTo(A),s=D.find("tr"),o=r.find("tr")),h||(x.width="100%",b[0].style.width="100%"),e.each(z(i,l),function(e,t){a=m(i,e),t.style.width=i.aoColumns[a].sWidth}),D&&be(function(e){e.style.width=""},o),d.bCollapse&&""!==f&&(x.height=T[0].offsetHeight+V[0].offsetHeight+"px"),u=A.outerWidth(),""===h?(E.width="100%",P&&(A.find("tbody").height()>C.offsetHeight||"scroll"==T.css("overflow-y"))&&(E.width=xe(A.outerWidth()-g))):""!==p?E.width=xe(p):u==T.width()&&T.height()<A.height()?(E.width=xe(u-g),A.outerWidth()>u-g&&(E.width=xe(u))):E.width=xe(u),u=A.outerWidth(),be(L,n),be(function(i){N.push(i.innerHTML),R.push(xe(e(i).css("width")))},n),be(function(e,i){e.style.width=R[i]},t),e(n).height(0),D&&(be(L,o),be(function(i){B.push(xe(e(i).css("width")))},o),be(function(e,i){e.style.width=B[i]},s),e(o).height(0)),be(function(e,i){e.innerHTML='<div class="dataTables_sizing" style="height:0;overflow:hidden;">'+N[i]+"</div>",e.style.width=R[i]},n),D&&be(function(e,i){e.innerHTML="",e.style.width=B[i]},o),A.outerWidth()<u?(c=C.scrollHeight>C.offsetHeight||"scroll"==T.css("overflow-y")?u+g:u,P&&(C.scrollHeight>C.offsetHeight||"scroll"==T.css("overflow-y"))&&(E.width=xe(c-g)),""!==h&&""===p||Be(i,1,"Possible column misalignment",6)):c="100%",x.width=xe(c),v.width=xe(c),D&&(i.nScrollFoot.style.width=xe(c)),f||P&&(x.height=xe(M.offsetHeight+g)),f&&d.bCollapse){x.height=xe(f);var O=h&&M.offsetWidth>C.offsetWidth?g:0;M.offsetHeight<C.offsetHeight&&(x.height=xe(M.offsetHeight+O))}var $=A.outerWidth();_[0].style.width=xe($),y.width=xe($);var H=A.height()>C.clientHeight||"scroll"==T.css("overflow-y"),U="padding"+(F.bScrollbarLeft?"Left":"Right");y[U]=H?g+"px":"0px",D&&(I[0].style.width=xe($),S[0].style.width=xe($),S[0].style[U]=H?g+"px":"0px"),T.scroll(),!i.bSorted&&!i.bFiltered||i._drawHold||(C.scrollTop=0)}function be(e,i,t){for(var s,n,o=0,l=0,r=i.length;l<r;){for(s=i[l].firstChild,n=t?t[l].firstChild:null;s;)1===s.nodeType&&(t?e(s,n,o):e(s,o),o++),s=s.nextSibling,n=t?n.nextSibling:null;l++}}function ve(t){var s,n,o,l,r,a=t.nTable,c=t.aoColumns,u=t.oScroll,d=u.sY,h=u.sX,m=u.sXInner,f=c.length,v=b(t,"bVisible"),w=e("th",t.nTHead),y=a.getAttribute("width"),_=a.parentNode,C=!1;for(s=0;s<v.length;s++)n=c[v[s]],null!==n.sWidth&&(n.sWidth=ye(n.sWidthOrig,_),C=!0);if(C||h||d||f!=g(t)||f!=w.length){var T=e(a).clone().empty().css("visibility","hidden").removeAttr("id").append(e(t.nTHead).clone(!1)).append(e(t.nTFoot).clone(!1)).append(e("<tbody><tr/></tbody>"));T.find("tfoot th, tfoot td").css("width","");var x=T.find("tbody tr");for(w=z(t,T.find("thead")[0]),s=0;s<v.length;s++)n=c[v[s]],w[s].style.width=null!==n.sWidthOrig&&""!==n.sWidthOrig?xe(n.sWidthOrig):"";if(t.aoData.length)for(s=0;s<v.length;s++)o=v[s],n=c[o],e(Ce(t,o)).clone(!1).append(n.sContentPadding).appendTo(x);if(T.appendTo(_),h&&m?T.width(m):h?(T.css("width","auto"),T.width()<_.offsetWidth&&T.width(_.offsetWidth)):d?T.width(_.offsetWidth):y&&T.width(y),_e(t,T[0]),h){var k=0;for(s=0;s<v.length;s++)n=c[v[s]],r=e(w[s]).outerWidth(),k+=null===n.sWidthOrig?r:parseInt(n.sWidth,10)+r-e(w[s]).width();T.width(xe(k)),a.style.width=xe(k)}for(s=0;s<v.length;s++)n=c[v[s]],(l=e(w[s]).width())&&(n.sWidth=xe(l));a.style.width=xe(T.css("width")),T.remove()}else for(s=0;s<f;s++)c[s].sWidth=xe(w.eq(s).width());y&&(a.style.width=xe(y)),!y&&!h||t._reszEvt||(e(i).bind("resize.DT-"+t.sInstance,we(function(){p(t)})),t._reszEvt=!0)}function we(e,i){var t,n,o=i!==s?i:200;return function(){var i=this,l=+new Date,r=arguments;t&&l<t+o?(clearTimeout(n),n=setTimeout(function(){t=s,e.apply(i,r)},o)):t?(t=l,e.apply(i,r)):t=l}}function ye(i,s){if(!i)return 0;var n=e("<div/>").css("width",xe(i)).appendTo(s||t.body),o=n[0].offsetWidth;return n.remove(),o}function _e(i,t){var s=i.oScroll;if(s.sX||s.sY){var n=s.sX?0:s.iBarWidth;t.style.width=xe(e(t).outerWidth()-n)}}function Ce(i,t){var s=Te(i,t);if(s<0)return null;var n=i.aoData[s];return n.nTr?n.anCells[t]:e("<td/>").html(x(i,s,t,"display"))[0]}function Te(e,i){for(var t,s=-1,n=-1,o=0,l=e.aoData.length;o<l;o++)t=x(e,o,i,"display")+"",t=t.replace(Ti,""),t.length>s&&(s=t.length,n=o);return n}function xe(e){return null===e?"0px":"number"==typeof e?e<0?"0px":e+"px":e.match(/\d$/)?e+"px":e}function ke(){if(!Ke.__scrollbarWidth){var i=e("<p/>").css({"width":"100%","height":200,"padding":0})[0],t=e("<div/>").css({"position":"absolute","top":0,"left":0,"width":200,"height":150,"padding":0,"overflow":"hidden","visibility":"hidden"}).append(i).appendTo("body"),s=i.offsetWidth;t.css("overflow","scroll");var n=i.offsetWidth;s===n&&(n=t[0].clientWidth),t.remove(),Ke.__scrollbarWidth=s-n}return Ke.__scrollbarWidth}function Se(i){var t,n,o,l,r,a,c,u=[],d=i.aoColumns,h=i.aaSortingFixed,p=e.isPlainObject(h),m=[],f=function(i){i.length&&!e.isArray(i[0])?m.push(i):m.push.apply(m,i)};for(e.isArray(h)&&f(h),p&&h.pre&&f(h.pre),f(i.aaSorting),p&&h.post&&f(h.post),t=0;t<m.length;t++)for(c=m[t][0],l=d[c].aDataSort,n=0,o=l.length;n<o;n++)r=l[n],a=d[r].sType||"string",m[t]._idx===s&&(m[t]._idx=e.inArray(m[t][1],d[r].asSorting)),u.push({"src":c,"col":r,"dir":m[t][1],"index":m[t]._idx,"type":a,"formatter":Ke.ext.type.order[a+"-pre"]});return u}function Ie(e){var i,t,s,n,o,l=[],r=Ke.ext.type.order,a=e.aoData,c=(e.aoColumns,0),u=e.aiDisplayMaster;for(v(e),o=Se(e),i=0,t=o.length;i<t;i++)n=o[i],n.formatter&&c++,De(e,n.col);if("ssp"!=je(e)&&0!==o.length){for(i=0,s=u.length;i<s;i++)l[u[i]]=i;c===o.length?u.sort(function(e,i){var t,s,n,r,c,u=o.length,d=a[e]._aSortData,h=a[i]._aSortData;for(n=0;n<u;n++)if(c=o[n],t=d[c.col],s=h[c.col],0!==(r=t<s?-1:t>s?1:0))return"asc"===c.dir?r:-r;return t=l[e],s=l[i],t<s?-1:t>s?1:0}):u.sort(function(e,i){var t,s,n,c,u,d,h=o.length,p=a[e]._aSortData,m=a[i]._aSortData;for(n=0;n<h;n++)if(u=o[n],t=p[u.col],s=m[u.col],d=r[u.type+"-"+u.dir]||r["string-"+u.dir],0!==(c=d(t,s)))return c;return t=l[e],s=l[i],t<s?-1:t>s?1:0})}e.bSorted=!0}function Ve(e){for(var i,t,s=e.aoColumns,n=Se(e),o=e.oLanguage.oAria,l=0,r=s.length;l<r;l++){var a=s[l],c=a.asSorting,u=a.sTitle.replace(/<.*?>/g,""),d=a.nTh;d.removeAttribute("aria-sort"),a.bSortable?(n.length>0&&n[0].col==l?(d.setAttribute("aria-sort","asc"==n[0].dir?"ascending":"descending"),t=c[n[0].index+1]||c[0]):t=c[0],i=u+("asc"===t?o.sSortAscending:o.sSortDescending)):i=u,d.setAttribute("aria-label",i)}}function Ae(i,t,n,o){var l,r=i.aoColumns[t],a=i.aaSorting,c=r.asSorting,u=function(i,t){var n=i._idx;return n===s&&(n=e.inArray(i[1],c)),n+1<c.length?n+1:t?null:0};if("number"==typeof a[0]&&(a=i.aaSorting=[a]),n&&i.oFeatures.bSortMulti){var d=e.inArray(t,hi(a,"0"));-1!==d?(l=u(a[d],!0),null===l?a.splice(d,1):(a[d][1]=c[l],a[d]._idx=l)):(a.push([t,c[0],0]),a[a.length-1]._idx=0)}else a.length&&a[0][0]==t?(l=u(a[0]),a.length=1,a[0][1]=c[l],a[0]._idx=l):(a.length=0,a.push([t,c[0]]),a[0]._idx=0);O(i),"function"==typeof o&&o(i)}function Me(e,i,t,s){var n=e.aoColumns[t];Oe(i,{},function(i){!1!==n.bSortable&&(e.oFeatures.bProcessing?(me(e,!0),setTimeout(function(){Ae(e,t,i.shiftKey,s),"ssp"!==je(e)&&me(e,!1)},0)):Ae(e,t,i.shiftKey,s))})}function Ee(i){var t,s,n,o=i.aLastSort,l=i.oClasses.sSortColumn,r=Se(i),a=i.oFeatures;if(a.bSort&&a.bSortClasses){for(t=0,s=o.length;t<s;t++)n=o[t].src,e(hi(i.aoData,"anCells",n)).removeClass(l+(t<2?t+1:3));for(t=0,s=r.length;t<s;t++)n=r[t].src,e(hi(i.aoData,"anCells",n)).addClass(l+(t<2?t+1:3))}i.aLastSort=r}function De(e,i){var t,s=e.aoColumns[i],n=Ke.ext.order[s.sSortDataType];n&&(t=n.call(e.oInstance,e,i,f(e,i)));for(var o,l,r=Ke.ext.type.order[s.sType+"-pre"],a=0,c=e.aoData.length;a<c;a++)o=e.aoData[a],o._aSortData||(o._aSortData=[]),o._aSortData[i]&&!n||(l=n?t[a]:x(e,a,i,"sort"),o._aSortData[i]=r?r(l):l)}function Fe(i){if(i.oFeatures.bStateSave&&!i.bDestroying){var t={"time":+new Date,"start":i._iDisplayStart,"length":i._iDisplayLength,"order":e.extend(!0,[],i.aaSorting),"search":te(i.oPreviousSearch),"columns":e.map(i.aoColumns,function(e,t){return{"visible":e.bVisible,"search":te(i.aoPreSearchCols[t])}})};He(i,"aoStateSaveParams","stateSaveParams",[i,t]),i.oSavedState=t,i.fnStateSaveCallback.call(i.oInstance,i,t)}}function Pe(i,t){var s,n,o=i.aoColumns;if(i.oFeatures.bStateSave){var l=i.fnStateLoadCallback.call(i.oInstance,i);if(l&&l.time){var r=He(i,"aoStateLoadParams","stateLoadParams",[i,l]);if(-1===e.inArray(!1,r)){var a=i.iStateDuration
;if(!(a>0&&l.time<+new Date-1e3*a)&&o.length===l.columns.length){for(i.oLoadedState=e.extend(!0,{},l),i._iDisplayStart=l.start,i.iInitDisplayStart=l.start,i._iDisplayLength=l.length,i.aaSorting=[],e.each(l.order,function(e,t){i.aaSorting.push(t[0]>=o.length?[0,t[1]]:t)}),e.extend(i.oPreviousSearch,se(l.search)),s=0,n=l.columns.length;s<n;s++){var c=l.columns[s];o[s].bVisible=c.visible,e.extend(i.aoPreSearchCols[s],se(c.search))}He(i,"aoStateLoaded","stateLoaded",[i,l])}}}}}function Re(i){var t=Ke.settings,s=e.inArray(i,hi(t,"nTable"));return-1!==s?t[s]:null}function Be(e,t,s,n){if(s="DataTables warning: "+(null!==e?"table id="+e.sTableId+" - ":"")+s,n&&(s+=". For more information about this error, please see http://datatables.net/tn/"+n),t)i.console&&console.log&&console.log(s);else{var o=Ke.ext;if("alert"!=(o.sErrMode||o.errMode))throw new Error(s);alert(s)}}function Ne(i,t,n,o){if(e.isArray(n))return void e.each(n,function(s,n){e.isArray(n)?Ne(i,t,n[0],n[1]):Ne(i,t,n)});o===s&&(o=n),t[n]!==s&&(i[o]=t[n])}function Le(i,t,s){var n;for(var o in t)t.hasOwnProperty(o)&&(n=t[o],e.isPlainObject(n)?(e.isPlainObject(i[o])||(i[o]={}),e.extend(!0,i[o],n)):s&&"data"!==o&&"aaData"!==o&&e.isArray(n)?i[o]=n.slice():i[o]=n);return i}function Oe(i,t,s){e(i).bind("click.DT",t,function(e){i.blur(),s(e)}).bind("keypress.DT",t,function(e){13===e.which&&(e.preventDefault(),s(e))}).bind("selectstart.DT",function(){return!1})}function $e(e,i,t,s){t&&e[i].push({"fn":t,"sName":s})}function He(i,t,s,n){var o=[];return t&&(o=e.map(i[t].slice().reverse(),function(e,t){return e.fn.apply(i.oInstance,n)})),null!==s&&e(i.nTable).trigger(s+".dt",n),o}function ze(e){var i=e._iDisplayStart,t=e.fnDisplayEnd(),s=e._iDisplayLength;i>=t&&(i=t-s),i-=i%s,(-1===s||i<0)&&(i=0),e._iDisplayStart=i}function Ue(i,t){var s=i.renderer,n=Ke.ext.renderer[t];return e.isPlainObject(s)&&s[t]?n[s[t]]||n._:"string"==typeof s?n[s]||n._:n._}function je(e){return e.oFeatures.bServerSide?"ssp":e.ajax||e.sAjaxSource?"ajax":"dom"}function qe(e,i){var t=[],s=Ui.numbers_length,n=Math.floor(s/2);return i<=s?t=mi(0,i):e<=n?(t=mi(0,s-2),t.push("ellipsis"),t.push(i-1)):e>=i-1-n?(t=mi(i-(s-2),i),t.splice(0,0,"ellipsis"),t.splice(0,0,0)):(t=mi(e-1,e+2),t.push("ellipsis"),t.push(i-1),t.splice(0,0,"ellipsis"),t.splice(0,0,0)),t.DT_el="span",t}function Ge(i){e.each({"num":function(e){return ji(e,i)},"num-fmt":function(e){return ji(e,i,oi)},"html-num":function(e){return ji(e,i,ii)},"html-num-fmt":function(e){return ji(e,i,ii,oi)}},function(e,t){Je.type.order[e+i+"-pre"]=t,e.match(/^html\-/)&&(Je.type.search[e+i]=Je.type.search.html)})}function We(e){return function(){var i=[Re(this[Ke.ext.iApiIndex])].concat(Array.prototype.slice.call(arguments));return Ke.ext.internal[e].apply(this,i)}}var Ke,Je,Xe,Ze,Qe,Ye={},ei=/[\r\n]/g,ii=/<.*?>/g,ti=/^[\w\+\-]/,si=/[\w\+\-]$/,ni=new RegExp("(\\"+["/",".","*","+","?","|","(",")","[","]","{","}","\\","$","^","-"].join("|\\")+")","g"),oi=/[',$\xa3\u20ac\xa5%\u2009\u202F]/g,li=function(e){return!e||!0===e||"-"===e},ri=function(e){var i=parseInt(e,10);return!isNaN(i)&&isFinite(e)?i:null},ai=function(e,i){return Ye[i]||(Ye[i]=new RegExp(ee(i),"g")),"string"==typeof e&&"."!==i?e.replace(/\./g,"").replace(Ye[i],"."):e},ci=function(e,i,t){var s="string"==typeof e;return i&&s&&(e=ai(e,i)),t&&s&&(e=e.replace(oi,"")),li(e)||!isNaN(parseFloat(e))&&isFinite(e)},ui=function(e){return li(e)||"string"==typeof e},di=function(e,i,t){return!!li(e)||(ui(e)?!!ci(gi(e),i,t)||null:null)},hi=function(e,i,t){var n=[],o=0,l=e.length;if(t!==s)for(;o<l;o++)e[o]&&e[o][i]&&n.push(e[o][i][t]);else for(;o<l;o++)e[o]&&n.push(e[o][i]);return n},pi=function(e,i,t,n){var o=[],l=0,r=i.length;if(n!==s)for(;l<r;l++)e[i[l]][t]&&o.push(e[i[l]][t][n]);else for(;l<r;l++)o.push(e[i[l]][t]);return o},mi=function(e,i){var t,n=[];i===s?(i=0,t=e):(t=i,i=e);for(var o=i;o<t;o++)n.push(o);return n},fi=function(e){for(var i=[],t=0,s=e.length;t<s;t++)e[t]&&i.push(e[t]);return i},gi=function(e){return e.replace(ii,"")},bi=function(e){var i,t,s,n=[],o=e.length,l=0;e:for(t=0;t<o;t++){for(i=e[t],s=0;s<l;s++)if(n[s]===i)continue e;n.push(i),l++}return n},vi=function(e,i,t){e[i]!==s&&(e[t]=e[i])},wi=/\[.*?\]$/,yi=/\(\)$/,_i=e("<div>")[0],Ci=_i.textContent!==s,Ti=/<.*?>/g;Ke=function(i){this.$=function(e,i){return this.api(!0).$(e,i)},this._=function(e,i){return this.api(!0).rows(e,i).data()},this.api=function(e){return new Xe(e?Re(this[Je.iApiIndex]):this)},this.fnAddData=function(i,t){var n=this.api(!0),o=e.isArray(i)&&(e.isArray(i[0])||e.isPlainObject(i[0]))?n.rows.add(i):n.row.add(i);return(t===s||t)&&n.draw(),o.flatten().toArray()},this.fnAdjustColumnSizing=function(e){var i=this.api(!0).columns.adjust(),t=i.settings()[0],n=t.oScroll;e===s||e?i.draw(!1):""===n.sX&&""===n.sY||ge(t)},this.fnClearTable=function(e){var i=this.api(!0).clear();(e===s||e)&&i.draw()},this.fnClose=function(e){this.api(!0).row(e).child.hide()},this.fnDeleteRow=function(e,i,t){var n=this.api(!0),o=n.rows(e),l=o.settings()[0],r=l.aoData[o[0][0]];return o.remove(),i&&i.call(this,l,r),(t===s||t)&&n.draw(),r},this.fnDestroy=function(e){this.api(!0).destroy(e)},this.fnDraw=function(e){this.api(!0).draw(!e)},this.fnFilter=function(e,i,t,n,o,l){var r=this.api(!0);null===i||i===s?r.search(e,t,n,l):r.column(i).search(e,t,n,l),r.draw()},this.fnGetData=function(e,i){var t=this.api(!0);if(e!==s){var n=e.nodeName?e.nodeName.toLowerCase():"";return i!==s||"td"==n||"th"==n?t.cell(e,i).data():t.row(e).data()||null}return t.data().toArray()},this.fnGetNodes=function(e){var i=this.api(!0);return e!==s?i.row(e).node():i.rows().nodes().flatten().toArray()},this.fnGetPosition=function(e){var i=this.api(!0),t=e.nodeName.toUpperCase();if("TR"==t)return i.row(e).index();if("TD"==t||"TH"==t){var s=i.cell(e).index();return[s.row,s.columnVisible,s.column]}return null},this.fnIsOpen=function(e){return this.api(!0).row(e).child.isShown()},this.fnOpen=function(e,i,t){return this.api(!0).row(e).child(i,t).show().child()[0]},this.fnPageChange=function(e,i){var t=this.api(!0).page(e);(i===s||i)&&t.draw(!1)},this.fnSetColumnVis=function(e,i,t){var n=this.api(!0).column(e).visible(i);(t===s||t)&&n.columns.adjust().draw()},this.fnSettings=function(){return Re(this[Je.iApiIndex])},this.fnSort=function(e){this.api(!0).order(e).draw()},this.fnSortListener=function(e,i,t){this.api(!0).order.listener(e,i,t)},this.fnUpdate=function(e,i,t,n,o){var l=this.api(!0);return t===s||null===t?l.row(i).data(e):l.cell(i,t).data(e),(o===s||o)&&l.columns.adjust(),(n===s||n)&&l.draw(),0},this.fnVersionCheck=Je.fnVersionCheck;var t=this,n=i===s,u=this.length;n&&(i={}),this.oApi=this.internal=Je.internal;for(var p in Ke.ext.internal)p&&(this[p]=We(p));return this.each(function(){var p,m={},f=u>1?Le(m,i,!0):i,g=0,b=this.getAttribute("id"),v=!1,C=Ke.defaults;if("table"!=this.nodeName.toLowerCase())return void Be(null,0,"Non-table node initialisation ("+this.nodeName+")",2);r(C),a(C.column),o(C,C,!0),o(C.column,C.column,!0),o(C,f);var T=Ke.settings;for(g=0,p=T.length;g<p;g++){if(T[g].nTable==this){var x=f.bRetrieve!==s?f.bRetrieve:C.bRetrieve,k=f.bDestroy!==s?f.bDestroy:C.bDestroy;if(n||x)return T[g].oInstance;if(k){T[g].oInstance.fnDestroy();break}return void Be(T[g],0,"Cannot reinitialise DataTable",3)}if(T[g].sTableId==this.id){T.splice(g,1);break}}null!==b&&""!==b||(b="DataTables_Table_"+Ke.ext._unique++,this.id=b);var S=e.extend(!0,{},Ke.models.oSettings,{"nTable":this,"oApi":t.internal,"oInit":f,"sDestroyWidth":e(this)[0].style.width,"sInstance":b,"sTableId":b});T.push(S),S.oInstance=1===t.length?t:e(this).dataTable(),r(f),f.oLanguage&&l(f.oLanguage),f.aLengthMenu&&!f.iDisplayLength&&(f.iDisplayLength=e.isArray(f.aLengthMenu[0])?f.aLengthMenu[0][0]:f.aLengthMenu[0]),f=Le(e.extend(!0,{},C),f),Ne(S.oFeatures,f,["bPaginate","bLengthChange","bFilter","bSort","bSortMulti","bInfo","bProcessing","bAutoWidth","bSortClasses","bServerSide","bDeferRender"]),Ne(S,f,["asStripeClasses","ajax","fnServerData","fnFormatNumber","sServerMethod","aaSorting","aaSortingFixed","aLengthMenu","sPaginationType","sAjaxSource","sAjaxDataProp","iStateDuration","sDom","bSortCellsTop","iTabIndex","fnStateLoadCallback","fnStateSaveCallback","renderer","searchDelay",["iCookieDuration","iStateDuration"],["oSearch","oPreviousSearch"],["aoSearchCols","aoPreSearchCols"],["iDisplayLength","_iDisplayLength"],["bJQueryUI","bJUI"]]),Ne(S.oScroll,f,[["sScrollX","sX"],["sScrollXInner","sXInner"],["sScrollY","sY"],["bScrollCollapse","bCollapse"]]),Ne(S.oLanguage,f,"fnInfoCallback"),$e(S,"aoDrawCallback",f.fnDrawCallback,"user"),$e(S,"aoServerParams",f.fnServerParams,"user"),$e(S,"aoStateSaveParams",f.fnStateSaveParams,"user"),$e(S,"aoStateLoadParams",f.fnStateLoadParams,"user"),$e(S,"aoStateLoaded",f.fnStateLoaded,"user"),$e(S,"aoRowCallback",f.fnRowCallback,"user"),$e(S,"aoRowCreatedCallback",f.fnCreatedRow,"user"),$e(S,"aoHeaderCallback",f.fnHeaderCallback,"user"),$e(S,"aoFooterCallback",f.fnFooterCallback,"user"),$e(S,"aoInitComplete",f.fnInitComplete,"user"),$e(S,"aoPreDrawCallback",f.fnPreDrawCallback,"user");var I=S.oClasses;if(f.bJQueryUI?(e.extend(I,Ke.ext.oJUIClasses,f.oClasses),f.sDom===C.sDom&&"lfrtip"===C.sDom&&(S.sDom='<"H"lfr>t<"F"ip>'),S.renderer?e.isPlainObject(S.renderer)&&!S.renderer.header&&(S.renderer.header="jqueryui"):S.renderer="jqueryui"):e.extend(I,Ke.ext.classes,f.oClasses),e(this).addClass(I.sTable),""===S.oScroll.sX&&""===S.oScroll.sY||(S.oScroll.iBarWidth=ke()),!0===S.oScroll.sX&&(S.oScroll.sX="100%"),S.iInitDisplayStart===s&&(S.iInitDisplayStart=f.iDisplayStart,S._iDisplayStart=f.iDisplayStart),null!==f.iDeferLoading){S.bDeferLoading=!0;var V=e.isArray(f.iDeferLoading);S._iRecordsDisplay=V?f.iDeferLoading[0]:f.iDeferLoading,S._iRecordsTotal=V?f.iDeferLoading[1]:f.iDeferLoading}var A=S.oLanguage;e.extend(!0,A,f.oLanguage),""!==A.sUrl&&(e.ajax({"dataType":"json","url":A.sUrl,"success":function(i){l(i),o(C.oLanguage,i),e.extend(!0,A,i),re(S)},"error":function(){re(S)}}),v=!0),null===f.asStripeClasses&&(S.asStripeClasses=[I.sStripeOdd,I.sStripeEven]);var M=S.asStripeClasses,E=e("tbody tr:eq(0)",this);-1!==e.inArray(!0,e.map(M,function(e,i){return E.hasClass(e)}))&&(e("tbody tr",this).removeClass(M.join(" ")),S.asDestroyStripes=M.slice());var D,P=[],R=this.getElementsByTagName("thead");if(0!==R.length&&(H(S.aoHeader,R[0]),P=z(S)),null===f.aoColumns)for(D=[],g=0,p=P.length;g<p;g++)D.push(null);else D=f.aoColumns;for(g=0,p=D.length;g<p;g++)d(S,P?P[g]:null);if(w(S,f.aoColumnDefs,D,function(e,i){h(S,e,i)}),E.length){var B=function(e,i){return e.getAttribute("data-"+i)?i:null};e.each(F(S,E[0]).cells,function(e,i){var t=S.aoColumns[e];if(t.mData===e){var n=B(i,"sort")||B(i,"order"),o=B(i,"filter")||B(i,"search");null===n&&null===o||(t.mData={"_":e+".display","sort":null!==n?e+".@data-"+n:s,"type":null!==n?e+".@data-"+n:s,"filter":null!==o?e+".@data-"+o:s},h(S,e))}})}var N=S.oFeatures;if(f.bStateSave&&(N.bStateSave=!0,Pe(S,f),$e(S,"aoDrawCallback",Fe,"state_save")),f.aaSorting===s){var L=S.aaSorting;for(g=0,p=L.length;g<p;g++)L[g][1]=S.aoColumns[g].asSorting[0]}Ee(S),N.bSort&&$e(S,"aoDrawCallback",function(){if(S.bSorted){var i=Se(S),t={};e.each(i,function(e,i){t[i.src]=i.dir}),He(S,null,"order",[S,i,t]),Ve(S)}}),$e(S,"aoDrawCallback",function(){(S.bSorted||"ssp"===je(S)||N.bDeferRender)&&Ee(S)},"sc"),c(S);var O=e(this).children("caption").each(function(){this._captionSide=e(this).css("caption-side")}),$=e(this).children("thead");0===$.length&&($=e("<thead/>").appendTo(this)),S.nTHead=$[0];var U=e(this).children("tbody");0===U.length&&(U=e("<tbody/>").appendTo(this)),S.nTBody=U[0];var j=e(this).children("tfoot");if(0===j.length&&O.length>0&&(""!==S.oScroll.sX||""!==S.oScroll.sY)&&(j=e("<tfoot/>").appendTo(this)),0===j.length||0===j.children().length?e(this).addClass(I.sNoFooter):j.length>0&&(S.nTFoot=j[0],H(S.aoFooter,S.nTFoot)),f.aaData)for(g=0;g<f.aaData.length;g++)y(S,f.aaData[g]);else(S.bDeferLoading||"dom"==je(S))&&_(S,e(S.nTBody).children("tr"));S.aiDisplay=S.aiDisplayMaster.slice(),S.bInitialised=!0,!1===v&&re(S)}),t=null,this};var xi=[],ki=Array.prototype,Si=function(i){var t,s,n=Ke.settings,o=e.map(n,function(e,i){return e.nTable});return i?i.nTable&&i.oApi?[i]:i.nodeName&&"table"===i.nodeName.toLowerCase()?(t=e.inArray(i,o),-1!==t?[n[t]]:null):i&&"function"==typeof i.settings?i.settings().toArray():("string"==typeof i?s=e(i):i instanceof e&&(s=i),s?s.map(function(i){return t=e.inArray(this,o),-1!==t?n[t]:null}).toArray():void 0):[]};Xe=function(i,t){if(!this instanceof Xe)throw"DT API must be constructed as a new object";var s=[],n=function(e){var i=Si(e);i&&s.push.apply(s,i)};if(e.isArray(i))for(var o=0,l=i.length;o<l;o++)n(i[o]);else n(i);this.context=bi(s),t&&this.push.apply(this,t.toArray?t.toArray():t),this.selector={"rows":null,"cols":null,"opts":null},Xe.extend(this,this,xi)},Ke.Api=Xe,Xe.prototype={"concat":ki.concat,"context":[],"each":function(e){for(var i=0,t=this.length;i<t;i++)e.call(this,this[i],i,this);return this},"eq":function(e){var i=this.context;return i.length>e?new Xe(i[e],this[e]):null},"filter":function(e){var i=[];if(ki.filter)i=ki.filter.call(this,e,this);else for(var t=0,s=this.length;t<s;t++)e.call(this,this[t],t,this)&&i.push(this[t]);return new Xe(this.context,i)},"flatten":function(){var e=[];return new Xe(this.context,e.concat.apply(e,this.toArray()))},"join":ki.join,"indexOf":ki.indexOf||function(e,i){for(var t=i||0,s=this.length;t<s;t++)if(this[t]===e)return t;return-1},"iterator":function(e,i,t,n){var o,l,r,a,c,u,d,h,p=[],m=this.context,f=this.selector;for("string"==typeof e&&(n=t,t=i,i=e,e=!1),l=0,r=m.length;l<r;l++){var g=new Xe(m[l]);if("table"===i)(o=t.call(g,m[l],l))!==s&&p.push(o);else if("columns"===i||"rows"===i)(o=t.call(g,m[l],this[l],l))!==s&&p.push(o);else if("column"===i||"column-rows"===i||"row"===i||"cell"===i)for(d=this[l],"column-rows"===i&&(u=Di(m[l],f.opts)),a=0,c=d.length;a<c;a++)h=d[a],(o="cell"===i?t.call(g,m[l],h.row,h.column,l,a):t.call(g,m[l],h,l,a,u))!==s&&p.push(o)}if(p.length||n){var b=new Xe(m,e?p.concat.apply([],p):p),v=b.selector;return v.rows=f.rows,v.cols=f.cols,v.opts=f.opts,b}return this},"lastIndexOf":ki.lastIndexOf||function(e,i){return this.indexOf.apply(this.toArray.reverse(),arguments)},"length":0,"map":function(e){var i=[];if(ki.map)i=ki.map.call(this,e,this);else for(var t=0,s=this.length;t<s;t++)i.push(e.call(this,this[t],t));return new Xe(this.context,i)},"pluck":function(e){return this.map(function(i){return i[e]})},"pop":ki.pop,"push":ki.push,"reduce":ki.reduce||function(e,i){return u(this,e,i,0,this.length,1)},"reduceRight":ki.reduceRight||function(e,i){return u(this,e,i,this.length-1,-1,-1)},"reverse":ki.reverse,"selector":null,"shift":ki.shift,"sort":ki.sort,"splice":ki.splice,"toArray":function(){return ki.slice.call(this)},"to$":function(){return e(this)},"toJQuery":function(){return e(this)},"unique":function(){return new Xe(this.context,bi(this))},"unshift":ki.unshift},Xe.extend=function(i,t,s){if(t&&(t instanceof Xe||t.__dt_wrapper)){var n,o,l;for(n=0,o=s.length;n<o;n++)l=s[n],t[l.name]="function"==typeof l.val?function(e,i,t){return function(){var s=i.apply(e,arguments);return Xe.extend(s,s,t.methodExt),s}}(i,l.val,l):e.isPlainObject(l.val)?{}:l.val,t[l.name].__dt_wrapper=!0,Xe.extend(i,t[l.name],l.propExt)}},Xe.register=Ze=function(i,t){if(e.isArray(i))for(var s=0,n=i.length;s<n;s++)Xe.register(i[s],t);else{var o,l,r,a,c=i.split("."),u=xi;for(o=0,l=c.length;o<l;o++){a=-1!==c[o].indexOf("()"),r=a?c[o].replace("()",""):c[o];var d=function(e,i){for(var t=0,s=e.length;t<s;t++)if(e[t].name===i)return e[t];return null}(u,r);d||(d={"name":r,"val":{},"methodExt":[],"propExt":[]},u.push(d)),o===l-1?d.val=t:u=a?d.methodExt:d.propExt}}},Xe.registerPlural=Qe=function(i,t,n){Xe.register(i,n),Xe.register(t,function(){var i=n.apply(this,arguments);return i===this?this:i instanceof Xe?i.length?e.isArray(i[0])?new Xe(i.context,i[0]):i[0]:s:i})};var Ii=function(i,t){if("number"==typeof i)return[t[i]];var s=e.map(t,function(e,i){return e.nTable});return e(s).filter(i).map(function(i){var n=e.inArray(this,s);return t[n]}).toArray()};Ze("tables()",function(e){return e?new Xe(Ii(e,this.context)):this}),Ze("table()",function(e){var i=this.tables(e),t=i.context;return t.length?new Xe(t[0]):i}),Qe("tables().nodes()","table().node()",function(){return this.iterator("table",function(e){return e.nTable},1)}),Qe("tables().body()","table().body()",function(){return this.iterator("table",function(e){return e.nTBody},1)}),Qe("tables().header()","table().header()",function(){return this.iterator("table",function(e){return e.nTHead},1)}),Qe("tables().footer()","table().footer()",function(){return this.iterator("table",function(e){return e.nTFoot},1)}),Qe("tables().containers()","table().container()",function(){return this.iterator("table",function(e){return e.nTableWrapper},1)}),Ze("draw()",function(e){return this.iterator("table",function(i){O(i,!1===e)})}),Ze("page()",function(e){return e===s?this.page.info().page:this.iterator("table",function(i){he(i,e)})}),Ze("page.info()",function(e){if(0===this.context.length)return s;var i=this.context[0],t=i._iDisplayStart,n=i._iDisplayLength,o=i.fnRecordsDisplay(),l=-1===n;return{"page":l?0:Math.floor(t/n),"pages":l?1:Math.ceil(o/n),"start":t,"end":i.fnDisplayEnd(),"length":n,"recordsTotal":i.fnRecordsTotal(),"recordsDisplay":o}}),Ze("page.len()",function(e){return e===s?0!==this.context.length?this.context[0]._iDisplayLength:s:this.iterator("table",function(i){ce(i,e)})});var Vi=function(e,i,t){if("ssp"==je(e)?O(e,i):(me(e,!0),U(e,[],function(t){M(e);for(var s=W(e,t),n=0,o=s.length;n<o;n++)y(e,s[n]);O(e,i),me(e,!1)})),t){var s=new Xe(e);s.one("draw",function(){t(s.ajax.json())})}};Ze("ajax.json()",function(){var e=this.context;if(e.length>0)return e[0].json}),Ze("ajax.params()",function(){var e=this.context;if(e.length>0)return e[0].oAjaxData}),Ze("ajax.reload()",function(e,i){return this.iterator("table",function(t){Vi(t,!1===i,e)})}),Ze("ajax.url()",function(i){var t=this.context;return i===s?0===t.length?s:(t=t[0],t.ajax?e.isPlainObject(t.ajax)?t.ajax.url:t.ajax:t.sAjaxSource):this.iterator("table",function(t){e.isPlainObject(t.ajax)?t.ajax.url=i:t.ajax=i})}),Ze("ajax.url().load()",function(e,i){return this.iterator("table",function(t){Vi(t,!1===i,e)})});var Ai=function(i,t){var n,o,l,r,a,c,u=[],d=typeof i;for(i&&"string"!==d&&"function"!==d&&i.length!==s||(i=[i]),l=0,r=i.length;l<r;l++)for(o=i[l]&&i[l].split?i[l].split(","):[i[l]],a=0,c=o.length;a<c;a++)(n=t("string"==typeof o[a]?e.trim(o[a]):o[a]))&&n.length&&u.push.apply(u,n);return u},Mi=function(e){return e||(e={}),e.filter&&!e.search&&(e.search=e.filter),{"search":e.search||"none","order":e.order||"current","page":e.page||"all"}},Ei=function(e){for(var i=0,t=e.length;i<t;i++)if(e[i].length>0)return e[0]=e[i],e.length=1,e.context=[e.context[i]],e;return e.length=0,e},Di=function(i,t){var s,n,o,l=[],r=i.aiDisplay,a=i.aiDisplayMaster,c=t.search,u=t.order,d=t.page;if("ssp"==je(i))return"removed"===c?[]:mi(0,a.length);if("current"==d)for(s=i._iDisplayStart,n=i.fnDisplayEnd();s<n;s++)l.push(r[s]);else if("current"==u||"applied"==u)l="none"==c?a.slice():"applied"==c?r.slice():e.map(a,function(i,t){return-1===e.inArray(i,r)?i:null});else if("index"==u||"original"==u)for(s=0,n=i.aoData.length;s<n;s++)"none"==c?l.push(s):(-1===(o=e.inArray(s,r))&&"removed"==c||o>=0&&"applied"==c)&&l.push(s);return l},Fi=function(i,t,s){return Ai(t,function(t){var n=ri(t);if(null!==n&&!s)return[n];var o=Di(i,s);if(null!==n&&-1!==e.inArray(n,o))return[n];if(!t)return o;if("function"==typeof t)return e.map(o,function(e){var s=i.aoData[e];return t(e,s._aData,s.nTr)?e:null});var l=fi(pi(i.aoData,o,"nTr"));return t.nodeName&&-1!==e.inArray(t,l)?[t._DT_RowIndex]:e(l).filter(t).map(function(){return this._DT_RowIndex}).toArray()})};Ze("rows()",function(i,t){i===s?i="":e.isPlainObject(i)&&(t=i,i=""),t=Mi(t);var n=this.iterator("table",function(e){return Fi(e,i,t)},1);return n.selector.rows=i,n.selector.opts=t,n}),Ze("rows().nodes()",function(){return this.iterator("row",function(e,i){return e.aoData[i].nTr||s},1)}),Ze("rows().data()",function(){return this.iterator(!0,"rows",function(e,i){return pi(e.aoData,i,"_aData")},1)}),Qe("rows().cache()","row().cache()",function(e){return this.iterator("row",function(i,t){var s=i.aoData[t];return"search"===e?s._aFilterData:s._aSortData},1)}),Qe("rows().invalidate()","row().invalidate()",function(e){return this.iterator("row",function(i,t){D(i,t,e)})}),Qe("rows().indexes()","row().index()",function(){return this.iterator("row",function(e,i){return i},1)}),Qe("rows().remove()","row().remove()",function(){var i=this;return this.iterator("row",function(t,s,n){var o=t.aoData;o.splice(s,1);for(var l=0,r=o.length;l<r;l++)null!==o[l].nTr&&(o[l].nTr._DT_RowIndex=l);e.inArray(s,t.aiDisplay);E(t.aiDisplayMaster,s),E(t.aiDisplay,s),E(i[n],s,!1),ze(t)})}),Ze("rows.add()",function(e){var i=this.iterator("table",function(i){var t,s,n,o=[];for(s=0,n=e.length;s<n;s++)t=e[s],t.nodeName&&"TR"===t.nodeName.toUpperCase()?o.push(_(i,t)[0]):o.push(y(i,t));return o},1),t=this.rows(-1);return t.pop(),t.push.apply(t,i.toArray()),t}),Ze("row()",function(e,i){return Ei(this.rows(e,i))}),Ze("row().data()",function(e){var i=this.context;return e===s?i.length&&this.length?i[0].aoData[this[0]]._aData:s:(i[0].aoData[this[0]]._aData=e,D(i[0],this[0],"data"),this)}),Ze("row().node()",function(){var e=this.context;return e.length&&this.length?e[0].aoData[this[0]].nTr||null:null}),Ze("row.add()",function(i){i instanceof e&&i.length&&(i=i[0]);var t=this.iterator("table",function(e){return i.nodeName&&"TR"===i.nodeName.toUpperCase()?_(e,i)[0]:y(e,i)});return this.row(t[0])});var Pi=function(i,t,s,n){var o=[],l=function(t,s){if(t.nodeName&&"tr"===t.nodeName.toLowerCase())o.push(t);else{var n=e("<tr><td/></tr>").addClass(s);e("td",n).addClass(s).html(t)[0].colSpan=g(i),o.push(n[0])}};if(e.isArray(s)||s instanceof e)for(var r=0,a=s.length;r<a;r++)l(s[r],n);else l(s,n);t._details&&t._details.remove(),t._details=e(o),t._detailsShow&&t._details.insertAfter(t.nTr)},Ri=function(e,i){var t=e.context;if(t.length){var n=t[0].aoData[i!==s?i:e[0]];n._details&&(n._details.remove(),n._detailsShow=s,n._details=s)}},Bi=function(e,i){var t=e.context;if(t.length&&e.length){var s=t[0].aoData[e[0]];s._details&&(s._detailsShow=i,i?s._details.insertAfter(s.nTr):s._details.detach(),Ni(t[0]))}},Ni=function(e){var i=new Xe(e),t=e.aoData;i.off("draw.dt.DT_details column-visibility.dt.DT_details destroy.dt.DT_details"),hi(t,"_details").length>0&&(i.on("draw.dt.DT_details",function(s,n){e===n&&i.rows({"page":"current"}).eq(0).each(function(e){var i=t[e];i._detailsShow&&i._details.insertAfter(i.nTr)})}),i.on("column-visibility.dt.DT_details",function(i,s,n,o){if(e===s)for(var l,r=g(s),a=0,c=t.length;a<c;a++)l=t[a],l._details&&l._details.children("td[colspan]").attr("colspan",r)}),i.on("destroy.dt.DT_details",function(s,n){if(e===n)for(var o=0,l=t.length;o<l;o++)t[o]._details&&Ri(i,o)}))};Ze("row().child()",function(e,i){var t=this.context;return e===s?t.length&&this.length?t[0].aoData[this[0]]._details:s:(!0===e?this.child.show():!1===e?Ri(this):t.length&&this.length&&Pi(t[0],t[0].aoData[this[0]],e,i),this)}),Ze(["row().child.show()","row().child().show()"],function(e){return Bi(this,!0),this}),Ze(["row().child.hide()","row().child().hide()"],function(){return Bi(this,!1),this}),Ze(["row().child.remove()","row().child().remove()"],function(){return Ri(this),this}),Ze("row().child.isShown()",function(){var e=this.context;return!(!e.length||!this.length)&&(e[0].aoData[this[0]]._detailsShow||!1)});var Li=/^(.+):(name|visIdx|visible)$/,Oi=function(e,i,t,s,n){for(var o=[],l=0,r=n.length;l<r;l++)o.push(x(e,n[l],i));return o},$i=function(i,t,s){var n=i.aoColumns,o=hi(n,"sName"),l=hi(n,"nTh");return Ai(t,function(t){var r=ri(t);if(""===t)return mi(n.length);if(null!==r)return[r>=0?r:n.length+r];if("function"==typeof t){var a=Di(i,s);return e.map(n,function(e,s){return t(s,Oi(i,s,0,0,a),l[s])?s:null})}var c="string"==typeof t?t.match(Li):"";if(!c)return e(l).filter(t).map(function(){return e.inArray(this,l)}).toArray();switch(c[2]){case"visIdx":case"visible":var u=parseInt(c[1],10);if(u<0){var d=e.map(n,function(e,i){return e.bVisible?i:null});return[d[d.length+u]]}return[m(i,u)];case"name":return e.map(o,function(e,i){return e===c[1]?i:null})}})},Hi=function(i,t,n,o){var l,r,a,c,u=i.aoColumns,d=u[t],h=i.aoData;if(n===s)return d.bVisible;if(d.bVisible!==n){if(n){var m=e.inArray(!0,hi(u,"bVisible"),t+1);for(r=0,a=h.length;r<a;r++)c=h[r].nTr,l=h[r].anCells,c&&c.insertBefore(l[t],l[m]||null)}else e(hi(i.aoData,"anCells",t)).detach();d.bVisible=n,N(i,i.aoHeader),N(i,i.aoFooter),(o===s||o)&&(p(i),(i.oScroll.sX||i.oScroll.sY)&&ge(i)),He(i,null,"column-visibility",[i,t,n]),Fe(i)}};Ze("columns()",function(i,t){i===s?i="":e.isPlainObject(i)&&(t=i,i=""),t=Mi(t);var n=this.iterator("table",function(e){return $i(e,i,t)},1);return n.selector.cols=i,n.selector.opts=t,n}),Qe("columns().header()","column().header()",function(e,i){return this.iterator("column",function(e,i){return e.aoColumns[i].nTh},1)}),Qe("columns().footer()","column().footer()",function(e,i){return this.iterator("column",function(e,i){return e.aoColumns[i].nTf},1)}),Qe("columns().data()","column().data()",function(){return this.iterator("column-rows",Oi,1)}),Qe("columns().dataSrc()","column().dataSrc()",function(){return this.iterator("column",function(e,i){return e.aoColumns[i].mData},1)}),Qe("columns().cache()","column().cache()",function(e){return this.iterator("column-rows",function(i,t,s,n,o){return pi(i.aoData,o,"search"===e?"_aFilterData":"_aSortData",t)},1)}),Qe("columns().nodes()","column().nodes()",function(){return this.iterator("column-rows",function(e,i,t,s,n){return pi(e.aoData,n,"anCells",i)},1)}),Qe("columns().visible()","column().visible()",function(e,i){return this.iterator("column",function(t,n){if(e===s)return t.aoColumns[n].bVisible;Hi(t,n,e,i)})}),Qe("columns().indexes()","column().index()",function(e){return this.iterator("column",function(i,t){return"visible"===e?f(i,t):t},1)}),Ze("columns.adjust()",function(){return this.iterator("table",function(e){p(e)},1)}),Ze("column.index()",function(e,i){if(0!==this.context.length){var t=this.context[0];if("fromVisible"===e||"toData"===e)return m(t,i);if("fromData"===e||"toVisible"===e)return f(t,i)}}),Ze("column()",function(e,i){return Ei(this.columns(e,i))});var zi=function(i,t,n){var o,l,r,a,c,u,d,h=i.aoData,p=Di(i,n),m=fi(pi(h,p,"anCells")),f=e([].concat.apply([],m)),g=i.aoColumns.length;return Ai(t,function(t){var n="function"==typeof t;if(null===t||t===s||n){for(l=[],r=0,a=p.length;r<a;r++)for(o=p[r],c=0;c<g;c++)u={"row":o,"column":c},n?(d=i.aoData[o],t(u,x(i,o,c),d.anCells[c])&&l.push(u)):l.push(u);return l}return e.isPlainObject(t)?[t]:f.filter(t).map(function(i,t){return o=t.parentNode._DT_RowIndex,{"row":o,"column":e.inArray(t,h[o].anCells)}}).toArray()})};Ze("cells()",function(i,t,n){if(e.isPlainObject(i)&&(typeof i.row!==s?(n=t,t=null):(n=i,i=null)),e.isPlainObject(t)&&(n=t,t=null),null===t||t===s)return this.iterator("table",function(e){return zi(e,i,Mi(n))});var o,l,r,a,c,u=this.columns(t,n),d=this.rows(i,n),h=this.iterator("table",function(e,i){for(o=[],l=0,r=d[i].length;l<r;l++)for(a=0,c=u[i].length;a<c;a++)o.push({"row":d[i][l],"column":u[i][a]});return o},1);return e.extend(h.selector,{"cols":t,"rows":i,"opts":n}),h}),Qe("cells().nodes()","cell().node()",function(){return this.iterator("cell",function(e,i,t){var n=e.aoData[i].anCells;return n?n[t]:s},1)}),Ze("cells().data()",function(){return this.iterator("cell",function(e,i,t){return x(e,i,t)},1)}),Qe("cells().cache()","cell().cache()",function(e){return e="search"===e?"_aFilterData":"_aSortData",this.iterator("cell",function(i,t,s){return i.aoData[t][e][s]},1)}),Qe("cells().render()","cell().render()",function(e){return this.iterator("cell",function(i,t,s){return x(i,t,s,e)},1)}),Qe("cells().indexes()","cell().index()",function(){return this.iterator("cell",function(e,i,t){return{"row":i,"column":t,"columnVisible":f(e,t)}},1)}),Qe("cells().invalidate()","cell().invalidate()",function(e){return this.iterator("cell",function(i,t,s){D(i,t,e,s)})}),Ze("cell()",function(e,i,t){return Ei(this.cells(e,i,t))}),Ze("cell().data()",function(e){var i=this.context,t=this[0];return e===s?i.length&&t.length?x(i[0],t[0].row,t[0].column):s:(k(i[0],t[0].row,t[0].column,e),D(i[0],t[0].row,"data",t[0].column),this)}),Ze("order()",function(i,t){var n=this.context;return i===s?0!==n.length?n[0].aaSorting:s:("number"==typeof i?i=[[i,t]]:e.isArray(i[0])||(i=Array.prototype.slice.call(arguments)),this.iterator("table",function(e){e.aaSorting=i.slice()}))}),Ze("order.listener()",function(e,i,t){return this.iterator("table",function(s){Me(s,e,i,t)})}),Ze(["columns().order()","column().order()"],function(i){var t=this;return this.iterator("table",function(s,n){var o=[];e.each(t[n],function(e,t){o.push([t,i])}),s.aaSorting=o})}),Ze("search()",function(i,t,n,o){var l=this.context;return i===s?0!==l.length?l[0].oPreviousSearch.sSearch:s:this.iterator("table",function(s){s.oFeatures.bFilter&&J(s,e.extend({},s.oPreviousSearch,{"sSearch":i+"","bRegex":null!==t&&t,"bSmart":null===n||n,"bCaseInsensitive":null===o||o}),1)})}),Qe("columns().search()","column().search()",function(i,t,n,o){return this.iterator("column",function(l,r){var a=l.aoPreSearchCols;if(i===s)return a[r].sSearch;l.oFeatures.bFilter&&(e.extend(a[r],{"sSearch":i+"","bRegex":null!==t&&t,"bSmart":null===n||n,"bCaseInsensitive":null===o||o}),J(l,l.oPreviousSearch,1))})}),Ze("state()",function(){return this.context.length?this.context[0].oSavedState:null}),Ze("state.clear()",function(){return this.iterator("table",function(e){e.fnStateSaveCallback.call(e.oInstance,e,{})})}),Ze("state.loaded()",function(){return this.context.length?this.context[0].oLoadedState:null}),Ze("state.save()",function(){return this.iterator("table",function(e){Fe(e)})}),Ke.versionCheck=Ke.fnVersionCheck=function(e){for(var i,t,s=Ke.version.split("."),n=e.split("."),o=0,l=n.length;o<l;o++)if(i=parseInt(s[o],10)||0,t=parseInt(n[o],10)||0,i!==t)return i>t;return!0},Ke.isDataTable=Ke.fnIsDataTable=function(i){var t=e(i).get(0),s=!1;return e.each(Ke.settings,function(e,i){i.nTable!==t&&i.nScrollHead!==t&&i.nScrollFoot!==t||(s=!0)}),s},Ke.tables=Ke.fnTables=function(i){return e.map(Ke.settings,function(t){if(!i||i&&e(t.nTable).is(":visible"))return t.nTable})},Ke.util={"throttle":we,"escapeRegex":ee},Ke.camelToHungarian=o,Ze("$()",function(i,t){var s=this.rows(t).nodes(),n=e(s);return e([].concat(n.filter(i).toArray(),n.find(i).toArray()))}),e.each(["on","one","off"],function(i,t){Ze(t+"()",function(){var i=Array.prototype.slice.call(arguments);i[0].match(/\.dt\b/)||(i[0]+=".dt");var s=e(this.tables().nodes());return s[t].apply(s,i),this})}),Ze("clear()",function(){return this.iterator("table",function(e){M(e)})}),Ze("settings()",function(){return new Xe(this.context,this.context)}),Ze("data()",function(){return this.iterator("table",function(e){return hi(e.aoData,"_aData")}).flatten()}),Ze("destroy()",function(t){return t=t||!1,this.iterator("table",function(s){var n,o=s.nTableWrapper.parentNode,l=s.oClasses,r=s.nTable,a=s.nTBody,c=s.nTHead,u=s.nTFoot,d=e(r),h=e(a),p=e(s.nTableWrapper),m=e.map(s.aoData,function(e){return e.nTr});s.bDestroying=!0,He(s,"aoDestroyCallback","destroy",[s]),t||new Xe(s).columns().visible(!0),p.unbind(".DT").find(":not(tbody *)").unbind(".DT"),e(i).unbind(".DT-"+s.sInstance),r!=c.parentNode&&(d.children("thead").detach(),d.append(c)),u&&r!=u.parentNode&&(d.children("tfoot").detach(),d.append(u)),d.detach(),p.detach(),s.aaSorting=[],s.aaSortingFixed=[],Ee(s),e(m).removeClass(s.asStripeClasses.join(" ")),e("th, td",c).removeClass(l.sSortable+" "+l.sSortableAsc+" "+l.sSortableDesc+" "+l.sSortableNone),
s.bJUI&&(e("th span."+l.sSortIcon+", td span."+l.sSortIcon,c).detach(),e("th, td",c).each(function(){var i=e("div."+l.sSortJUIWrapper,this);e(this).append(i.contents()),i.detach()})),!t&&o&&o.insertBefore(r,s.nTableReinsertBefore),h.children().detach(),h.append(m),d.css("width",s.sDestroyWidth).removeClass(l.sTable),(n=s.asDestroyStripes.length)&&h.children().each(function(i){e(this).addClass(s.asDestroyStripes[i%n])});var f=e.inArray(s,Ke.settings);-1!==f&&Ke.settings.splice(f,1)})}),Ke.version="1.10.4",Ke.settings=[],Ke.models={},Ke.models.oSearch={"bCaseInsensitive":!0,"sSearch":"","bRegex":!1,"bSmart":!0},Ke.models.oRow={"nTr":null,"anCells":null,"_aData":[],"_aSortData":null,"_aFilterData":null,"_sFilterRow":null,"_sRowStripe":"","src":null},Ke.models.oColumn={"idx":null,"aDataSort":null,"asSorting":null,"bSearchable":null,"bSortable":null,"bVisible":null,"_sManualType":null,"_bAttrSrc":!1,"fnCreatedCell":null,"fnGetData":null,"fnSetData":null,"mData":null,"mRender":null,"nTh":null,"nTf":null,"sClass":null,"sContentPadding":null,"sDefaultContent":null,"sName":null,"sSortDataType":"std","sSortingClass":null,"sSortingClassJUI":null,"sTitle":null,"sType":null,"sWidth":null,"sWidthOrig":null},Ke.defaults={"aaData":null,"aaSorting":[[0,"asc"]],"aaSortingFixed":[],"ajax":null,"aLengthMenu":[10,25,50,100],"aoColumns":null,"aoColumnDefs":null,"aoSearchCols":[],"asStripeClasses":null,"bAutoWidth":!0,"bDeferRender":!1,"bDestroy":!1,"bFilter":!0,"bInfo":!0,"bJQueryUI":!1,"bLengthChange":!0,"bPaginate":!0,"bProcessing":!1,"bRetrieve":!1,"bScrollCollapse":!1,"bServerSide":!1,"bSort":!0,"bSortMulti":!0,"bSortCellsTop":!1,"bSortClasses":!0,"bStateSave":!1,"fnCreatedRow":null,"fnDrawCallback":null,"fnFooterCallback":null,"fnFormatNumber":function(e){return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,this.oLanguage.sThousands)},"fnHeaderCallback":null,"fnInfoCallback":null,"fnInitComplete":null,"fnPreDrawCallback":null,"fnRowCallback":null,"fnServerData":null,"fnServerParams":null,"fnStateLoadCallback":function(e){try{return JSON.parse((-1===e.iStateDuration?sessionStorage:localStorage).getItem("DataTables_"+e.sInstance+"_"+location.pathname))}catch(e){}},"fnStateLoadParams":null,"fnStateLoaded":null,"fnStateSaveCallback":function(e,i){try{(-1===e.iStateDuration?sessionStorage:localStorage).setItem("DataTables_"+e.sInstance+"_"+location.pathname,JSON.stringify(i))}catch(e){}},"fnStateSaveParams":null,"iStateDuration":7200,"iDeferLoading":null,"iDisplayLength":10,"iDisplayStart":0,"iTabIndex":0,"oClasses":{},"oLanguage":{"oAria":{"sSortAscending":": activate to sort column ascending","sSortDescending":": activate to sort column descending"},"oPaginate":{"sFirst":"First","sLast":"Last","sNext":"Next","sPrevious":"Previous"},"sEmptyTable":"No data available in table","sInfo":"Showing _START_ to _END_ of _TOTAL_ entries","sInfoEmpty":"Showing 0 to 0 of 0 entries","sInfoFiltered":"(filtered from _MAX_ total entries)","sInfoPostFix":"","sDecimal":"","sThousands":",","sLengthMenu":"Show _MENU_ entries","sLoadingRecords":"Loading...","sProcessing":"Processing...","sSearch":"Search:","sSearchPlaceholder":"","sUrl":"","sZeroRecords":"No matching records found"},"oSearch":e.extend({},Ke.models.oSearch),"sAjaxDataProp":"data","sAjaxSource":null,"sDom":"lfrtip","searchDelay":null,"sPaginationType":"simple_numbers","sScrollX":"","sScrollXInner":"","sScrollY":"","sServerMethod":"GET","renderer":null},n(Ke.defaults),Ke.defaults.column={"aDataSort":null,"iDataSort":-1,"asSorting":["asc","desc"],"bSearchable":!0,"bSortable":!0,"bVisible":!0,"fnCreatedCell":null,"mData":null,"mRender":null,"sCellType":"td","sClass":"","sContentPadding":"","sDefaultContent":null,"sName":"","sSortDataType":"std","sTitle":null,"sType":null,"sWidth":null},n(Ke.defaults.column),Ke.models.oSettings={"oFeatures":{"bAutoWidth":null,"bDeferRender":null,"bFilter":null,"bInfo":null,"bLengthChange":null,"bPaginate":null,"bProcessing":null,"bServerSide":null,"bSort":null,"bSortMulti":null,"bSortClasses":null,"bStateSave":null},"oScroll":{"bCollapse":null,"iBarWidth":0,"sX":null,"sXInner":null,"sY":null},"oLanguage":{"fnInfoCallback":null},"oBrowser":{"bScrollOversize":!1,"bScrollbarLeft":!1},"ajax":null,"aanFeatures":[],"aoData":[],"aiDisplay":[],"aiDisplayMaster":[],"aoColumns":[],"aoHeader":[],"aoFooter":[],"oPreviousSearch":{},"aoPreSearchCols":[],"aaSorting":null,"aaSortingFixed":[],"asStripeClasses":null,"asDestroyStripes":[],"sDestroyWidth":0,"aoRowCallback":[],"aoHeaderCallback":[],"aoFooterCallback":[],"aoDrawCallback":[],"aoRowCreatedCallback":[],"aoPreDrawCallback":[],"aoInitComplete":[],"aoStateSaveParams":[],"aoStateLoadParams":[],"aoStateLoaded":[],"sTableId":"","nTable":null,"nTHead":null,"nTFoot":null,"nTBody":null,"nTableWrapper":null,"bDeferLoading":!1,"bInitialised":!1,"aoOpenRows":[],"sDom":null,"searchDelay":null,"sPaginationType":"two_button","iStateDuration":0,"aoStateSave":[],"aoStateLoad":[],"oSavedState":null,"oLoadedState":null,"sAjaxSource":null,"sAjaxDataProp":null,"bAjaxDataGet":!0,"jqXHR":null,"json":s,"oAjaxData":s,"fnServerData":null,"aoServerParams":[],"sServerMethod":null,"fnFormatNumber":null,"aLengthMenu":null,"iDraw":0,"bDrawing":!1,"iDrawError":-1,"_iDisplayLength":10,"_iDisplayStart":0,"_iRecordsTotal":0,"_iRecordsDisplay":0,"bJUI":null,"oClasses":{},"bFiltered":!1,"bSorted":!1,"bSortCellsTop":null,"oInit":null,"aoDestroyCallback":[],"fnRecordsTotal":function(){return"ssp"==je(this)?1*this._iRecordsTotal:this.aiDisplayMaster.length},"fnRecordsDisplay":function(){return"ssp"==je(this)?1*this._iRecordsDisplay:this.aiDisplay.length},"fnDisplayEnd":function(){var e=this._iDisplayLength,i=this._iDisplayStart,t=i+e,s=this.aiDisplay.length,n=this.oFeatures,o=n.bPaginate;return n.bServerSide?!1===o||-1===e?i+s:Math.min(i+e,this._iRecordsDisplay):!o||t>s||-1===e?s:t},"oInstance":null,"sInstance":null,"iTabIndex":0,"nScrollHead":null,"nScrollFoot":null,"aLastSort":[],"oPlugins":{}},Ke.ext=Je={"classes":{},"errMode":"alert","feature":[],"search":[],"internal":{},"legacy":{"ajax":null},"pager":{},"renderer":{"pageButton":{},"header":{}},"order":{},"type":{"detect":[],"search":{},"order":{}},"_unique":0,"fnVersionCheck":Ke.fnVersionCheck,"iApiIndex":0,"oJUIClasses":{},"sVersion":Ke.version},e.extend(Je,{"afnFiltering":Je.search,"aTypes":Je.type.detect,"ofnSearch":Je.type.search,"oSort":Je.type.order,"afnSortData":Je.order,"aoFeatures":Je.feature,"oApi":Je.internal,"oStdClasses":Je.classes,"oPagination":Je.pager}),e.extend(Ke.ext.classes,{"sTable":"dataTable","sNoFooter":"no-footer","sPageButton":"paginate_button","sPageButtonActive":"current","sPageButtonDisabled":"disabled","sStripeOdd":"odd","sStripeEven":"even","sRowEmpty":"dataTables_empty","sWrapper":"dataTables_wrapper","sFilter":"dataTables_filter","sInfo":"dataTables_info","sPaging":"dataTables_paginate paging_","sLength":"dataTables_length","sProcessing":"dataTables_processing","sSortAsc":"sorting_asc","sSortDesc":"sorting_desc","sSortable":"sorting","sSortableAsc":"sorting_asc_disabled","sSortableDesc":"sorting_desc_disabled","sSortableNone":"sorting_disabled","sSortColumn":"sorting_","sFilterInput":"","sLengthSelect":"","sScrollWrapper":"dataTables_scroll","sScrollHead":"dataTables_scrollHead","sScrollHeadInner":"dataTables_scrollHeadInner","sScrollBody":"dataTables_scrollBody","sScrollFoot":"dataTables_scrollFoot","sScrollFootInner":"dataTables_scrollFootInner","sHeaderTH":"","sFooterTH":"","sSortJUIAsc":"","sSortJUIDesc":"","sSortJUI":"","sSortJUIAscAllowed":"","sSortJUIDescAllowed":"","sSortJUIWrapper":"","sSortIcon":"","sJUIHeader":"","sJUIFooter":""}),function(){var i="";i="";var t=i+"ui-state-default",s=i+"css_right ui-icon ui-icon-",n=i+"fg-toolbar ui-toolbar ui-widget-header ui-helper-clearfix";e.extend(Ke.ext.oJUIClasses,Ke.ext.classes,{"sPageButton":"fg-button ui-button "+t,"sPageButtonActive":"ui-state-disabled","sPageButtonDisabled":"ui-state-disabled","sPaging":"dataTables_paginate fg-buttonset ui-buttonset fg-buttonset-multi ui-buttonset-multi paging_","sSortAsc":t+" sorting_asc","sSortDesc":t+" sorting_desc","sSortable":t+" sorting","sSortableAsc":t+" sorting_asc_disabled","sSortableDesc":t+" sorting_desc_disabled","sSortableNone":t+" sorting_disabled","sSortJUIAsc":s+"triangle-1-n","sSortJUIDesc":s+"triangle-1-s","sSortJUI":s+"carat-2-n-s","sSortJUIAscAllowed":s+"carat-1-n","sSortJUIDescAllowed":s+"carat-1-s","sSortJUIWrapper":"DataTables_sort_wrapper","sSortIcon":"DataTables_sort_icon","sScrollHead":"dataTables_scrollHead "+t,"sScrollFoot":"dataTables_scrollFoot "+t,"sHeaderTH":t,"sFooterTH":t,"sJUIHeader":n+" ui-corner-tl ui-corner-tr","sJUIFooter":n+" ui-corner-bl ui-corner-br"})}();var Ui=Ke.ext.pager;e.extend(Ui,{"simple":function(e,i){return["previous","next"]},"full":function(e,i){return["first","previous","next","last"]},"simple_numbers":function(e,i){return["previous",qe(e,i),"next"]},"full_numbers":function(e,i){return["first","previous",qe(e,i),"next","last"]},"_numbers":qe,"numbers_length":7}),e.extend(!0,Ke.ext.renderer,{"pageButton":{"_":function(i,s,n,o,l,r){var a,c,u=i.oClasses,d=i.oLanguage.oPaginate,h=0,p=function(t,s){var o,m,f,g,b=function(e){he(i,e.data.action,!0)};for(o=0,m=s.length;o<m;o++)if(g=s[o],e.isArray(g)){var v=e("<"+(g.DT_el||"div")+"/>").appendTo(t);p(v,g)}else{switch(a="",c="",g){case"ellipsis":t.append("<span>&hellip;</span>");break;case"first":a=d.sFirst,c=g+(l>0?"":" "+u.sPageButtonDisabled);break;case"previous":a=d.sPrevious,c=g+(l>0?"":" "+u.sPageButtonDisabled);break;case"next":a=d.sNext,c=g+(l<r-1?"":" "+u.sPageButtonDisabled);break;case"last":a=d.sLast,c=g+(l<r-1?"":" "+u.sPageButtonDisabled);break;default:a=g+1,c=l===g?u.sPageButtonActive:""}a&&(f=e("<a>",{"class":u.sPageButton+" "+c,"aria-controls":i.sTableId,"data-dt-idx":h,"tabindex":i.iTabIndex,"id":0===n&&"string"==typeof g?i.sTableId+"_"+g:null}).html(a).appendTo(t),Oe(f,{"action":g},b),h++)}};try{var m=e(t.activeElement).data("dt-idx");p(e(s).empty(),o),null!==m&&e(s).find("[data-dt-idx="+m+"]").focus()}catch(e){}}}}),e.extend(Ke.ext.type.detect,[function(e,i){var t=i.oLanguage.sDecimal;return ci(e,t)?"num"+t:null},function(e,i){if(e&&!(e instanceof Date)&&(!ti.test(e)||!si.test(e)))return null;var t=Date.parse(e);return null!==t&&!isNaN(t)||li(e)?"date":null},function(e,i){var t=i.oLanguage.sDecimal;return ci(e,t,!0)?"num-fmt"+t:null},function(e,i){var t=i.oLanguage.sDecimal;return di(e,t)?"html-num"+t:null},function(e,i){var t=i.oLanguage.sDecimal;return di(e,t,!0)?"html-num-fmt"+t:null},function(e,i){return li(e)||"string"==typeof e&&-1!==e.indexOf("<")?"html":null}]),e.extend(Ke.ext.type.search,{"html":function(e){return li(e)?e:"string"==typeof e?e.replace(ei," ").replace(ii,""):""},"string":function(e){return li(e)?e:"string"==typeof e?e.replace(ei," "):e}});var ji=function(e,i,t,s){return 0===e||e&&"-"!==e?(i&&(e=ai(e,i)),e.replace&&(t&&(e=e.replace(t,"")),s&&(e=e.replace(s,""))),1*e):-1/0};e.extend(Je.type.order,{"date-pre":function(e){return Date.parse(e)||0},"html-pre":function(e){return li(e)?"":e.replace?e.replace(/<.*?>/g,"").toLowerCase():e+""},"string-pre":function(e){return li(e)?"":"string"==typeof e?e.toLowerCase():e.toString?e.toString():""},"string-asc":function(e,i){return e<i?-1:e>i?1:0},"string-desc":function(e,i){return e<i?1:e>i?-1:0}}),Ge(""),e.extend(!0,Ke.ext.renderer,{"header":{"_":function(i,t,s,n){e(i.nTable).on("order.dt.DT",function(e,o,l,r){if(i===o){var a=s.idx;t.removeClass(s.sSortingClass+" "+n.sSortAsc+" "+n.sSortDesc).addClass("asc"==r[a]?n.sSortAsc:"desc"==r[a]?n.sSortDesc:s.sSortingClass)}})},"jqueryui":function(i,t,s,n){e("<div/>").addClass(n.sSortJUIWrapper).append(t.contents()).append(e("<span/>").addClass(n.sSortIcon+" "+s.sSortingClassJUI)).appendTo(t),e(i.nTable).on("order.dt.DT",function(e,o,l,r){if(i===o){var a=s.idx;t.removeClass(n.sSortAsc+" "+n.sSortDesc).addClass("asc"==r[a]?n.sSortAsc:"desc"==r[a]?n.sSortDesc:s.sSortingClass),t.find("span."+n.sSortIcon).removeClass(n.sSortJUIAsc+" "+n.sSortJUIDesc+" "+n.sSortJUI+" "+n.sSortJUIAscAllowed+" "+n.sSortJUIDescAllowed).addClass("asc"==r[a]?n.sSortJUIAsc:"desc"==r[a]?n.sSortJUIDesc:s.sSortingClassJUI)}})}}}),Ke.render={"number":function(e,i,t,s){return{"display":function(n){var o=n<0?"-":"";n=Math.abs(parseFloat(n));var l=parseInt(n,10),r=t?i+(n-l).toFixed(t).substring(2):"";return o+(s||"")+l.toString().replace(/\B(?=(\d{3})+(?!\d))/g,e)+r}}}},e.extend(Ke.ext.internal,{"_fnExternApiFunc":We,"_fnBuildAjax":U,"_fnAjaxUpdate":j,"_fnAjaxParameters":q,"_fnAjaxUpdateDraw":G,"_fnAjaxDataSrc":W,"_fnAddColumn":d,"_fnColumnOptions":h,"_fnAdjustColumnSizing":p,"_fnVisibleToColumnIndex":m,"_fnColumnIndexToVisible":f,"_fnVisbleColumns":g,"_fnGetColumns":b,"_fnColumnTypes":v,"_fnApplyColumnDefs":w,"_fnHungarianMap":n,"_fnCamelToHungarian":o,"_fnLanguageCompat":l,"_fnBrowserDetect":c,"_fnAddData":y,"_fnAddTr":_,"_fnNodeToDataIndex":C,"_fnNodeToColumnIndex":T,"_fnGetCellData":x,"_fnSetCellData":k,"_fnSplitObjNotation":S,"_fnGetObjectDataFn":I,"_fnSetObjectDataFn":V,"_fnGetDataMaster":A,"_fnClearTable":M,"_fnDeleteIndex":E,"_fnInvalidate":D,"_fnGetRowElements":F,"_fnCreateTr":P,"_fnBuildHead":B,"_fnDrawHead":N,"_fnDraw":L,"_fnReDraw":O,"_fnAddOptionsHtml":$,"_fnDetectHeader":H,"_fnGetUniqueThs":z,"_fnFeatureHtmlFilter":K,"_fnFilterComplete":J,"_fnFilterCustom":X,"_fnFilterColumn":Z,"_fnFilter":Q,"_fnFilterCreateSearch":Y,"_fnEscapeRegex":ee,"_fnFilterData":ie,"_fnFeatureHtmlInfo":ne,"_fnUpdateInfo":oe,"_fnInfoMacros":le,"_fnInitialise":re,"_fnInitComplete":ae,"_fnLengthChange":ce,"_fnFeatureHtmlLength":ue,"_fnFeatureHtmlPaginate":de,"_fnPageChange":he,"_fnFeatureHtmlProcessing":pe,"_fnProcessingDisplay":me,"_fnFeatureHtmlTable":fe,"_fnScrollDraw":ge,"_fnApplyToChildren":be,"_fnCalculateColumnWidths":ve,"_fnThrottle":we,"_fnConvertToWidth":ye,"_fnScrollingWidthAdjust":_e,"_fnGetWidestNode":Ce,"_fnGetMaxLenString":Te,"_fnStringToCss":xe,"_fnScrollBarWidth":ke,"_fnSortFlatten":Se,"_fnSort":Ie,"_fnSortAria":Ve,"_fnSortListener":Ae,"_fnSortAttachListener":Me,"_fnSortingClasses":Ee,"_fnSortData":De,"_fnSaveState":Fe,"_fnLoadState":Pe,"_fnSettingsFromNode":Re,"_fnLog":Be,"_fnMap":Ne,"_fnBindAction":Oe,"_fnCallbackReg":$e,"_fnCallbackFire":He,"_fnLengthOverflow":ze,"_fnRenderer":Ue,"_fnDataSource":je,"_fnRowAttributes":R,"_fnCalculateEnd":function(){}}),e.fn.dataTable=Ke,e.fn.dataTableSettings=Ke.settings,e.fn.dataTableExt=Ke.ext,e.fn.DataTable=function(i){return e(this).dataTable(i).api()},e.each(Ke,function(i,t){e.fn.DataTable[i]=t}),e.fn.dataTable}(e)}()}(window,document),e.fn.dataTable}),csui.define("csui/lib/jquery.dataTables.bootstrap/js/dataTables.bootstrap",["csui/lib/jquery","csui/lib/jquery.dataTables/js/jquery.dataTables","csui/lib/binf/js/binf"],function(e,i){return function(t,s,n){!function(t){"use strict";e&&"bootstrap"!=i.defaults.renderer&&function(e,i){e.extend(!0,i.defaults,{"dom":"<'binf-row'<'binf-col-sm-6'l><'binf-col-sm-6'f>><'binf-row'<'binf-col-sm-12'tr>><'binf-row'<'binf-col-sm-6'i><'binf-col-sm-6'p>>","renderer":"bootstrap"}),e.extend(i.ext.classes,{"sWrapper":"dataTables_wrapper binf-form-inline dt-bootstrap","sFilterInput":"binf-form-control binf-input-sm","sLengthSelect":"binf-form-control binf-input-sm"}),i.ext.renderer.pageButton.bootstrap=function(t,s,n,o,l,r){var a,c,u=new i.Api(t),d=t.oClasses,h=t.oLanguage.oPaginate,p=function(i,s){var o,m,f,g,b=function(i){i.preventDefault(),e(i.currentTarget).hasClass("binf-disabled")||u.page(i.data.action).draw(!1)};for(o=0,m=s.length;o<m;o++)if(g=s[o],e.isArray(g))p(i,g);else{switch(a="",c="",g){case"ellipsis":a="&hellip;",c=" binf-disabled";break;case"first":a=h.sFirst,c=g+(l>0?"":" binf-disabled");break;case"previous":a=h.sPrevious,c=g+(l>0?"":" binf-disabled");break;case"next":a=h.sNext,c=g+(l<r-1?"":" binf-disabled");break;case"last":a=h.sLast,c=g+(l<r-1?"":" binf-disabled");break;default:a=g+1,c=l===g?" binf-active":""}a&&(f=e("<li>",{"class":d.sPageButton+" "+c,"aria-controls":t.sTableId,"tabindex":t.iTabIndex,"id":0===n&&"string"==typeof g?t.sTableId+"_"+g:null}).append(e("<a>",{"href":"#"}).html(a)).appendTo(i),t.oApi._fnBindAction(f,{"action":g},b))}};p(e(s).empty().html('<ul class="binf-pagination"/>').children("ul"),o)},i.TableTools&&(e.extend(!0,i.TableTools.classes,{"container":"DTTT binf-btn-group","buttons":{"normal":"binf-btn binf-btn-default","disabled":"binf-disabled"},"collection":{"container":"DTTT_dropdown binf-dropdown-menu","buttons":{"normal":"","disabled":"disabled"}},"print":{"info":"DTTT_print_info"},"select":{"row":"binf-active"}}),e.extend(!0,i.TableTools.DEFAULTS.oTags,{"collection":{"container":"ul","button":"li","liner":"a"}})),e.fn.dataTable}(e,i)}()}(window,document),e.fn.dataTable}),csui.define("csui/lib/jquery.dataTables.tableTools/js/dataTables.tableTools",["csui/lib/jquery","csui/lib/jquery.dataTables/js/jquery.dataTables"],function(e){var i;return function(t,s,n){e&&!e.fn.dataTable.TableTools&&function(n,o){var l={"version":"1.0.4-TableTools2","clients":{},"moviePath":"","nextId":1,"$":function(e){return"string"==typeof e&&(e=s.getElementById(e)),e.addClass||(e.hide=function(){this.style.display="none"},e.show=function(){this.style.display=""},e.addClass=function(e){this.removeClass(e),this.className+=" "+e},e.removeClass=function(e){this.className=this.className.replace(new RegExp("\\s*"+e+"\\s*")," ").replace(/^\s+/,"").replace(/\s+$/,"")},e.hasClass=function(e){return!!this.className.match(new RegExp("\\s*"+e+"\\s*"))}),e},"setMoviePath":function(e){this.moviePath=e},"dispatch":function(e,i,t){var s=this.clients[e];s&&s.receiveEvent(i,t)},"register":function(e,i){this.clients[e]=i},"getDOMObjectPosition":function(e){var i={"left":0,"top":0,"width":e.width?e.width:e.offsetWidth,"height":e.height?e.height:e.offsetHeight};for(""!==e.style.width&&(i.width=e.style.width.replace("px","")),""!==e.style.height&&(i.height=e.style.height.replace("px",""));e;)i.left+=e.offsetLeft,i.top+=e.offsetTop,e=e.offsetParent;return i},"Client":function(e){this.handlers={},this.id=l.nextId++,this.movieId="ZeroClipboard_TableToolsMovie_"+this.id,l.register(this.id,this),e&&this.glue(e)}};l.Client.prototype={"id":0,"ready":!1,"movie":null,"clipText":"","fileName":"","action":"copy","handCursorEnabled":!0,"cssEffects":!0,"handlers":null,"sized":!1,"glue":function(e,i){this.domElement=l.$(e);var t=99;this.domElement.style.zIndex&&(t=parseInt(this.domElement.style.zIndex,10)+1);var n=l.getDOMObjectPosition(this.domElement);this.div=s.createElement("div");var o=this.div.style;o.position="absolute",o.left="0px",o.top="0px",o.width=n.width+"px",o.height=n.height+"px",o.zIndex=t,void 0!==i&&""!==i&&(this.div.title=i),0!==n.width&&0!==n.height&&(this.sized=!0),this.domElement&&(this.domElement.appendChild(this.div),this.div.innerHTML=this.getHTML(n.width,n.height).replace(/&/g,"&amp;"))},"positionElement":function(){var e=l.getDOMObjectPosition(this.domElement),i=this.div.style;if(i.position="absolute",i.width=e.width+"px",i.height=e.height+"px",0!==e.width&&0!==e.height){this.sized=!0;var t=this.div.childNodes[0];t.width=e.width,t.height=e.height}},"getHTML":function(e,i){var t="",s="id="+this.id+"&width="+e+"&height="+i;if(navigator.userAgent.match(/MSIE/)){t+='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="'+(location.href.match(/^https/i)?"https://":"http://")+'download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=10,0,0,0" width="'+e+'" height="'+i+'" id="'+this.movieId+'" align="middle"><param name="allowFullScreen" value="false" /><param name="movie" value="'+l.moviePath+'" /><param name="loop" value="false" /><param name="menu" value="false" /><param name="quality" value="best" /><param name="bgcolor" value="#ffffff" /><param name="flashvars" value="'+s+'"/><param name="wmode" value="transparent"/></object>'}else t+='<embed id="'+this.movieId+'" src="'+l.moviePath+'" loop="false" menu="false" quality="best" bgcolor="#ffffff" width="'+e+'" height="'+i+'" name="'+this.movieId+'" align="middle" allowFullScreen="false" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer" flashvars="'+s+'" wmode="transparent" />';return t},"hide":function(){this.div&&(this.div.style.left="-2000px")},"show":function(){this.reposition()},"destroy":function(){if(this.domElement&&this.div){this.hide(),this.div.innerHTML="";var e=s.getElementsByTagName("body")[0];try{e.removeChild(this.div)}catch(e){}this.domElement=null,this.div=null}},"reposition":function(e){if(e&&(this.domElement=l.$(e),this.domElement||this.hide()),this.domElement&&this.div){var i=l.getDOMObjectPosition(this.domElement),t=this.div.style;t.left=i.left+"px",t.top=i.top+"px"}},"clearText":function(){this.clipText="",this.ready&&this.movie.clearText()},"appendText":function(e){this.clipText+=e,this.ready&&this.movie.appendText(e)},"setText":function(e){this.clipText=e,this.ready&&this.movie.setText(e)},"setCharSet":function(e){this.charSet=e,this.ready&&this.movie.setCharSet(e)},"setBomInc":function(e){this.incBom=e,this.ready&&this.movie.setBomInc(e)},"setFileName":function(e){this.fileName=e,this.ready&&this.movie.setFileName(e)},"setAction":function(e){this.action=e,this.ready&&this.movie.setAction(e)},"addEventListener":function(e,i){e=e.toString().toLowerCase().replace(/^on/,""),this.handlers[e]||(this.handlers[e]=[]),this.handlers[e].push(i)},"setHandCursor":function(e){this.handCursorEnabled=e,this.ready&&this.movie.setHandCursor(e)},"setCSSEffects":function(e){this.cssEffects=!!e},"receiveEvent":function(e,i){var n;switch(e=e.toString().toLowerCase().replace(/^on/,"")){case"load":if(this.movie=s.getElementById(this.movieId),!this.movie)return n=this,void setTimeout(function(){n.receiveEvent("load",null)},1);if(!this.ready&&navigator.userAgent.match(/Firefox/)&&navigator.userAgent.match(/Windows/))return n=this,setTimeout(function(){n.receiveEvent("load",null)},100),void(this.ready=!0);this.ready=!0,this.movie.clearText(),this.movie.appendText(this.clipText),this.movie.setFileName(this.fileName),this.movie.setAction(this.action),this.movie.setCharSet(this.charSet),this.movie.setBomInc(this.incBom),this.movie.setHandCursor(this.handCursorEnabled);break;case"mouseover":this.domElement&&this.cssEffects&&this.recoverActive&&this.domElement.addClass("binf-active");break;case"mouseout":this.domElement&&this.cssEffects&&(this.recoverActive=!1,this.domElement.hasClass("binf-active")&&(this.domElement.removeClass("binf-active"),this.recoverActive=!0));break;case"mousedown":this.domElement&&this.cssEffects&&this.domElement.addClass("binf-active");break;case"mouseup":this.domElement&&this.cssEffects&&(this.domElement.removeClass("binf-active"),this.recoverActive=!1)}if(this.handlers[e])for(var o=0,l=this.handlers[e].length;o<l;o++){var r=this.handlers[e][o];"function"==typeof r?r(this,i):"object"==typeof r&&2==r.length?r[0][r[1]](this,i):"string"==typeof r&&t[r](this,i)}}},t.ZeroClipboard_TableTools=l,function(e,t,s){i=function(t,s){!this instanceof i&&alert("Warning: TableTools must be initialised with the keyword 'new'");var n=e.fn.dataTable.Api?new e.fn.dataTable.Api(t).settings()[0]:t.fnSettings();return this.s={"that":this,"dt":n,"print":{"saveStart":-1,"saveLength":-1,"saveScroll":-1,"funcEnd":function(){}},"buttonCounter":0,"select":{"type":"","selected":[],"preRowSelect":null,"postSelected":null,"postDeselected":null,"all":!1,"selectedClass":""},"custom":{},"swfPath":"","buttonSet":[],"master":!1,"tags":{}},this.dom={"container":null,"table":null,"print":{"hidden":[],"message":null},"collection":{"collection":null,"background":null}},this.classes=e.extend(!0,{},i.classes),this.s.dt.bJUI&&e.extend(!0,this.classes,i.classes_themeroller),this.fnSettings=function(){return this.s},void 0===s&&(s={}),i._aInstances.push(this),this._fnConstruct(s),this},i.prototype={"fnGetSelected":function(e){var i,t,s=[],n=this.s.dt.aoData,o=this.s.dt.aiDisplay;if(e)for(i=0,t=o.length;i<t;i++)n[o[i]]._DTTT_selected&&s.push(n[o[i]].nTr);else for(i=0,t=n.length;i<t;i++)n[i]._DTTT_selected&&s.push(n[i].nTr);return s},"fnGetSelectedData":function(){var e,i,t=[],s=this.s.dt.aoData;for(e=0,i=s.length;e<i;e++)s[e]._DTTT_selected&&t.push(this.s.dt.oInstance.fnGetData(e));return t},"fnGetSelectedIndexes":function(e){var i,t,s=[],n=this.s.dt.aoData,o=this.s.dt.aiDisplay;if(e)for(i=0,t=o.length;i<t;i++)n[o[i]]._DTTT_selected&&s.push(o[i]);else for(i=0,t=n.length;i<t;i++)n[i]._DTTT_selected&&s.push(i);return s},"fnIsSelected":function(e){var i=this.s.dt.oInstance.fnGetPosition(e);return!0===this.s.dt.aoData[i]._DTTT_selected},"fnSelectAll":function(e){this._fnRowSelect(e?this.s.dt.aiDisplay:this.s.dt.aoData)},"fnSelectNone":function(e){this._fnRowDeselect(this.fnGetSelectedIndexes(e))},"fnSelect":function(e){"single"==this.s.select.type?(this.fnSelectNone(),this._fnRowSelect(e)):this._fnRowSelect(e)},"fnDeselect":function(e){this._fnRowDeselect(e)},"fnGetTitle":function(e){var i="";if(void 0!==e.sTitle&&""!==e.sTitle)i=e.sTitle;else{var t=s.getElementsByTagName("title");t.length>0&&(i=t[0].innerHTML)}return"\xa1".toString().length<4?i.replace(/[^a-zA-Z0-9_\u00A1-\uFFFF\.,\-_ !\(\)]/g,""):i.replace(/[^a-zA-Z0-9_\.,\-_ !\(\)]/g,"")},"fnCalcColRatios":function(e){var i,t,s=this.s.dt.aoColumns,n=this._fnColumnTargets(e.mColumns),o=[],l=0,r=0;for(i=0,t=n.length;i<t;i++)n[i]&&(l=s[i].nTh.offsetWidth,r+=l,o.push(l));for(i=0,t=o.length;i<t;i++)o[i]=o[i]/r;return o.join("\t")},"fnGetTableData":function(e){if(this.s.dt)return this._fnGetDataTablesData(e)},"fnSetText":function(e,i){this._fnFlashSetText(e,i)},"fnResizeButtons":function(){for(var e in l.clients)if(e){var i=l.clients[e];void 0!==i.domElement&&i.domElement.parentNode&&i.positionElement()}},"fnResizeRequired":function(){for(var e in l.clients)if(e){var i=l.clients[e];if(void 0!==i.domElement&&i.domElement.parentNode==this.dom.container&&!1===i.sized)return!0}return!1},"fnPrint":function(e,i){void 0===i&&(i={}),void 0===e||e?this._fnPrintStart(i):this._fnPrintEnd()},"fnInfo":function(i,t){var s=e("<div/>").addClass(this.classes.print.info).html(i).appendTo("body");setTimeout(function(){s.fadeOut("normal",function(){s.remove()})},t)},"fnContainer":function(){return this.dom.container},"_fnConstruct":function(t){var n=this;this._fnCustomiseSettings(t),this.dom.container=s.createElement(this.s.tags.container),this.dom.container.className=this.classes.container,"none"!=this.s.select.type&&this._fnRowSelectConfig(),this._fnButtonDefinations(this.s.buttonSet,this.dom.container),this.s.dt.aoDestroyCallback.push({"sName":"TableTools","fn":function(){e(n.s.dt.nTBody).off("click.DTTT_Select","tr"),e(n.dom.container).empty();var t=e.inArray(n,i._aInstances);-1!==t&&i._aInstances.splice(t,1)}})},"_fnCustomiseSettings":function(t){void 0===this.s.dt._TableToolsInit&&(this.s.master=!0,this.s.dt._TableToolsInit=!0),this.dom.table=this.s.dt.nTable,this.s.custom=e.extend({},i.DEFAULTS,t),this.s.swfPath=this.s.custom.sSwfPath,void 0!==l&&(l.moviePath=this.s.swfPath),this.s.select.type=this.s.custom.sRowSelect,this.s.select.preRowSelect=this.s.custom.fnPreRowSelect,this.s.select.postSelected=this.s.custom.fnRowSelected,this.s.select.postDeselected=this.s.custom.fnRowDeselected,this.s.custom.sSelectedClass&&(this.classes.select.row=this.s.custom.sSelectedClass),this.s.tags=this.s.custom.oTags,this.s.buttonSet=this.s.custom.aButtons},"_fnButtonDefinations":function(t,s){for(var n,o=0,l=t.length;o<l;o++){if("string"==typeof t[o]){if(void 0===i.BUTTONS[t[o]]){alert("TableTools: Warning - unknown button type: "+t[o]);continue}n=e.extend({},i.BUTTONS[t[o]],!0)}else{if(void 0===i.BUTTONS[t[o].sExtends]){alert("TableTools: Warning - unknown button type: "+t[o].sExtends);continue}var r=e.extend({},i.BUTTONS[t[o].sExtends],!0);n=e.extend(r,t[o],!0)}var a=this._fnCreateButton(n,e(s).hasClass(this.classes.collection.container));a&&s.appendChild(a)}},"_fnCreateButton":function(i,t){var s=this._fnButtonBase(i,t);if(i.sAction.match(/flash/)){if(!this._fnHasFlash())return!1;this._fnFlashConfig(s,i)}else"text"==i.sAction?this._fnTextConfig(s,i):"div"==i.sAction?this._fnTextConfig(s,i):"collection"==i.sAction&&(this._fnTextConfig(s,i),this._fnCollectionConfig(s,i));return-1!==this.s.dt.iTabIndex&&e(s).attr("tabindex",this.s.dt.iTabIndex).attr("aria-controls",this.s.dt.sTableId).on("keyup.DTTT",function(i){13===i.keyCode&&(i.stopPropagation(),e(this).trigger("click"))}).on("mousedown.DTTT",function(e){i.sAction.match(/flash/)||e.preventDefault()}),s},"_fnButtonBase":function(e,i){var t,n,o;i?(t=e.sTag&&"default"!==e.sTag?e.sTag:this.s.tags.collection.button,n=e.sLinerTag&&"default"!==e.sLinerTag?e.sLiner:this.s.tags.collection.liner,o=this.classes.collection.buttons.normal):(t=e.sTag&&"default"!==e.sTag?e.sTag:this.s.tags.button,n=e.sLinerTag&&"default"!==e.sLinerTag?e.sLiner:this.s.tags.liner,o=this.classes.buttons.normal);var l=s.createElement(t),r=s.createElement(n),a=this._fnGetMasterSettings();return l.className=o+" "+e.sButtonClass,l.setAttribute("id","ToolTables_"+this.s.dt.sInstance+"_"+a.buttonCounter),l.appendChild(r),r.innerHTML=e.sButtonText,a.buttonCounter++,l},"_fnGetMasterSettings":function(){if(this.s.master)return this.s;for(var e=i._aInstances,t=0,s=e.length;t<s;t++)if(this.dom.table==e[t].s.dt.nTable)return e[t].s},"_fnCollectionConfig":function(e,i){var t=s.createElement(this.s.tags.collection.container);t.style.display="none",t.className=this.classes.collection.container,i._collection=t,s.body.appendChild(t),this._fnButtonDefinations(i.aButtons,t)},"_fnCollectionShow":function(i,n){var o=this,l=e(i).offset(),r=n._collection,a=l.left,c=l.top+e(i).outerHeight(),u=e(t).height(),d=e(s).height(),h=e(t).width(),p=e(s).width();r.style.position="absolute",r.style.left=a+"px",r.style.top=c+"px",r.style.display="block",e(r).css("opacity",0);var m=s.createElement("div");m.style.position="absolute",m.style.left="0px",m.style.top="0px",m.style.height=(u>d?u:d)+"px",m.style.width=(h>p?h:p)+"px",m.className=this.classes.collection.background,e(m).css("opacity",0),s.body.appendChild(m),s.body.appendChild(r);var f=e(r).outerWidth(),g=e(r).outerHeight();a+f>p&&(r.style.left=p-f+"px"),c+g>d&&(r.style.top=c-g-e(i).outerHeight()+"px"),this.dom.collection.collection=r,this.dom.collection.background=m,setTimeout(function(){e(r).animate({"opacity":1},500),e(m).animate({"opacity":.25},500)},10),this.fnResizeButtons(),e(m).click(function(){o._fnCollectionHide.call(o,null,null)})},"_fnCollectionHide":function(i,t){null!==t&&"collection"==t.sExtends||null!==this.dom.collection.collection&&(e(this.dom.collection.collection).animate({"opacity":0},500,function(e){this.style.display="none"}),e(this.dom.collection.background).animate({"opacity":0},500,function(e){this.parentNode.removeChild(this)}),this.dom.collection.collection=null,this.dom.collection.background=null)},"_fnRowSelectConfig":function(){if(this.s.master){var i=this,t=this.s.dt;this.s.dt.aoOpenRows;e(t.nTable).addClass(this.classes.select.table),"os"===this.s.select.type&&(e(t.nTBody).on("mousedown.DTTT_Select","tr",function(i){i.shiftKey&&e(t.nTBody).css("-moz-user-select","none").one("selectstart.DTTT_Select","tr",function(){return!1})}),e(t.nTBody).on("mouseup.DTTT_Select","tr",function(i){e(t.nTBody).css("-moz-user-select","")})),e(t.nTBody).on("click.DTTT_Select",this.s.custom.sRowSelector,function(s){var n="tr"===this.nodeName.toLowerCase()?this:e(this).parents("tr")[0],o=i.s.select,l=i.s.dt.oInstance.fnGetPosition(n);if(n.parentNode==t.nTBody&&null!==t.oInstance.fnGetData(n)){if("os"==o.type)if(s.ctrlKey||s.metaKey)i.fnIsSelected(n)?i._fnRowDeselect(n,s):i._fnRowSelect(n,s);else if(s.shiftKey){var r=i.s.dt.aiDisplay.slice(),a=e.inArray(o.lastRow,r),c=e.inArray(l,r);if(0===i.fnGetSelected().length||-1===a)r.splice(e.inArray(l,r)+1,r.length);else{if(a>c){var u=c;c=a,a=u}r.splice(c+1,r.length),r.splice(0,a)}i.fnIsSelected(n)?(r.splice(e.inArray(l,r),1),i._fnRowDeselect(r,s)):i._fnRowSelect(r,s)
}else i.fnIsSelected(n)&&1===i.fnGetSelected().length?i._fnRowDeselect(n,s):(i.fnSelectNone(),i._fnRowSelect(n,s));else i.fnIsSelected(n)?i._fnRowDeselect(n,s):"single"==o.type?(i.fnSelectNone(),i._fnRowSelect(n,s)):"multi"==o.type&&i._fnRowSelect(n,s);o.lastRow=l}}),t.oApi._fnCallbackReg(t,"aoRowCreatedCallback",function(s,n,o){t.aoData[o]._DTTT_selected&&e(s).addClass(i.classes.select.row)},"TableTools-SelectAll")}},"_fnRowSelect":function(t,s){var n,o,l=this,r=this._fnSelectData(t),a=(0===r.length||r[0].nTr,[]);for(n=0,o=r.length;n<o;n++)r[n].nTr&&a.push(r[n].nTr);if(null===this.s.select.preRowSelect||this.s.select.preRowSelect.call(this,s,a,!0)){for(n=0,o=r.length;n<o;n++)r[n]._DTTT_selected=!0,r[n].nTr&&e(r[n].nTr).addClass(l.classes.select.row);null!==this.s.select.postSelected&&this.s.select.postSelected.call(this,a),i._fnEventDispatch(this,"select",a,!0)}},"_fnRowDeselect":function(t,s){var n,o,l=this,r=this._fnSelectData(t),a=(0===r.length||r[0].nTr,[]);for(n=0,o=r.length;n<o;n++)r[n].nTr&&a.push(r[n].nTr);if(null===this.s.select.preRowSelect||this.s.select.preRowSelect.call(this,s,a,!1)){for(n=0,o=r.length;n<o;n++)r[n]._DTTT_selected=!1,r[n].nTr&&e(r[n].nTr).removeClass(l.classes.select.row);null!==this.s.select.postDeselected&&this.s.select.postDeselected.call(this,a),i._fnEventDispatch(this,"select",a,!1)}},"_fnSelectData":function(e){var i,t,s,n=[];if(e.nodeName)i=this.s.dt.oInstance.fnGetPosition(e),n.push(this.s.dt.aoData[i]);else{if(void 0!==e.length){for(t=0,s=e.length;t<s;t++)e[t].nodeName?(i=this.s.dt.oInstance.fnGetPosition(e[t]),n.push(this.s.dt.aoData[i])):"number"==typeof e[t]?n.push(this.s.dt.aoData[e[t]]):n.push(e[t]);return n}n.push(e)}return n},"_fnTextConfig":function(t,s){var n=this;null!==s.fnInit&&s.fnInit.call(this,t,s),""!==s.sToolTip&&(t.title=s.sToolTip),e(t).hover(function(){null!==s.fnMouseover&&s.fnMouseover.call(this,t,s,null)},function(){null!==s.fnMouseout&&s.fnMouseout.call(this,t,s,null)}),null!==s.fnSelect&&i._fnEventListen(this,"select",function(e){s.fnSelect.call(n,t,s,e)}),e(t).click(function(e){null!==s.fnClick&&s.fnClick.call(n,t,s,null,e),null!==s.fnComplete&&s.fnComplete.call(n,t,s,null,null),n._fnCollectionHide(t,s)})},"_fnHasFlash":function(){try{if(new ActiveXObject("ShockwaveFlash.ShockwaveFlash"))return!0}catch(e){if(navigator.mimeTypes&&void 0!==navigator.mimeTypes["application/x-shockwave-flash"]&&navigator.mimeTypes["application/x-shockwave-flash"].enabledPlugin)return!0}return!1},"_fnFlashConfig":function(e,i){var t=this,s=new l.Client;null!==i.fnInit&&i.fnInit.call(this,e,i),s.setHandCursor(!0),"flash_save"==i.sAction?(s.setAction("save"),s.setCharSet("utf16le"==i.sCharSet?"UTF16LE":"UTF8"),s.setBomInc(i.bBomInc),s.setFileName(i.sFileName.replace("*",this.fnGetTitle(i)))):"flash_pdf"==i.sAction?(s.setAction("pdf"),s.setFileName(i.sFileName.replace("*",this.fnGetTitle(i)))):s.setAction("copy"),s.addEventListener("mouseOver",function(n){null!==i.fnMouseover&&i.fnMouseover.call(t,e,i,s)}),s.addEventListener("mouseOut",function(n){null!==i.fnMouseout&&i.fnMouseout.call(t,e,i,s)}),s.addEventListener("mouseDown",function(n){null!==i.fnClick&&i.fnClick.call(t,e,i,s)}),s.addEventListener("complete",function(n,o){null!==i.fnComplete&&i.fnComplete.call(t,e,i,s,o),t._fnCollectionHide(e,i)}),this._fnFlashGlue(s,e,i.sToolTip)},"_fnFlashGlue":function(e,i,t){var n=this,o=i.getAttribute("id");s.getElementById(o)?e.glue(i,t):setTimeout(function(){n._fnFlashGlue(e,i,t)},100)},"_fnFlashSetText":function(e,i){var t=this._fnChunkData(i,8192);e.clearText();for(var s=0,n=t.length;s<n;s++)e.appendText(t[s])},"_fnColumnTargets":function(i){var t,s,n=[],o=this.s.dt,l=o.aoColumns,r=l.length;if("function"==typeof i){var a=i.call(this,o);for(t=0,s=r;t<s;t++)n.push(-1!==e.inArray(t,a))}else if("object"==typeof i){for(t=0,s=r;t<s;t++)n.push(!1);for(t=0,s=i.length;t<s;t++)n[i[t]]=!0}else if("visible"==i)for(t=0,s=r;t<s;t++)n.push(!!l[t].bVisible);else if("hidden"==i)for(t=0,s=r;t<s;t++)n.push(!l[t].bVisible);else if("sortable"==i)for(t=0,s=r;t<s;t++)n.push(!!l[t].bSortable);else for(t=0,s=r;t<s;t++)n.push(!0);return n},"_fnNewline":function(e){return"auto"==e.sNewLine?navigator.userAgent.match(/Windows/)?"\r\n":"\n":e.sNewLine},"_fnGetDataTablesData":function(i){var t,s,n,l,r,a,c,u=[],d="",h=this.s.dt,p=new RegExp(i.sFieldBoundary,"g"),m=this._fnColumnTargets(i.mColumns),f=void 0!==i.bSelectedOnly&&i.bSelectedOnly;if(i.bHeader){for(r=[],t=0,s=h.aoColumns.length;t<s;t++)m[t]&&(d=h.aoColumns[t].sTitle.replace(/\n/g," ").replace(/<.*?>/g,"").replace(/^\s+|\s+$/g,""),d=this._fnHtmlDecode(d),r.push(this._fnBoundData(d,i.sFieldBoundary,p)));u.push(r.join(i.sFieldSeperator))}f=!0;var g,b=this.fnGetSelectedIndexes();for(f="none"!==this.s.select.type&&f&&0!==b.length,g=f?b:o.Api?new o.Api(h).rows(i.oSelectorOpts).indexes().flatten().toArray():h.oInstance.$("tr",i.oSelectorOpts).map(function(e,i){return h.oInstance.fnGetPosition(i)}).get(),n=0,l=g.length;n<l;n++){for(c=h.aoData[g[n]].nTr,r=[],t=0,s=h.aoColumns.length;t<s;t++)if(m[t]){var v=h.oApi._fnGetCellData(h,g[n],t,"display");i.fnCellRender?d=i.fnCellRender(v,t,c,g[n])+"":"string"==typeof v?(d=v.replace(/\n/g," "),d=d.replace(/<img.*?\s+alt\s*=\s*(?:"([^"]+)"|'([^']+)'|([^\s>]+)).*?>/gi,"$1$2$3"),d=d.replace(/<.*?>/g,"")):d=v+"",d=d.replace(/^\s+/,"").replace(/\s+$/,""),d=this._fnHtmlDecode(d),r.push(this._fnBoundData(d,i.sFieldBoundary,p))}u.push(r.join(i.sFieldSeperator)),i.bOpenRows&&(a=e.grep(h.aoOpenRows,function(e){return e.nParent===c}),1===a.length&&(d=this._fnBoundData(e("td",a[0].nTr).html(),i.sFieldBoundary,p),u.push(d)))}if(i.bFooter&&null!==h.nTFoot){for(r=[],t=0,s=h.aoColumns.length;t<s;t++)m[t]&&null!==h.aoColumns[t].nTf&&(d=h.aoColumns[t].nTf.innerHTML.replace(/\n/g," ").replace(/<.*?>/g,""),d=this._fnHtmlDecode(d),r.push(this._fnBoundData(d,i.sFieldBoundary,p)));u.push(r.join(i.sFieldSeperator))}return u.join(this._fnNewline(i))},"_fnBoundData":function(e,i,t){return""===i?e:i+e.replace(t,i+i)+i},"_fnChunkData":function(e,i){for(var t=[],s=e.length,n=0;n<s;n+=i)n+i<s?t.push(e.substring(n,n+i)):t.push(e.substring(n,s));return t},"_fnHtmlDecode":function(e){if(-1===e.indexOf("&"))return e;var i=s.createElement("div");return e.replace(/&([^\s]*?);/g,function(e,t){return"#"===e.substr(1,1)?String.fromCharCode(Number(t.substr(1))):(i.innerHTML=e,i.childNodes[0].nodeValue)})},"_fnPrintStart":function(i){var n=this,o=this.s.dt;this._fnPrintHideNodes(o.nTable),this.s.print.saveStart=o._iDisplayStart,this.s.print.saveLength=o._iDisplayLength,i.bShowAll&&(o._iDisplayStart=0,o._iDisplayLength=-1,o.oApi._fnCalculateEnd&&o.oApi._fnCalculateEnd(o),o.oApi._fnDraw(o)),""===o.oScroll.sX&&""===o.oScroll.sY||(this._fnPrintScrollStart(o),e(this.s.dt.nTable).bind("draw.DTTT_Print",function(){n._fnPrintScrollStart(o)}));var l=o.aanFeatures;for(var r in l)if("i"!=r&&"t"!=r&&1==r.length)for(var a=0,c=l[r].length;a<c;a++)this.dom.print.hidden.push({"node":l[r][a],"display":"block"}),l[r][a].style.display="none";e(s.body).addClass(this.classes.print.body),""!==i.sInfo&&this.fnInfo(i.sInfo,3e3),i.sMessage&&e("<div/>").addClass(this.classes.print.message).html(i.sMessage).prependTo("body"),this.s.print.saveScroll=e(t).scrollTop(),t.scrollTo(0,0),e(s).bind("keydown.DTTT",function(e){27==e.keyCode&&(e.preventDefault(),n._fnPrintEnd.call(n,e))})},"_fnPrintEnd":function(i){var n=this.s.dt,o=this.s.print;this.dom.print;this._fnPrintShowNodes(),""===n.oScroll.sX&&""===n.oScroll.sY||(e(this.s.dt.nTable).unbind("draw.DTTT_Print"),this._fnPrintScrollEnd()),t.scrollTo(0,o.saveScroll),e("div."+this.classes.print.message).remove(),e(s.body).removeClass("DTTT_Print"),n._iDisplayStart=o.saveStart,n._iDisplayLength=o.saveLength,n.oApi._fnCalculateEnd&&n.oApi._fnCalculateEnd(n),n.oApi._fnDraw(n),e(s).unbind("keydown.DTTT")},"_fnPrintScrollStart":function(){var i,t,s=this.s.dt,n=s.nScrollHead.getElementsByTagName("div")[0],o=(n.getElementsByTagName("table")[0],s.nTable.parentNode);i=s.nTable.getElementsByTagName("thead"),i.length>0&&s.nTable.removeChild(i[0]),null!==s.nTFoot&&(t=s.nTable.getElementsByTagName("tfoot"),t.length>0&&s.nTable.removeChild(t[0])),i=s.nTHead.cloneNode(!0),s.nTable.insertBefore(i,s.nTable.childNodes[0]),null!==s.nTFoot&&(t=s.nTFoot.cloneNode(!0),s.nTable.insertBefore(t,s.nTable.childNodes[1])),""!==s.oScroll.sX&&(s.nTable.style.width=e(s.nTable).outerWidth()+"px",o.style.width=e(s.nTable).outerWidth()+"px",o.style.overflow="visible"),""!==s.oScroll.sY&&(o.style.height=e(s.nTable).outerHeight()+"px",o.style.overflow="visible")},"_fnPrintScrollEnd":function(){var e=this.s.dt,i=e.nTable.parentNode;""!==e.oScroll.sX&&(i.style.width=e.oApi._fnStringToCss(e.oScroll.sX),i.style.overflow="auto"),""!==e.oScroll.sY&&(i.style.height=e.oApi._fnStringToCss(e.oScroll.sY),i.style.overflow="auto")},"_fnPrintShowNodes":function(){for(var e=this.dom.print.hidden,i=0,t=e.length;i<t;i++)e[i].node.style.display=e[i].display;e.splice(0,e.length)},"_fnPrintHideNodes":function(i){for(var t=this.dom.print.hidden,s=i.parentNode,n=s.childNodes,o=0,l=n.length;o<l;o++)if(n[o]!=i&&1==n[o].nodeType){var r=e(n[o]).css("display");"none"!=r&&(t.push({"node":n[o],"display":r}),n[o].style.display="none")}"BODY"!=s.nodeName.toUpperCase()&&this._fnPrintHideNodes(s)}},i._aInstances=[],i._aListeners=[],i.fnGetMasters=function(){for(var e=[],t=0,s=i._aInstances.length;t<s;t++)i._aInstances[t].s.master&&e.push(i._aInstances[t]);return e},i.fnGetInstance=function(e){"object"!=typeof e&&(e=s.getElementById(e));for(var t=0,n=i._aInstances.length;t<n;t++)if(i._aInstances[t].s.master&&i._aInstances[t].dom.table==e)return i._aInstances[t];return null},i._fnEventListen=function(e,t,s){i._aListeners.push({"that":e,"type":t,"fn":s})},i._fnEventDispatch=function(e,t,s,n){for(var o=i._aListeners,l=0,r=o.length;l<r;l++)e.dom.table==o[l].that.dom.table&&o[l].type==t&&o[l].fn(s,n)},i.buttonBase={"sAction":"text","sTag":"default","sLinerTag":"default","sButtonClass":"DTTT_button_text","sButtonText":"Button text","sTitle":"","sToolTip":"","sCharSet":"utf8","bBomInc":!1,"sFileName":"*.csv","sFieldBoundary":"","sFieldSeperator":"\t","sNewLine":"auto","mColumns":"all","bHeader":!0,"bFooter":!0,"bOpenRows":!1,"bSelectedOnly":!1,"oSelectorOpts":void 0,"fnMouseover":null,"fnMouseout":null,"fnClick":null,"fnSelect":null,"fnComplete":null,"fnInit":null,"fnCellRender":null},i.BUTTONS={"csv":e.extend({},i.buttonBase,{"sAction":"flash_save","sButtonClass":"DTTT_button_csv","sButtonText":"CSV","sFieldBoundary":'"',"sFieldSeperator":",","fnClick":function(e,i,t){this.fnSetText(t,this.fnGetTableData(i))}}),"xls":e.extend({},i.buttonBase,{"sAction":"flash_save","sCharSet":"utf16le","bBomInc":!0,"sButtonClass":"DTTT_button_xls","sButtonText":"Excel","fnClick":function(e,i,t){this.fnSetText(t,this.fnGetTableData(i))}}),"copy":e.extend({},i.buttonBase,{"sAction":"flash_copy","sButtonClass":"DTTT_button_copy","sButtonText":"Copy","fnClick":function(e,i,t){this.fnSetText(t,this.fnGetTableData(i))},"fnComplete":function(e,i,t,s){var n=s.split("\n").length;i.bHeader&&n--,null!==this.s.dt.nTFoot&&i.bFooter&&n--;var o=1==n?"":"s";this.fnInfo("<h6>Table copied</h6><p>Copied "+n+" row"+o+" to the clipboard.</p>",1500)}}),"pdf":e.extend({},i.buttonBase,{"sAction":"flash_pdf","sNewLine":"\n","sFileName":"*.pdf","sButtonClass":"DTTT_button_pdf","sButtonText":"PDF","sPdfOrientation":"portrait","sPdfSize":"A4","sPdfMessage":"","fnClick":function(e,i,t){this.fnSetText(t,"title:"+this.fnGetTitle(i)+"\nmessage:"+i.sPdfMessage+"\ncolWidth:"+this.fnCalcColRatios(i)+"\norientation:"+i.sPdfOrientation+"\nsize:"+i.sPdfSize+"\n--/TableToolsOpts--\n"+this.fnGetTableData(i))}}),"print":e.extend({},i.buttonBase,{"sInfo":"<h6>Print view</h6><p>Please use your browser's print function to print this table. Press escape when finished.</p>","sMessage":null,"bShowAll":!0,"sToolTip":"View print view","sButtonClass":"DTTT_button_print","sButtonText":"Print","fnClick":function(e,i){this.fnPrint(!0,i)}}),"text":e.extend({},i.buttonBase),"select":e.extend({},i.buttonBase,{"sButtonText":"Select button","fnSelect":function(i,t){0!==this.fnGetSelected().length?e(i).removeClass(this.classes.buttons.disabled):e(i).addClass(this.classes.buttons.disabled)},"fnInit":function(i,t){e(i).addClass(this.classes.buttons.disabled)}}),"select_single":e.extend({},i.buttonBase,{"sButtonText":"Select button","fnSelect":function(i,t){1==this.fnGetSelected().length?e(i).removeClass(this.classes.buttons.disabled):e(i).addClass(this.classes.buttons.disabled)},"fnInit":function(i,t){e(i).addClass(this.classes.buttons.disabled)}}),"select_all":e.extend({},i.buttonBase,{"sButtonText":"Select all","fnClick":function(e,i){this.fnSelectAll()},"fnSelect":function(i,t){this.fnGetSelected().length==this.s.dt.fnRecordsDisplay()?e(i).addClass(this.classes.buttons.disabled):e(i).removeClass(this.classes.buttons.disabled)}}),"select_none":e.extend({},i.buttonBase,{"sButtonText":"Deselect all","fnClick":function(e,i){this.fnSelectNone()},"fnSelect":function(i,t){0!==this.fnGetSelected().length?e(i).removeClass(this.classes.buttons.disabled):e(i).addClass(this.classes.buttons.disabled)},"fnInit":function(i,t){e(i).addClass(this.classes.buttons.disabled)}}),"ajax":e.extend({},i.buttonBase,{"sAjaxUrl":"/xhr.php","sButtonText":"Ajax button","fnClick":function(i,t){var s=this.fnGetTableData(t);e.ajax({"url":t.sAjaxUrl,"data":[{"name":"tableData","value":s}],"success":t.fnAjaxComplete,"dataType":"json","type":"POST","cache":!1,"error":function(){alert("Error detected when sending table data to server")}})},"fnAjaxComplete":function(e){alert("Ajax complete")}}),"div":e.extend({},i.buttonBase,{"sAction":"div","sTag":"div","sButtonClass":"DTTT_nonbutton","sButtonText":"Text button"}),"collection":e.extend({},i.buttonBase,{"sAction":"collection","sButtonClass":"DTTT_button_collection","sButtonText":"Collection","fnClick":function(e,i){this._fnCollectionShow(e,i)}})},i.buttons=i.BUTTONS,i.classes={"container":"DTTT_container","buttons":{"normal":"DTTT_button","disabled":"DTTT_disabled"},"collection":{"container":"DTTT_collection","background":"DTTT_collection_background","buttons":{"normal":"DTTT_button","disabled":"DTTT_disabled"}},"select":{"table":"DTTT_selectable","row":"DTTT_selected selected"},"print":{"body":"DTTT_Print","info":"DTTT_print_info","message":"DTTT_PrintMessage"}},i.classes_themeroller={"container":"DTTT_container ui-buttonset ui-buttonset-multi","buttons":{"normal":"DTTT_button ui-button ui-state-default"},"collection":{"container":"DTTT_collection ui-buttonset ui-buttonset-multi"}},i.DEFAULTS={"sSwfPath":"../swf/copy_csv_xls_pdf.swf","sRowSelect":"none","sRowSelector":"tr","sSelectedClass":null,"fnPreRowSelect":null,"fnRowSelected":null,"fnRowDeselected":null,"aButtons":["copy","csv","xls","pdf","print"],"oTags":{"container":"div","button":"a","liner":"span","collection":{"container":"div","button":"a","liner":"span"}}},i.defaults=i.DEFAULTS,i.prototype.CLASS="TableTools",i.version="2.2.3",e.fn.dataTable.Api&&e.fn.dataTable.Api.register("tabletools()",function(){var e=null;return this.context.length>0&&(e=i.fnGetInstance(this.context[0].nTable)),e}),"function"==typeof e.fn.dataTable&&"function"==typeof e.fn.dataTableExt.fnVersionCheck&&e.fn.dataTableExt.fnVersionCheck("1.9.0")?e.fn.dataTableExt.aoFeatures.push({"fnInit":function(e){var t=e.oInit,s=t?t.tableTools||t.oTableTools||{}:{};return new i(e.oInstance,s).dom.container},"cFeature":"T","sFeature":"TableTools"}):alert("Warning: TableTools requires DataTables 1.9.0 or newer - www.datatables.net/download"),e.fn.DataTable.TableTools=i}(e,t,s),"function"==typeof n.fn.dataTable&&"function"==typeof n.fn.dataTableExt.fnVersionCheck&&n.fn.dataTableExt.fnVersionCheck("1.9.0")?n.fn.dataTableExt.aoFeatures.push({"fnInit":function(e){var t=void 0!==e.oInit.oTableTools?e.oInit.oTableTools:{},s=new i(e.oInstance,t);return i._aInstances.push(s),s.dom.container},"cFeature":"T","sFeature":"TableTools"}):alert("Warning: TableTools 2 requires DataTables 1.9.0 or newer - www.datatables.net/download"),n.fn.dataTable.TableTools=i,n.fn.DataTable.TableTools=i}(e,e.fn.dataTable)}(window,document),e.fn.dataTable.TableTools}),csui.define("csui/controls/table/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/table/impl/nls/root/lang",{"searchPlaceholder":"Search {0}","searchByNamePlaceholder":"Search by name","searchIconTooltip":"Search by {0}","searchClearIconTooltip":"Clear","collapseSearch":"Close search","collapseSearchAria":"Clear all and close search","selectAll":"Select all items","selectAllAria":"Select all items","selectItem":"Select {0}","selectItemAria":"Select {0}. When selected an action bar of options can be reached per shift-tab","selectedItemActionBarAria":"Action bar of selected items","nameAria":"{0}","nameNoOpenAria":"{0}. Can not be opened.","NodeTableNoItems":"No item to display.","NodeTableLoadingItems":"Loading...","NodeTableProcessingItems":"","NodeTablePageInfo":"Showing _START_ to _END_ of _TOTAL_ items","NodeTableEmptyPageInfo":"Showing 0 items","NodeTableFilteredPageInfo":"(filtered from _MAX_ total items)","NodeTablePageInfoSuffix":"","NodeTablePageThousandsSeparator":",","NodeTablePagingFirst":"First","NodeTablePagingLast":"Last","NodeTablePagingPrevious":"Previous","NodeTablePagingNext":"Next","NodeTablePageSizeSelector":"Show _MENU_ items","NodeTablePageFilterLabel":"Filter by:","NodeTableSortAscending":": Click to sort ascending","NodeTableSortDescending":": Click to sort descending","NodeTableSortByAria":"{0}: Click to sort by {0}","backButtonTooltip":"Go back","typeAndNameAria":"{0} {1}","tableApplicationAria":"Table","descriptionColumnTitle":"Description","cellNoTexAria":"No text"}),csui.define("csui/utils/focusable",["csui/lib/ally"],function(e){"use strict";function i(i,t){var s=t?t.querySelector(i):i;return e.query.focusable({"context":s,"includeContext":!1,"strategy":"quick"})}function t(i){return e.is.focusable(i)}return{"findFocusables":i,"isFocusable":t}}),csui.define("csui/controls/table/cells/cell.registry",["csui/lib/underscore"],function(e){function i(){this._columnKeys={},this._columnOtherKeys={},this._dataTypes={}}return e.extend(i.prototype,{"hasCellViewByOtherKey":function(e){return!!this._columnOtherKeys[e]},"getCellView":function(e){if("type"!==e.get("column_type_identifier")){var i=e.get("column_key"),t=i&&this._columnKeys[i];if(t)return t}var s=e.get("type");return s&&this._dataTypes[s.toString()]},"registerByColumnKey":function(i,t){if(!e.isString(i)||!i)throw new Error("Column key must be a non-empty string");this._registerCellView(this._columnKeys,i,t)},"registerByOtherColumnKey":function(i,t){if(!e.isString(i)||!i)throw new Error("Column key must be a non-empty string");this._registerCellView(this._columnOtherKeys,i,t)},"registerByDataType":function(i,t){if(!e.isNumber(i)||!i)throw new Error("Data type must be a non-zero number");this._registerCellView(this._dataTypes,i.toString(),t)},"_registerCellView":function(e,i,t){if("function"!=typeof t)throw new Error("Column handler must be a function object");e[i]=t}}),new i}),csui.define("csui/controls/table/cells/cell/cell.view",["module","csui/lib/underscore","csui/lib/marionette","csui/utils/focusable"],function(e,i,t,s){"use strict";var n=i.extend({"multiValueSeparator":", "},e.config());return t.View.extend({"tagName":"td","constructor":function(e){t.View.prototype.constructor.apply(this,arguments),this.listenTo(this,"before:render",this._detachClickHandler).listenTo(this,"before:destroy",this._detachClickHandler)},"render":function(){return this._ensureViewIsIntact(),this.triggerMethod("before:render",this),this._renderContent(),this.bindUIElements(),this._attachClickHandler(),this.triggerMethod("render",this),this},"_renderContent":function(){var e=i.result(this,"className");e&&this.$el.addClass(e);var t=this.options.column;if(t){var s=t.name;this.$el.attr("data-csui-attribute",s),this.model.get("addEmptyAttribute")&&!this.model.get(s)&&void 0!==this.model.get(s)&&this.el.setAttribute("data-csui-empty-cell",!0)}this.renderValue(),this._ensureAriaLabel()},"_ensureAriaLabel":function(){if(!1!==this.needsAriaLabel){if(void 0===this.needsAriaLabel){if(1===s.findFocusables(this.el).length)return}var e=this.getAriaLabel();e&&this.$el.attr("aria-label",e)}},"_attachClickHandler":function(){var e=this;this.$el.on("click."+this.cid,function(i){e.triggerMethod("clicked:cell",i)})},"_detachClickHandler":function(){this.$el.off("click."+this.cid)},"renderValue":function(){var e=this.getValueText();this.$el.text(e),this.$el.attr("title",e)},"getValueText":function(){var e=this.options.column;if(e){var i=e.name,t=this.model,s=t.get(i+"_formatted");return null!==s&&void 0!==s||null!==(s=t.get(i))&&void 0!==s||(s=""),this.getSingleOrMultipleValueText(s)}return""},"getAriaLabel":function(){return this.getValueText()},"getSingleOrMultipleValueText":function(e,i){return i=this._validateFormater(i),Array.isArray(e)?this.concatenateTextValues(e,i):i(e)},"concatenateTextValues":function(e,i){return i=this._validateFormater(i),e.map(i).join(n.multiValueSeparator)},"_validateFormater":function(e){return e||function(e){return e}}},{"hasFixedWidth":!1,"columnClassName":"","getValue":function(e,i){var t=e.get(i.name);if(Array.isArray(t))for(var s=0;s<t.length;s++)if(void 0!==t[s]&&null!==t[s]){t=t[s];break}return void 0!==t?t:null}})}),csui.define("hbs!csui/controls/table/cells/templated/value",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){var n;return'<span title="'+this.escapeExpression((n=null!=(n=i.value||(null!=e?e.value:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"value","hash":{}}):n))+'">'+this.escapeExpression((n=null!=(n=i.formattedValue||(null!=e?e.formattedValue:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"formattedValue","hash":{}}):n))+"</span>\r\n"}});return t.registerPartial("csui_controls_table_cells_templated_value",s),s}),csui.define("csui/controls/table/cells/templated/templated.view",["csui/controls/table/cells/cell/cell.view","hbs!csui/controls/table/cells/templated/value"],function(e,i){"use strict";return e.extend({"template":i,"renderValue":function(){var e=this.getValueData(),i=e?this.template(e):"";this.$el.html(i)},"getValueData":function(){function e(e){return e}function i(e){return void 0!==l||null!==l?l:(null===e&&(e=""),e)}var t=this.model,s=this.options.column,n=s.name,o=t.get(n),l=t.get(n+"_formatted");return this.getSingleOrMultipleValueData(o,e,i)},"getSingleOrMultipleValueData":function(e,i,t){var s,n;return Array.isArray(e)?(s=this.concatenateTextValues(e,i),n=this.concatenateTextValues(e,t)):(s=i(e),n=t(e)),{"value":s,"formattedValue":n}}})}),csui.define("hbs!csui/controls/table/cells/text/impl/text",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"1":function(e,i,t,s){var n;return'    <div class="csui-table-cell-text" aria-label="'+this.escapeExpression((n=null!=(n=i.value||(null!=e?e.value:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"value","hash":{}}):n))+'">&nbsp;</div>\r\n'},"3":function(e,i,t,s){var n;return'    <div class="csui-table-cell-text" title="'+this.escapeExpression((n=null!=(n=i.value||(null!=e?e.value:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"value","hash":{}}):n))+'">'+this.escapeExpression((n=null!=(n=i.value||(null!=e?e.value:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"value","hash":{}}):n))+"</div>\r\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){var n;return null!=(n=i.if.call(e,null!=e?e.isEmpty:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.program(3,s,0)}))?n:""}});return t.registerPartial("csui_controls_table_cells_text_impl_text",s),s}),csui.define("css!csui/controls/table/cells/text/impl/text",[],function(){}),csui.define("csui/controls/table/cells/text/text.view",["csui/controls/table/cells/templated/templated.view","i18n!csui/controls/table/impl/nls/lang","hbs!csui/controls/table/cells/text/impl/text","css!csui/controls/table/cells/text/impl/text"],function(e,i,t){return e.extend({"className":"csui-truncate","template":t,"renderValue":function(){var e=this.getValueText(),t=void 0===e||0===e.length;t&&(e=i.cellNoTexAria);var s=this.template({"value":e,"isEmpty":t});this.$el.html(s)}})}),csui.define("hbs!csui/controls/table/cells/name/impl/name",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"1":function(e,i,t,s){var n;return null!=(n=i.if.call(e,null!=e?e.inactive:e,{"name":"if","hash":{},"fn":this.program(2,s,0),"inverse":this.program(4,s,0)}))?n:""},"2":function(e,i,t,s){var n;return'    <div class="csui-table-cell-name-div">\r\n      <div class="csui-table-cell-name-justify-div">\r\n        <p class="csui-table-cell-name-value csui-table-cell-no-default-action"\r\n           title="'+this.escapeExpression((n=null!=(n=i.name||(null!=e?e.name:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"name","hash":{}}):n))+'" aria-label="'+this.escapeExpression((n=null!=(n=i.nameNoOpenAria||(null!=e?e.nameNoOpenAria:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"nameNoOpenAria","hash":{}}):n))+'">'+this.escapeExpression((n=null!=(n=i.name||(null!=e?e.name:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"name","hash":{}}):n))+'</p>\r\n      </div>\r\n      <div class="csui-table-cell-name-appendix"></div>\r\n    </div>\r\n'},"4":function(e,i,t,s){var n;return'    <div class="csui-table-cell-name-div">\r\n      <a href="'+this.escapeExpression((n=null!=(n=i.defaultActionUrl||(null!=e?e.defaultActionUrl:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"defaultActionUrl","hash":{}}):n))+'"\r\n         class="csui-table-cell-name-value csui-table-cell-default-action csui-table-cell-name-justify-div"\r\n         title="'+this.escapeExpression((n=null!=(n=i.name||(null!=e?e.name:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"name","hash":{}}):n))+'" aria-label="'+this.escapeExpression((n=null!=(n=i.nameAria||(null!=e?e.nameAria:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"nameAria","hash":{}}):n))+'">\r\n        <span class="csui-table-cell-name-link-text">'+this.escapeExpression((n=null!=(n=i.name||(null!=e?e.name:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"name","hash":{}}):n))+'</span>\r\n      </a>\r\n      <div class="csui-table-cell-name-appendix"></div>\r\n    </div>\r\n'},"6":function(e,i,t,s){var n;return'  <div class="csui-table-cell-name-div">\r\n    <div class="csui-table-cell-name-justify-div">\r\n      <p class="csui-table-cell-name-value csui-table-cell-no-default-action"\r\n         title="'+this.escapeExpression((n=null!=(n=i.name||(null!=e?e.name:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"name","hash":{}}):n))+'" aria-label="'+this.escapeExpression((n=null!=(n=i.nameNoOpenAria||(null!=e?e.nameNoOpenAria:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"nameNoOpenAria","hash":{}}):n))+'">'+this.escapeExpression((n=null!=(n=i.name||(null!=e?e.name:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"name","hash":{}}):n))+'</p>\r\n    </div>\r\n    <div class="csui-table-cell-name-appendix"></div>\r\n  </div>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){var n;return null!=(n=i.if.call(e,null!=e?e.defaultAction:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.program(6,s,0)}))?n:""}});return t.registerPartial("csui_controls_table_cells_name_impl_name",s),s}),csui.define("css!csui/controls/table/cells/name/impl/name",[],function(){}),csui.define("csui/controls/table/cells/name/name.view",["csui/lib/underscore","csui/controls/table/cells/templated/templated.view","csui/controls/table/cells/cell.registry","csui/utils/base","csui/utils/node.links/node.links","hbs!csui/controls/table/cells/name/impl/name","i18n!csui/controls/table/impl/nls/lang","css!csui/controls/table/cells/name/impl/name"],function(e,i,t,s,n,o,l){"use strict";return i.extend({"template":o,"className":"csui-truncate","constructor":function(e){i.prototype.constructor.apply(this,arguments),this.listenTo(this,"before:render",function(){this.needsAriaLabel=!(this.options.column.defaultAction&&!this.model.get("inactive"))})},"getValueData":function(){var i=this.options.column,t=this.model,s=t.get(i.name),o=n.getUrl(t);return{"defaultAction":i.defaultAction,"defaultActionUrl":o,"contextualMenu":i.contextualMenu,"name":s,"nameAria":e.str.sformat(l.nameAria,s),"nameNoOpenAria":e.str.sformat(l.nameNoOpenAria,s),"inactive":t.get("inactive")}}},{"widthFactor":1.5,"columnClassName":"csui-table-cell-name","permanentColumn":!0})}),csui.define("css!csui/controls/table/cells/date/impl/date",[],function(){}),csui.define("csui/controls/table/cells/date/date.view",["csui/lib/underscore","csui/controls/table/cells/templated/templated.view","csui/controls/table/cells/cell.registry","csui/utils/types/date","css!csui/controls/table/cells/date/impl/date"],function(e,i,t,s){"use strict";var n=i.extend({"className":"csui-nowrap","needsAriaLabel":!0,"constructor":function(){i.prototype.constructor.apply(this,arguments)},"formatFunction":function(e,i){return i&&i.includeTime?s.formatExactDateTime(e):s.formatExactDate(e)},"getValueData":function(){function e(e){return n(e,s)}var i=this.options.column,t=this.model.get(i.name),s={"includeTime":!1!==i.attributes.include_time},n=this.formatFunction;return this.getSingleOrMultipleValueData(t,e,e)},"getValueText":function(){return this.getValueData().formattedValue}},{"flexibleWidth":!0,"columnClassName":"csui-table-cell-date","getValue":function(e,t){var n=i.getValue(e,t);return n&&s.deserializeDate(n)}});return t.registerByDataType(-7,n),n}),csui.define("csui/controls/table/cells/datetime/datetime.view",["csui/controls/table/cells/date/date.view","csui/controls/table/cells/cell.registry","csui/utils/base"],function(e,i,t){var s=e.extend({"formatFunction":t.formatDateTime});return i.registerByDataType(401,s),s}),csui.define("hbs!csui/controls/table/cells/duedate/duedate",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"1":function(e,i,t,s){var n;return'  <span class="cellview_warning" title="'+this.escapeExpression((n=null!=(n=i.value||(null!=e?e.value:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"value","hash":{}}):n))+'">'+this.escapeExpression((n=null!=(n=i.formattedValue||(null!=e?e.formattedValue:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"formattedValue","hash":{}}):n))+"</span>\r\n"},"3":function(e,i,t,s){var n;return'  <span title="'+this.escapeExpression((n=null!=(n=i.value||(null!=e?e.value:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"value","hash":{}}):n))+'">'+this.escapeExpression((n=null!=(n=i.formattedValue||(null!=e?e.formattedValue:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"formattedValue","hash":{}}):n))+"</span>\r\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){var n;return null!=(n=i.if.call(e,null!=e?e.pastDueDate:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.program(3,s,0)}))?n:""}});return t.registerPartial("csui_controls_table_cells_duedate_duedate",s),s}),csui.define("csui/controls/table/cells/duedate/duedate.view",["csui/lib/underscore","csui/controls/table/cells/date/date.view","csui/controls/table/cells/cell.registry","csui/utils/base","hbs!csui/controls/table/cells/duedate/duedate"],function(e,i,t,s,n){var o=i.extend({"template":n,"formatFunction":s.formatDateTime,"getValueData":function(){var t=this.model.get(this.options.column.name);return e.extend(i.prototype.getValueData.call(this),{"pastDueDate":new Date(t)<new Date})}});return t.registerByColumnKey("date_due",o),o}),
csui.define("csui/controls/table/cells/member/member.view",["csui/lib/underscore","csui/controls/table/cells/cell/cell.view","csui/controls/table/cells/cell.registry","csui/utils/base"],function(e,i,t,s){"use strict";var n=i.extend({"className":"csui-truncate","needsAriaLabel":!0,"getValueText":function(){return n.getValue(this.model,this.options.column)}},{"getValue":function(i,t){var n=t.name,o=i.get(n+"_expand")||i.get(n)||"";return e.isObject(o)?s.formatMemberName(o):i.get(n+"_formatted")||o.toString()},"getModelExpand":function(e){return{"properties":[e.column.name]}}});return t.registerByDataType(14,n),t.registerByDataType(19,n),t.registerByColumnKey("owner_id",n),n}),csui.define("hbs!csui/controls/table/cells/node.state/impl/reservation/reservation",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"1":function(e,i,t,s){var n,o;return(null!=(n=i.if.call(e,null!=e?e.canUnreserve:e,{"name":"if","hash":{},"fn":this.program(2,s,0),"inverse":this.noop}))?n:"")+'  <span class="icon '+this.escapeExpression((o=null!=(o=i.iconPrefix||(null!=e?e.iconPrefix:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"iconPrefix","hash":{}}):o))+"_"+(null!=(n=i.if.call(e,null!=e?e.isReservedByOther:e,{"name":"if","hash":{},"fn":this.program(4,s,0),"inverse":this.program(6,s,0)}))?n:"")+'"\r\n        title="'+this.escapeExpression((o=null!=(o=i.reservedTooltip||(null!=e?e.reservedTooltip:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"reservedTooltip","hash":{}}):o))+'"></span>\r\n'+(null!=(n=i.if.call(e,null!=e?e.canUnreserve:e,{"name":"if","hash":{},"fn":this.program(8,s,0),"inverse":this.noop}))?n:"")},"2":function(e,i,t,s){var n;return'    <button type="button" aria-label="'+this.escapeExpression((n=null!=(n=i.reservedAria||(null!=e?e.reservedAria:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"reservedAria","hash":{}}):n))+'">\r\n'},"4":function(e,i,t,s){return"other"},"6":function(e,i,t,s){return"self"},"8":function(e,i,t,s){return"    </button>\r\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){var n;return null!=(n=i.if.call(e,null!=e?e.isReserved:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?n:""}});return t.registerPartial("csui_controls_table_cells_node.state_impl_reservation_reservation",s),s}),csui.define("csui/controls/table/cells/node.state/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/table/cells/node.state/nls/root/lang",{"reservedTooltip":"Reserved by {0}\r\n{1}","reservedAria":"Reserved by {0} at {1}, click to unreserve","reservedSharedCollaborationTooltip":"Shared for collaboration by {0}\r\n{1}","reservedSharedCollaborationAria":"Shared for collaboration by {0} at {1}","reserved_attribute_title":"Reserved","reserved_attribute_name":"reserved","reserved_shared_collaboration_attribute_title":"Shared for collaboration","reserved_shared_collaboration_attribute_name":"reserved_shared_collaboration"}),csui.define("css!csui/controls/table/cells/node.state/impl/reservation/reservation",[],function(){}),csui.define("csui/controls/table/cells/node.state/impl/reservation/reservation.view",["csui/lib/underscore","csui/lib/marionette","csui/utils/base","csui/utils/contexts/factories/user","csui/models/nodes","csui/utils/commands","csui/utils/commandhelper","hbs!csui/controls/table/cells/node.state/impl/reservation/reservation","i18n!csui/controls/table/cells/node.state/nls/lang","css!csui/controls/table/cells/node.state/impl/reservation/reservation"],function(e,i,t,s,n,o,l,r,a){"use strict";return i.ItemView.extend({"tagName":"li","className":"csui-node-state-reservation","template":r,"triggers":{"click button":"remove:reservation"},"constructor":function(){i.ItemView.prototype.constructor.apply(this,arguments);var e=this.options.context.getModel(s);this.userId=e.get("id"),this.unreserveCommand=o.get("UnreserveDoc"),this.commandStatus={"nodes":new n([this.model]),"context":this.options.context};var t=this.model.actions;t&&this.listenTo(t,"update",function(){this._isDestroyed||this.render()})},"templateHelpers":function(){var i,s,n,o=this._getReservedStatus(),l=o.isReserved,r=o.isSharedCollaboration,c=o.reservedBy;if(l){var u=t.formatExactDate(this.model.get("reserved_date")),d=t.formatMemberName(c);r?(i=a.reservedSharedCollaborationTooltip,s=a.reservedSharedCollaborationAria):(i=a.reservedTooltip,s=a.reservedAria),i=e.str.sformat(i,d,u),s=e.str.sformat(s,d,u),n=r?"icon-shared_collaborate":"icon-reserved"}return this._reservedStatus={"isReserved":l,"isSharedCollaboration":r,"isReservedByOther":c&&this.userId!==c.id,"canUnreserve":o.canUnreserve,"reservedTooltip":i,"reservedAria":s,"iconPrefix":n},this._reservedStatus},"onRemoveReservation":function(e){if(this._reservedStatus.canUnreserve){var i=this.unreserveCommand,t=i.execute(this.commandStatus);l.handleExecutionResults(t,{"command":i,"suppressSuccessMessage":this.commandStatus.suppressSuccessMessage,"suppressFailMessage":this.commandStatus.suppressFailMessage})}},"_getReservedStatus":function(){var e=this.model.get("reserved"),i=this.model.get("reserved_shared_collaboration"),t=this.model.get("reserved_user_id_expand"),s=!i&&this.unreserveCommand.enabled(this.commandStatus);return t||(t=this.model.get("reserved_user_id"))&&"number"==typeof t&&(t={"id":t}),{"isReserved":e&&void 0!==t||i,"isSharedCollaboration":i,"reservedBy":t,"canUnreserve":s}},"getAttributes":function(){var e,i,t=this.templateHelpers();return t.isSharedCollaboration?(e=a.reserved_shared_collaboration_attribute_title,i=a.reserved_shared_collaboration_attribute_name):(e=a.reserved_attribute_title,i=a.reserved_attribute_name),[{"label":e,"value":t.isReserved,"name":i,"tooltip":t.reservedTooltip,"aria":t.reservedAria}]}},{"enabled":function(e){var i=e.node,t=i.get("reserved"),s=i.get("reserved_shared_collaboration"),n=i.get("reserved_user_id");return t&&n||s},"getModelExpand":function(e){return{"properties":["reserved_user_id"]}}})}),csui.define("csui/controls/table/cells/node.state/node.state.icons",["csui/lib/underscore","csui/lib/backbone","csui/controls/table/cells/node.state/impl/reservation/reservation.view","csui-ext!csui/controls/table/cells/node.state/node.state.icons"],function(e,i,t,s){"use strict";var n=i.Model.extend({"defaults":{"sequence":100,"iconView":null,"iconViewOptions":null},"constructor":function(e,t){i.Model.prototype.constructor.apply(this,arguments)}}),o=i.Collection.extend({"model":n,"comparator":"sequence","constructor":function(e,t){i.Collection.prototype.constructor.apply(this,arguments)}}),l=new o;return s&&(s=e.flatten(s,!0),l.add(s)),l}),csui.define("csui/controls/table/cells/node.state/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/table/cells/node.state/impl/nls/root/lang",{"stateListAria":"List of states","someStateIconsAria":"State available","noStateIconsAria":"No state","bool_value_true":"true","bool_value_false":"false"}),csui.define("css!csui/controls/table/cells/node.state/impl/node.state",[],function(){}),csui.define("csui/controls/table/cells/node.state/node.state.view",["module","csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/utils/log","csui/utils/base","csui/controls/table/cells/cell/cell.view","csui/controls/table/cells/cell.registry","csui/controls/table/cells/node.state/node.state.icons","csui/models/mixins/v2.fields/v2.fields.mixin","i18n!csui/controls/table/cells/node.state/impl/nls/lang","css!csui/controls/table/cells/node.state/impl/node.state"],function(e,i,t,s,n,o,l,r,a,c,u){"use strict";var d=/\baccessibleTable\b(?:=([^&]*)?)?/i.exec(location.search);d=d&&"false"!==d[1],n=n(e.id);var h=s.CollectionView.extend({"tagName":"ul","attributes":{"aria-label":u.stateListAria},"getChildView":function(e){return e.get("iconView")},"childViewOptions":function(e){return i.extend({"context":this.options.context,"model":this.options.node,"tableView":this.options.tableView},e.get("iconViewOptions"))}}),p=l.extend({"needsAriaLabel":!0,"events":{"focus":"_disengageKeyTrap","keydown":"_handleKeys","keyup":"_trapKeys"},"constructor":function(e){l.prototype.constructor.apply(this,arguments),this.cellRegion=new s.Region({"el":this.el}),this.listenTo(this,"before:render",this._rememberFocus).listenTo(this,"before:render",this._disengageKeyTrap).listenTo(this,"before:render",this._destroyStateIcons).listenTo(this,"render",this._restoreFocus).listenTo(this,"before:destroy",this._disengageKeyTrap).listenTo(this,"before:destroy",this._destroyStateIcons)},"_destroyStateIcons":function(){this.cellRegion.empty()},"_getEnabledNodeStateIcons":function(){var e;return e=Object.getPrototypeOf(a),new e.constructor(a.filter(function(e){var i=e.get("iconView");return i&&(!i.enabled||i.enabled({"context":this.options.context,"node":this.model}))},this))},"renderValue":function(){var e=this._getEnabledNodeStateIcons();if(e.length){var i=new h({"context":this.options.context,"node":this.model,"tableView":this.options.tableView,"collection":e});this.cellRegion.show(i)}else this._renderEmpty()},"getAriaLabel":function(){return this.cellRegion.currentView?u.someStateIconsAria:u.noStateIconsAria},"getAttributes":function(){var e=this,t=[];return this._getEnabledNodeStateIcons().each(function(s){var n=s.get("iconView"),o=new n({"context":e.options.context,"model":e.model});i.isFunction(o.getAttributes)&&(t=t.concat(o.getAttributes()))}),i.each(t,function(e){i.isBoolean(e.value)&&(e.value=!0===e.value?u.bool_value_true:u.bool_value_false)}),t},"_renderEmpty":function(){d&&t("<span>",{"title":u.noStateIconsAria}).text(u.noStateIconsAria).appendTo(this.$el)},"_handleKeys":function(e){"Enter"===e.key?e.target===this.el&&(e.preventDefault(),this._disengageKeyTrap(),this._engageKeyTrap()):this._hasEngagedKeyTrap()&&("Escape"===e.key?(this._disengageKeyTrap(),this.el.focus()):"ArrowLeft"===e.key?(e.preventDefault(),e.stopPropagation(),this._moveFocus(-1)):"ArrowRight"===e.key?(e.preventDefault(),e.stopPropagation(),this._moveFocus(1)):this._trapKeys(e))},"_trapKeys":function(e){!this._hasEngagedKeyTrap()||"ArrowUp"!==e.key&&"ArrowDown"!==e.key&&"Tab"!==e.key||(e.preventDefault(),e.stopPropagation())},"_rememberFocus":function(){this._focusTrapped=this.el.contains(document.activeElement)&&this._hasEngagedKeyTrap()},"_restoreFocus":function(){this._focusTrapped&&this._engageKeyTrap()},"_engageKeyTrap":function(){var e=o.findFocusables(this.el);e.length&&(this._keysTrapped=!0,e[0].focus())},"_disengageKeyTrap":function(){this._hasEngagedKeyTrap()&&(this._keysTrapped=!1)},"_hasEngagedKeyTrap":function(){return this._keysTrapped},"_moveFocus":function(e){var i=o.findFocusables(this.el),t=i.length-1,s=i.index(document.activeElement)+e;s<0?s=t:s>t&&(s=0),s=i[s],s?s.focus():n.warn("Focusable elements were unexpectedly removed from {0} ({1}).",n.getObjectName(this),this.cid)&&console.warn(n.last)}},{"columnClassName":"csui-table-cell-node-state","flexibleWidth":!0,"getModelFields":function(e){return a.reduce(function(i,t){var s=t.get("iconView");if(s&&s.getModelFields){var n=s.getModelFields(e);n&&c.mergePropertyParameters(i,n)}return i},{})},"getModelExpand":function(e){return a.reduce(function(i,t){var s=t.get("iconView");if(s&&s.getModelExpand){var n=s.getModelExpand(e);n&&c.mergePropertyParameters(i,n)}return i},{})}});return r.registerByColumnKey("reserved",p),r.registerByOtherColumnKey("reserved_user_id",p),p}),csui.define("csui/controls/table/cells/parent/impl/parent.base.view",["csui/lib/underscore","csui/lib/marionette","csui/behaviors/default.action/default.action.behavior","csui/utils/defaultactionitems","csui/utils/commands"],function(e,i,t,s,n){"use strict";return i.ItemView.extend({"behaviors":{"DefaultAction":{"behaviorClass":t}},"constructor":function(e){i.ItemView.prototype.constructor.apply(this,arguments),this.listenTo(this,"cell:node:request",function(){if(this.model.actions.length>0)this.triggerMethod("execute:defaultAction",this.model);else{this.model.resetCommands(),this.model.setCommands(s.getAllCommandSignatures(n));var e=this;this.model.fetch().done(function(){e.triggerMethod("execute:defaultAction",e.model)})}})}})}),csui.define("hbs!csui/controls/table/cells/parent/impl/parent.with.icon",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){var n;return'<a href="'+this.escapeExpression((n=null!=(n=i.defaultActionUrl||(null!=e?e.defaultActionUrl:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"defaultActionUrl","hash":{}}):n))+'" class="csui-parent-name" title="'+this.escapeExpression((n=null!=(n=i.name||(null!=e?e.name:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"name","hash":{}}):n))+'">'+this.escapeExpression((n=null!=(n=i.name||(null!=e?e.name:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"name","hash":{}}):n))+"</a>\r\n"}});return t.registerPartial("csui_controls_table_cells_parent_impl_parent.with.icon",s),s}),csui.define("css!csui/controls/table/cells/parent/impl/parent.with.icon",[],function(){}),csui.define("csui/controls/table/cells/parent/impl/parent.with.icon.view",["csui/lib/underscore","csui/utils/node.links/node.links","csui/controls/node-type.icon/node-type.icon.view","csui/controls/table/cells/parent/impl/parent.base.view","hbs!csui/controls/table/cells/parent/impl/parent.with.icon","css!csui/controls/table/cells/parent/impl/parent.with.icon"],function(e,i,t,s,n){"use strict";return s.extend({"template":n,"className":"csui-parent-location","triggers":{"click a.csui-parent-name":"cell:node:request","click .cs-icon-group":"cell:node:request"},"templateHelpers":function(){return{"name":this.model.get("name"),"defaultActionUrl":i.getUrl(this.model)}},"constructor":function(e){s.prototype.constructor.apply(this,arguments),this.iconView=new t({"node":this.model})},"onRender":function(){this.iconView.render(),this.$el.prepend(this.iconView.$el)}})}),csui.define("csui/controls/table/cells/parent/impl/parent.with.text.view",["csui/lib/underscore","csui/utils/node.links/node.links","csui/controls/table/cells/parent/impl/parent.base.view"],function(e,i,t){"use strict";return t.extend({"tagName":"a","attributes":function(){return{"title":this.model.get("name"),"href":i.getUrl(this.model)}},"template":!1,"triggers":{"click":"cell:node:request"},"constructor":function(e){t.prototype.constructor.apply(this,arguments)},"onRender":function(){this.el.textContent=this.model.get("name")}})}),csui.define("csui/controls/table/cells/parent/parent.view",["csui/lib/underscore","csui/lib/marionette","csui/models/node/node.model","csui/controls/table/cells/cell/cell.view","csui/controls/table/cells/cell.registry","csui/controls/table/cells/parent/impl/parent.with.icon.view","csui/controls/table/cells/parent/impl/parent.with.text.view"],function(e,i,t,s,n,o,l){"use strict";var r=s.extend({"events":{"keydown":"onKeyInView"},"constructor":function(e){s.prototype.constructor.apply(this,arguments);var n=this.model.get("parent_id_expand")||this.model.get("parent_id")||this.model.get("location_id_expand")||this.model.get("location_id");153===this.model.get("type")&&(n=this.model.get("workflow_id_expand")||this.model.get("workflow_id")),this.parentModel=new t(n,{"connector":this.model.connector}),this.parentIconView=new o({"model":this.parentModel,"context":this.options.context}),this.parentTextView=new l({"model":this.parentModel,"context":this.options.context}),this.contentRegion=new i.Region({"el":this.el})},"renderValue":function(){this.contentRegion.show(this.parentIconView)},"getValueText":function(){return this.parentModel.get("name")},"getContentView":function(){return this.parentIconView}},{"getModelExpand":function(e){return{"properties":["parent_id"]}}});return n.registerByColumnKey("parent_id",r),n.registerByColumnKey("location_id",r),r}),csui.define("csui/controls/table/cells/priority/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/table/cells/priority/impl/nls/root/lang",{"priority_name_high":"High","priority_name_medium":"Medium","priority_name_low":"Low"}),csui.define("hbs!csui/controls/table/cells/priority/impl/priority",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"1":function(e,i,t,s){return'  <span class="icon icon-priorityHigh"></span>\r\n'},"3":function(e,i,t,s){return'  <span class="icon icon-priorityMedium"></span>\r\n'},"5":function(e,i,t,s){return'  <span class="icon icon-priorityLow"></span>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){var n,o;return(null!=(n=i.if.call(e,null!=e?e.priority_high:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?n:"")+(null!=(n=i.if.call(e,null!=e?e.priority_medium:e,{"name":"if","hash":{},"fn":this.program(3,s,0),"inverse":this.noop}))?n:"")+(null!=(n=i.if.call(e,null!=e?e.priority_low:e,{"name":"if","hash":{},"fn":this.program(5,s,0),"inverse":this.noop}))?n:"")+'<span title="'+this.escapeExpression((o=null!=(o=i.priority_name||(null!=e?e.priority_name:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"priority_name","hash":{}}):o))+'">'+this.escapeExpression((o=null!=(o=i.priority_name||(null!=e?e.priority_name:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"priority_name","hash":{}}):o))+"</span>\r\n"}});return t.registerPartial("csui_controls_table_cells_priority_impl_priority",s),s}),csui.define("css!csui/controls/table/cells/priority/impl/priority",[],function(){}),csui.define("csui/controls/table/cells/priority/priority.view",["csui/controls/table/cells/templated/templated.view","csui/controls/table/cells/cell.registry","i18n!csui/controls/table/cells/priority/impl/nls/lang","hbs!csui/controls/table/cells/priority/impl/priority","css!csui/controls/table/cells/priority/impl/priority"],function(e,i,t,s){"use strict";var n=e.extend({"template":s,"needsAriaLabel":!0,"getValueData":function(){var e=this._getPriorityObject();return{"priority":e.priority,"priority_name":e.priority_name,"priority_high":e.priority_high,"priority_medium":e.priority_medium,"priority_low":e.priority_low}},"getValueText":function(){return this._getPriorityObject().priority_name},"_getPriorityObject":function(){var e={};e.priority=this.model.get(this.options.column.name);var i,s=this.model.get(this.options.column.name+"_name");return e.priority_high=!1,e.priority_medium=!1,e.priority_low=!1,e.priority>50?(e.priority_high=!0,i=t.priority_name_high):50===e.priority?(e.priority_medium=!0,i=t.priority_name_medium):e.priority<50&&(e.priority_low=!0,i=t.priority_name_low),e.priority_name=i||s,e}},{"hasFixedWidth":!0,"columnClassName":"csui-table-cell-priority"});return i.registerByColumnKey("priority",n),n}),csui.define("css!csui/controls/table/cells/select/impl/select.view",[],function(){}),csui.define("csui/controls/table/cells/select/select.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/controls/checkbox/checkbox.view","csui/controls/table/cells/cell/cell.view","csui/controls/table/cells/cell.registry","i18n!csui/controls/table/impl/nls/lang","css!csui/controls/table/cells/select/impl/select.view"],function(e,i,t,s,n,o,l,r){var a=o.extend({"constructor":function(e){a.__super__.constructor.apply(this,arguments)},"renderValue":function(){var i=this;this.$el.empty();var t=!0===this.model.get(a.isSelectedModelAttributeName),o=e.str.sformat(r.selectItem,this.model.get("name")),l=e.str.sformat(r.selectItemAria,this.model.get("name")),c=!1!==this.model.get("selectable");this.checkboxView=new n({"checked":t?"true":"false","disabled":!c,"ariaLabel":l,"title":o}),new s.Region({"el":this.el}).show(this.checkboxView);var u=this.checkboxView.model;this.listenTo(this.model,"change:"+a.isSelectedModelAttributeName,function(e,i,t){this.checkboxView.setChecked(i)}),this.checkboxView.listenTo(this.checkboxView,"clicked",function(e){e.cancel=!0;var t=u.get("checked");i.triggerMethod("clicked:checkbox",{"checked":t})})}},{"columnKey":"_select","hasFixedWidth":!0,"columnClassName":"csui-table-cell-_select","isSelectedModelAttributeName":"csuiIsSelected"});return l.registerByColumnKey(a.columnKey,a),a}),csui.define("hbs!csui/controls/table/cells/toggledetails/impl/toggledetails",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"1":function(e,i,t,s){var n,o;return'  <a class="expand-details-row-toggle" title="'+this.escapeExpression((o=null!=(o=i.expandToggleTooltip||(null!=e?e.expandToggleTooltip:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"expandToggleTooltip","hash":{}}):o))+'" aria-label="'+this.escapeExpression((o=null!=(o=i.expandToggleAria||(null!=e?e.expandToggleAria:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"expandToggleAria","hash":{}}):o))+'"\r\n     href="#csui-details-row-'+this.escapeExpression((o=null!=(o=i.id||(null!=e?e.id:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"id","hash":{}}):o))+'" data-binf-toggle="collapse" aria-expanded="false"\r\n     aria-controls="csui-details-row-'+this.escapeExpression((o=null!=(o=i.id||(null!=e?e.id:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"id","hash":{}}):o))+'">\r\n'+(null!=(n=i.if.call(e,null!=e?e.rowIsExpanded:e,{"name":"if","hash":{},"fn":this.program(2,s,0),"inverse":this.program(4,s,0)}))?n:"")+"  </a>\r\n"},"2":function(e,i,t,s){return'      <span class="csui-button-icon icon-expandArrowUp"></span>\r\n'},"4":function(e,i,t,s){return'      <span class="csui-button-icon icon-expandArrowDown"></span>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){var n;return null!=(n=i.if.call(e,null!=e?e.hasMetadataRow:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?n:""}});return t.registerPartial("csui_controls_table_cells_toggledetails_impl_toggledetails",s),s}),csui.define("csui/controls/table/cells/toggledetails/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/table/cells/toggledetails/impl/nls/root/lang",{"expandAllTooltip":"Show all","expandAllAria":"Show more details of all items","collapseAllTooltip":"Show less","collapseAllAria":"Show less details of all items","showMoreTooltip":"Show more","showMoreAria":"Show more details","showLessTooltip":"Show less","showLessAria":"Show less details"}),csui.define("css!csui/controls/table/cells/toggledetails/impl/toggledetails",[],function(){}),csui.define("csui/controls/table/cells/toggledetails/toggledetails.view",["csui/controls/table/cells/templated/templated.view","csui/controls/table/cells/cell.registry","hbs!csui/controls/table/cells/toggledetails/impl/toggledetails","i18n!csui/controls/table/cells/toggledetails/impl/nls/lang","css!csui/controls/table/cells/toggledetails/impl/toggledetails","csui/lib/binf/js/binf"],function(e,i,t,s){"use strict";var n=e.extend({"template":t,"triggers":{"click a":"toggle"},"events":{"keydown":"onKeyInView"},"getValueData":function(){return{"hasMetadataRow":this.model.get("hasMetadataRow"),"id":this.model.cid,"rowIsExpanded":this.options.rowIsExpanded,"expandToggleTooltip":this.options.rowIsExpanded?s.showLessTooltip:s.showMoreTooltip,"expandToggleAria":this.options.rowIsExpanded?s.showLessAria:s.showMoreAria}},"onToggle":function(e){var i=this.$("a").attr("href"),t=this.$el.parent().parent().find("[id="+i.replace("#","")+"]"),s=this;t.hasClass("binf-collapse")&&(this.options.rowIsExpanded=!1,t.hasClass("binf-in")?t.binf_collapse("hide").on("hidden.binf.collapse",function(){s.trigger("toggle:detailsrow",{"model":s.model,"detailsRowIsExpanded":s.options.rowIsExpanded})}):(t.binf_collapse("show"),this.options.rowIsExpanded=!0),this.trigger("toggle:detailsrow",{"model":this.model,"detailsRowIsExpanded":this.options.rowIsExpanded}),this.render())}},{"hasFixedWidth":!0,"columnClassName":"csui-table-cell-_toggledetails","rowIsExpandedModelAttributeName":"csui-toggledetails-rowIsExpanded","widthFactor":1/3});return i.registerByColumnKey("_toggledetails",n),n}),csui.define("csui/controls/table/cells/size/impl/nls/localized.strings",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/table/cells/size/impl/nls/root/localized.strings",{"ColumnTitle":"Size","containerSize":{"formatForNone":"{0} items","formatForOne":"{0} item","formatForTwo":"{0} items","formatForFive":"{0} items"},"sizeUnavailable":"No size","sizeUnavailableAria":"Size unavailable for {0}"}),csui.define("css!csui/controls/table/cells/size/impl/size",[],function(){}),csui.define("csui/controls/table/cells/size/size.view",["csui/lib/underscore","csui/controls/table/cells/templated/templated.view","csui/controls/table/cells/cell.registry","csui/utils/base","i18n!csui/controls/table/cells/size/impl/nls/localized.strings","css!csui/controls/table/cells/size/impl/size"],function(e,i,t,s,n){"use strict";var o=/\baccessibleTable\b(?:=([^&]*)?)?/i.exec(location.search);o=o&&"false"!==o[1];var l=i.extend({"className":"csui-nowrap","needsAriaLabel":!0,"getValueData":function(){var e,t=this.model,l=this.options.column,r=l.name,a=t.get(r),c=t.get("type");if(null==a){if(!o)return i.prototype.getValueData.apply(this,arguments);a=e=n.sizeUnavailable}else if(t.get("container"))a=e=899!==c&&411!==c?t.get(r+"_formatted"):"",o&&!a&&(a=e=n.sizeUnavailable);else{if(144!==c&&749!==c&&736!==c&&30309!==c)return i.prototype.getValueData.apply(this,arguments);e=s.formatFriendlyFileSize(a),a=s.formatExactFileSize(a)}return{"value":a,"formattedValue":e}},"getValueText":function(){var e=this.getValueData();return e&&e.formattedValue||e.value},"getTooltipValueText":function(){var e=this.getValueData();return e&&e.value||this.getValueText()},"getAriaLabel":function(){var i=this.getValueData();return i&&i.value||e.str.sformat(n.sizeUnavailableAria,this.model.get("type_name"))}},{"flexibleWidth":!0,"columnClassName":"csui-table-cell-size"});return t.registerByColumnKey("size",l),t.registerByColumnKey("container_size",l),t.registerByColumnKey("file_size",l),l}),csui.define("hbs!csui/controls/table/cells/status/impl/status",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"1":function(e,i,t,s){var n;return'  <span class="cellview_warning" title="'+this.escapeExpression((n=null!=(n=i.status_name||(null!=e?e.status_name:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"status_name","hash":{}}):n))+'">'+this.escapeExpression((n=null!=(n=i.status_name||(null!=e?e.status_name:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"status_name","hash":{}}):n))+"</span>\r\n"},"3":function(e,i,t,s){var n;return'  <span title="'+this.escapeExpression((n=null!=(n=i.status_name||(null!=e?e.status_name:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"status_name","hash":{}}):n))+'">'+this.escapeExpression((n=null!=(n=i.status_name||(null!=e?e.status_name:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"status_name","hash":{}}):n))+"</span>\r\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){var n;return null!=(n=i.if.call(e,null!=e?e.status_late:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.program(3,s,0)}))?n:""}});return t.registerPartial("csui_controls_table_cells_status_impl_status",s),s}),csui.define("csui/controls/table/cells/status/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/table/cells/status/impl/nls/root/lang",{"status_name_206_0":"Pending","status_name_206_1":"In Progress","status_name_206_2":"Issue","status_name_206_3":"On Hold","status_name_153_1":"OK","status_name_153_2":"Halted","status_name_153_3":"Step Late","status_name_153_4":"Milestone Late","status_name_153_5":"Late","status_name_153_6":"Suspended","status_name_153_7":"Completed","status_name_153_8":"Stopped","status_name_153_9":"Archived","status_name_153_10":"Subwork Late"}),csui.define("css!csui/controls/table/cells/status/impl/status",[],function(){}),csui.define("csui/controls/table/cells/status/status.view",["csui/controls/table/cells/templated/templated.view","csui/controls/table/cells/cell.registry","hbs!csui/controls/table/cells/status/impl/status","i18n!csui/controls/table/cells/status/impl/nls/lang","css!csui/controls/table/cells/status/impl/status"],function(e,i,t,s){"use strict";var n=e.extend({"template":t,"needsAriaLabel":!0,"getValueData":function(){var e=this._getStatusName(),i=this.model.get("type"),t=!1;return 153!==i||3!==status&&4!==status&&5!==status&&10!==status||(t=!0),{"status_name":e,"status_late":t}},"getValueText":function(){return this._getStatusName()},"_getStatusName":function(){var e=this.model.get("type"),i=this.model.get(this.options.column.name),t=s["status_name_"+e+"_"+i],n=this.model.get(this.options.column.name+"_name");return t||n}},{"hasFixedWidth":!0,"columnClassName":"csui-table-cell-status"});return i.registerByColumnKey("status",n),n}),csui.define("hbs!csui/widgets/favorites/impl/favorite.star/favorite.add.form",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"1":function(e,i,t,s){var n;return"  <label for=\"grpSelectId\" class='favorite-group-label'>"+this.escapeExpression((n=null!=(n=i.group_label||(null!=e?e.group_label:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"group_label","hash":{}}):n))+"</label>\r\n  <div class='favorite-groups-container'></div>\r\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){var n,o;return'<div role="heading" aria-level="3" aria-label="Add favorite">\r\n<label for="'+this.escapeExpression((o=null!=(o=i.name_input_id||(null!=e?e.name_input_id:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"name_input_id","hash":{}}):o))+"\" class='favorite-name-label'>"+this.escapeExpression((o=null!=(o=i.name_label||(null!=e?e.name_label:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"name_label","hash":{}}):o))+'</label>\r\n<input id="'+this.escapeExpression((o=null!=(o=i.name_input_id||(null!=e?e.name_input_id:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"name_input_id","hash":{}}):o))+"\" class='favorite-name-input binf-form-control' type='text' placeholder='"+this.escapeExpression((o=null!=(o=i.name_place_holder||(null!=e?e.name_place_holder:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"name_place_holder","hash":{}}):o))+"' value='"+this.escapeExpression((o=null!=(o=i.favorite_name||(null!=e?e.favorite_name:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"favorite_name","hash":{}}):o))+"'>\r\n<div class='favorite-name-input-error-div'>\r\n  <span class='favorite-name-input-error'></span>\r\n</div>\r\n\r\n"+(null!=(n=i.if.call(e,null!=e?e.groups:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?n:"")+"\r\n<div class='favorite-buttons-container'>\r\n  <button title=\""+this.escapeExpression((o=null!=(o=i.add_button_label||(null!=e?e.add_button_label:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"add_button_label","hash":{}}):o))+"\" class='add-btn binf-btn binf-btn-primary binf-btn-default'>"+this.escapeExpression((o=null!=(o=i.add_button_label||(null!=e?e.add_button_label:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"add_button_label","hash":{}}):o))+'</button>\r\n  <button title="'+this.escapeExpression((o=null!=(o=i.cancel_button_label||(null!=e?e.cancel_button_label:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"cancel_button_label","hash":{}}):o))+"\" class='cancel-btn binf-btn binf-btn-default'>"+this.escapeExpression((o=null!=(o=i.cancel_button_label||(null!=e?e.cancel_button_label:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"cancel_button_label","hash":{}}):o))+"</button>\r\n</div>\r\n</div>\r\n"}});return t.registerPartial("csui_widgets_favorites_impl_favorite.star_favorite.add.form",s),s}),csui.define("hbs!csui/widgets/favorites/impl/favorite.star/favorite.add.form.group",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){var n
;return'<a href="#" tabindex="-1">\r\n  <span class="favorite_group" title="'+this.escapeExpression((n=null!=(n=i.name||(null!=e?e.name:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"name","hash":{}}):n))+'">'+this.escapeExpression((n=null!=(n=i.name||(null!=e?e.name:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"name","hash":{}}):n))+"</span>\r\n</a>\r\n"}});return t.registerPartial("csui_widgets_favorites_impl_favorite.star_favorite.add.form.group",s),s}),csui.define("hbs!csui/widgets/favorites/impl/favorite.star/favorite.add.form.groups",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){return'<button id="grpSelectId" type="button" class="binf-btn binf-btn-default binf-dropdown-toggle"\r\n        data-binf-toggle="dropdown" aria-haspopup="true" aria-expanded="false">\r\n  <span class="selected-group-label"></span>\r\n  <span class="cs-icon icon-caret-down"></span>\r\n</button>\r\n<div class="binf-dropdown-menu favorite-groups-dropdown-container" role="menu">\r\n  <ul class="favorite-groups-dropdown"></ul>\r\n</div>\r\n'}});return t.registerPartial("csui_widgets_favorites_impl_favorite.star_favorite.add.form.groups",s),s}),csui.define("csui/widgets/favorites/impl/favorite.star/favorite.add.form.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/controls/mixins/layoutview.events.propagation/layoutview.events.propagation.mixin","csui/behaviors/dropdown.menu/dropdown.menu.behavior","csui/controls/tile/behaviors/perfect.scrolling.behavior","csui/utils/namedsessionstorage","hbs!csui/widgets/favorites/impl/favorite.star/favorite.add.form","hbs!csui/widgets/favorites/impl/favorite.star/favorite.add.form.group","hbs!csui/widgets/favorites/impl/favorite.star/favorite.add.form.groups","i18n!csui/widgets/favorites/impl/nls/lang"],function(e,i,t,s,n,o,l,r,a,c,u,d){var h=new r,p=s.ItemView.extend({"tagName":"li","attributes":function(){return{"role":"menuitem"}},"template":c,"triggers":{"click a":"click:item"},"constructor":function(e){s.ItemView.prototype.constructor.apply(this,arguments)}}),m=s.CompositeView.extend({"className":"favorite-groups-dropdown-container binf-dropdown","template":u,"behaviors":{"PerfectScrolling":{"behaviorClass":l,"contentParent":".favorite-groups-dropdown","suppressScrollX":!0},"DropdownMenuBehavior":{"behaviorClass":o}},"ui":{"toggle":">.binf-dropdown-toggle","selectedLabel":">.binf-btn >.selected-group-label","groupsScrollbarContainer":".favorite-groups-dropdown"},"events":{"shown.binf.dropdown":"onShownDropdown"},"childViewContainer":".favorite-groups-dropdown","childView":p,"childEvents":{"click:item":"onClickItem","render":"_onChildRender"},"_onChildRender":function(e){var i=e.$el;e.model.get("tab_id")===this.options.favModel.get("tab_id")&&i.addClass("binf-active")},"constructor":function(e){s.CompositeView.call(this,e)},"onRender":function(){var e=this.options.collection.findWhere({"tab_id":this.options.favModel.get("tab_id")}),i=e.get("name");this.ui.selectedLabel.text(i),this.ui.selectedLabel.attr("title",i),this.ui.toggle.attr("aria-label",d.addFavoriteGroupLabel+" - "+i),this.ui.toggle.binf_dropdown()},"onClickItem":function(e){this.$el.find("ul li").removeClass("binf-active"),e.$el.addClass("binf-active"),this.ui.toggle.binf_dropdown("toggle"),this.ui.toggle.focus();var i=e.model.get("tab_id");this.options.favModel.set("tab_id",i);var t=e.model.get("name");this.ui.selectedLabel.text(t),this.ui.selectedLabel.attr("title",t),this.ui.toggle.attr("aria-label",d.addFavoriteGroupLabel+" - "+t),h.set("csuiFavoriteTabID",i)},"_computeDropdownMenuMaxHeight":function(){var e=170,t=this.ui.groupsScrollbarContainer[0];if(!t.getBoundingClientRect)return e;var s=t.getBoundingClientRect();return e=i(window).height()-s.top-16},"onShownDropdown":function(){this.ui.groupsScrollbarContainer.css("max-height",this._computeDropdownMenuMaxHeight()),this.ui.toggle.attr("aria-expanded","true"),this.triggerMethod("dom:refresh")},"closeDropdownMenu":function(){this.$el.hasClass("binf-open")&&(this.ui.toggle.attr("aria-expanded","false"),this.ui.toggle.binf_dropdown("toggle",!1))}}),f=s.LayoutView.extend({"template":a,"templateHelpers":function(){return{"name_label":d.addFavoriteNameLabel,"name_place_holder":d.addFavoriteNamePlaceHolder,"name_input_id":e.uniqueId("nameInp"),"favorite_name":this.options.favModel.get("name"),"groups":this.showGroups,"group_label":d.addFavoriteGroupLabel,"add_button_label":d.addFavoriteAddButtonLabel,"cancel_button_label":d.addFavoriteCancelButtonLabel}},"regions":{"favGroupsRegion":".favorite-groups-container"},"triggers":{"click .add-btn":"click:add:button","click .cancel-btn":"click:cancel:button"},"ui":{"nameInput":".favorite-name-input","nameInputError":".favorite-name-input-error","addButton":".add-btn","cancelButton":".cancel-btn"},"events":{"click @ui.nameInput":"onClickNameInput","keyup":"onKeyupEvent","keyup @ui.nameInput":"onNameInputEvent","blur @ui.nameInput":"onNameInputEvent","keydown @ui.nameInput":"controlsOnKeydownEvent","keydown @ui.addButton":"controlsOnKeydownEvent","keydown @ui.cancelButton":"cancelButtonOnKeydownEvent"},"constructor":function(e){if(s.LayoutView.call(this,e),this.showGroups=!0,1===this.options.collection.length&&-1===this.options.collection.at(0).get("tab_id")&&(this.showGroups=!1),this.showGroups){this.groupsView=new m(e);var i=h.get("csuiFavoriteTabID");this.options.collection.findWhere({"tab_id":i})||(i=-1,h.set("csuiFavoriteTabID",i)),i&&this.options.favModel&&this.options.favModel.set("tab_id",i)}this.propagateEventsToRegions()},"onRender":function(){this.showGroups&&(this.groupsView.render(),this.favGroupsRegion.show(this.groupsView)),this.validateNameInputAndSetAddButtonState(!0)},"currentlyFocusedElement":function(e){return this.ui.nameInput},"showInlineError":function(e){this.ui.nameInputError.attr("title",e),this.ui.nameInputError.text(e)},"clearInlineError":function(){this.ui.nameInputError.attr("title",""),this.ui.nameInputError.text("")},"validateNameInputAndSetAddButtonState":function(e){var i=!1,t=this.ui.nameInput.val();return t=t.trim(),t.length<1?i=!1:t.length>248?!0!==e&&this.showInlineError(d.nameErrorMaxLengthExceed):t.indexOf(":")>=0?!0!==e&&this.showInlineError(d.nameErrorContainSemiColon):(this.clearInlineError(),i=!0),i?(this.options.favModel.set("name",t),this.ui.addButton.prop("disabled",!1)):this.ui.addButton.prop("disabled",!0),i},"cancelButtonOnKeydownEvent":function(e){e&&13===e.keyCode&&(e.preventDefault(),e.stopPropagation(),this.trigger("click:cancel:button"))},"controlsOnKeydownEvent":function(e){e&&13===e.keyCode&&(e.preventDefault(),e.stopPropagation(),this.validateNameInputAndSetAddButtonState()&&this.trigger("click:add:button"))},"onKeyupEvent":function(e){e&&27===e.keyCode&&(e.preventDefault(),this.trigger("click:cancel:button"))},"onNameInputEvent":function(e){if(!e||27!==e.keyCode){this.validateNameInputAndSetAddButtonState()}},"onClickNameInput":function(e){e&&e.stopPropagation(),this.groupsView&&this.groupsView.closeDropdownMenu()}});return e.extend(f.prototype,n),f}),csui.define("hbs!csui/widgets/favorites/impl/favorite.star/favorite.star.view",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"1":function(e,i,t,s){var n;return"  <div class='csui-favorite-star-view-container csui-favorite-popover-container'>\r\n"+(null!=(n=i.if.call(e,null!=e?e.selected:e,{"name":"if","hash":{},"fn":this.program(2,s,0),"inverse":this.program(7,s,0)}))?n:"")+"  </div>\r\n"},"2":function(e,i,t,s){var n,o;return'      <button type="button" class="csui-favorite-star selected csui-acc-focusable"\r\n              '+(null!=(n=i.if.call(e,null!=e?e.focusable:e,{"name":"if","hash":{},"fn":this.program(3,s,0),"inverse":this.program(5,s,0)}))?n:"")+'\r\n               title="'+this.escapeExpression((o=null!=(o=i.removeFav||(null!=e?e.removeFav:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"removeFav","hash":{}}):o))+'" aria-label="'+this.escapeExpression((o=null!=(o=i.removeFav||(null!=e?e.removeFav:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"removeFav","hash":{}}):o))+'">\r\n        <span class="icon icon-socialFav"></span>\r\n      </button>\r\n'},"3":function(e,i,t,s){return'tabindex="0"'},"5":function(e,i,t,s){return'tabindex="-1"'},"7":function(e,i,t,s){var n,o;return'      <button type="button" class="csui-favorite-star csui-acc-focusable"\r\n              '+(null!=(n=i.if.call(e,null!=e?e.focusable:e,{"name":"if","hash":{},"fn":this.program(3,s,0),"inverse":this.program(5,s,0)}))?n:"")+"\r\n              "+(null!=(n=i.unless.call(e,null!=e?e.showInFavoritesTable:e,{"name":"unless","hash":{},"fn":this.program(8,s,0),"inverse":this.noop}))?n:"")+'\r\n               title="'+this.escapeExpression((o=null!=(o=i.addFav||(null!=e?e.addFav:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"addFav","hash":{}}):o))+'" aria-label="'+this.escapeExpression((o=null!=(o=i.addFav||(null!=e?e.addFav:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"addFav","hash":{}}):o))+'">\r\n        <span class="icon icon-socialFavOpen"></span>\r\n      </button>\r\n'},"8":function(e,i,t,s){return'aria-haspopup="dialog"'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){var n;return null!=(n=i.if.call(e,null!=e?e.enabled:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?n:""}});return t.registerPartial("csui_widgets_favorites_impl_favorite.star_favorite.star.view",s),s}),csui.define("css!csui/widgets/favorites/impl/favorite.star/favorite.star.view",[],function(){}),csui.define("csui/widgets/favorites/favorite.star.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/models/favorite.model","csui/dialogs/modal.alert/modal.alert","csui/utils/base","i18n","csui/controls/progressblocker/blocker","csui/utils/contexts/factories/favorite2groups","csui/widgets/favorites/impl/favorite.star/favorite.add.form.view","csui/controls/mixins/keyboard.navigation/modal.keyboard.navigation.mixin","hbs!csui/widgets/favorites/impl/favorite.star/favorite.star.view","i18n!csui/widgets/favorites/impl/nls/lang","css!csui/widgets/favorites/impl/favorite.star/favorite.star.view"],function(e,i,t,s,n,o,l,r,a,c,u,d,h,p){var m=s.ItemView.extend({"template":h,"templateHelpers":function(){return{"enabled":this.enabled(),"showInFavoritesTable":this.favTableOptions.isFavoritesTable,"focusable":this.options.focusable,"addFav":p.addFav,"removeFav":p.removeFav,"selected":this.favModel.get("selected")}},"events":{"keydown":"onKeyInView","click":"_onClickView","click button.csui-favorite-star":"_onClickStarButton","click button > span.icon-socialFav":"_clickRemoveFavoriteStar","click button > span.icon-socialFavOpen":"_clickAddFavoriteStar"},"constructor":function(t){t||(t={}),e.defaults(t,{"formPopoverPlacement":"left","popoverAtBodyElement":!1,"focusable":!0}),this.favTableOptions=t.favoritesTableOptions||{},s.ItemView.call(this,t),t&&t.blockingParentView&&a.delegate(this,t.blockingParentView),this.favGroupsCollection=t.context&&t.context.getCollection(c,{"detached":!0,"permanent":!0});var o=this.model&&this.model.connector,l={};this.model&&(l=e.extend(this._getModelDataForFavoriteModel(),{"selected":this.model.get("favorite")})),this.favModel=new n(l,{"connector":o}),this.listenTo(this.favModel,"change:selected",this.render),this.uniqueViewId="view"+e.uniqueId(),this.popoverContainerClassname="csui-favorite-popover-container "+this.uniqueViewId,this.popoverContainerSelector=".csui-favorite-popover-container."+this.uniqueViewId,i(window).bind("resize."+this.uniqueViewId,{"view":this},this._onWindowResize)},"onBeforeDestroy":function(){this.triggerMethod("close:add:favorite:form"),this.closePopover(),i(window).unbind("resize."+this.uniqueViewId,this._onWindowResize)},"enabled":function(){return!(!this.model||!this.options.context)},"onRender":function(){this._previousFocusElm&&i(this._previousFocusElm).hasClass("csui-favorite-star")&&(this.$el.find("button.csui-favorite-star").focus(),this._previousFocusElm=void 0),this._previousTitle=void 0,this.favGroupsCollection.ensureFetched(),this.delegateEvents()},"_onWindowResize":function(e){if(!l.isTouchBrowser()&&!l.isAppleMobile()&&e&&e.data&&e.data.view){var i=e.data.view;i.showingForm&&i.closePopover()}},"_getPopoverParent":function(){return this.options.popoverAtBodyElement?i(this.popoverContainerSelector):this.$el},"_handleClickEvent":function(e){if(!i(e.target).closest(".binf-popover").length){var t;if(e&&e.data&&e.data.view){if(t=e.data.view,t.commandBlocked)return;i(document).off("click",t._handleClickEvent)}t&&t.closePopover(),t&&t._setBlocked()}},"_handleScrollEvent":function(e){if(!l.isTouchBrowser()&&!l.isAppleMobile()&&!i(e.target).closest(".binf-popover").length){var t;e&&e.data&&e.data.view&&(t=e.data.view,i(document).off("scroll",t._handleScrollEvent)),t&&t.closePopover()}},"_getModelDataForFavoriteModel":function(){var e;return e=this.favTableOptions.isFavoritesTable&&this.favTableOptions.selectedGroup?this.favTableOptions.selectedGroup.get("tab_id"):this.model.get("favorite_tab_id")||-1,{"id":this.model.get("id"),"name":this.model.get("favorite_name")||this.model.get("name"),"tab_id":e}},"_onClickView":function(e){!this.enabled()||this.$el.find(e.target).length>0||this._onClickStarButton(e)},"_onClickStarButton":function(e){this.$el.find("span.icon-socialFav").length>0?this._clickRemoveFavoriteStar(e):this._clickAddFavoriteStar(e)},"_setBlocked":function(){this.commandBlocked=!0,setTimeout(e.bind(function(){this.commandBlocked=!1},this),500)},"_clickAddFavoriteStar":function(e){e&&e.preventDefault(),this.commandBlocked||(0===this._getPopoverParent().find(".binf-popover").length&&this._setBlocked(),this._capturePreviousFocusElement(),this.favModel.set(this._getModelDataForFavoriteModel()),this.favTableOptions.isFavoritesTable?(this._addFavoriteToClientSideCollection(!0),this.favGroupsCollection.trigger("bulk:update")):this._addFavoriteWithForm())},"_clickRemoveFavoriteStar":function(e){e&&e.preventDefault(),e&&e.stopPropagation(),this.commandBlocked||(this._setBlocked(),this._capturePreviousFocusElement(),this.favTableOptions.isFavoritesTable?(this._removeFavoriteFromClientSideCollection(!0),this.favGroupsCollection.trigger("bulk:update")):this._removeFavoriteFromServer())},"_clickAddButton":function(){this.commandBlocked||this._addFavoriteToServer().done(e.bind(function(){this._previousTitle=void 0,this.disengageModalKeyboardFocusOnClose(),this.closePopover(),this._restorePreviousFocusAfterClosingPopover()},this))},"_clickCancelButton":function(){this.closePopover()},"scrollCheckToClosePopover":function(){if(this._elTop){var e=this.$el.offset().top;(this._elTop&&this._elTop<e-15||this._elTop>e+15)&&this.closePopover()}},"_capturePreviousFocusElement":function(){this._previousFocusElm=document.activeElement},"_restorePreviousFocusAfterClosingPopover":function(){if(this._previousFocusElm){var e=i(this._previousFocusElm);e.hasClass("csui-favorite-star")?this.$el.find("button.csui-favorite-star").focus():e.focus(),this._previousFocusElm=void 0}},"closePopover":function(){if(this._getPopoverParent().find(".binf-popover").length>0){i(document).off("click",this._handleClickEvent),i(document).off("scroll",this._handleScrollEvent),this.disengageModalKeyboardFocusOnClose(),this.triggerMethod("close:add:favorite:form"),this.showingForm=!1,this.commandBlocked=!1,this._elTop=void 0;var t=i(this.$el.find(".csui-favorite-star")[0]);t.binf_popover("destroy"),this._previousTitle&&(t.attr("title",this._previousTitle),this._previousTitle=void 0),this._restorePreviousFocusAfterClosingPopover(),setTimeout(e.bind(function(){this.addForm&&this.addForm.destroy(),this.addForm=void 0,this.options.popoverAtBodyElement&&i(this.popoverContainerSelector).remove()},this),500)}},"_removeFavoriteFromClientSideCollection":function(e){var i=this;this.model.set("favorite",!1,{"silent":!0}),this.$el.trigger("favorite:change"),!0===e&&(this.listenToOnce(this.favGroupsCollection,"bulk:update:succeed",function(){i.stopListening(i.favGroupsCollection,"bulk:update:fail"),i.favModel.set("selected",!1)}),this.listenToOnce(this.favGroupsCollection,"bulk:update:fail",function(){i.stopListening(i.favGroupsCollection,"bulk:update:succeed"),this.model.set("favorite",!0,{"silent":!0})})),this.favGroupsCollection.each(function(e){e.favorites&&e.favorites.remove({"id":i.favModel.get("id")})})},"_removeFavoriteFromServer":function(){var e=this;this.blockActions(),this.favModel.removeFromFavorites().always(function(i){e.unblockActions()}).done(function(i){e._removeFavoriteFromClientSideCollection()}).fail(function(i){e._showErrorMessage(e.favModel,i)})},"_addFavoriteWithForm":function(){this._getPopoverParent().find(".binf-popover").length>0||this.favGroupsCollection.ensureFetched().always(e.bind(function(){this._showAddFavoriteForm()},this))},"_showAddFavoriteForm":function(){this.favModel.set(this._getModelDataForFavoriteModel()),this.addForm&&this.addForm.destroy(),this.addForm=new u({"context":this.options.context,"model":this.model,"favModel":this.favModel,"collection":this.favGroupsCollection}),this.addForm.render(),this.listenTo(this.addForm,"click:add:button",this._clickAddButton),this.listenTo(this.addForm,"click:cancel:button",this._clickCancelButton);var t=this.options.formPopoverPlacement;r&&r.settings.rtl&&(t="left"===t?"right":"left");var s={"html":!0,"content":this.addForm.el,"trigger":"manual","placement":t};if(this.options.popoverAtBodyElement){var n=i("body"),o=this.$el.closest(".binf-modal-body");o&&o.length>0&&(n=i(o[0])),n.append('<div class="binf-widgets '+this.popoverContainerClassname+'"></div>'),s=e.extend(s,{"container":this.popoverContainerSelector})}var a=i(this.$el.find(".csui-favorite-star")[0]);this._previousTitle=a.attr("title");var c=(a.offset().left+a.outerWidth())/i(window).width()*100;2===i(window).devicePixelRatio?(c<29&&!r.settings.rtl||c>70&&r.settings.rtl)&&(t="left"===t?"right":"left",s.placement=t):i(window).width()<1280?(c<44&&!r.settings.rtl||c>58&&r.settings.rtl)&&(t="left"===t?"right":"left",s.placement=t):(c<25&&!r.settings.rtl||c>80&&r.settings.rtl)&&(t="left"===t?"right":"left",s.placement=t),a.binf_popover(s).binf_popover("show");var d=this._getPopoverParent().find(".binf-popover");this.favGroupsCollection.length>1&&d.addClass("show-groups");var h=parseInt(d.css("top"),10)+52;d.css("top",h);var p=d.find(".binf-arrow");if(p.css("top",20),!0===this.options.popoverAtBodyElement)!0!==l.isVisibleInWindowViewportVertically(d)&&(h=parseInt(d.css("top"),10)-d.height()+45,d.css("top",h),p.css("top",d.height()-20));else if(this.options.checkVisible){var m=d.closest(".csui-perfect-scrolling");0===m.length&&(m=d.closest(".csui-normal-scrolling")),!0!==l.isElementVisibleInParent(d,m,90,90)&&(h=parseInt(d.css("top"),10)-d.height()+45,d.css("top",h),i(this.$el.find(".binf-arrow")[0]).css("top",d.height()-23))}var f=i(this.$el.find(".csui-favorite-star > .icon")[0]),g=f.offset().top+f.height()/2,b=p.offset().top+11,v=g-b;d.offset({"top":d.offset().top+v}),this.engageModalKeyboardFocusOnOpen(this.addForm.el);var w=e.uniqueId("popoverLabelId");d.find(">.binf-popover-title").attr("id",w),d.attr("role","dialog"),d.attr("aria-labelledby",w),a.on("shown.binf.popover",e.bind(function(e){this._elTop=this.$el.offset().top,this.addForm&&this.addForm.currentlyFocusedElement().focus(),i(document).on("click",{"view":this},this._handleClickEvent),this.options.popoverAtBodyElement&&i(document).on("scroll",{"view":this},this._handleScrollEvent),this.triggerMethod("show:add:favorite:form")},this)),this.showingForm=!0},"_addFavoriteToClientSideCollection":function(e){var i=this;this.model.set("favorite",!0,{"silent":!0}),this.$el.trigger("favorite:change",this.favModel),!0===e&&(this.listenToOnce(this.favGroupsCollection,"bulk:update:succeed",function(){i.stopListening(i.favGroupsCollection,"bulk:update:fail"),i.favModel.set("selected",!0)}),this.listenToOnce(this.favGroupsCollection,"bulk:update:fail",function(){i.stopListening(i.favGroupsCollection,"bulk:update:succeed"),this.model.set("favorite",!1,{"silent":!0})}));var t=this.favGroupsCollection.findWhere({"tab_id":this.favModel.get("tab_id")}),s=this.model.clone();s.set("favorite",!0),s.set("favorite_name",this.favModel.get("name")),s.set("favorite_tab_id",this.favModel.get("tab_id")),t.favorites.add(s)},"_addFavoriteToServer":function(){var e=i.Deferred(),t=this;return this.blockActions(),this.favModel.addToFavorites().always(function(e){t.unblockActions()}).done(function(i){t.model.setExpand("properties",["parent_id"]),t.model.fetch().always(function(){e.resolve(i),t._addFavoriteToClientSideCollection()})}).fail(function(i){e.reject(i),t._showErrorMessage(t.favModel,i)}),e.promise()},"_suspendPopoverBehaviors":function(){this._getPopoverParent().find(".binf-popover").length>0&&(this._focusElementBeforeErrorDialog=document.activeElement,i(document).off("click",this._handleClickEvent),this.disengageModalKeyboardFocusOnClose())},"_resumePopoverBehaviors":function(){this._getPopoverParent().find(".binf-popover").length>0&&(i(document).on("click",{"view":this},this._handleClickEvent),this.addForm&&this.engageModalKeyboardFocusOnOpen(this.addForm.el),this._focusElementBeforeErrorDialog&&i(this._focusElementBeforeErrorDialog).focus(),this._focusElementBeforeErrorDialog=void 0)},"_showErrorMessage":function(i,t){var s=new l.Error(t),n=p.updateFavoriteFailTitle,r=e.str.sformat(p.updateFavoriteFailMessage,i.get("id"),s.message);this._suspendPopoverBehaviors(),o.showError(r,n).always(e.bind(function(){this._resumePopoverBehaviors()},this))},"toggleFavorite":function(){this.model.get("favorite")?this._clickRemoveFavoriteStar():this._clickAddFavoriteStar()},"onKeyInView":function(e){if(32===e.keyCode||13===e.keyCode){if(this._getPopoverParent().find(".binf-popover").length>0)return void e.stopPropagation();e.preventDefault(),e.stopPropagation(),this.enabled()&&this.toggleFavorite()}},"blockActions":function(){},"unblockActions":function(){}});return d.mixin(m.prototype),m}),csui.define("css!csui/controls/table/cells/favorite/impl/favorite",[],function(){}),csui.define("csui/controls/table/cells/favorite/favorite.view",["csui/lib/underscore","csui/controls/table/cells/templated/templated.view","csui/controls/table/cells/cell.registry","csui/widgets/favorites/favorite.star.view","css!csui/controls/table/cells/favorite/impl/favorite"],function(e,i,t,s){var n=i.extend({"getValueData":function(){return this.model.toJSON()},"constructor":function(e){i.prototype.constructor.apply(this,arguments)},"onBeforeDestroy":function(){this.triggerMethod("close:add:favorite:form"),this.favStarView&&(this.favStarView.destroy(),this.favStarView=void 0)},"onRender":function(){this.favStarView||(this.favStarView=new s(e.extend({"checkVisible":!0,"popoverAtBodyElement":!0,"focusable":!1},this.options))),this.listenTo(this.favStarView,"show:add:favorite:form",function(){this.triggerMethod("show:add:favorite:form")}),this.listenTo(this.favStarView,"close:add:favorite:form",function(){this.triggerMethod("close:add:favorite:form")}),this.favStarView.render(),this.$el.append(this.favStarView.el),this.listenTo(this.options.tableView,"scroll",function(){this.favStarView&&this.favStarView.scrollCheckToClosePopover()})}},{"hasFixedWidth":!0,"columnClassName":"csui-table-cell-favorite"});return t.registerByColumnKey("favorite",n),n}),csui.define("csui/controls/table/cells/favorite/favorite.name.view",["csui/controls/table/cells/name/name.view","csui/controls/table/cells/cell.registry"],function(e,i){var t=e.extend({});return i.registerByColumnKey("favorite_name",t),t}),csui.define("hbs!csui/controls/table/cells/type.icon/impl/type.icon",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"1":function(e,i,t,s){var n;return null!=(n=i.if.call(e,null!=e?e.inactive:e,{"name":"if","hash":{},"fn":this.program(2,s,0),"inverse":this.program(4,s,0)}))?n:""},"2":function(e,i,t,s){return'    <div class="csui-table-cell-no-default-action"></div>\r\n'},"4":function(e,i,t,s){var n;return'    <a class="csui-table-cell-default-action" href="'+this.escapeExpression((n=null!=(n=i.defaultActionUrl||(null!=e?e.defaultActionUrl:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"defaultActionUrl","hash":{}}):n))+'"\r\n       aria-label="'+this.escapeExpression((n=null!=(n=i.typeAndNameAria||(null!=e?e.typeAndNameAria:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"typeAndNameAria","hash":{}}):n))+'"></a>\r\n'},"6":function(e,i,t,s){return'  <div class="csui-table-cell-no-default-action"></div>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){var n;return null!=(n=i.if.call(e,null!=e?e.defaultAction:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.program(6,s,0)}))?n:""}});return t.registerPartial("csui_controls_table_cells_type.icon_impl_type.icon",s),s}),csui.define("css!csui/controls/table/cells/type.icon/impl/type.icon",[],function(){}),csui.define("csui/controls/table/cells/type.icon/type.icon.view",["csui/lib/underscore","csui/lib/marionette","csui/controls/table/cells/templated/templated.view","csui/controls/node-type.icon/node-type.icon.view","csui/controls/table/cells/cell.registry","csui/utils/node.links/node.links","hbs!csui/controls/table/cells/type.icon/impl/type.icon","i18n!csui/controls/table/impl/nls/lang","css!csui/controls/table/cells/type.icon/impl/type.icon"],function(e,i,t,s,n,o,l,r){"use strict";var a=t.extend({"events":{"keydown":"onKeyInView"},"template":l,"constructor":function(e){t.prototype.constructor.apply(this,arguments),this.needsAriaLabel=!this.options.column.defaultAction,this.listenTo(this,"render",this._createNodeTypeIcon).listenTo(this,"before:render",this._destroyNodeTypeIcon).listenTo(this,"before:destroy",this._destroyNodeTypeIcon)},"getValueData":function(){var i=this.model,t=o.getUrl(this.model),s=e.str.sformat(r.typeAndNameAria,i.get("type_name"),i.get("name"));return{"defaultAction":this.options.column.defaultAction,"defaultActionUrl":t,"typeAndNameAria":s,"inactive":i.get("inactive")}},"_createNodeTypeIcon":function(){var e=new s({"node":this.model});this.cellRegion=new i.Region({"el":this.$("> *")}),this.cellRegion.show(e)},"_destroyNodeTypeIcon":function(){this.cellRegion&&(this.cellRegion.empty(),this.cellRegion=null)},"getValueText":function(){return this.model.get("type_name")||""}},{"hasFixedWidth":!0,"columnClassName":"csui-table-cell-type"});return n.registerByColumnKey("type",a),a}),csui.define("csui/dialogs/members.picker/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/dialogs/members.picker/impl/nls/root/lang",{"ViewDenied":'Access denied, you do not have permission to view "{0}".',"cancelButtonLabel":"Cancel","dialogTitle":"View group membership","serverError":"Server request failed with error code {0}.","backButtonTooltip":"Go back","missingConnector":"Missing connector information!","emptyMembersText":"No results found.","UserPickerPlaceHolder":"Enter user or group","addButtonLabel":"Add","selectPermissionLevel":"Select permission level","nextButtonLabel":"Next","doneButtonLabel":"Done","groupSymbolAlt":"Group symbol","userSymbolAlt":"User symbol","disabledItemTypeNameAria":"Disabled: {0}: {1}","itemTypeNameAria":"{0}: {1}","AddUserOrGroup":"Add user or group","AddMember":"Add member","userSearchPlaceHolder":"Search for user","addAnotherNamePlaceHolder":"Add another user or group","removeSelectedUser":"Remove member","removeSelectedUserAria":"Remove {0} from selection list","singleUserText":"{0} added to the {1} group.","singleUserFailureText":"{0} failed to add to the {1} group.","SinglePassMoreThanOneFail":"{0} added to the {1} group and {2} members failed to added to the group.","onlyFailUsersText":"{0} members failed to add to the {1} group","onlyAllSuccessText":"{0} members Successfully added to the {1} group","onlyAllFailureText":"{0} members failed to add to the {1} group","manyUserText":"{0} members Successfully added, {1} members failed to add to the {2} group .","searchIconTitle":"Open user or group search box","searchIconAria":"Click or press enter to open user or group search box","openSearchBar":"Open search bar","closeSearchBar":"Close search bar"}),csui.define("hbs!csui/dialogs/members.picker/impl/member.list/list.item",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"1":function(e,i,t,s){return""},"3":function(e,i,t,s){var n,o;return'  <a class="csui-item-standard csui-list-group-item" href="">\r\n    <span class="csui-icon csui-start-icon '+this.escapeExpression((o=null!=(o=i.selected||(null!=e?e.selected:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"selected","hash":{}}):o))+'"></span>\r\n'+(null!=(n=i.if.call(e,null!=e?e.isGroup:e,{"name":"if","hash":{},"fn":this.program(4,s,0),"inverse":this.program(6,s,0)}))?n:"")+'    <span title="'+this.escapeExpression((o=null!=(o=i.name||(null!=e?e.name:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"name","hash":{}}):o))+'" class="csui-list-item-title">'+this.escapeExpression((o=null!=(o=i.name||(null!=e?e.name:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"name","hash":{}}):o))+"</span>\r\n  </a>\r\n"},"4":function(e,i,t,s){var n;return'      <span class="csui-user-default-picture-dlg csui-icon image_group_placeholder_permission"></span>\r\n      <span><img src="'+this.escapeExpression((n=null!=(n=i.imgSrc||(null!=e?e.imgSrc:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"imgSrc","hash":{}}):n))+'" alt="'+this.escapeExpression((n=null!=(n=i.imgAlt||(null!=e?e.imgAlt:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"imgAlt","hash":{}}):n))+'"\r\n                 class="binf-hidden csui-user-profile-picture-dlg csui-member-group-icon csui-icon" /></span>\r\n      <span class="csui-icon csui-end-icon icon-sidebar-expand24 binf-hidden"></span>\r\n'},"6":function(e,i,t,s){var n;return'      <span\r\n          class="csui-user-default-picture-dlg csui-icon image_user_placeholder">'+this.escapeExpression((n=null!=(n=i.initials||(null!=e?e.initials:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"initials","hash":{}}):n))+'</span>\r\n      <span><img src="'+this.escapeExpression((n=null!=(n=i.imgSrc||(null!=e?e.imgSrc:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"imgSrc","hash":{}}):n))+'" alt="'+this.escapeExpression((n=null!=(n=i.imgAlt||(null!=e?e.imgAlt:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"imgAlt","hash":{}}):n))+'"\r\n                 class="binf-hidden csui-user-profile-picture-dlg csui-member-group-icon csui-icon" /></span>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){var n;return(null!=(n=i.if.call(e,null!=e?e.totalcount:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.program(3,s,0)}))?n:"")+"\r\n"}});return t.registerPartial("csui_dialogs_members.picker_impl_member.list_list.item",s),s}),csui.define("hbs!csui/dialogs/node.picker/impl/search.list/search.location.item",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){var n;return'<span class="csui-type-location-icon" aria-hidden="true"></span><span title="'+this.escapeExpression((n=null!=(n=i.name||(null!=e?e.name:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"name","hash":{}}):n))+'"\r\n                                                                      class="csui-list-item-title">'+this.escapeExpression((n=null!=(n=i.name||(null!=e?e.name:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"name","hash":{}}):n))+"</span>\r\n"}});return t.registerPartial("csui_dialogs_node.picker_impl_search.list_search.location.item",s),s}),
csui.define("css!csui/dialogs/members.picker/impl/members.picker",[],function(){}),csui.define("csui/dialogs/members.picker/impl/member.list/list.item.view",["csui/lib/underscore","csui/lib/jquery","csui/controls/listitem/listitemstandard.view","csui/utils/url","csui/utils/user.avatar.color","hbs!csui/dialogs/members.picker/impl/member.list/list.item","hbs!csui/dialogs/node.picker/impl/search.list/search.location.item","i18n!csui/dialogs/members.picker/impl/nls/lang","css!csui/dialogs/members.picker/impl/members.picker"],function(e,i,t,s,n,o,l,r){return t.extend({"template":o,"searchLocationTemplate":l,"templateHelpers":function(){return{"defaultProfilePictureClass":this._isGroup()?"image_group_placeholder_permission":"image_user_placeholder","imgAlt":this._isGroup()?r.groupSymbolAlt:r.userSymbolAlt,"totalcount":!this.options.model.collection.totalCount,"isGroup":!!this._isGroup(),"name":this.options.model.get("name_formatted"),"selected":this.selected?"icon-listview-checkmark":"","imgSrc":"data:image/gif;base64,R0lGODlhAQABAIAAAAUEBAAAACwAAAAAAQABAAACAkQBADs="}},"tagName":"li","events":{"keydown":"onKeyInView"},"ui":{"link":".csui-list-group-item"},"onKeyInView":function(e){return 39!==e.keyCode&&32!==e.keyCode&&13!==e.keyCode||(this.$el.trigger("click"),this.$el.focus(),!1)},"_isUser":function(){return 0===this.options.model.get("type")},"_isGroup":function(){return 1===this.options.model.get("type")},"_isInActiveUser":function(){return this.options.model.get("type")<0},"constructor":function(e){t.apply(this,arguments),this.browsed=!1},"toggleSelect":function(){this.selected=!this.selected,this.isDestroyed||this.render()},"toggleBrowse":function(){this.browsed=!this.browsed,this.render()},"assignedBrowseNSelect":function(){this.browsed=this.selected=!0,this.render()},"unassignBrowseNSelect":function(){this.isDestroyed||(this.browsed=this.selected=!1,this.render())},"isSelected":function(){return this.selected},"isBrowsed":function(){return this.browsed},"setValidity":function(e){this.valid=e},"onRender":function(){this.$el.addClass("cs-left-item-"+this.model.get("id")),this.$el.removeClass("select"),this.$el.removeClass("browse"),this.ui.link.removeAttr("aria-selected"),this.$el.attr("role","option");var i=e.str.sformat(r.itemTypeNameAria,this.model.get("type_name"),this.model.get("name"));this.valid||(i=e.str.sformat(r.disabledItemTypeNameAria,this.model.get("type_name"),this.model.get("name"))),this.$el.attr("aria-label",i),this.selected?(this._isGroup()&&this.$el.find("span").removeClass("binf-hidden"),this.$el.addClass("select"),this.$el.attr("aria-selected","true")):this.browsed&&(this.$el.addClass("browse"),this.$el.find("span.csui-end-icon").removeClass("binf-hidden")),this._isBrowsable(this.model)&&(this.ui.link.attr("aria-haspopup","true"),this.ui.link.attr("aria-expanded","false")),this._renderPhoto()},"_renderPhoto":function(){var i=this.model.get("photo_url"),t=n.getUserAvatarColor(this.options.model.attributes.data.properties);if(this.$el.find(".csui-user-default-picture-dlg.image_user_placeholder").css("background-color",t),this._isGroup()||null===i);else{var s=this;this._resolvePhoto(i).done(e.bind(function(e){var i=s.$el.find(".csui-user-profile-picture-dlg");s.$el.find(".csui-user-default-picture-dlg").addClass("binf-hidden"),s.url=URL.createObjectURL(e),i.removeClass("binf-hidden").attr("src",s.url)})).fail(function(){s.$el.find(".csui-user-profile-picture-dlg").attr("src","data:image/gif;base64,R0lGODlhAQABAIAAAAUEBAAAACwAAAAAAQABAAACAkQBADs=")})}},"_resolvePhoto":function(e){var t=this.options.model.connector,n=t.connection,o=new s(n.url).getCgiScript(),l=i.Deferred(),r=s.combine(o,e),a={"url":r,"dataType":"binary","connection":n};return t.makeAjaxCall(a).done(function(e){l.resolve(e)}).fail(l.reject),l.promise()},"_isBrowsable":function(e){return e.get("container")&&!1!==e.get("perm_see_contents")}})}),csui.define("hbs!csui/dialogs/members.picker/impl/member.list/member.list",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){return'<div class="list-content">\r\n  <ul class="binf-list-group" role="listbox"></ul>\r\n  <div class="binf-search-location-group"></div>\r\n</div>'}});return t.registerPartial("csui_dialogs_members.picker_impl_member.list_member.list",s),s}),csui.define("hbs!csui/dialogs/members.picker/impl/member.list/empty.members.list",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){var n;return"<p class='csui-members-empty'> "+this.escapeExpression((n=null!=(n=i.emptyTableText||(null!=e?e.emptyTableText:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"emptyTableText","hash":{}}):n))+" </p>\r\n"}});return t.registerPartial("csui_dialogs_members.picker_impl_member.list_empty.members.list",s),s}),csui.define("css!csui/dialogs/members.picker/impl/member.list/member.list",[],function(){}),csui.define("csui/dialogs/members.picker/impl/member.list/member.list.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/dialogs/members.picker/impl/member.list/list.item.view","csui/controls/progressblocker/blocker","csui/behaviors/keyboard.navigation/tabable.region.behavior","csui/controls/tile/behaviors/perfect.scrolling.behavior","hbs!csui/dialogs/members.picker/impl/member.list/member.list","hbs!csui/dialogs/members.picker/impl/member.list/empty.members.list","i18n!csui/dialogs/members.picker/impl/nls/lang","css!csui/dialogs/members.picker/impl/member.list/member.list"],function(e,i,t,s,n,o,l,r,a,c){"use strict";return t.CompositeView.extend({"className":"cs-list","template":r,"childViewContainer":".binf-list-group","childView":s,"childViewOptions":function(){return{"locationEle":this.ui.location}},"childEvents":{"click:item":"onItemClick","before:add:child":"onBeforeAddChild"},"ui":{"listParent":".list-content","list":".binf-list-group","location":".binf-search-location-group"},"events":{"keydown":"onKeyInView"},"onBeforeAddChild":function(e){var i=this.commandType.validateTarget(e.model);e.setValidity(i)},"onAddChild":function(i){var t=i.model.get("id");if(this.selectedItem&&this.selectedItem.model.get("id")===t&&(this.selectedItem=i,this.toggleSelectedChild(i)),this.commandType.validateMember(i.model)?i.$el.addClass("csui-acc-focusable"):i.$el.hide(),!this.commandType.isSelectable(i.model)&&!this._isBrowsable(i.model)){i.$el.addClass("csui-disabled");var s=e.str.sformat(c.disabledItemTypeNameAria,i.model.get("type_name"),i.model.get("name"));i.$el.attr("aria-label",s)}return this._isBrowsable(i.model)?(i.ui.link.attr("aria-haspopup","true"),i.ui.link.attr("aria-expanded","false")):(i.ui.link.removeAttr("aria-haspopup"),i.ui.link.removeAttr("aria-expanded")),this.browsedChild&&this.browsedChild.model.get("id")===t&&(this.browsedChild=i,this.toggleBrowsedChild(i)),!0},"collectionEvents":{"sync":"syncUpdate","reset":"rebuild"},"behaviors":{"PerfectScrolling":{"behaviorClass":l,"contentParent":"> .list-content","suppressScrollX":!0},"TabableRegion":{"behaviorClass":o}},"isTabable":function(){return this.children.find(function(e){var i=e.$el;return i.is(":visible")&&!i.is(":disabled")})},"currentlyFocusedElement":function(){var e=this.$el.find(".binf-list-group-item.csui-acc-focusable");if(e.length)return i(e[this.focusIndex])},"setFocus":function(){var e=this.$el.find(".binf-list-group-item.csui-acc-focusable");i(e[this.focusIndex]).focus()},"onKeyInView":function(e){var t=e.keyCode,s=this.$el.find(".binf-list-group-item.csui-acc-focusable");switch(t){case 38:case 40:38===t?this.focusIndex>0&&--this.focusIndex:this.focusIndex<s.length&&++this.focusIndex,this.trigger("changed:focus"),i(s[this.focusIndex]).focus()}},"constructor":function(s){s||(s={}),e.defaults(s,{"pageSize":30}),t.CompositeView.prototype.constructor.apply(this,arguments),this.jQuery=i,n.imbue(this),this.selectedItem=s.selection?s.selection:null,this.blockScroll=!0,this.notFetching=!0,this.init=!0,this.nextCollectionPage=e.bind(this.addNextCollectionPage,this),this.commandType=s.commandType,this.focusIndex=0,this.listenTo(this.collection,"sync",function(){if(this.ui.listParent.find("p.csui-members-empty").remove(),0===this.collection.length){this.ui.listParent.addClass("csui-members-empty");var e=a.call(this,{"emptyTableText":c.emptyMembersText});this.ui.listParent.append(e)}else this.ui.listParent.removeClass("csui-members-empty")}),this.listenTo(this.collection,"request",this.setBlocker),this.listenTo(this.collection,"reset",this.setBlocker),this.listenTo(this,"browse:complete",function(){this.notFetching=!0})},"syncUpdate":function(){this.nextTriggerSetting=this.options.pageSize/2,this.blockScroll=!0,this.notFetching=!0,this.init=!0,this.unblockActions()},"rebuild":function(){if(this.ui.listParent.find("p.csui-members-empty").remove(),0===this.collection.length){this.ui.listParent.addClass("csui-members-empty");var e=a.call(this,{"emptyTableText":c.emptyMembersText});this.ui.listParent.append(e)}else this.ui.listParent.removeClass("csui-members-empty");this.reset(),this.trigger("dom:refresh")},"reset":function(){this.init=!0;var e=this;this.scrollBar&&(this.scrollBar.scrollTop(0),this.collection.length||setTimeout(function(){e.triggerMethod("update:scrollbar",this)},0))},"stopBlocker":function(){return this.unblockActions(),!0},"setBlocker":function(){return this.blockScroll&&(this.blockScroll=!1,this.blockActions()),!0},"addNextCollectionPage":function(){var e=this.collection.length,i=this.ui.list.height()-this.ui.listParent.height(),t=this.ui.listParent.scrollTop()/i,s=(e-this.nextTriggerSetting)/e;e&&e<this.collection.totalCount&&t>=s&&(this.notFetching&&(this.notFetching=!1,this.collection.setSkip(e,!1),this.collection.fetch({"reset":!1,"remove":!1,"merge":!1})),t>.98&&this.init&&(this.setBlocker(),this.init=!1))},"onDomRefresh":function(){this.scrollBar||(this.scrollBar=this.ui.listParent,this.scrollBar.on("scroll",this.nextCollectionPage))},"onItemClick":function(e){e.$el.hasClass("csui-disabled")||this._processClickedItem(e)},"_processClickedItem":function(e){if(this.notFetching){this.notFetching=!1;this._isBrowsable(e.model)?this._browseSelection(e):this._targetSelection(e),e.$el.blur()}return this.$el.trigger("setCurrentTabFocus"),!0},"clearSelect":function(){var e=this;return this.selectedItem&&e.toggleSelectedChild(this.selectedItem),this.selectedItem=null,!0},"toggleSelectedChild":function(e){this.commandType.isSelectable(e.model)&&e.toggleSelect()},"toggleBrowsedChild":function(e){e&&e.toggleBrowse()},"_isBrowsable":function(e){return 1===e.get("type")},"_targetSelection":function(e){var i=e.model,t=(i.get("id"),e.isSelected()),s=i.get("type");this.clearSelect(),t||(this.selectedItem=e,this.toggleSelectedChild(e)),this.trigger("selection:change",{"type":s,"member":i,"add":!t}),this.notFetching=!0},"_browseSelection":function(e){var i=this.commandType.isSelectableType(e.model),t=this.commandType.isSelectable(e.model),s=this.commandType.browseAllowed(e.model),n=e.isBrowsed(),o=!1,l=e.model.attributes.type;n?(t&&this._targetSelection(e),this.notFetching=!0):(t?(this._browseNSelect(e),o=!0):((s||i)&&(this.clearSelect(),o=!0),this.toggleBrowsedChild(e)),s&&this.trigger("selection:change",{"member":e.model,"silent":!1,"add":o,"type":l}),this._browse(e,o))},"_browse":function(e,i){this.browsedChild&&this.browsedChild.toggleBrowse(),this.browsedChild=e,e.ui.link.attr("aria-expanded","true"),this.trigger("browse:select",{"member":e.model,"add":i})},"_browseNSelect":function(e){this.clearSelect(),this.selectedItem=e,e.assignedBrowseNSelect()}})}),csui.define("csui/behaviors/input/placeholder",["csui/lib/underscore","csui/lib/backbone","csui/lib/marionette"],function(e,i,t){"use strict";return t.Behavior.extend({"events":{"keydown @ui.inputField":"onKeyDown","keyup @ui.inputField":"onKeyUp","focus @ui.inputField":"onFocus"},"initialize":function(e,i){this.isEmpty=!0},"onKeyDown":function(){var e=this.view.ui.inputField.val(),i=this.view.ui.inputField.attr("placeholder");!0===this.isEmpty&&e===i&&this.view.ui.inputField.val("")},"onKeyUp":function(){var e=this.view.ui.inputField.val(),i=this.view.ui.inputField.attr("placeholder");0===e.length||e===i?(this.isEmpty=!0,this.view.ui.inputField.val(i),this.view.ui.inputField[0].setSelectionRange(0,0)):this.isEmpty=!1},"onFocus":function(){var e=this.view.ui.inputField.attr("placeholder");0===this.view.ui.inputField.val().length&&(this.isEmpty=!0,this.view.ui.inputField.val(e),this.view.ui.inputField[0].setSelectionRange(0,0))}})}),csui.define("hbs!csui/dialogs/members.picker/impl/select.view/impl/header/header",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"1":function(e,i,t,s){var n;return'  <div class="csui-search-item-left-panel">\r\n    <div class="csui-search-item-type">\r\n      <span class="csui-type-label"> '+this.escapeExpression((n=null!=(n=i.type||(null!=e?e.type:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"type","hash":{}}):n))+' </span>\r\n    </div>\r\n    <div class="csui-search-item">\r\n      <div class="csui-search-item-name">\r\n        '+this.escapeExpression((n=null!=(n=i.name||(null!=e?e.name:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"name","hash":{}}):n))+'\r\n      </div>\r\n    </div>\r\n  </div>\r\n  <div class="csui-search-item-right-panel">\r\n    <div class="csui-search-item-location">\r\n      <div class="csui-search-toolbar-container">\r\n        '+this.escapeExpression((n=null!=(n=i.location||(null!=e?e.location:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"location","hash":{}}):n))+"\r\n      </div>\r\n    </div>\r\n  </div>\r\n"},"3":function(e,i,t,s){var n,o;return'  <div class="csui-targetbrowse-history">\r\n      <span class="csui-targetbrowse-arrow-back">\r\n        <span class="icon arrow_back cs-go-back" title="'+this.escapeExpression((o=null!=(o=i.backButtonTooltip||(null!=e?e.backButtonTooltip:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"backButtonTooltip","hash":{}}):o))+'" tabindex="0"\r\n              aria-label="'+this.escapeExpression((o=null!=(o=i.backButtonAria||(null!=e?e.backButtonAria:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"backButtonAria","hash":{}}):o))+'" data-cstabindex="-1" role="link"></span>\r\n      </span>\r\n  </div>\r\n  <div class="csui-folder-name">\r\n    <span class="folder-name" title="'+this.escapeExpression((o=null!=(o=i.title||(null!=e?e.title:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"title","hash":{}}):o))+'">'+this.escapeExpression((o=null!=(o=i.title||(null!=e?e.title:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"title","hash":{}}):o))+"</span>\r\n"+(null!=(n=i.if.call(e,null!=e?e.allMembers:e,{"name":"if","hash":{},"fn":this.program(4,s,0),"inverse":this.noop}))?n:"")+'  </div>\r\n\r\n  <form class="cs-modal-filter">\r\n    <div class="binf-form-group">\r\n      <input class="binf-form-control cs-filter-input" placeholder="'+this.escapeExpression((o=null!=(o=i.search_placeholder||(null!=e?e.search_placeholder:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"search_placeholder","hash":{}}):o))+'"\r\n             tabindex="0" data-cstabindex="-1" aria-label="'+this.escapeExpression((o=null!=(o=i.search_placeholder||(null!=e?e.search_placeholder:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"search_placeholder","hash":{}}):o))+'">\r\n      <span class="binf-form-control-feedback cs-icon icon-formfield-clear" role="button"\r\n            aria-label="'+this.escapeExpression((o=null!=(o=i.clearSearchButtonAria||(null!=e?e.clearSearchButtonAria:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"clearSearchButtonAria","hash":{}}):o))+'" tabindex="0" data-cstabindex="-1"></span>\r\n      <button class="binf-btn csui-form-control-search" title="'+this.escapeExpression((o=null!=(o=i.collapseSearch||(null!=e?e.collapseSearch:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"collapseSearch","hash":{}}):o))+'" aria-label="'+this.escapeExpression((o=null!=(o=i.collapseSearch||(null!=e?e.collapseSearch:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"collapseSearch","hash":{}}):o))+'" aria-expanded="true" aria-haspopup="true"\r\n              tabindex="0" data-cstabindex="-1">\r\n      <span class="form-control-search cs-icon icon-sv-search-hide"></span>\r\n      </button>\r\n    </div>\r\n  </form>\r\n'},"4":function(e,i,t,s){var n;return'      <span class="cs-icon icon-sv-search csui-acc-focusable" tabindex="0" data-cstabindex="-1"\r\n            role="button" aria-expanded="false" title="'+this.escapeExpression((n=null!=(n=i.openSearchBar||(null!=e?e.openSearchBar:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"openSearchBar","hash":{}}):n))+'"\r\n            aria-label="'+this.escapeExpression((n=null!=(n=i.searchInButtonAria||(null!=e?e.searchInButtonAria:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"searchInButtonAria","hash":{}}):n))+'"></span>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){var n;return null!=(n=i.if.call(e,null!=e?e.searchView:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.program(3,s,0)}))?n:""}});return t.registerPartial("csui_dialogs_members.picker_impl_select.view_impl_header_header",s),s}),csui.define("csui/dialogs/node.picker/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/dialogs/node.picker/impl/nls/root/lang",{"noSearchResultMessage":"No results found","PermissionDenied":"Permission denied","ViewDenied":'Access denied, you do not have permission to view "{0}".',"InsufficientContent":"Insufficient content to open the browse dialog","selectButtonLabel":"Select","cancelButtonLabel":"Cancel","copyButtonLabel":"Copy","moveButtonLabel":"Move","clearSearchButtonAria":"Clear Search","collapseSearch":"Clear and collapse search","saveFilterButtonLabel":"Save","placeHolderName":"Enter name","itemTypeNameAria":"{0}: {1}","disabledItemTypeNameAria":"Disabled: {0}: {1}","dialogTitle":"Select an object","dialogTitleForContainers":"Select a Container","dialogTitleForDocuments":"Select a Document","dialogTitleForCategories":"Select a Category","breadcrumbAria":"Breadcrumb in Dialog","serverError":"Server request failed with error code {0}.","backButtonTooltip":"Go back","backToFolderView":"Go back to Folder View","backToSearchAria":"Go back to Search View","Type":"Type","Name":"Name","Location":"Location","searchResults":"Search results","searchFoundAbout":"About {0} items","searchFoundZero":"No items","nameCannotContainColon":"Name cannot contain a colon","nameCannotBeEmpty":"This is a required field.","SelectOneItemMessage":"{0} item selected","SelectManyItemsMessage":"{0} items selected","noValue":"(no value)","nodePickerChoices":"Choices"}),csui.define("csui/dialogs/members.picker/impl/select.view/impl/header/header.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/lib/backbone","csui/behaviors/input/placeholder","i18n!csui/controls/table/impl/nls/lang","csui/behaviors/keyboard.navigation/tabable.region.behavior","csui/models/member/member.model","csui/models/member/membercollection","hbs!csui/dialogs/members.picker/impl/select.view/impl/header/header","i18n!csui/dialogs/node.picker/impl/nls/lang","i18n!csui/dialogs/members.picker/impl/nls/root/lang"],function(e,i,t,s,n,o,l,r,a,c,u,d){return t.ItemView.extend({"template":c,"tagName":"div","templateHelpers":function(){return{"title":this.options.title||!!this.options&&!!this.options.container&&this.options.container.get("name"),"search_icon_tooltip":e.str.sformat(o.searchIconTooltip,this.options.columnTitle),"search_placeholder":o.searchByNamePlaceholder,"search_clear_icon_tooltip":o.searchClearIconTooltip,"backButtonTooltip":u.backButtonTooltip||o.backButtonTooltip,"type":u.Type,"name":u.Name,"location":u.Location,"searchView":this.options.searchView,"searchInButtonAria":e.str.sformat(o.searchPlaceholder,this.title),"clearSearchButtonAria":u.clearSearchButtonAria,"allMembers":!this.container.id&&!this.container.groupId,"openSearchBar":d.openSearchBar,"closeSearchBar":d.closeSearchBar,"collapseSearch":u.collapseSearch,"backButtonAria":o.backButtonTooltip}},"ui":{"searchBox":"> form.cs-modal-filter","openSearchIcon":"> .csui-folder-name .icon-sv-search","headerTitle":"> .csui-folder-name","searchInput":"> form .cs-filter-input","clearer":"> form .binf-form-control-feedback","tabElements":"> *[tabindex]","closeSearchButton":"> form .csui-form-control-search","backButton":".csui-targetbrowse-arrow-back"},"events":{"click .icon-sv-search":"searchClicked","click @ui.closeSearchButton":"searchClicked","paste @ui.searchInput":"contentPasted","change @ui.searchInput":"filterChanged","click @ui.clearer":"searchFieldClearerClicked","submit @ui.searchBox":"filterChanged","keydown":"onKeyInView"},"behaviors":{"Placeholder":{"behaviorClass":n},"TabableRegionBehavior":{"behaviorClass":l}},"constructor":function(e){this.options=e||{},this.container=e.container,this.title=e.title,this.headerView=this,t.ItemView.prototype.constructor.apply(this,arguments),this.container&&this.listenTo(this.container,"change:name",function(e){this.title=e.get("name"),this.render()})},"onRender":function(){this.ui.clearer.toggle(!1),this.ui.searchBox.toggleClass("binf-hidden"),this.ui.closeSearchButton.toggleClass("binf-hidden"),this.ui.searchInput.hide();var e=this;this.ui.searchInput.keyup(function(i){e.filterChanged(i)}),this.$el.find("*[data-cstabindex]").on("focus",function(){var t=i(this);e.focusedElement&&e.focusedElement.removeClass(l.accessibilityActiveElementClass),t.addClass(l.accessibilityActiveElementClass),e.focusedElement=t})},"currentlyFocusedElement":function(){var e=this.$el.find("*[data-cstabindex=-1]");return e.length&&e.prop("tabindex",0),this.focusedElement?this.focusedElement:(this.$el.find(".csui-folder-name.binf-hidden").length?this.focusElement=this.$el.find("input"):this.$el.find(".csui-targetbrowse-arrow-back .cs-go-back").is(":visible")?this.focusElement=this.$el.find(".csui-targetbrowse-arrow-back .cs-go-back"):this.$el.find(".csui-folder-name .icon-sv-search").is(":visible")&&(this.focusElement=this.$el.find(".csui-folder-name .icon-sv-search")),this.focusElement)},"onLastTabElement":function(e){var t=this.$("[data-cstabindex=-1]"),s=t.length-1;if(t.length){var n,o=0,r=s+1,a=1;e||(o=s,r=-1,a=-1);for(var c=o;c!=r;c+=a)if(i(t[c]).is(":visible")){o=c;break}return o>=0&&o<=s&&(n=t[o]),this.$(".csui-focus").removeClass("csui-focus"),i(n).hasClass(l.accessibilityActiveElementClass)&&!e}return!0},"onKeyInView":function(e){var t=i(e.target);switch(e.keyCode){case 13:t.removeClass(l.accessibilityActiveElementClass),i(e.target).trigger("click");break;case 27:i(e.target).hasClass(".icon-sv-search")||this.$el.trigger("tabNextRegion");break;default:return!0}return!1},"searchClicked":function(t){t.preventDefault(),t.stopPropagation(),s.trigger("closeToggleAction"),this.ui.headerTitle.toggleClass("binf-hidden"),this.ui.searchInput.toggleClass(l.accessibilityFocusableClass),this.ui.clearer.toggle(!1),this.getValue().length&&(this.ui.searchInput.val(""),this.filterChanged(t)),this.ui.searchInput.toggle(200,"linear",e.bind(function(){this.ui.searchInput.focus()},this)),this.ui.closeSearchButton.toggleClass(l.accessibilityFocusableClass),this.ui.closeSearchButton.removeClass(l.accessibilityActiveElementClass),this.ui.openSearchIcon.toggleClass(l.accessibilityFocusableClass),this.ui.searchBox.toggleClass("binf-hidden"),this.ui.closeSearchButton.toggleClass("binf-hidden"),i(t.target).hasClass("form-control-search")?(this.ui.searchInput.removeClass(l.accessibilityActiveElementClass),this.ui.openSearchIcon.addClass(l.accessibilityActiveElementClass),this.$el.trigger("setCurrentTabFocus")):(this.ui.searchInput.addClass(l.accessibilityActiveElementClass),this.ui.openSearchIcon.removeClass(l.accessibilityActiveElementClass)),this.trigger("changed:focus"),this.focusElement.focus()},"searchFieldClearerClicked":function(e){e.preventDefault(),e.stopPropagation(),this.ui.clearer.removeClass(l.accessibilityFocusableClass),this.ui.clearer.removeClass(l.accessibilityActiveElementClass),this.ui.searchInput.val(""),this.filterChanged(e),this.ui.searchInput.focus(),this.ui.searchInput.addClass(l.accessibilityActiveElementClass)},"getColumn":function(){return this.options.column},"getValue":function(){var e;return e=this.ui.searchInput.val(),e===this.ui.searchInput.attr("placeholder")&&(e=""),e},"setValue":function(e){e&&e.length&&(this.ui.searchInput.val(e),this.lastFilterValue=e)},"getShown":function(){return this.ui.searchInput.hasClass("binf-show")},"setShown":function(e){!0===e&&this.ui.searchInput.hasClass("binf-hidden")?this.ui.searchInput.toggleClass("show binf-hidden"):!1===e&&this.ui.searchInput.hasClass("binf-show")&&this.ui.searchInput.toggleClass("show binf-hidden")},"setFocus":function(){var e=this.ui.searchInput.val().length;this.ui.searchInput.focus(),this.ui.searchInput[0].setSelectionRange(e,e)},"contentPasted":function(e){this.applyFilter()},"filterChanged":function(e){return this.applyFilter(),!1},"applyFilter":function(){var e=this.getValue(),i=!!e.length;if(this.ui.clearer.toggle(i),i?this.ui.clearer.addClass(l.accessibilityFocusableClass):this.ui.clearer.removeClass(l.accessibilityFocusableClass),this.lastFilterValue!=e){this.lastFilterValue=e;var t=this;this.filterTimeout&&clearTimeout(this.filterTimeout),this.filterTimeout=setTimeout(function(){t.filterTimeout=void 0,t.trigger("change:filterValue",{"name":t.getValue(),"collection":t.options.collection})},1e3)}}})}),csui.define("hbs!csui/dialogs/members.picker/impl/select.view/impl/select.view",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){return'<div>\r\n  <div class="csui-mp-header cs-folder-name"></div>\r\n</div>\r\n<div class="csui-mp-content"></div>\r\n\r\n'}});return t.registerPartial("csui_dialogs_members.picker_impl_select.view_impl_select.view",s),s}),csui.define("css!csui/dialogs/members.picker/impl/select.view/impl/select.view",[],function(){}),csui.define("csui/dialogs/members.picker/impl/select.view/select.view",["module","csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/utils/log","csui/utils/base","csui/dialogs/members.picker/impl/member.list/member.list.view","csui/controls/list/list.view","csui/behaviors/keyboard.navigation/tabable.region.behavior","csui/dialogs/members.picker/impl/select.view/impl/header/header.view","hbs!csui/dialogs/members.picker/impl/select.view/impl/select.view","csui/controls/mixins/layoutview.events.propagation/layoutview.events.propagation.mixin","i18n!csui/dialogs/members.picker/impl/nls/lang","css!csui/dialogs/members.picker/impl/select.view/impl/select.view"],function(e,i,t,s,n,o,l,r,a,c,u,d,h,p){var m=n.LayoutView.extend({"template":d,"templateHelpers":function(){return{"backButtonTooltip":p.backButtonTooltip,"backButtonAria":p.backButtonTooltip}},"regions":{"viewHeaderRegion":".csui-mp-header","viewContentRegion":".csui-mp-content"},"ui":{"backButton":".csui-targetbrowse-arrow-back"},"behaviors":{"TabableRegion":{"behaviorClass":c}},"events":{"click @ui.backButton":"onClickFolderBack","keydown @ui.backButton":"selectFolderBack"},"constructor":function(e){e||(e={}),t.defaults(e,{"pageSize":30}),n.LayoutView.prototype.constructor.call(this,e),this.rendered=!1,this.selectedMember=null,this.collection=e.collection,this.completeCollection=e.collection,this.originalModels=e.collection.models,this.container=e.container,this.propagateEventsToRegions(),this.setHeader(e),this.setListView(e),this.onWinRefresh=t.bind(this.windowRefresh,this),i(window).bind("resize.app",this.onWinRefresh)},"windowRefresh":function(){var e=this.options.parentEl.height();(window.chrome||navigator.userAgent.indexOf("Firefox")>0)&&e>0&&this.$el.css("height",e+"px")},"onDestroy":function(){this.$el.off(),i(window).unbind("resize.app",this.onWinRefresh)},"onRender":function(){var e=this,i=e.$el.find(".csui-mp-content");this.viewHeaderRegion.show(this.headerView),this.viewContentRegion.show(this.listView),this.$el.hover(function(){i.addClass("binf-focus")},function(){i.removeClass("binf-focus")}),this.rendered=!0},"onDomRefresh":function(){this.windowRefresh()},"onShow":function(){this.rendered||this.render(),t.each(this.regionManager._regions,function(e){e.currentView&&e.currentView.trigger("show")})},"getNumberOfSelectItems":function(){return null!==this.selectedMember?1:0},"setNewSelect":function(e,i){this.clearSelect(),this._setSelection({"member":e,"add":!0,"silent":i})},"clearSelect":function(){!!this.listView&&this.listView.clearSelect(),this.selectedMember=null},"setListView":function(e){e||(e={});var i={"collection":this.collection,"container":this.container,"commandType":e.commandType,"pageSize":e.pageSize},s=this.listView=new r(i);this.listenTo(s,"selection:change",this._setSelection).listenTo(s,"browse:select",t.bind(this.trigger,this,"browse:select",this)).listenTo(this,"browse:complete",t.bind(s.trigger,s,"browse:complete"))},"selectFolderBack":function(e){13!==e.keyCode&&32!==e.keyCode||(e.preventDefault(),e.stopPropagation(),this.trigger("backbutton:click",this))},"onClickFolderBack":function(e){e.preventDefault(),e.stopPropagation(),this.trigger("backbutton:click",this)},"setHeader":function(){var e=this.container&&(this.container.get("name")||this.options.displayName);e=null===e?this.options.locationName:e,this.headerView=new u({"title":e,"container":this.container,"searchView":this.options.searchView}),this.listenTo(this.headerView,"change:filterValue",this.applyFilter)},"applyFilter":function(e){if(t.extend(e,{"type":this.options.listTypes}),this.collection.fetching)this.filterValuePending=e;else{var i=this;this.collection.setLimit(0,this.options.pageSize,!1),this.collection.setFilter(e,!1),this.collection.fetch({"reset":!0}).fail(function(e){i.listView.stopBlocker(),i.trigger("search:failed",{"resp":e,"view":i})}),this.listView.reset()}},"refresh":function(){var e=this;this.collection.fetch({"reset":!0}).fail(function(){e.listView.stopBlocker()})},"stopBlocker":function(){this.listView.stopBlocker()},"addMemberSelection":function(e){this._setSelection({"browse":!0,"add":!0,"breadCrumbSelection":!0,"member":e,"type":1})},"_setSelection":function(e){var i=(e.member.get("id"),this.options.commandType);this.selectedMember=null,e.add&&i.isSelectable(e.member)&&(this.selectedMember=e.member),e.silent||this.trigger("selection:change",e,this)}});return t.extend(m.prototype,h),m}),csui.define("hbs!csui/dialogs/members.picker/impl/select.views/selectviews",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){return"\r\n"}});return t.registerPartial("csui_dialogs_members.picker_impl_select.views_selectviews",s),s}),csui.define("csui/dialogs/members.picker/impl/select.views/select.views",["module","csui/lib/jquery","csui/lib/underscore","csui/lib/marionette","csui/utils/log","csui/utils/base","i18n!csui/dialogs/members.picker/impl/nls/lang","csui/models/member/member.model","csui/models/member/membercollection","csui/dialogs/members.picker/impl/select.view/select.view","csui/dialogs/modal.alert/modal.alert","csui/utils/commands","hbs!csui/dialogs/members.picker/impl/select.views/selectviews","csui/controls/mixins/view.events.propagation/view.events.propagation.mixin","csui/lib/jquery.ui/js/jquery-ui"],function(e,i,t,s,n,o,l,r,a,c,u,d,h,p){"use strict";var m=s.ItemView.extend({"className":"csui-select-lists","template":h,"constructor":function(e){e||(e={}),t.defaults(e,{"pageSize":30}),s.ItemView.prototype.constructor.call(this,e),this.commandType=e.commandType,this.leftView=this.rightView=null,this.rootGroup=e.rootGroup,this.invalidMembers=[],
this.ancestorCollection=e.ancestorCollection,this.connector=e.connector},"onRender":function(){this.setLeftOnly(),this.leftView&&this.leftView.render(),this.rightView&&this.rightView.render()},"onDomRefresh":function(){this.leftView.triggerMethod("dom:refresh",this.leftView),this.rightView&&this.rightView.triggerMethod("dom:refresh",this.rightView)},"onShow":function(){this.leftView.triggerMethod("show"),this.rightView&&this.rightView.triggerMethod("show")},"setParentGroupAsTarget":function(e){var i=this.commandType.isSelectable(e);return this.rightView&&this.rightView.clearSelect(),this.leftView&&this.leftView.setNewSelect(e,!0),i},"getSelection":function(){var e=this.rightView?this.rightView.selectedMember:null,i=null===e?this.leftView.selectedMember:null;return null!==e?e:i},"getNumberOfSelectItems":function(){return this.rightView&&this.rightView.getNumberOfSelectItems()>0?this.rightView.getNumberOfSelectItems():this.leftView.getNumberOfSelectItems()},"leftNodeId":function(){var e=this.leftView.container;return e?e.get("id"):-1},"setLeftOnly":function(){var e=this._setView(this.rootGroup,"cs-start-locations left-only",!1,this.options),i=e.view.container,t=this;return e.promise.done(function(){i&&t.leftView.addMemberSelection(i),t.options.targetBrowseHistory.length>0?t.showBackButton():(t.options.targetBrowseHistory.length>1||1===t.options.targetBrowseHistory.length&&t.options.navigateFromHistory)&&t.showBackButton()}).fail(function(e){t.forceClose(e)}),this.leftView=e.view,e.promise},"forceClose":function(e){this._displayAlert(e).always(this.trigger("close"))},"newLeftView":function(e,i){var t=this;return this.options.pageSize=i,this._drillUp(e).done(function(i){t.leftView=i,t.leftView.addMemberSelection(e),t.trigger("changed"),t.onDomRefresh()}).fail(function(e){t._displayAlert(e)})},"onSelectionChange":function(e,i){var t,s=i&&this._isRightView(i);return e&&!e.breadCrumbSelection&&(s?e.add&&this.leftView.clearSelect():this.rightView&&(e.add&&this.rightView.clearSelect(),t=this.rightView.container.id!==e.member.id)),1===e.type&&this._updateAncestorCollection(e.member,{"isLeftView":!s,"replaceRightView":t}),e.member.add=e.add,this.trigger("change:complete",e.member),!0},"onBrowse":function(e,i){var t=this._isRightView(e),s=null;return this.trigger("changing:selection"),s=t?this.selectRight(i):this.selectLeft(i),s.done(function(){e.trigger("browse:complete")}).fail(function(){e.clearSelect()}),s},"selectLeft":function(e){var i=this;return this._runSelection(e,".cs-pane-view").done(function(e){e&&(i.rightView=e,i.onDomRefresh())})},"selectRight":function(e){var i=this,t=Math.floor((this.leftView.collection.skipCount||0)/this.leftView.collection.topCount)+1,s=parseInt(this.leftView.collection.topCount)*parseInt(t),n=e.member.get("parentId"),o=this.ancestorCollection.get(n),l=o&&this.ancestorCollection.get(o.get("parentId"));if(0===this.options.targetBrowseHistory.length)this.options.targetBrowseHistory.push("start.location");else{var r={"leftId":l?l.get("id"):null,"leftName":l?l.get("name"):void 0,"leftParent":l?l.get("parentId"):void 0,"leftType":l?l.get("type"):void 0,"rightId":o?o.get("id"):void 0,"rightName":o?o.get("name"):void 0,"rightParent":o?o.get("parentId"):void 0,"rightType":o?o.get("type"):void 0,"pageSize":s};this.options.targetBrowseHistory.push(r)}return this._runSelection(e,".csui-panel.cs-start-locations").done(function(e){e&&(i.leftView=i.rightView,i.showBackButton(),i.rightView=e,i.onDomRefresh())})},"showBackButton":function(){this.leftView&&this.options.targetBrowseHistory.length>=1&&this.leftView.headerView.ui.backButton.parent().show()},"hideBackButton":function(){this.leftView&&this.options.targetBrowseHistory.length<1&&this.leftView.headerView.ui.backButton.parent().hide()},"_runSelection":function(e,t){var s=e.member,n=this,o=i.Deferred();return this._drillDown(s,t).done(function(e){n.trigger("changed"),n.trigger("change:complete",s),o.resolve(e)}).fail(function(e){n._displayAlert(e),n.trigger("change:complete"),o.reject()}),o},"_drillUp":function(e,t){var s=this._setView(e,"csui-new-view left-only binf-hidden","prepend"),n=s.view,o=this,l=i.Deferred();return n.$el.addClass("zeroWidth").removeClass("binf-hidden"),n.render(),t||o._removeRightView(s.promise).done(function(){l.resolve(s.view)}).fail(function(e){l.reject(e)}),l},"_drillDown":function(e,i){var t=this._setView(e,"csui-new-view",!1),s=t.view;return s.render(),this.rightView?this._replaceView(t.promise,s,i):this._addRightView(t.promise,s)},"_showLeftOnly":function(){function e(){if(t){var e=t[0].selectView;s.cancelEventsToViewsPropagation(e),e.destroy(),t.remove(),s.rightView=null}}var i=this.$el.find(".csui-panel.cs-start-locations"),t=this.$el.find(".csui-panel.cs-pane-view.csui-slideMidLeft"),s=this;t.hide(),i.animate({"width":"100%"},{"duration":200,"complete":e})},"_removeRightView":function(e){var t=this.$el.find(".csui-new-view"),s=this.$el.find(".csui-panel.cs-start-locations"),n=this.$el.find(".cs-pane-view"),o=i.Deferred(),l=this;return s.hide(),n.hide(),t[0].className="csui-panel cs-start-locations left-only",e.done(function(){l._finishRightRemove(t,s,n),o.resolve()}).fail(function(e){l._removeNewView(t,s,n),o.reject(e)}),o},"_removeNewView":function(e,i,t){e||(e=this.$el.find(".csui-new-view"));var s=e[0].selectView;this.cancelEventsToViewsPropagation(s),s.destroy(),e.remove(),i&&i.show(),t&&t.show()},"_finishRightRemove":function(e,i,t){var s;return t.length>0&&(s=t[0].selectView,this.cancelEventsToViewsPropagation(s),s.destroy(),t.remove(),this.rightView=null),s=i[0].selectView,this.cancelEventsToViewsPropagation(s),s.destroy(),i.remove(),this.leftView=null,!0},"_addRightView":function(e,t){var s=this.$el.find(".csui-panel.cs-start-locations"),n=this.$el.find(".csui-new-view"),o=i.Deferred(),l=this;return s[0].className="csui-panel cs-start-locations",n[0].className="csui-panel cs-pane-view csui-slideMidLeft",e.done(function(){o.resolve(t)}).fail(function(e){l._removeNewView(n),s.animate({"width":"100%"},200),l.leftView.clearSelect(),l.leftView.refresh(),o.reject(e)}),o},"_replaceView":function(e,t,s){var n=this.$el.find(s),o=i(".csui-new-view"),l=i(".cs-pane-view"),r=i.Deferred(),a=this;switch(n.hide(),s){case".csui-panel.cs-start-locations":l[0].className="csui-panel cs-start-locations csui-slideLeft",o[0].className="csui-panel cs-pane-view csui-slideMidLeft";break;case".cs-pane-view":o[0].className="csui-panel cs-pane-view csui-slideMidLeft"}return e.done(function(){a._removeView(n),r.resolve(t)}).fail(function(e){a._reverseRemoveView(o,s,l),".csui-panel.cs-start-locations"===s&&n.show(),r.reject(e)}),r},"_reverseRemoveView":function(e,i,t){switch(this._removeNewView(e),i){case".csui-panel.cs-start-locations":t[0].className="csui-panel cs-pane-view csui-slideRight",this.rightView.refresh();break;case".cs-pane-view":this._removeView(t),this.leftView.$el[0].className="csui-panel cs-start-locations left-only",this.leftView.clearSelect(),this.leftView.refresh()}return!0},"_removeView":function(e){var i=e[0].selectView;return this.cancelEventsToViewsPropagation(i),i.destroy(),e.remove(),!0},"_setView":function(e,i,s,n){n||(n=this._getViewOptions(e,this.connector)),t.defaults(n,this.options,{"invalidMembers":this.invalidMembers}),s||(s="append");var o=this._newView(n,i),l=this._fetchView(o);return o.el.selectView=o,this.$el[s](o.el),{"view":o,"promise":l}},"_fetchView":function(e){return this._fetchCollection(e)},"_fetchCollection":function(e){return e.collection.setOrder(this.options.orderBy,!1),e.collection.setLimit(0,this.options.pageSize,!1),e.collection.fetch({"reset":!1,"merge":!1,"remove":!1})},"_newView":function(e,i){var s=t.extend({"className":i+" csui-panel","parentEl":this.$el},e),n=new c(s);return this.propagateEventsToViews(n),this.listenTo(n,"selection:change",this.onSelectionChange),this.listenTo(n,"backbutton:click",this._onClickBackButton),this.listenTo(n,"browse:select",t.bind(this.onBrowse,this)),n},"_onClickBackButton":function(){var e=this,i=this.options.targetBrowseHistory.length>0?this.options.targetBrowseHistory.pop():void 0;if(this.options.navigateFromHistory=1===this.options.targetBrowseHistory.length,i.leftId){var t=new r({"id":i.leftId,"name":i.leftName},{"connector":this.connector}),s=new r({"id":i.rightId,"name":i.rightName},{"connector":this.connector});this.newLeftView(t,i.pageSize).done(function(){e.setParentGroupAsTarget(t),e.trigger("change:complete"),e.options.targetBrowseHistory.length>0&&s&&s.get("id")&&e.$el.find(".cs-left-item-"+s.get("id")).length>0&&e.$el.find(".cs-left-item-"+s.get("id")).trigger("click"),e.showBackButton()})}else if("start.location"===i)this.trigger("change:location",this.options.startLocation);else{e.hideBackButton();var n=new r({"id":this.options.container.groupId},{"connector":this.connector});this.options.container.groupId;this.newLeftView(n,i.pageSize).done(function(){e.setParentGroupAsTarget(n);var t=e.ancestorCollection.findByIndex(i.rightId);e.ancestorCollection.findByIndex(i.rightId),e.ancestorCollection.reset(e.ancestorCollection.slice(0,t))})}},"_isRightView":function(e){var i=e.$el[0].className.split(" ");return t.contains(i,"cs-pane-view")},"_addNewPanel":function(e,i){var t=document.createElement("div");return t.className=e,this.$el[i](t),t},"_getViewOptions":function(e,i){var t=new r({"id":e.get("id"),"name":e.get("name"),"parentId":e.get("parentId"),"nodeId":e.get("nodeId"),"categoryId":e.get("categoryId"),"groupId":e.get("groupId")},{"connector":i});return{"container":t,"collection":new a(void 0,{"member":t,"autofetch":!0,"orderBy":this.options.orderBy,"commands":d.getAllSignatures(),"connector":this.connector,"type":"all.groups"===this.options.startLocation?1:null})}},"_displayAlert":function(e){var i=t.str.sformat(l.serverError,"unknown");return e&&(e instanceof c?i=t.str.sformat(l.ViewDenied,e.member.get("name")):e.responseJSON&&(i=e.responseJSON.error)),u.showInformation(i)},"_updateAncestorCollection":function(e,i){var t=this.ancestorCollection.findByIndex(e.id);t>=0?this.ancestorCollection.reset(this.ancestorCollection.slice(0,t+1)):(i.isLeftView&&i.replaceRightView&&this.ancestorCollection.pop(),this.ancestorCollection.add(e.clone()))}});return t.extend(m.prototype,p),m}),csui.define("hbs!csui/dialogs/members.picker/impl/selectedMembers/impl/selectedMember",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){var n;return'<div class="csui-selected-member" id="'+this.escapeExpression((n=null!=(n=i.id||(null!=e?e.id:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"id","hash":{}}):n))+'">\r\n  <div class="member-picture binf-pull-left">\r\n    <span class="csui-icon-paceholder csui-icon image_user_placeholder">'+this.escapeExpression((n=null!=(n=i.initials||(null!=e?e.initials:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"initials","hash":{}}):n))+'</span>\r\n    <img class="csui-icon-user csui-icon binf-img-circle binf-hidden" alt="'+this.escapeExpression((n=null!=(n=i.name||(null!=e?e.name:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"name","hash":{}}):n))+'"\r\n         src="'+this.escapeExpression((n=null!=(n=i.userImgSrc||(null!=e?e.userImgSrc:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"userImgSrc","hash":{}}):n))+'">\r\n  </div>\r\n  <div class="member-info binf-pull-left">\r\n    <span class="name binf-pull-left" title="'+this.escapeExpression((n=null!=(n=i.name||(null!=e?e.name:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"name","hash":{}}):n))+'">'+this.escapeExpression((n=null!=(n=i.name||(null!=e?e.name:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"name","hash":{}}):n))+'</span>\r\n    <span class="department binf-pull-left" title="'+this.escapeExpression((n=null!=(n=i.department||(null!=e?e.department:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"department","hash":{}}):n))+'">'+this.escapeExpression((n=null!=(n=i.department||(null!=e?e.department:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"department","hash":{}}):n))+'</span>\r\n\r\n  </div>\r\n  <button type="button" class="close notification_error" aria-label="'+this.escapeExpression((n=null!=(n=i.removeSelectedUserAria||(null!=e?e.removeSelectedUserAria:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"removeSelectedUserAria","hash":{}}):n))+'"\r\n          title="'+this.escapeExpression((n=null!=(n=i.removeSelectedUser||(null!=e?e.removeSelectedUser:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"removeSelectedUser","hash":{}}):n))+'"></button>\r\n</div>\r\n \r\n'}});return t.registerPartial("csui_dialogs_members.picker_impl_selectedMembers_impl_selectedMember",s),s}),csui.define("csui/dialogs/members.picker/impl/selectedMembers/selectedMember",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/utils/base","csui/utils/url","csui/utils/user.avatar.color","csui/behaviors/keyboard.navigation/tabable.region.behavior","hbs!csui/dialogs/members.picker/impl/selectedMembers/impl/selectedMember","i18n!csui/dialogs/members.picker/impl/nls/lang"],function(e,i,t,s,n,o,l,r,a){return t.ItemView.extend({"template":r,"tagName":"div","className":"csui-userpicker-item","ui":{"closeButton":".close","personalizedImage":".csui-icon-user","defaultImage":".csui-icon-paceholder"},"behaviors":{"TabableRegion":{"behaviorClass":l}},"events":{"click @ui.closeButton":"onRemoveButtonClicked"},"currentlyFocusedElement":function(){return this.ui.closeButton},"templateHelpers":function(){return{"name":s.formatMemberName(this.model),"department":this.model.get("group_id")&&this.model.get("group_id").name,"id":this.model.get("id"),"initials":this.model.get("initials"),"userImgSrc":"data:image/gif;base64,R0lGODlhAQABAIAAAAUEBAAAACwAAAAAAQABAAACAkQBADs=","removeSelectedUser":a.removeSelectedUser,"removeSelectedUserAria":e.str.sformat(a.removeSelectedUserAria,this.model.get("name_formatted"))}},"constructor":function(e){e||(e={}),e.disabledMessage||(e.disabledMessage=""),t.ItemView.prototype.constructor.call(this,e),this.listenTo(this,"render",this._assignUserColor)},"onRender":function(){this.options.lightWeight||this._displayProfileImage()},"onDestroy":function(){this._releasePhotoUrl()},"onRemoveButtonClicked":function(e){e.stopPropagation(),e.preventDefault(),this._parent.trigger("remove:selectItem",this.model)},"_displayProfileImage":function(){var i=this._getUserPhotoUrl();if(this.ui.personalizedImage.addClass("esoc-userprofile-img-"+this.model.get("id")),i){var t={"url":i,"dataType":"binary"};this._releasePhotoUrl(),this.options.model.connector.makeAjaxCall(t).always(e.bind(function(e,i,t){200===t.status?this._showPersonalizedImage(e):this._showDefaultImage()},this))}else this._showDefaultImage()},"_getUserPhotoUrl":function(){var e=this.options.model&&this.options.model.connector.connection||this.options.connector&&this.options.connector.connection,i=new n(e.url).getCgiScript(),t=this.model.get("photo_url");if(t&&t.indexOf("?")>0)return n.combine(i,t)},"_showPersonalizedImage":function(e){this._releasePhotoUrl(),this._photoUrl=URL.createObjectURL(e),this.ui.personalizedImage.attr("src",this._photoUrl),this.ui.defaultImage.addClass("binf-hidden"),this.ui.personalizedImage.removeClass("binf-hidden")},"_showDefaultImage":function(e){this._releasePhotoUrl(),this.ui.personalizedImage.addClass("binf-hidden"),this.ui.defaultImage.removeClass("binf-hidden")},"_releasePhotoUrl":function(){this._photoUrl&&(URL.revokeObjectURL(this._photoUrl),this._photoUrl=void 0)},"_assignUserColor":function(){var e=o.getUserAvatarColor(this.model.attributes);this.ui.defaultImage.css("background",e)}})}),csui.define("hbs!csui/dialogs/members.picker/impl/selectedMembers/impl/selectedMemberList",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){return'<div class="csui-selected-member-list"></div>'}});return t.registerPartial("csui_dialogs_members.picker_impl_selectedMembers_impl_selectedMemberList",s),s}),csui.define("css!csui/dialogs/members.picker/impl/selectedMembers/impl/selectedMember",[],function(){}),csui.define("csui/dialogs/members.picker/impl/selectedMembers/selectedMemberList",["csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/dialogs/members.picker/impl/selectedMembers/selectedMember","csui/controls/tile/behaviors/perfect.scrolling.behavior","hbs!csui/dialogs/members.picker/impl/selectedMembers/impl/selectedMemberList","csui/controls/mixins/layoutview.events.propagation/layoutview.events.propagation.mixin","css!csui/dialogs/members.picker/impl/selectedMembers/impl/selectedMember"],function(e,i,t,s,n,o,l,r){var a=s.CollectionView.extend({"template":l,"childView":n,"childViewContainer":".csui-selected-member-list","childViewOptions":{"collection":this.collection},"ui":{"memberListContainer":".csui-selected-member-list"},"behaviors":{"PerfectScrolling":{"behaviorClass":o,"suppressScrollX":!0,"scrollYMarginOffset":15}},"constructor":function(e){e||(e={}),this.collection=e.collection||new t.Collection,s.CollectionView.prototype.constructor.apply(this,arguments),this.listenTo(this,"show:selectItem",i.bind(function(e){this.collection.add(e)},this))},"onRender":function(){this.listenTo(this,"remove:selectItem",i.bind(function(e){this.collection.remove(e)},this))}});return i.extend(a.prototype,r),a}),csui.define("csui/models/memberancestorcollection",["module","csui/lib/underscore","csui/lib/jquery","csui/lib/backbone"],function(e,i,t,s){"use strict";return s.Collection.extend({"constructor":function(e,i,t){s.Collection.prototype.constructor.apply(this,arguments),this.context=t},"clone":function(){return new this.constructor(this.attributes,{"connector":this.connector})},"isFetchable":function(){return!1},"add":function(e,i){s.Collection.prototype.add.apply(this,arguments),this.trigger("sync",this)},"findByIndex":function(e){for(var i=0;i<this.models.length;i++)if(this.models[i].id===e)return i;return-1}})}),csui.define("hbs!csui/dialogs/members.picker/impl/members.picker",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){return'<div id="csui-mp-selected-member-list-container"\r\n     class="csui-mp-selected-member-list-container"></div>\r\n<div id="csui-mp-breadcrumbs" class="cs-breadcrumb">\r\n  <div role="navigation" class="breadcrumb-inner"></div>\r\n  <div class="searchheader-inner"></div>\r\n</div>\r\n<div id="csui-mp-selectviews"></div>\r\n'}});return t.registerPartial("csui_dialogs_members.picker_impl_members.picker",s),s}),csui.define("csui/dialogs/members.picker/impl/members.picker.view",["module","csui/lib/jquery","csui/lib/underscore","csui/lib/marionette","csui/utils/log","csui/utils/base","csui/models/member/member.model","csui/dialogs/members.picker/impl/select.views/select.views","csui/dialogs/members.picker/impl/selectedMembers/selectedMemberList","csui/controls/breadcrumbs/breadcrumbs.view","csui/models/memberancestorcollection","hbs!csui/dialogs/members.picker/impl/members.picker","csui/controls/mixins/layoutview.events.propagation/layoutview.events.propagation.mixin"],function(e,i,t,s,n,o,l,r,a,c,u,d,h){var p=s.LayoutView.extend({"template":d,"regions":{"breadcrumbRegion":"#csui-mp-breadcrumbs > .breadcrumb-inner","searchHeaderRegion":"#csui-mp-breadcrumbs > div.searchheader-inner","selectViewRegion":"#csui-mp-selectviews","selectedMemberListRegion":"#csui-mp-selected-member-list-container"},"ui":{"breadcrumb":"#csui-mp-breadcrumbs","breadcrumbContent":".breadcrumb-inner","selectViews":"#csui-mp-selectviews"},"constructor":function(e){e||(e={}),s.LayoutView.prototype.constructor.call(this,e),this.propagateEventsToRegions(),this.rootGroup=e.container,this.ancestorCollection=new u(this.rootGroup.clone(),e,e.context),e.rootGroup=this.rootGroup,e.ancestorCollection=this.ancestorCollection,this.setBreadcrumbs(e),this.setViews(e),this.onWinRefresh=t.bind(this.windowRefresh,this),i(window).bind("resize.app",this.onWinRefresh)},"windowRefresh":function(){var e=i(".cs-breadcrumb"),t=e.is(":visible")?e.height():0;this.$el.height();window.chrome,this.selectViews.triggerMethod("dom:refresh",this.selectViews)},"onDestroy":function(){i(window).unbind("resize.app",this.onWinRefresh)},"onRender":function(){this.options.searchView&&this.searchHeaderRegion.show(this.searchHeaderView),this.breadcrumbs&&this.breadcrumbRegion.show(this.breadcrumbs),this.selectViews.options.navigateFromHistory=this.options.navigateFromHistory,this.selectViewRegion.show(this.selectViews),this.selectedMemberListRegion.show(this.selectedMemberList)},"onDomRefresh":function(){this.windowRefresh()},"onShow":function(){t.each(this.regionManager.regions,function(e){e.currentView&&e.currentView.trigger("show")}),this.options.adduserorgroup&&1===this.ancestorCollection.length&&(this.ui.breadcrumb.hide(),this.ui.selectViews.addClass("csui-full-height"))},"setViews":function(e){var i=this.selectViews=new r(e);this.selectedMemberList=new a,this.listenTo(i,"changed",this.updateBreadcrumbs),this.listenTo(i,"change:location",t.bind(this.trigger,this,"change:location")),this.listenTo(i,"change:complete",t.bind(this.trigger,this,"change:complete")),this.listenTo(i,"close",this.close),this.listenTo(this.selectedMemberList,"add:child remove:child",this.onMemberListChange)},"onMemberListChange":function(){this.adjustSelectViews(),this.trigger("update:button",this.selectedMemberList.collection)},"adjustSelectViews":function(){var e=this.selectedMemberList.collection.length<3?this.selectedMemberList.collection.length:3,i=e?e*this.selectedMemberList.$el.find(".csui-userpicker-item").height():0,t=i?"calc(100% - "+i+"px)":"100%";this.selectViews.$el.find(".list-content").css({"height":t})},"getSelection":function(){return this.selectViews.getSelection()},"getNumberOfSelectItems":function(){return this.selectViews.getNumberOfSelectItems()},"close":function(){this.destroy(),this.trigger("close")},"updateBreadcrumbs":function(){return this.options.adduserorgroup&&1===this.ancestorCollection.length?(this.ui.breadcrumb.hide(),this.ui.selectViews.addClass("csui-full-height")):(this.ui.breadcrumb.show(),this.ui.breadcrumbContent.show(),this.ui.selectViews.removeClass("csui-full-height")),this.windowRefresh(),this.adjustSelectViews(),!0},"setBreadcrumbs":function(e){return this.breadcrumbs=new c({"node":e.rootGroup,"collection":e.ancestorCollection}),this.setBreadcrumbEvents(),!0},"setBreadcrumbEvents":function(){this.listenTo(this.breadcrumbs,"before:defaultAction",function(e){var i=this.selectViews,t=this;i.newLeftView(e.node).done(function(e){i.setParentGroupAsTarget(e.container),t.trigger("change:complete",e.container)})})}});return t.extend(p.prototype,h),p}),csui.define("csui/dialogs/members.picker/start.locations/start.location.collection",["require","module","csui/lib/underscore","csui/lib/jquery","csui/lib/backbone"],function(e,i,t,s,n){"use strict";function o(e){return e.lastIndexOf("/")>=0?e:"csui/dialogs/members.picker/start.locations/"+e}function l(e){return!t.contains(c.blacklist,e)&&(!c.whitelist.length||t.contains(c.whitelist,e))}var r=i.config(),a=r.startLocations||[],c=r.masks||{};t.isArray(a)||(a=Array.prototype.concat.apply([],t.values(a))),c=t.reduce(t.values(c),function(e,i){return{"blacklist":e.blacklist.concat(i.blacklist||[]),"whitelist":e.whitelist.concat(i.whitelist||[])}},{"blacklist":[],"whitelist":[]}),c={"blacklist":t.unique(c.blacklist),"whitelist":t.unique(c.whitelist)},a=t.chain(a).map(o).filter(l).unique().value();var u=n.Model.extend({"defaults":{"id":null,"name":null,"icon":null,"invalid":!1,"factory":null,"unselectable":!0},"constructor":function(e,i){n.Model.prototype.constructor.apply(this,arguments)},"sync":function(e,i,t){if("read"!==e)throw new Error("Only fetching the widget is supported.");var n=this;return t||(t={}),this._resolveFactory(t).then(function(){return n.get("factory").updateLocationModel(n)}).then(function(){var e=n.toJSON();t.success&&t.success(e,t),n.trigger("sync",n,e,t)},function(){var e=n.get("error");return t.error&&t.error(e,t),n.trigger("error",n,e,t),s.Deferred().reject(e)})},"_resolveFactory":function(i){var t=this,n=s.Deferred(),o=this.getFactoryData(),l=this.getFactoryModulePath(o);return e([l],function(e){t.set("factory",new e(i)),n.resolve()},function(e){t.set("error",e),i.ignoreErrors?n.resolve():n.reject(e)}),n.promise()},"getFactoryData":function(){var e,i=this.get("id"),t=i.lastIndexOf("/");return t<0?e="csui/dialogs/members.picker/start.locations/"+i:(e=i,i=i.substring(t+1)),{"name":i,"path":e}},"getFactoryModulePath":function(e){return e.path+"/"+e.name+".factory"}});return n.Collection.extend({"model":u,"constructor":function(e){e||(e={});var i=e.startLocations;i=i?t.chain(i).concat(["current.group"]).map(o).filter(l).unique().value():a;var s=t.map(i,function(e){return{"id":e}});n.Collection.prototype.constructor.call(this,s,e)},"sync":function(e,i,t){if("read"!==e)throw new Error("Only fetching the start locations is supported.");var s=this;return t||(t={}),this._resolveFactories(t).then(function(){if(!1!==t.removeInvalid){var e=s.where({"invalid":!0});s.remove(e)}var i=s.toJSON();t.success&&t.success(i,t),s.trigger("sync",s,i,t)})},"_resolveFactories":function(e){var i=this.filter(function(e){return e.has("id")&&!(e.has("factory")||e.has("error"))}),n=t.defaults({"ignoreErrors":!0},t.omit(e,"success","error")),o=t.invoke(i,"fetch",n);return s.when.apply(s,o)}})}),csui.define("csui/dialogs/members.picker/impl/command.type",["module","csui/lib/underscore","i18n!csui/dialogs/members.picker/impl/nls/lang"],function(e,i,t){var s=(e.config(),function(e){var i=e.initialContainer;this.unselectableMembers=e.unselectableMembers,this.selectableMembers=e.selectableMembers,this.invalidMembers=e.invalidMembers,this.selectableTypes=e.selectableTypes||[],this.unselectableTypes=e.unselectableTypes||[],this.showAllTypes=e.showAllTypes||!1,this.parentId=i?i.get("id"):-1,this.addButtonLabel=e.addButtonLabel||t.addButtonLabel});return i.extend(s.prototype,{"getSelectableMemberTypes":function(){return this.showAllTypes?[]:this.selectableTypes},"validateTarget":function(e){var t=e.data?e.data.id:e.get("id"),s=e.get("type"),n=i.every(this.unselectableMembers,function(e){return t!==e});return this.browseAllowed(e)&&(n=i.every(this.unselectableTypes,function(e){return s!==e})),n},"validId":function(e){return(e.data?e.data.id:e.get("id"))!==this.parentId},"validateAddableTypes":function(e){return!e.addable_types},"isSelectableType":function(e){var t=e.get("type");if(!t&&0!==t)return!1;var s=i.every(this.unselectableTypes,function(e){return t!==e});return s&&!i.isEmpty(this.selectableTypes)&&!(s=-1!==i.indexOf(this.selectableTypes,t))&&this.browseAllowed(e)&&i.indexOf(this.selectableTypes,-1)>-1&&(s=!0),s},"isSelectable":function(e){var t=e.data?e.data.id:e.get("id");if(e.get("unselectable"))return!1;var s=this.isSelectableType(e);return s&&(s=i.every(this.unselectableMembers,function(e){return t!==e})),this.selectableMembers&&(s=1===e.get("type")),s},"browseAllowed":function(e){return 1===e.get("type")},"validateMember":function(e){var i=this._hasValidId(e);return i&&!this.showAllTypes&&(this.browseAllowed(e)||this.selectableTypes.length>0&&-1===this.selectableTypes.indexOf(e.get("type"))&&(i=!1)),i},"_hasValidId":function(e){return i.every(this.invalidmembers,function(i){return i.get("id")!==e.get("id")})}}),s}),csui.define("hbs!csui/dialogs/node.picker/impl/header/start.location.selector/start.location.selector.item",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"1":function(e,i,t,s){var n;return'    <span class="cs-icon '+this.escapeExpression((n=null!=(n=i.iconClass||(null!=e?e.iconClass:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"iconClass","hash":{}}):n))+'"></span>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){var n,o;return'<a role="menuitem" tabindex="-1" href="#" class='+this.escapeExpression((o=null!=(o=i.class||(null!=e?e.class:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"class","hash":{}}):o))+">\r\n"+(null!=(n=i.if.call(e,null!=e?e.icon:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?n:"")+'  <span class="cs-label">'+this.escapeExpression((o=null!=(o=i.name||(null!=e?e.name:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"name","hash":{}}):o))+"</span>\r\n</a>\r\n"}});return t.registerPartial("csui_dialogs_node.picker_impl_header_start.location.selector_start.location.selector.item",s),s}),csui.define("hbs!csui/dialogs/node.picker/impl/header/start.location.selector/start.location.selector",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){var n;return'<button id="'+this.escapeExpression((n=null!=(n=i.id||(null!=e?e.id:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"id","hash":{}}):n))+'" class="binf-btn binf-btn-default binf-dropdown-toggle csui-acc-focusable"\r\n        data-binf-toggle="dropdown" aria-haspopup="true" aria-expanded="false"\r\n        aria-label="'+this.escapeExpression((n=null!=(n=i.labelSelectLocation||(null!=e?e.labelSelectLocation:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"labelSelectLocation","hash":{}}):n))+'">\r\n  <span class="'+this.escapeExpression((n=null!=(n=i.iconClass||(null!=e?e.iconClass:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"iconClass","hash":{}}):n))+'"></span>\r\n  <span class="cs-label">'+this.escapeExpression((n=null!=(n=i.name||(null!=e?e.name:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"name","hash":{}}):n))+'</span>\r\n  <span class="cs-icon icon-caret-down"></span>\r\n</button>\r\n<div class="csui-separator"></div>\r\n<ul class="binf-dropdown-menu" role="menu" aria-labelledby="'+this.escapeExpression((n=null!=(n=i.id||(null!=e?e.id:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"id","hash":{}}):n))+'"></ul>\r\n'}});return t.registerPartial("csui_dialogs_node.picker_impl_header_start.location.selector_start.location.selector",s),s}),csui.define("csui/dialogs/node.picker/start.locations/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/dialogs/node.picker/start.locations/impl/nls/root/lang",{"labelNoSelection":"Go to...","labelSearch":"Search","labelCurrentLocation":"Current location","labelFavorites":"Favorites","labelEnterpriseVolume":"Enterprise Volume","labelPersonalVolume":"Personal Volume","labelPerspectiveAssetsVolume":"Perspective Assets Volume","labelRecentContainers":"Recent Places","labelSelectLocation":"Select start location"}),csui.define("css!csui/dialogs/node.picker/impl/header/start.location.selector/start.location.selector",[],function(){}),csui.define("csui/dialogs/node.picker/impl/header/start.location.selector/start.location.selector.view",["csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/behaviors/keyboard.navigation/tabable.region.behavior","hbs!csui/dialogs/node.picker/impl/header/start.location.selector/start.location.selector.item","hbs!csui/dialogs/node.picker/impl/header/start.location.selector/start.location.selector","i18n!csui/dialogs/node.picker/start.locations/impl/nls/lang","css!csui/dialogs/node.picker/impl/header/start.location.selector/start.location.selector","csui/lib/binf/js/binf"],function(e,i,t,s,n,o,l){"use strict";function r(e){var i=e.get("icon")||"";return i&&i.indexOf("-")<0&&(i="icon-menu-"+i),"cs-icon "+i}var a=t.ItemView.extend({"tagName":"li","attributes":{"role":"presentation"},"template":n,"templateHelpers":function(){return{"iconClass":r(this.model)}},"triggers":{"click >a":"click:link"},"constructor":function(){t.ItemView.prototype.constructor.apply(this,arguments),this.listenTo(this.model,"change",this.render)}})
;return t.CompositeView.extend({"className":"dropdown-locations","template":o,"childView":a,"childViewContainer":"> .binf-dropdown-menu","behaviors":{"TabableRegion":{"behaviorClass":s}},"ui":{"toggle":"> .binf-dropdown-toggle","selectedLabel":">.binf-dropdown-toggle >.cs-label","selectedIcon":">.binf-dropdown-toggle >.cs-icon:not(.icon-caret-down)","selectedLocation":">.binf-dropdown-toggle >span:not(.icon-caret-down)"},"events":{"keyup":"onKeyInView"},"constructor":function(e){t.CompositeView.prototype.constructor.apply(this,arguments),this.selected=new i.Model,this.options.selected?this._setSelection(this.options.selected.attributes):this.resetSelection(),this.listenTo(this.collection,"change",this._refreshSelection),this.listenTo(this.selected,"change",this._updateSelection),this.listenTo(i,"closeToggleAction",this._closeToggle)},"filter":function(e,i,t){return!e.get("hide")},"currentlyFocusedElement":function(){return this.$el.find("button")},"accDeactivateTabableRegion":function(){this._closeToggle()},"reset":function(){this.resetSelection()},"resetSelection":function(){this.selected.set({"id":e.uniqueId(),"name":l.labelNoSelection,"icon":""})},"serializeData":function(){var i=e.pick(this.selected.toJSON(),["id","name","icon"]);return e.defaults({"id":e.uniqueId()},i)},"templateHelpers":function(){return{"search":l.labelSearch,"iconClass":r(this.selected),"labelSelectLocation":l.labelSelectLocation}},"onKeyInView":function(e){var i=this.$el.hasClass("binf-open");if(27===e.keyCode&&i)return this.$el.removeClass("binf-open"),this.$('*[tabindex = "0"]').focus(),!1},"onRender":function(){this.ui.toggle.binf_dropdown()},"onChildviewClickLink":function(e){this.ui.selectedLabel.removeClass("select-prompt"),this._setSelection(e.model.attributes),this.ui.toggle.binf_dropdown("toggle"),this.ui.selectedLocation.removeClass("binf-hide"),this.triggerMethod("change:location",e.model),this.$el.trigger("setCurrentTabFocus")},"hideDropDownLabel":function(e){var i=this.selected.get("factory"),t=i.getLocationParameters().container,s=t&&t.get("id");(e&&e.get("id"))!==s&&(this._setSelection({"name":l.labelSelectLocation,"id":""}),this.ui.selectedLabel.addClass("select-prompt"),this.ui.selectedIcon.addClass("binf-hide"))},"_setSelection":function(e){this.selected.set(e)},"_updateSelection":function(){this.ui.selectedLabel.text(this.selected.get("name")),this.ui.selectedIcon.attr("class",r(this.selected))},"_refreshSelection":function(e){e.get("id")===this.selected.get("id")&&this._setSelection(e.attributes)},"_closeToggle":function(){var e=this.$el;e.hasClass&&e.hasClass("binf-open")&&this.ui.toggle.binf_dropdown("toggle"),this.ui.toggle&&this.ui.toggle.attr&&this.ui.toggle.attr("aria-expanded","false")}})}),csui.define("hbs!csui/dialogs/members.picker/impl/header/user.search/user.search",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){var n;return'<div class="csui-user-search-container">\r\n  <div class="csui-user-search-bar"></div>\r\n</div><a href="javascript:void(0);" class="icon icon-global-search csui-header-userpicker-icon\r\n         icon-header-search csui-acc-focusable" title="'+this.escapeExpression((n=null!=(n=i.searchIconTitle||(null!=e?e.searchIconTitle:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"searchIconTitle","hash":{}}):n))+'" tabindex="0"\r\n         data-cstabindex="-1" role="button" aria-expanded="false"\r\n         aria-label="'+this.escapeExpression((n=null!=(n=i.searchIconAria||(null!=e?e.searchIconAria:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"searchIconAria","hash":{}}):n))+'"></a>'}});return t.registerPartial("csui_dialogs_members.picker_impl_header_user.search_user.search",s),s}),csui.define("csui/dialogs/members.picker/impl/header/user.search/user.search.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/marionette","csui/behaviors/keyboard.navigation/tabable.region.behavior","i18n","i18n!csui/dialogs/members.picker/impl/nls/lang","hbs!csui/dialogs/members.picker/impl/header/user.search/user.search"],function(e,i,t,s,n,o,l){return t.ItemView.extend({"className":"csui-user-lookup","template":l,"templateHelpers":{"searchIconTitle":o.searchIconTitle,"searchIconAria":o.searchIconAria},"ui":{"input":".cs-search","userPickerIcon":".csui-header-userpicker-icon"},"events":{"click @ui.userPickerIcon":"userPickerIconClicked"},"initialize":function(e){this.options=e},"constructor":function(e){e||(e={}),e.data||(e.data={}),this.options=e,this.direction=n.settings.rtl?"left":"right",t.ItemView.prototype.constructor.call(this,e)},"onShow":function(){var e=this;csui.require(["csui/controls/userpicker/userpicker.view"],function(s){e.pickerView=new s({"context":e.options.context,"limit":5,"memberFilter":{"type":[0,1]},"widgetoptions":e.options,"placeholder":e.options.placeHolder||o.UserPickerPlaceHolder,"prettyScrolling":!0,"scrollContainerHeight":"auto","model":e.options.userPickerModel,"id_input":i.uniqueId("csui-inline-permissions-user-picker-input"),"lightWeight":!1}),new t.Region({"el":e.$el.find(".csui-user-search-bar")}).show(e.pickerView),e.listenTo(e.pickerView,"item:change",e.processItemChange),e.listenTo(e.pickerView,"item:clear",e.processItemChange)})},"processItemChange":function(){var e=arguments.length>0&&arguments[0].item;this.param=e,this.trigger("show:selectItem",this.param),this.processAfterSelect()},"processAfterSelect":function(){""!==this.pickerView.ui.searchbox.val()&&this.pickerView&&this.pickerView.ui&&this.pickerView.ui.searchclear&&this.pickerView.ui.searchclear.trigger("click")},"updatePlaceHolder":function(e){e?this.$el.find("input").attr("placeholder",o.addAnotherNamePlaceHolder):this.$el.find("input").attr("placeholder",o.UserPickerPlaceHolder)},"currentlyFocusedElement":function(e){if(this.$el){var i=this.$el.find("*[data-cstabindex=-1]");i.length&&i.prop("tabindex",0);!(!!e&&e.shiftKey)&&this.$el.find(".search-bar").length&&this.$el.find(".search-bar").is(":visible")?this.focusElement=this.$el.find(".csui-input"):this.$el.find("a.csui-acc-focusable").length&&(this.focusElement=this.$el.find("a.csui-acc-focusable"))}return this.focusElement},"userPickerIconClicked":function(i){if(e(document).bind("click."+this.cid+" keydown."+this.cid,this,this._hideSearchBar),this.ui.input.toggleClass(s.accessibilityFocusableClass),this.$el.find(".csui-user-search-container").is(":visible"));else if(this.$el&&this.$el.parents()){var t=this;this.hideStartLocations(),this.$el.find(".csui-user-search-container").show("blind",{"direction":this.direction},"200",function(){t.$el.find(".csui-user-search-container input").focus()})}this.ui.userPickerIcon.attr("aria-expanded",!0)},"_hideSearchBar":function(i){var t=i||window.event,s=e(".csui-user-search-container"),n=i.data;s.is(":visible")&&(("keydown"!==t.type||27!==t.keyCode&&27!==t.which)&&(e(t.target).closest(s).length||"click"!==t.type||e(t.target).closest(".csui-header-userpicker-icon").length)||(n.$el.find(".csui-user-search-container input").val(""),n.$el.find(s).hide("blind",{"direction":i.data.direction},"200",function(){n.showStartLocations(),n.focusedElement=void 0,n.currentlyFocusedElement().focus()}),e(document).unbind("click."+n.cid+" keydown."+n.cid),n.ui.userPickerIcon instanceof Object&&n.ui.userPickerIcon.attr("aria-expanded",!1)))},"showStartLocations":function(e){this.trigger("show:startLocation")},"hideStartLocations":function(e){this.trigger("hide:startLocation")}})}),csui.define("hbs!csui/dialogs/members.picker/impl/header/members.picker.header",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"1":function(e,i,t,s){var n,o;return'  <h2 class="member-title">'+(null!=(o=null!=(o=i.title||(null!=e?e.title:e))?o:i.helperMissing,n="function"==typeof o?o.call(e,{"name":"title","hash":{}}):o)?n:"")+'</h2><span class="csui-separator"></span>\r\n  <div class="csui-target-controls">\r\n'+(null!=(n=i.if.call(e,null!=e?e.locationSelector:e,{"name":"if","hash":{},"fn":this.program(2,s,0),"inverse":this.noop}))?n:"")+'    <div class="csui-member-picker-container">\r\n      <div class="csui-member-picker"></div>\r\n    </div>\r\n  </div>\r\n'},"2":function(e,i,t,s){var n;return'      <div class="csui-start-locations binf-dropdown '+(null!=(n=i.if.call(e,null!=e?e.displayStartLocation:e,{"name":"if","hash":{},"fn":this.program(3,s,0),"inverse":this.noop}))?n:"")+'"></div>\r\n'},"3":function(e,i,t,s){return"binf-hidden"},"5":function(e,i,t,s){var n,o;return'  <h2 class="member-title member-picker-view-header">'+this.escapeExpression((o=null!=(o=i.title||(null!=e?e.title:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"title","hash":{}}):o))+'</h2><span\r\n      class="csui-view-separator csui-separator binf-hidden"></span>\r\n  <div class="csui-target-controls">\r\n'+(null!=(n=i.if.call(e,null!=e?e.isNotDeleted:e,{"name":"if","hash":{},"fn":this.program(6,s,0),"inverse":this.noop}))?n:"")+"  </div>\r\n"},"6":function(e,i,t,s){var n;return'      <div class="csui-member-picker-container">\r\n        <span class="csui-member-picker"></span>\r\n        <span tabindex="-1" class="csui-add-member icon-toolbarAdd binf-hidden"\r\n              title="'+this.escapeExpression((n=null!=(n=i.addMemberTitle||(null!=e?e.addMemberTitle:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"addMemberTitle","hash":{}}):n))+'"></span>\r\n      </div>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){var n;return null!=(n=i.if.call(e,null!=e?e.adduserorgroup:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.program(5,s,0)}))?n:""}});return t.registerPartial("csui_dialogs_members.picker_impl_header_members.picker.header",s),s}),csui.define("css!csui/dialogs/members.picker/impl/header/members.picker.header",[],function(){}),csui.define("csui/dialogs/members.picker/impl/header/members.picker.header.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/dialogs/node.picker/impl/header/start.location.selector/start.location.selector.view","csui/dialogs/members.picker/impl/header/user.search/user.search.view","csui/behaviors/keyboard.navigation/tabable.region.behavior","hbs!csui/dialogs/members.picker/impl/header/members.picker.header","i18n!csui/dialogs/members.picker/impl/nls/lang","css!csui/dialogs/members.picker/impl/header/members.picker.header"],function(e,i,t,s,n,o,l,r){return t.LayoutView.extend({"template":l,"className":"cs-header-control","regions":{"startLocations":".csui-start-locations","userSearch":".csui-member-picker"},"templateHelpers":function(){return{"adduserorgroup":this.options.adduserorgroup,"locationSelector":this.options.locationSelector,"displayStartLocation":this.options.displayStartLocation,"isNotDeleted":!(this.options.headerViewoptions.selectedGroup&&this.options.headerViewoptions.selectedGroup.get("right_id_expand").deleted),"title":this.options.title?this.options.title:r.dialogTitle,"addMemberTitle":r.AddMember}},"ui":{"addIcon":".csui-add-member.icon-toolbarAdd","memberPickerContainer":".csui-member-picker-container","viewSeparator":".csui-view-separator","headerTitle":".member-picker-view-header"},"events":{"click @ui.addIcon":"onAddMemberClick","keyup":"onKeyInView"},"onAddMemberClick":function(e){e.stopPropagation(),e.preventDefault(),this.ui.addIcon.addClass("binf-hidden"),this.ui.viewSeparator.removeClass("binf-hidden"),this.ui.headerTitle.html(r.AddUserOrGroup),this.editPermission&&this.showUserSearchView(e),this.trigger("enable:add")},"behaviors":{"TabableRegion":{"behaviorClass":o}},"currentlyFocusedElement":function(e){if(this.$el){var t=this.$("*[tabindex]:visible");return t.length&&t.prop("tabindex",0),!!t[0]&&i(t[0])}},"onKeyInView":function(e){13===e.keyCode&&i(e.target).hasClass("csui-add-member")&&i(e.target).trigger("click")},"initialize":function(){var e=this.options;e.locationSelector&&e.adduserorgroup&&(this.startLocationView=new s({"collection":this.options.locations,"title":this.options.dialogTitle,"selected":this.options.initialLocation}),e.placeHolder=void 0!==this.options.selectedMember?r.addAnotherNamePlaceHolder:r.userSearchPlaceHolder,e.addAnotherNamePlaceHolder=r.addAnotherNamePlaceHolder,this.options=e)},"onRender":function(){var e=this.options,i=this.options.authUser&&this.options.authUser.get("id"),t=this.options.headerViewoptions.selectedGroup&&this.options.headerViewoptions.selectedGroup.get("right_id_expand").leader_id,s=!1;t&&t===i&&(s=!0),this.editPermission=(s||this.options.hasEditPermissionAction)&&this.options.node&&"simple"!==this.options.node.get("permissions_model"),this.editPermission?this.ui.addIcon.removeClass("binf-hidden"):this.ui.addIcon.addClass("binf-hidden"),this.options.showUserPicker&&(this.ui.addIcon.addClass("binf-hidden"),this.showUserSearchView(),this.trigger("enable:add")),this.startLocationView&&e.adduserorgroup&&(this.startLocations.show(this.startLocationView),this.options.showUserPicker&&(this.showUserSearchView(),this.userSearchView.on("show:startLocation",this.showStartLocations,this),this.userSearchView.on("hide:startLocation",this.hideStartLocations,this)))},"showUserSearchView":function(e){this.userSearchView=new n(this.options),this.userSearch.show(this.userSearchView),this.userSearchView.userPickerIconClicked(e),this.userSearchView.on("show:selectItem",this.selectUsers,this)},"selectUsers":function(e){e&&this.trigger("show:selectItem",e)},"showStartLocations":function(){this.startLocationView.$el.removeClass("binf-hidden")},"hideStartLocations":function(){this.startLocationView.$el.addClass("binf-hidden")},"onDestroy":function(){this.startLocationView&&this.startLocationView.destroy()}})}),csui.define("csui/controls/wizard/step/impl/footer.view",["csui/lib/marionette","csui/behaviors/keyboard.navigation/tabable.region.behavior"],function(e,i){var t=e.ItemView.extend({"tagName":"button","className":"binf-btn","template":!1,"triggers":{"click":"click"},"behaviors":{"TabableRegion":{"behaviorClass":i}},"constructor":function(i){e.View.prototype.constructor.apply(this,arguments)},"isTabable":function(){return this.$el.is(":not(:disabled)")&&this.$el.is(":not(:hidden)")},"currentlyFocusedElement":function(){return-1===this.$el.prop("tabindex")&&this.$el.prop("tabindex",0),this.$el},"onRender":function(){var e=this.$el,i=this.model.attributes;e.text(i.label),e.addClass(i.default?"binf-btn-primary cs-add-button":"binf-btn-default"),i.toolTip&&e.attr("title",i.toolTip),i.separate&&e.addClass("cs-separate"),this.updateButton(i)},"updateButton":function(e){var i=this.$el;e||(e={}),void 0!==e.hidden&&(e.hidden?i.addClass("binf-hidden"):i.removeClass("binf-hidden")),void 0!==e.disabled&&i.prop("disabled",e.disabled)}});return e.CollectionView.extend({"childView":t,"constructor":function(i){e.CollectionView.prototype.constructor.apply(this,arguments),this.listenTo(this,"update:button",this.selectedMemberCollection,this)},"onDomRefresh":function(){this.children.each(function(e){e.trigger("dom:refresh")})},"selectedMemberCollection":function(e){this.selectedMemberCollection=e},"getButtons":function(){return this.children.toArray()},"updateButton":function(e,i){var s=this.collection.get(e);s?this.children.findByModel(s).updateButton(i):!!t.updateButton&&t.updateButton(this.$('[data-cs-id="'+e+'"]'),i)},"getPreviousButton":function(){return this.children.toArray()[0]},"getNextButton":function(){var e=this.children.toArray();return e[e.length-1]}})}),csui.define("hbs!csui/controls/wizard/step/impl/step.header",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"1":function(e,i,t,s){var n,o;return(null!=(n=i.if.call(e,null!=e?e.actionIconLeft:e,{"name":"if","hash":{},"fn":this.program(2,s,0),"inverse":this.noop}))?n:"")+(null!=(n=i.if.call(e,null!=e?e.iconLeft:e,{"name":"if","hash":{},"fn":this.program(4,s,0),"inverse":this.program(6,s,0)}))?n:"")+'    <h4 class="tile-title binf-modal-title">'+this.escapeExpression((o=null!=(o=i.title||(null!=e?e.title:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"title","hash":{}}):o))+'</h4>\r\n  </div>\r\n\r\n    <div class="cs-header-control"></div>\r\n\r\n'+(null!=(n=i.if.call(e,null!=e?e.showCloseBtn:e,{"name":"if","hash":{},"fn":this.program(11,s,0),"inverse":this.noop}))?n:"")+"\r\n"},"2":function(e,i,t,s){var n;return'    <span class="tile-type-action-icon cs-icon-left '+this.escapeExpression((n=null!=(n=i.actionIconLeft||(null!=e?e.actionIconLeft:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"actionIconLeft","hash":{}}):n))+'" tabindex="0"></span>\r\n'},"4":function(e,i,t,s){var n;return'    <span class="tile-type-icon cs-icon-left '+this.escapeExpression((n=null!=(n=i.iconLeft||(null!=e?e.iconLeft:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"iconLeft","hash":{}}):n))+'"></span>\r\n    <div class="tile-title">\r\n'},"6":function(e,i,t,s){var n;return null!=(n=i.if.call(e,null!=e?e.imageLeftUrl:e,{"name":"if","hash":{},"fn":this.program(7,s,0),"inverse":this.program(9,s,0)}))?n:""},"7":function(e,i,t,s){var n;return'        <div class="tile-type-image '+this.escapeExpression((n=null!=(n=i.imageLeftClass||(null!=e?e.imageLeftClass:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"imageLeftClass","hash":{}}):n))+'">\r\n          <img src="'+this.escapeExpression((n=null!=(n=i.imageLeftUrl||(null!=e?e.imageLeftUrl:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"imageLeftUrl","hash":{}}):n))+'" aria-hidden="true" alt="">\r\n        </div>\r\n      <div class="tile-title">\r\n'},"9":function(e,i,t,s){return'      <div class="tile-title cs-text-only">\r\n'},"11":function(e,i,t,s){var n;return'      <div class="cs-close" title="'+this.escapeExpression((n=null!=(n=i.dialogCloseButtonTooltip||(null!=e?e.dialogCloseButtonTooltip:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"dialogCloseButtonTooltip","hash":{}}):n))+'">\r\n        <div class="icon circular '+this.escapeExpression((n=null!=(n=i.iconRight||(null!=e?e.iconRight:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"iconRight","hash":{}}):n))+'" tabindex="0" aria-label="'+this.escapeExpression((n=null!=(n=i.dialogCloseAria||(null!=e?e.dialogCloseAria:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"dialogCloseAria","hash":{}}):n))+'"\r\n             role="button"></div>\r\n      </div>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){var n;return null!=(n=i.if.call(e,null!=e?e.expandedHeader:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?n:""}});return t.registerPartial("csui_controls_wizard_step_impl_step.header",s),s}),csui.define("csui/controls/wizard/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/wizard/impl/nls/root/lang",{"dialogCloseButtonTooltip":"Close","dialogCloseAria":"Close dialog","back":"Back","next":"Next","cancel":"Cancel"}),csui.define("css!csui/controls/wizard/impl/wizard",[],function(){}),csui.define("csui/controls/wizard/step/impl/header.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/behaviors/keyboard.navigation/tabable.region.behavior","hbs!csui/controls/wizard/step/impl/step.header","i18n!csui/controls/wizard/impl/nls/lang","css!csui/controls/wizard/impl/wizard"],function(e,i,t,s,n,o){return t.ItemView.extend({"template":n,"behaviors":{"TabableRegion":{"behaviorClass":s}},"ui":{"headerControl":".cs-header-control"},"events":{"keydown":"onKeyInView"},"templateHelpers":function(){return{"iconLeft":this.options.iconLeft,"actionIconLeft":this.options.actionIconLeft,"imageLeftUrl":this.options.imageLeftUrl,"imageLeftClass":this.options.imageLeftClass,"title":this.options.title,"showCloseBtn":this.options.showCloseBtn,"iconRight":this.options.iconRight||"cs-icon-cross","expandedHeader":this.options.expandedHeader,"dialogCloseButtonTooltip":o.dialogCloseButtonTooltip,"dialogCloseAria":o.dialogCloseAria}},"constructor":function(e){t.View.prototype.constructor.apply(this,arguments)},"isTabable":function(){return this.$("*[tabindex]").length>0},"currentlyFocusedElement":function(e){var t=this.$("*[tabindex]");return t.length&&t.prop("tabindex",0),i(e&&e.shiftKey?t[t.length-1]:t[0])},"onLastTabElement":function(e,i){return e&&i.target===this.$("*[tabindex]")[0]},"onKeyInView":function(e){var t=e.keyCode;13!==t&&32!==t||i(e.target).click()},"onRender":function(){var i=this.options.headers||[];i.length&&e.each(i,function(e){var i=this._renderHeader(e);this.$el.append(i)},this);var t=this.options.headerControl;t&&(this.ui.headerControl.append(t.$el),t.render(),t.trigger("dom:refresh")),this.options.actionIconLeft&&this._adjustTitleCSS()},"onDomRefresh":function(){var e=this.options.headerControl;e&&(e.triggerMethod("dom:refresh"),e.triggerMethod("after:show"))},"_renderHeader":function(e){var t=i('<div class="modal-header-item"></div>').text(e.label);return e.class&&t.addClass(e.class),e.id&&t.attr("id",e.id),t},"_adjustTitleCSS":function(e){this.$el.find("div.tile-title").addClass("tile-action-icon-tittle")}})}),csui.define("hbs!csui/controls/wizard/step/impl/wizard.step",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"1":function(e,i,t,s){return'  <div class="binf-modal-dialog binf-modal-lg">\r\n'},"3":function(e,i,t,s){var n;return null!=(n=i.if.call(e,null!=e?e.midSize:e,{"name":"if","hash":{},"fn":this.program(4,s,0),"inverse":this.program(6,s,0)}))?n:""},"4":function(e,i,t,s){return'    <div class="binf-modal-dialog binf-modal-md">\r\n'},"6":function(e,i,t,s){return'    <div class="binf-modal-dialog">\r\n'},"8":function(e,i,t,s){var n;return'      <div class="binf-modal-body cs-dialog cs-dialog-bodymessage">'+this.escapeExpression((n=null!=(n=i.bodyMessage||(null!=e?e.bodyMessage:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"bodyMessage","hash":{}}):n))+"</div>\r\n"},"10":function(e,i,t,s){return'      <div class="binf-modal-body"></div>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){var n,o;return(null!=(n=i.if.call(e,null!=e?e.largeSize:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.program(3,s,0)}))?n:"")+'\r\n  <div class="binf-modal-content" aria-label="'+this.escapeExpression((o=null!=(o=i.dialogTxtAria||(null!=e?e.dialogTxtAria:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"dialogTxtAria","hash":{}}):o))+'">\r\n\r\n    <div class="tile-header binf-modal-header"></div>\r\n\r\n'+(null!=(n=i.if.call(e,null!=e?e.bodyMessage:e,{"name":"if","hash":{},"fn":this.program(8,s,0),"inverse":this.program(10,s,0)}))?n:"")+'\r\n    <div class="binf-modal-footer binf-hidden"></div>\r\n\r\n  </div>\r\n\r\n</div>\r\n'}});return t.registerPartial("csui_controls_wizard_step_impl_wizard.step",s),s}),csui.define("csui/controls/wizard/step/wizard.step.view",["module","csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/controls/mixins/layoutview.events.propagation/layoutview.events.propagation.mixin","csui/behaviors/keyboard.navigation/tabables.behavior","csui/controls/wizard/step/impl/footer.view","csui/controls/wizard/step/impl/header.view","hbs!csui/controls/wizard/step/impl/wizard.step","csui/utils/log","i18n!csui/controls/wizard/impl/nls/lang","i18n"],function(e,i,t,s,n,o,l,r,a,c,u,d,h){u=u(e.id);var p=n.LayoutView.extend({"className":function(){var e="cs-wizard-step cs-dialog binf-modal binf-fade";return this.options.className&&(e+=" "+i.result(this.options,"className")),e},"attributes":{"tabindex":"-1","role":"dialog","aria-hidden":"true"},"template":c,"behaviors":{"TabablesBehavior":{"behaviorClass":l,"recursiveNavigation":!0,"containTabFocus":!0}},"regions":{"body":".binf-modal-body","header":".binf-modal-header","footer":".binf-modal-footer"},"ui":{"header":".binf-modal-header","footer":".binf-modal-footer","body":".binf-modal-body"},"events":{"hide.binf.modal":"onHiding","hidden.binf.modal":"onHidden","click .cs-close":"onClickClose","shown.binf.modal":"onShown","keyup":"onKeyInView","setCurrentTabFocus":"setCurrentTabFocus","tabNextRegion":"tabNextRegion","click .tile-type-action-icon":"onClickActionIcon"},"templateHelpers":function(){return{"largeSize":this.options.largeSize,"midSize":this.options.midSize,"bodyMessage":this.options.bodyMessage,"dialogTxtAria":this.options.dialogTxtAria}},"constructor":function(){n.LayoutView.prototype.constructor.apply(this,arguments),this.listenToOnce(this,"before:hide",l.popTabableHandler),this.propagateEventsToRegions()},"onKeyInView":function(e){27===e.keyCode&&(e.preventDefault(),e.stopPropagation(),this.destroy(),this.trigger("close:wizard"))},"setCurrentTabFocus":function(){this.focusOnLastRegion=!0,this.$el.focus()},"tabNextRegion":function(){this.trigger("changed:focus")},"onRender":function(){this.$el.addClass(p.prototype.className.call(this)).attr("tabindex",0),this._renderHeader(),this.options.view&&this.body.show(this.options.view),this._renderFooter()},"onShow":function(){t(window).scrollTop(0),this.$el.binf_modal({"backdrop":"static","keyboard":!1,"paddingWhenOverflowing":!1})},"kill":function(){return p.__super__.destroy.apply(this,arguments),this._scrollToBegin(),!0},"destroy":function(){return this.$el.is(":visible")?(this.$el.binf_modal("hide"),t("body").removeClass("binf-modal-open")):p.__super__.destroy.apply(this,arguments),this._scrollToBegin(),this},"updateButton":function(e,i){var t=this.footerView;if(!t.updateButton)throw new Error("Dialog footer does not support button updating.");t.updateButton(e,i)},"showView":function(e){this.body.show(e),e.triggerMethod("after:show")},"onShown":function(){this.options.view&&(this.options.view.triggerMethod("dom:refresh"),this.options.view.triggerMethod("after:show")),this.headerView&&(this.headerView.triggerMethod("dom:refresh"),this.headerView.triggerMethod("after:show")),this.footerView&&(this.footerView.triggerMethod("dom:refresh"),this.footerView.triggerMethod("after:show"))},"onHiding":function(){this.triggerMethod("before:hide")},"onHidden":function(){this.triggerMethod("hide"),this.destroy()},"onClickClose":function(e){e.preventDefault(),e.stopPropagation(),this.trigger("close:wizard")},"onClickActionIcon":function(e){this.options.view.trigger("click:actionIcon")},"onClickButton":function(e){if("Add"===e.model.get("id"))this.trigger("add:member");else{var i=e.model.attributes;i.click&&i.click({"dialog":this,"button":this.$el}),i.close&&this.trigger("close:wizard")}},"_scrollToBegin":function(){if(!0===h.settings.rtl){var e=t("body").width();t("body").scrollLeft(e)}else t("body").scrollLeft(0),t(".csui-add-permission").focus()},"_renderHeader":function(){var e=this.headerView=this.options.headerView,i=void 0!==this.options.standardHeader?this.options.standardHeader:!this.options.template;if(e&&(e.editpermission=!!this.options.wizard&&!!this.options.wizard.edit_permission&&this.options.wizard.edit_permission),e)this.header.show(e);else{var t={"iconLeft":this.options.iconLeft,"actionIconLeft":this.options.actionIconLeft,"imageLeftUrl":this.options.imageLeftUrl,"imageLeftClass":this.options.imageLeftClass,"title":this.options.title,"iconRight":this.options.iconRight||"cs-icon-cross","headers":this.options.headers,"headerControl":this.options.headerControl,"expandedHeader":i,"el":this.ui.header[0]};e=this.headerView=new a(t),e.render(),this.header.attachView(e),this.headerView.trigger("dom:refresh")}},"_renderFooter":function(){var e=this.footerView=this.options.footerView;if(e)this.ui.footer.removeClass("binf-hidden"),this.footer.show(e);else{var t=[];this.options.isFirstStep||t.push({"id":"previous","label":this.options.previousButtonLabel||d.back,"toolTip":this.options.previousButtonLabel||d.back,"default":!1,"disabled":!1,"separate":!0,"click":i.bind(this.onClickPreviousButton,this)});var n={"id":"next","label":this.options.nextButtonLabel||d.next,"toolTip":this.options.nextButtonLabel||d.next,"default":!0,"disabled":void 0===this.options.disableNext||this.options.disableNext,"click":i.bind(this.onClickNextButton,this)},o={"id":"done","label":this.options.doneButtonLabel||d.next,"toolTip":this.options.doneButtonLabel||d.next,"default":!0,"disabled":void 0===this.options.disableDone||this.options.disableDone,"click":i.bind(this.onClickDoneButton,this)};this.options.nextButton?t.push(n):this.options.doneButton&&t.push(o),t.push({"id":"cancel","label":d.cancel,"toolTip":d.cancel,"close":!0});var l=this.options.buttons||t;l.length&&this.ui.footer.removeClass("binf-hidden"),e=this.footerView=new r({"collection":new s.Collection(l),"wizardView":this,"el":this.ui.footer[0]}),this.listenTo(e,"childview:click",this.onClickButton),e.render(),this.footer.attachView(e)}},"showPreviousButton":function(){this.footer.currentView.getPreviousButton().$el.removeClass("binf-hidden")},"hidePreviousButton":function(){this.footer.currentView.getPreviousButton().$el.addClass("binf-hidden")},"validate":function(){return!this.body.currentView||!this.body.currentView.validate||this.body.currentView.validate()},"onClickNextButton":function(){this.trigger("next:clicked")},"onClickDoneButton":function(){this.trigger("done:clicked")},"onClickPreviousButton":function(){this.trigger("previous:clicked")}});return i.extend(p.prototype,o),p}),csui.define("hbs!csui/controls/wizard/impl/wizard",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){return""}});return t.registerPartial("csui_controls_wizard_impl_wizard",s),s}),csui.define("csui/controls/wizard/wizard.view",["module","csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/controls/mixins/layoutview.events.propagation/layoutview.events.propagation.mixin","csui/behaviors/keyboard.navigation/tabables.behavior","csui/controls/wizard/step/wizard.step.view","hbs!csui/controls/wizard/impl/wizard","csui/utils/non-emptying.region/non-emptying.region","csui/utils/log","i18n","css!csui/controls/wizard/impl/wizard","csui/lib/binf/js/binf"],function(e,i,t,s,n,o,l,r,a,c,u,d){var h=n.LayoutView.extend({"id":"wizard","template":a,"behaviors":{"TabablesBehavior":{"behaviorClass":l,"recursiveNavigation":!0,"containTabFocus":!0}},"className":function(){var e="cs-wizard";return this.options.className&&(e+=" "+i.result(this.options,"className")),e},"templateHelpers":function(){return{}},"constructor":function(e){e||(e={}),n.LayoutView.prototype.constructor.apply(this,arguments),this.propagateEventsToRegions()},"initialize":function(){this.currentStep=0,this.stepViews=[],this.direction="right"},"show":function(e){var i=t.fn.binf_modal.getDefaultContainer(),s=new c({"el":i});return this.edit_permission=e.editpermission,s.show(this),this},"onRender":function(){return this.renderCurrentStep(),this},"renderCurrentStep":function(){if(this.currentView=this.getCurrentView(),this.currentView._isRendered)this.showCurrentView();else{new c({"el":this.el}).show(this.currentView)}},"getCurrentView":function(){if(this.currentStep<this.stepViews.length)return this.stepViews[this.currentStep];var e=this.currentStep,t=new r(i.extend(this.options.steps[e],{"wizard":this,"isFirstStep":this.isFirstStep()}));return this.stepViews.push(t),this.listenTo(t,"next:clicked",this.nextStep).listenTo(t,"previous:clicked",this.prevStep).listenTo(t,"done:clicked",this.save).listenTo(t,"add:member",this.addMember).listenTo(t,"close:wizard",this.closeWizard),t},"nextStep":function(){this.currentView.validate()&&(this.isLastStep()?this.save():(this.hideCurrentView(),this.currentStep+=1,this.direction=d&&d.settings.rtl?"left":"right",this.renderCurrentStep()))},"prevStep":function(){this.isFirstStep()||(this.hideCurrentView(),this.currentStep-=1,this.direction=d&&d.settings.rtl?"right":"left",this.renderCurrentStep())},"hideCurrentView":function(){this.currentView.$el.addClass("binf-hidden")},"showCurrentView":function(){this.currentView.$el.removeClass("binf-hidden")},"addDirection":function(){
this.currentView.$el.find(".binf-modal-dialog").removeClass("left"),this.currentView.$el.find(".binf-modal-dialog").removeClass("right"),this.currentView.$el.find(".binf-modal-dialog").addClass(this.direction)},"updateButton":function(e,i){if(!this.currentView.updateButton)throw new Error("Dialog footer does not support button updating.");this.currentView.updateButton(e,i)},"save":function(){this.trigger("save:result")},"addMember":function(){this.trigger("add:member")},"isFirstStep":function(){return 0===this.currentStep},"isLastStep":function(){return this.currentStep===this.options.steps.length-1},"onBeforeDestroy":function(){i.each(this.stepViews,function(e,i){e.destroy()})},"closeWizard":function(){this.trigger("closing:wizard"),this.destroy()},"getStepViewByStepNumber":function(e){return this.stepViews&&e<this.stepViews.length?this.stepViews[e]:null}});return i.extend(h.prototype,o),h}),csui.define("hbs!csui/widgets/permissions/impl/edit/permission.level.selector/impl/permission.level.selector",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"1":function(e,i,t,s){var n;return'    <li class="csui-permission-level-item" data-optionid="'+this.escapeExpression(this.lambda(null!=e?e.id:e,e))+'" role="listitem"\r\n        aria-label="'+this.escapeExpression(this.lambda(null!=e?e.name:e,e))+'">\r\n      <a tabindex="-1" href="#">\r\n        <span class="cs-icon"></span>\r\n        <span class="cs-label">'+this.escapeExpression(this.lambda(null!=e?e.name:e,e))+"</span>\r\n"+(null!=(n=i.if.call(e,null!=e?e.showActionIcon:e,{"name":"if","hash":{},"fn":this.program(2,s,0),"inverse":this.noop}))?n:"")+"      </a>\r\n    </li>\r\n"},"2":function(e,i,t,s){return'          <span class="csui-icon '+this.escapeExpression(this.lambda(null!=e?e.actionIcon:e,e))+'"></span>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){var n;return'<ul class="csui-permission-levels" role="listbox">\r\n'+(null!=(n=i.each.call(e,null!=e?e.permissionLevelOptions:e,{"name":"each","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?n:"")+"</ul>\r\n"}});return t.registerPartial("csui_widgets_permissions_impl_edit_permission.level.selector_impl_permission.level.selector",s),s}),csui.define("csui/widgets/permissions/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/widgets/permissions/impl/nls/root/lang",{"properties":"Properties","versions":"Versions","general":"General","UserPickerPlaceHolder":"Enter name or group","PermissionLookupPlaceHolder":"Enter name or group for permissions lookup","right_id":"User / Group","permission_level":"Permission level","goBackTooltip":"Go back","emptyPermissionListMsg":"{0} was not found in this permissions list.","addMemberToGroup":"Add {0} as a member to a group that currently has permissions","grantAccessToMember":"Grant access to a group in which {0} is already a member","permissionLevelFullControl":"Full control","permissionLevelWrite":"Write","permissionLevelRead":"Read","permissionLevelCustom":"Custom...","permissionLevelNone":"None","FullControl":"Full control","Write":"Write","Read":"Read","Custom":"Custom","None":"None","see":"See","see_contents":"See contents","modify":"Modify","edit_attributes":"Edit attributes","add_items":"Add items","reserve":"Reserve","delete_versions":"Delete version","delete":"Delete","edit_permissions":"Edit permissions","edit_label_permissions":"edit_permissions","saveButtonLabel":"Ok","cancelButtonLabel":"Cancel","applyButtonLabel":"Apply","AddDropdownTitle":"Add","AddUserOrGroup":"Add user or group","NoOwnerAssigned":"No owner assigned","addMajorVersion":"Add major version","allUsersAndGroups":"Users and Groups","addUsersAndGroups":"Add users or groups","addButtonLabel":"Add","addButtonTooltip":"Add member to group","cancelButtonTooltip":"Close dialog","noPermissionsAvailable":"Permissions page is not available for {0}"});csui.define("css!csui/widgets/permissions/impl/permissions",[],function(){}),csui.define("csui/widgets/permissions/impl/edit/permission.level.selector/permission.level.selector.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/behaviors/keyboard.navigation/tabable.region.behavior","csui/models/permission/nodepermission.model","hbs!csui/widgets/permissions/impl/edit/permission.level.selector/impl/permission.level.selector","i18n!csui/widgets/permissions/impl/nls/lang","css!csui/widgets/permissions/impl/permissions","csui/lib/binf/js/binf"],function(e,i,t,s,n,o,l){"use strict";return t.ItemView.extend({"_permissionLevelOptions":void 0,"selected":void 0,"openSelectedProperties":!1,"className":"cs-permission-level-selector","template":o,"behaviors":{"TabableRegion":{"behaviorClass":s}},"events":{"click li[data-optionid]":"onClickOption","keydown":"onKeyInView"},"constructor":function(e){e||(e={}),t.ItemView.prototype.constructor.apply(this,arguments)},"initialize":function(){this.focusIndex=0,this._setupPermissionLevelOptions();var i=this.options.selected||this.options.permissionModel.getPermissionLevel();-1!==e.indexOf(e.pluck(this._permissionLevelOptions,"id"),i)?this._setSelected(i):this._setSelected(n.PERMISSION_LEVEL_NONE)},"onKeyInView":function(e){var t=e.keyCode,s=this.$el.find("a[tabindex]");if(s.length)if(13===e.keyCode)i(s[this.focusIndex]).parent().click(),e.stopPropagation(),e.preventDefault();else if(38===t||40===t)38===t?this.focusIndex>0&&--this.focusIndex:this.focusIndex<s.length-1&&++this.focusIndex,i(s[this.focusIndex]).focus(),e.stopPropagation(),e.preventDefault();else if(9===t){var n=this.$el.parents("body").find(".csui-edit-permission-popover-container .binf-popover");n.binf_popover("destroy")}},"onClickOption":function(e){e.preventDefault(),e.stopPropagation(),this._setSelected(parseInt(i(e.currentTarget).attr("data-optionid"))),this._showSelected(),this.trigger("permission:level:selected"),this.$el.trigger("setCurrentTabFocus")},"templateHelpers":function(){return{"permissionLevelOptions":this._permissionLevelOptions}},"currentlyFocusedElement":function(){var e=this.$el.find("a[tabindex]");if(e.length)return i(e[this.focusIndex])},"accDeactivateTabableRegion":function(){},"onRender":function(){this._showSelected()},"_getOptionName":function(i){var t;return t=e.indexOf(e.pluck(this._permissionLevelOptions,"id"),i),-1===t?"":this._permissionLevelOptions[t].name},"_setupPermissionLevelOptions":function(){this._permissionLevelOptions=[{"id":n.PERMISSION_LEVEL_NONE,"name":l.permissionLevelNone},{"id":n.PERMISSION_LEVEL_READ,"name":l.permissionLevelRead},{"id":n.PERMISSION_LEVEL_WRITE,"name":l.permissionLevelWrite},{"id":n.PERMISSION_LEVEL_FULL_CONTROL,"name":l.permissionLevelFullControl},{"id":n.PERMISSION_LEVEL_CUSTOM,"name":l.permissionLevelCustom,"showActionIcon":!0}]},"_setSelected":function(e){this.selected=e},"_showSelected":function(){var e=this.$el.find("li[data-optionid]");e.find(".cs-icon").removeClass("icon-listview-checkmark"),e.removeAttr("aria-selected");var i=this.$el.find("li[data-optionid="+this.selected+"]");i.find(".cs-icon").addClass("icon-listview-checkmark"),i.attr("aria-selected","true")},"_showOpenSelectedProperties":function(){!0===this.openSelectedProperties?(this.ui.toggle.attr("aria-expanded","true"),this.ui.iconOpenSelectedProperties.removeClass("icon-checkbox").addClass("icon-checkbox-selected")):(this.ui.toggle.attr("aria-expanded","false"),this.ui.iconOpenSelectedProperties.removeClass("icon-checkbox-selected").addClass("icon-checkbox"))},"getSelectedPermissions":function(){return n.getPermissionsByLevelExceptCustom(this.selected,this.options.isContainer)}})}),csui.define("hbs!csui/controls/tree/impl/treeview",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"1":function(e,i,t,s){var n,o;return'  <div class="csui-tree-child '+(null!=(n=i.if.call(e,null!=e?e.nodeSplit:e,{"name":"if","hash":{},"fn":this.program(2,s,0),"inverse":this.noop}))?n:"")+" "+(null!=(n=i.if.call(e,null!=e?e.nodeClass:e,{"name":"if","hash":{},"fn":this.program(4,s,0),"inverse":this.noop}))?n:"")+'">\r\n      <input type="checkbox" id="node_'+this.escapeExpression((o=null!=(o=i.nodeId||(null!=e?e.nodeId:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"nodeId","hash":{}}):o))+'" tabindex="-1" name="'+this.escapeExpression((o=null!=(o=i.nodeId||(null!=e?e.nodeId:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"nodeId","hash":{}}):o))+'"\r\n             aria-label="'+this.escapeExpression((o=null!=(o=i.nodeName||(null!=e?e.nodeName:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"nodeName","hash":{}}):o))+'" class="csui-tree-checkbox\r\n    '+(null!=(n=i.if.call(e,null!=e?e.readonly:e,{"name":"if","hash":{},"fn":this.program(6,s,0),"inverse":this.noop}))?n:"")+'" '+(null!=(n=i.if.call(e,null!=e?e.readonly:e,{"name":"if","hash":{},"fn":this.program(11,s,0),"inverse":this.program(13,s,0)}))?n:"")+'>\r\n    <label for="node_'+this.escapeExpression((o=null!=(o=i.nodeId||(null!=e?e.nodeId:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"nodeId","hash":{}}):o))+'"></label>\r\n    <span class="csui-node-name">'+this.escapeExpression((o=null!=(o=i.nodeName||(null!=e?e.nodeName:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"nodeName","hash":{}}):o))+"</span>\r\n"+(null!=(n=i.if.call(e,null!=e?e.nodeSplit:e,{"name":"if","hash":{},"fn":this.program(16,s,0),"inverse":this.noop}))?n:"")+"  </div>\r\n  <ul></ul>\r\n"},"2":function(e,i,t,s){var n;return" "+this.escapeExpression((n=null!=(n=i.splitClass||(null!=e?e.splitClass:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"splitClass","hash":{}}):n))},"4":function(e,i,t,s){return" nodeClass"},"6":function(e,i,t,s){var n;return null!=(n=i.if.call(e,null!=e?e.checked:e,{"name":"if","hash":{},"fn":this.program(7,s,0),"inverse":this.program(9,s,0)}))?n:""},"7":function(e,i,t,s){return"  icon-checkbox-on_disabled\r\n    "},"9":function(e,i,t,s){return" icon-checkbox-disabled"},"11":function(e,i,t,s){return"disabled "},"13":function(e,i,t,s){var n;return null!=(n=i.if.call(e,null!=e?e.checked:e,{"name":"if","hash":{},"fn":this.program(14,s,0),"inverse":this.noop}))?n:""},"14":function(e,i,t,s){return' tabindex="-1"  checked'},"16":function(e,i,t,s){var n;return'      <div class="csui-tree-split '+this.escapeExpression((n=null!=(n=i.splitClass||(null!=e?e.splitClass:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"splitClass","hash":{}}):n))+'">\r\n        <div class="csui-splitcontrol-label">\r\n          <span>'+this.escapeExpression((n=null!=(n=i.splitName||(null!=e?e.splitName:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"splitName","hash":{}}):n))+'</span>\r\n        </div>\r\n      </div>\r\n      <div class="csui-separator"></div>\r\n'},"18":function(e,i,t,s){var n,o;return'    <div class="csui-tree-child '+(null!=(n=i.if.call(e,null!=e?e.nodeSplit:e,{"name":"if","hash":{},"fn":this.program(2,s,0),"inverse":this.noop}))?n:"")+'">\r\n      <input type="checkbox" id="node_'+this.escapeExpression((o=null!=(o=i.nodeId||(null!=e?e.nodeId:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"nodeId","hash":{}}):o))+'" name="'+this.escapeExpression((o=null!=(o=i.nodeId||(null!=e?e.nodeId:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"nodeId","hash":{}}):o))+'"\r\n             aria-label="'+this.escapeExpression((o=null!=(o=i.nodeName||(null!=e?e.nodeName:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"nodeName","hash":{}}):o))+'"  tabindex="-1" class="csui-tree-checkbox\r\n             '+(null!=(n=i.if.call(e,null!=e?e.nodeClass:e,{"name":"if","hash":{},"fn":this.program(4,s,0),"inverse":this.noop}))?n:"")+"\r\n        "+(null!=(n=i.if.call(e,null!=e?e.readonly:e,{"name":"if","hash":{},"fn":this.program(19,s,0),"inverse":this.noop}))?n:"")+'" '+(null!=(n=i.if.call(e,null!=e?e.readonly:e,{"name":"if","hash":{},"fn":this.program(11,s,0),"inverse":this.program(22,s,0)}))?n:"")+'>\r\n      <label for="node_'+this.escapeExpression((o=null!=(o=i.nodeId||(null!=e?e.nodeId:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"nodeId","hash":{}}):o))+'"></label>\r\n      <span class="csui-node-name">'+this.escapeExpression((o=null!=(o=i.nodeName||(null!=e?e.nodeName:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"nodeName","hash":{}}):o))+"</span>\r\n"+(null!=(n=i.if.call(e,null!=e?e.nodeSplit:e,{"name":"if","hash":{},"fn":this.program(25,s,0),"inverse":this.noop}))?n:"")+"    </div>\r\n"},"19":function(e,i,t,s){var n;return null!=(n=i.if.call(e,null!=e?e.checked:e,{"name":"if","hash":{},"fn":this.program(20,s,0),"inverse":this.program(9,s,0)}))?n:""},"20":function(e,i,t,s){return" icon-checkbox-on_disabled\r\n    "},"22":function(e,i,t,s){var n;return null!=(n=i.if.call(e,null!=e?e.checked:e,{"name":"if","hash":{},"fn":this.program(23,s,0),"inverse":this.noop}))?n:""},"23":function(e,i,t,s){return" checked"},"25":function(e,i,t,s){var n;return'        <div class="csui-tree-split '+this.escapeExpression((n=null!=(n=i.splitClass||(null!=e?e.splitClass:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"splitClass","hash":{}}):n))+'">\r\n          <div class="csui-splitcontrol-label">\r\n            <span>'+this.escapeExpression((n=null!=(n=i.splitName||(null!=e?e.splitName:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"splitName","hash":{}}):n))+'</span>\r\n          </div>\r\n        </div>\r\n        <div class="csui-separator"></div>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){var n;return null!=(n=i.if.call(e,null!=e?e.isNodesExists:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.program(18,s,0)}))?n:""}});return t.registerPartial("csui_controls_tree_impl_treeview",s),s}),csui.define("css!csui/controls/tree/impl/treeview",[],function(){}),csui.define("csui/controls/tree/tree.view",["module","csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","hbs!csui/controls/tree/impl/treeview","css!csui/controls/tree/impl/treeview"],function(e,i,t,s,n,o){"use strict";var l=n.CompositeView.extend({"template":o,"templateHelpers":function(){return{"isNodesExists":!!(this.model.nodes&&this.model.nodes.length>0),"readonly":!!this.model.attributes&&this.model.attributes.readonly}},"tagName":"li","childViewContainer":"ul","className":"csui-tree-root","events":{"click input.csui-tree-checkbox":"onNodeClicked"},"initialize":function(){this.collection=this.model.nodes},"onNodeClicked":function(e){this.trigger("Node:clicked",e.target)}});return n.CollectionView.extend({"tagName":"ul","className":"csui-tree-container","childView":l,"childEvents":{"Node:clicked":"onChildNodeClicked"},"onChildNodeClicked":function(e,i){i.checked?this.trigger("node:selected",i):this.trigger("node:unselected",i)}})}),csui.define("csui/models/permission/permissionlevel",["module","csui/lib/jquery","csui/lib/underscore","csui/lib/backbone"],function(e,i,t,s){"use strict";var n=s.Model.extend({"initialize":function(){var e=this.get("nodes");e&&(this.nodes=new o(e),this.unset("nodes"))}}),o=s.Collection.extend({"model":n});return o}),csui.define("csui/widgets/permissions/impl/edit/permission.attributes/impl/permission.attributes.data",["csui/lib/jquery","csui/lib/underscore","csui/lib/marionette","csui/models/permission/permissionlevel","i18n!csui/widgets/permissions/impl/nls/lang"],function(e,i,t,s,n){function o(e){var t=!1!==e.readonly,o=e.permissions||[],l=[{"nodeName":n.see,"nodeId":"see","readonly":t,"checked":o.indexOf("see")>=0,"nodes":[{"nodeName":n.see_contents,"nodeId":"see_contents","nodeClass":"","nodeSplit":!0,"splitName":n.Read,"splitClass":"csui-split-read","readonly":t,"checked":o.indexOf("see_contents")>=0},{"nodeName":n.modify,"nodeId":"modify","readonly":t,"checked":o.indexOf("modify")>=0,"nodes":[{"nodeName":n.edit_attributes,"nodeId":"edit_attributes","readonly":t,"checked":o.indexOf("edit_attributes")>=0},{"nodeName":n.reserve,"nodeId":"reserve","readonly":t,"checked":o.indexOf("reserve")>=0,"nodes":[{"nodeName":n.addMajorVersion,"nodeId":"add_major_version","readonly":t,"checked":o.indexOf("add_major_version")>=0}]},{"nodeName":n.delete_versions,"nodeId":"delete_versions","readonly":t,"checked":o.indexOf("delete_versions")>=0,"nodes":[{"nodeName":n.delete,"nodeId":"delete","nodeSplit":!0,"splitName":n.Write,"splitClass":"csui-split-write","readonly":t,"checked":o.indexOf("delete")>=0,"nodes":[{"nodeName":n.edit_permissions,"nodeId":"edit_permissions","nodeSplit":!0,"splitName":n.FullControl,"splitClass":"csui-split-fullcontrol","readonly":t,"checked":o.indexOf("edit_permissions")>=0}]}]}]}]}];if(e.node)if(e.node.get("container"))l[0].nodes[1].nodes.splice(1,0,{"nodeName":n.add_items,"nodeId":"add_items","readonly":t,"checked":o.indexOf("add_items")>=0});else if(!e.isAdvancedVersioning){var r=i.findWhere(l[0].nodes[1].nodes,{"nodeName":n.reserve});r.nodes.splice(i.findIndex(r.nodes,{"nodeName":n.addMajorVersion}),1)}return new s(l)}return{"getPermissionAttributes":o}}),csui.define("hbs!csui/widgets/permissions/impl/edit/permission.attributes/impl/permission.attributes",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"1":function(e,i,t,s){var n;return'  <div class="csui-permission-attribute-buttons-container">\r\n    <button class="cs-save-btn binf-btn binf-btn-primary\r\n  binf-btn-default" tabindex="-1">'+this.escapeExpression((n=null!=(n=i.save_button_label||(null!=e?e.save_button_label:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"save_button_label","hash":{}}):n))+'</button>\r\n    <button class="cs-cancel-btn binf-btn binf-btn-default"\r\n            tabindex="-1">'+this.escapeExpression((n=null!=(n=i.cancel_button_label||(null!=e?e.cancel_button_label:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"cancel_button_label","hash":{}}):n))+"</button>\r\n  </div>\r\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){var n;return'<div class="csui-permission-attribute-tree"></div>\r\n\r\n'+(null!=(n=i.if.call(e,null!=e?e.showButtons:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?n:"")}});return t.registerPartial("csui_widgets_permissions_impl_edit_permission.attributes_impl_permission.attributes",s),s}),csui.define("csui/widgets/permissions/impl/edit/permission.attributes/permission.attributes.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/marionette","csui/utils/base","i18n","csui/behaviors/keyboard.navigation/tabables.behavior","csui/controls/tree/tree.view","csui/widgets/permissions/impl/edit/permission.attributes/impl/permission.attributes.data","hbs!csui/widgets/permissions/impl/edit/permission.attributes/impl/permission.attributes","i18n!csui/widgets/permissions/impl/nls/lang"],function(e,i,t,s,n,o,l,r,a,c){return t.LayoutView.extend({"className":"csui-permission-attributes","template":a,"regions":{"treeRegion":".csui-permission-attribute-tree"},"events":{"click button.cs-save-btn":"onClickSave","click button.cs-cancel-btn":"onClickCancel","keydown":"_handleKeyEvents"},"behaviors":{"TabablesBehavior":{"behaviorClass":o}},"_handleKeyEvents":function(i){var t=this.$el.find("input.csui-tree-checkbox");i&&i.shiftKey&&9===i.keyCode?e(t[t.length]).focus():"Cancel"===i.target.textContent&&9===i.keyCode&&t.length&&e(t[0]).focus()},"currentlyFocusedElement":function(i){var t=this.$("*[tabindex]");return t.length&&t.prop("tabindex",0),e(i&&i.shiftKey?t[t.length-1]:t[0])},"templateHelpers":function(){var e=this.options.showButtons;return void 0===e&&(e=!this.options.readonly),{"save_button_label":c.saveButtonLabel,"cancel_button_label":c.cancelButtonLabel,"showButtons":e}},"constructor":function(e){e||(e={}),t.LayoutView.prototype.constructor.call(this,e),this.options=e,this.focusIndex=0},"onRender":function(){var e=r.getPermissionAttributes({"readonly":this.options.readonly,"node":this.options.node,"permissions":this.options.permissions||this.model.get("permissions"),"isAdvancedVersioning":this.options.isAdvancedVersioning||this.model&&this.model.collection&&this.model.collection.isAdvancedVersioning});this.treeView=new l({"collection":e}),this.treeRegion.show(this.treeView),this.listenTo(this.treeView,"node:selected",this.onPermissionNodeSelected),this.listenTo(this.treeView,"node:unselected",this.onPermissionNodeUnselected)},"onPermissionNodeSelected":function(e){var i,t=this.treeView;e.attributes.name.value===c.edit_label_permissions?(t.$el.find("input:checkbox").each(function(e,i){i.checked=!0}),i=t.$el.find("input.csui-tree-checkbox")):e.attributes.name.value===c.edit_attributes?(t.$el.find("#node_see")[0].checked=!0,t.$el.find("#node_see_contents")[0].checked=!0,t.$el.find("#node_modify")[0].checked=!0,i=t.$el.find(e).closest(".csui-tree-root").parents(".csui-tree-root").children(".csui-tree-child").find("input.csui-tree-checkbox")):e.attributes.name.value===c.delete?(t.$el.find("#node_see")[0].checked=!0,t.$el.find("#node_see_contents")[0].checked=!0,t.$el.find("#node_delete_versions")[0].checked=!0,i=t.$el.find(e).closest(".csui-tree-root").parents(".csui-tree-root").children(".csui-tree-child").find("input.csui-tree-checkbox")):e.attributes.name.value===c.delete_versions?(t.$el.find("#node_see")[0].checked=!0,t.$el.find("#node_see_contents")[0].checked=!0,t.$el.find("#node_modify")[0].checked=!0,i=t.$el.find(e).closest(".csui-tree-root").parents(".csui-tree-root").children(".csui-tree-child").find("input.csui-tree-checkbox")):e.attributes.name.value===c.reserve?(t.$el.find("#node_see")[0].checked=!0,t.$el.find("#node_see_contents")[0].checked=!0,t.$el.find("#node_modify")[0].checked=!0,i=t.$el.find(e).closest(".csui-tree-root").parents(".csui-tree-root").children(".csui-tree-child").find("input.csui-tree-checkbox")):i=t.$el.find(e).closest(".csui-tree-root").parents(".csui-tree-root").children(".csui-tree-child").find("input.csui-tree-checkbox"),i.prop("checked",!0),i.length&&0!==this.options.node.attributes.type&&(t.$el.find("#node_see_contents")[0].checked=!0)},"onPermissionNodeUnselected":function(e){var i,t=this.treeView;"see_contents"===e.attributes.name.value?i=t.$el.find(e).closest(".csui-tree-root").siblings(".csui-tree-root").find("input.csui-tree-checkbox"):(i=t.$el.find(e).closest(".csui-tree-root").children("ul").find("input.csui-tree-checkbox"),i.length&&"reserve"!==e.attributes.name.value||(t.$el.find("#node_edit_permissions")[0].checked=!1)),i.prop("checked",!1)},"onClickSave":function(){var e=this.getSelectedPermissions();this.trigger("permission:attribute:save:clicked",e)},"onClickCancel":function(){this.trigger("permission:attribute:cancel:clicked")},"onDestroy":function(){},"getSelectedPermissions":function(){for(var e=this.treeView.$el.find("input.csui-tree-checkbox"),i=[],t=0;t<e.length;t++)e[t].checked&&i.push(e[t].name);return i}})}),csui.define("hbs!csui/widgets/permissions/impl/edit/apply.permission/impl/apply.permission",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){return'<div class="csui-apply-permission-content">\r\n  <span class="csui-apply-permission-message"></span>\r\n</div>\r\n<div class="csui-apply-permission-subfolder-container">\r\n  <div class="csui-apply-permission-sub-folder">\r\n    <span class="csui-apply-permission-sub-folder-label"></span>\r\n    <div class="required-fields-switch"></div>\r\n  </div>\r\n  <div class="csui-apply-permission-subitems-container">\r\n    <div class="csui-apply-subitems-message"></div>\r\n  </div>\r\n</div>'}});return t.registerPartial("csui_widgets_permissions_impl_edit_apply.permission_impl_apply.permission",s),s}),csui.define("hbs!csui/widgets/permissions/impl/edit/apply.permission/impl/include.subitems",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"1":function(e,i,t,s){var n;return'  <div class="csui-selected-checkbox csui-slice-checkbox csui-checkbox-primary\r\n  csui-permisison-subItem">\r\n    <input type="checkbox" class="csui-subtypes-option" name="'+this.escapeExpression((n=null!=(n=i.itemName||(null!=e?e.itemName:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"itemName","hash":{}}):n))+'" id="'+this.escapeExpression((n=null!=(n=i.value||(null!=e?e.value:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"value","hash":{}}):n))+'"\r\n           value="'+this.escapeExpression((n=null!=(n=i.value||(null!=e?e.value:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"value","hash":{}}):n))+'">\r\n    <label class="csui-subtype-name" for="'+this.escapeExpression((n=null!=(n=i.itemName||(null!=e?e.itemName:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"itemName","hash":{}}):n))+'" title="'+this.escapeExpression((n=null!=(n=i.itemName||(null!=e?e.itemName:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"itemName","hash":{}}):n))+'">\r\n      <span class="cs-ellipsis">'+this.escapeExpression((n=null!=(n=i.itemName||(null!=e?e.itemName:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"itemName","hash":{}}):n))+"\r\n        ("+this.escapeExpression((n=null!=(n=i.total||(null!=e?e.total:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"total","hash":{}}):n))+" "+this.escapeExpression((n=null!=(n=i.itemTitle||(null!=e?e.itemTitle:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"itemTitle","hash":{}}):n))+")\r\n  </span>\r\n    </label>\r\n  </div>\r\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){var n;return null!=(n=i.each.call(e,null!=e?e.subItems:e,{"name":"each","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?n:""}});return t.registerPartial("csui_widgets_permissions_impl_edit_apply.permission_impl_include.subitems",s),s}),csui.define("csui/widgets/permissions/impl/edit/apply.permission/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/widgets/permissions/impl/edit/apply.permission/impl/nls/root/lang",{"applyPermissionHeaderTitle":"Apply permissions","removePermissionHeaderTitle":"Remove {0}","restorePublicAccessHeaderTitle":"Restore public access","applytoSubFolder":"Apply to sub-folders","applytoSubFolderWithCount":"Apply to sub-folders ( {0} )","applyToSubItemsTitle":"Include special items in {0} and sub-folders","applyToItem":"Permissions will be applied to all items in {0}.","applyToThresholdExceeded":"Permissions will be applied to large number of items in {0}.","removeThresholdExceeded":"Permissions will be removed from large number of items in {0}","removeToItem":"Permissions will be removed from all items in {0}","RestorePermissions":"Permissions will be restored to all items in {0}.","includeSubItems":"Including {0}","publicAccess":"Public Access","item":"item","items":"items","204":"Task lists","207":"Channels","215":"Discussions","298":"Collections","3030202":"Communities"}),csui.define("csui/widgets/permissions/impl/edit/apply.permission/apply.permission.view",["module","csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/behaviors/keyboard.navigation/tabable.region.behavior","csui/models/permission/nodepermission.model","hbs!csui/widgets/permissions/impl/edit/apply.permission/impl/apply.permission","hbs!csui/widgets/permissions/impl/edit/apply.permission/impl/include.subitems","i18n!csui/widgets/permissions/impl/edit/apply.permission/impl/nls/lang","csui/utils/taskqueue","csui/utils/permissions/permissions.precheck","csui/controls/progressblocker/blocker","csui/lib/handlebars.helpers.xif","css!csui/widgets/permissions/impl/permissions"],function(e,i,t,s,n,o,l,r,a,c,u,d,h){"use strict";var p=e.config();return i.defaults(p,{"parallelism":5}),n.ItemView.extend({"className":"csui-apply-permission","template":r,"includeSubitemsTemplate":a,"ui":{"applyPermissionMsg":".csui-apply-permission-message","appplyToSubFolderContainer":".csui-apply-permission-sub-folder","appplyToSubFolder":".csui-apply-permission-sub-folder-label","applyToSubItemsContainer":"csui-apply-permission-subitems-container","applyToSubItemsTitle":".csui-apply-subitems-message","subItemsCheckBox":".csui-subtypes-option"},"behaviors":{"TabableRegion":{"behaviorClass":o}},"events":{"keydown":"onKeyInView"},"constructor":function(e){var t=this;t._=i,t.userSelectionCount=0,e||(e={}),e.removePermission=e.removePermission||!1,n.ItemView.prototype.constructor.apply(this,arguments),h.imbue(this)},"initialize":function(){this.focusIndex=0},"onKeyInView":function(e){var i=e.keyCode,s=this.$el.find("*[tabindex]");s.length&&(13===e.keyCode?(t(s[this.focusIndex]).parent().click(),e.stopPropagation(),e.preventDefault()):38!==i&&40!==i||(38===i?this.focusIndex>0&&--this.focusIndex:this.focusIndex<s.length-1&&++this.focusIndex,t(s[this.focusIndex]).focus(),e.stopPropagation(),e.preventDefault()))},"currentlyFocusedElement":function(){var e=this.$el.find("*[tabindex]");if(e.length)return t(e[this.focusIndex])},"onRender":function(){var e=this,t="";t=this.options.removePermission?i.str.sformat(c.removeToItem,this.options.model.get("container")):this.options.restorePublicAccess?i.str.sformat(c.RestorePermissions,this.options.model.get("name")):i.str.sformat(c.applyToItem,this.options.model.get("name")),this.ui.applyPermissionMsg.html(t),this.options.model&&this.options.model.get("container")&&(this.options.applyTo||this.options.model.get("applyTo")?(this.options.applyTo=this.options.applyTo?this.options.applyTo:this.options.model.get("applyTo"),this.loadSubFolderDeatils(this),this.loadSpecialItems(this.options.applyTo.subTypes,this.options.applyTo.thresholdExceeded)):(this.options.applyTo={},this.blockActions&&this.blockActions(),d.fetchPermissionsPreCheck(this.options).done(function(){e.model.set({"applyTo":e.options.applyTo},{"silent":!0}),e.unblockActions&&e.unblockActions(),e.loadSubFolderDeatils(e),e.loadSpecialItems(e.options.applyTo.subTypes,e.options.applyTo.thresholdExceeded)})))},"loadSubFolderDeatils":function(e){if((e.options.applyTo&&e.options.applyTo.subTypes.indexOf(0))>=0){e.ui.appplyToSubFolderContainer.removeClass("binf-hidden"),e.$(e.ui.appplyToSubFolder).html(c.applytoSubFolder),e.requiredFieldSwitchModel=new s.Model({"data":!1});var t=i.uniqueId("appplyToSubFolder");e.ui.appplyToSubFolder.attr("id",t),csui.require(["csui/controls/form/fields/booleanfield.view"],function(i){e.requiredFieldSwitchView=new i({"mode":"writeonly","model":e.requiredFieldSwitchModel,"labelId":t}),e.requiredFieldSwitchView.render(),e.requiredFieldSwitchView.on("field:changed",function(i){e.subFolderSelected=i.fieldvalue,i.fieldvalue?e.options.subTypes?e.loadSpecialItems(e.options.subTypes,e.options.thresholdExceeded):e.fetchSubFoldersSubItems(e.options).then(function(i){e.loadSpecialItems(e.options.subTypes,e.options.thresholdExceeded)}):e.options.applyTo&&e.loadSpecialItems(e.options.applyTo.subTypes,e.options.applyTo.thresholdExceeded)}),e.$(".required-fields-switch").append(e.requiredFieldSwitchView.$el)})}else e.ui.appplyToSubFolderContainer.addClass("binf-hidden")},"loadSpecialItems":function(e,t){var s=this,n=e,o=t,l=(s.options.applyTo&&s.options.applyTo.subTypes.indexOf(0),s.model.get("name")),r=this.options.permissionModel&&this.options.permissionModel.get("right_id_expand")&&this.options.permissionModel.get("right_id_expand").name_formatted,a="";if(r=this.options.permissionModel&&"public"===this.options.permissionModel.get("type")?c.publicAccess:r,n.indexOf(204)>=0&&(a=""===a?a+c[204]:a+", "+c[204]),n.indexOf(207)>=0&&(a=""===a?a+c[207]:a+", "+c[207]),n.indexOf(215)>=0&&(a=""===a?a+c[215]:a+", "+c[215]),n.indexOf(298)>=0&&(a=""===a?a+c[298]:a+", "+c[298]),n.indexOf(3030202)>=0&&(a=""===a?a+c[3030202]:a+", "+c[3030202]),this.options.removePermission&&i.str.sformat(c.removeToItem,l),
o)this.options.removePermission?s.ui.applyPermissionMsg.html(i.str.sformat(c.removeThresholdExceeded,l)):this.options.restorePublicAccess?s.ui.applyPermissionMsg.html(i.str.sformat(c.RestorePermissions,this.options.model.get("name"))):s.ui.applyPermissionMsg.html(i.str.sformat(c.applyToThresholdExceeded,l));else if(this.options.removePermission)s.ui.applyPermissionMsg.html(i.str.sformat(c.removeToItem,l));else if(this.options.restorePublicAccess){var u=i.str.sformat(c.RestorePermissions,this.options.model.get("name"));s.ui.applyPermissionMsg.html(u)}else!!s.ui.applyPermissionMsg.html&&s.ui.applyPermissionMsg.html(i.str.sformat(c.applyToItem,l));""!==a?(s.ui.applyToSubItemsContainer.removeClass("binf-hidden"),s.ui.applyToSubItemsTitle.html(i.str.sformat(c.includeSubItems,a))):(!!s.ui.applyToSubItemsTitle.html&&s.ui.applyToSubItemsTitle.html(""),!!s.ui.applyToSubItemsContainer.addClass&&s.ui.applyToSubItemsContainer.addClass("binf-hidden"))},"fetchSubFoldersSubItems":function(e){this.options=e,this.options.subTypes=[];var s=this,n=d.includeSubTypes(),o=new u({"parallelism":p.parallelism}),l=s.model.get("id"),r=s.model.connector.connection.url.replace("v1","v2")+"/nodes/"+l+"/descendents/subtypes/exists?sub_types=",a=i.map(n,function(e){var i=t.Deferred();return o.pending.add({"worker":function(){var t={"url":r+e,"type":"GET","data":{"include_sub_items":!0}};return s.model.connector.makeAjaxCall(t).done(function(e){void 0!==e.results.data.subtypes_info&&s.options.subTypes.push(e.results.data.subtypes_info[0].id),s.options.thresholdExceeded=e.results.data.threshold_exceeded,i.resolve(e)}).fail(function(e){i.reject(e)}),i.promise()}}),i.promise(a)});return t.whenAll.apply(t,a)},"getApplyToFlag":function(){return this.subFolderSelected}})}),csui.define("hbs!csui/dialogs/node.picker/impl/node.list/list.item",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){var n;return'<a class="csui-item-standard csui-list-group-item" href="#">\r\n<span class="csui-icon csui-start-icon '+this.escapeExpression((n=null!=(n=i.selected||(null!=e?e.selected:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"selected","hash":{}}):n))+'"></span>\r\n<span class="csui-type-icon" aria-hidden="true" title="'+this.escapeExpression((n=null!=(n=i.iconTitle||(null!=e?e.iconTitle:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"iconTitle","hash":{}}):n))+'"></span>\r\n<span title="'+this.escapeExpression((n=null!=(n=i.name||(null!=e?e.name:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"name","hash":{}}):n))+'" class="csui-list-item-title">\r\n  '+this.escapeExpression((n=null!=(n=i.name||(null!=e?e.name:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"name","hash":{}}):n))+'\r\n</span>\r\n<span class="csui-icon csui-end-icon '+this.escapeExpression((n=null!=(n=i.browsed||(null!=e?e.browsed:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"browsed","hash":{}}):n))+'"></span>\r\n</a>\r\n'}});return t.registerPartial("csui_dialogs_node.picker_impl_node.list_list.item",s),s}),csui.define("csui/dialogs/node.picker/impl/node.list/list.item.view",["csui/lib/underscore","csui/lib/jquery","csui/controls/listitem/listitemstandard.view","hbs!csui/dialogs/node.picker/impl/node.list/list.item","hbs!csui/dialogs/node.picker/impl/search.list/search.location.item","csui/controls/node-type.icon/node-type.icon.view","csui/behaviors/default.action/default.action.behavior","i18n!csui/dialogs/node.picker/impl/nls/lang"],function(e,i,t,s,n,o,l,r){return t.extend({"template":s,"searchLocationTemplate":n,"templateHelpers":function(){return{"selected":this.selected?"icon-listview-checkmark":"","browsed":this.browsed?"icon-sidebar-expand24":""}},"tagName":"li","events":{"keydown":"onKeyInView"},"ui":{"link":".csui-list-group-item"},"onKeyInView":function(e){return 39!==e.keyCode&&32!==e.keyCode&&13!==e.keyCode||(this.$el.trigger("click"),this.$el.focus(),!1)},"constructor":function(e){t.apply(this,arguments),this.selected=!1,this.browsed=!1},"toggleSelect":function(){this.selected=!this.selected,this.render()},"toggleBrowse":function(){this.browsed=!this.browsed,this.render()},"assignedBrowseNSelect":function(){this.browsed=this.selected=!0,this.render()},"unassignBrowseNSelect":function(){this.isDestroyed||(this.browsed=this.selected=!1,this.render())},"isSelected":function(){return this.selected},"isBrowsed":function(){return this.browsed},"setValidity":function(e){this.valid=e},"setEnable":function(i){if(i){this.$el.removeClass("csui-disabled");var t=e.str.sformat(r.itemTypeNameAria,this.model.get("type_name"),this.model.get("name"));this.valid||(t=e.str.sformat(r.disabledItemTypeNameAria,this.model.get("type_name"),this.model.get("name"))),this.$el.attr("aria-label",t)}else{this.$el.addClass("csui-disabled");var s=e.str.sformat(r.disabledItemTypeNameAria,this.model.get("type_name"),this.model.get("name"));this.$el.attr("aria-label",s)}},"onRender":function(){this.$el.addClass("cs-left-item-"+this.model.get("id")),this.$el.removeClass("select"),this.$el.removeClass("browse"),this.ui.link.removeAttr("aria-expanded","false"),this.$el.removeAttr("aria-selected"),this.$el.attr("role","option"),this.setEnable(!0),this.options.searchView||(i(".binf-list-group").removeClass("search-left-item"),i(".csui-np-content .csui-search-item-left-panel").is(":visible")?i(".binf-list-group").addClass("search-left-folder-right"):i(".cs-start-locations .binf-search-location-group").is(":visible")&&i(".binf-list-group").removeClass("search-left-folder-right"),this._nodeLocationIconView&&this._nodeLocationIconView.destroy()),this._isBrowsable(this.model)&&this.ui.link.attr("aria-haspopup","true"),this.selected?(this.$el.addClass("select"),this.ui.link.attr("aria-expanded","true"),this.$el.attr("aria-selected","true")):this.browsed&&this.$el.addClass("browse"),this._nodeIconView=new o({"el":this.$(".csui-type-icon").get(0),"node":this.model});var e=this._nodeIconView.model.get("className");e=this.valid?e:e+"_nonselectable",this._nodeIconView.model.set("className",e);var t=this._nodeIconView.model.get("mainClassName");t=this.valid?t:t+"_nonselectable",this._nodeIconView.model.set("mainClassName",t),this._nodeIconView.render()},"onBeforeDestroy":function(){this._nodeIconView&&this._nodeIconView.destroy()},"_openSearchLocation":function(e){e.preventDefault(),e.stopPropagation(),this._parent.triggerMethod("click:location",this.model.parent)},"_isBrowsable":function(e){return e.get("container")&&!1!==e.get("perm_see_contents")},"getResolvedModel":function(){var e=this.model;return this.options.resolveShortcuts&&1===e.get("type")&&void 0!==e.original&&(e=e.original),e}})}),csui.define("hbs!csui/dialogs/node.picker/impl/node.list/node.list",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"1":function(e,i,t,s){return"search-left-item"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){var n,o;return'\r\n<div class="list-content">\r\n  <ul class="binf-list-group '+(null!=(n=i.if.call(e,null!=e?e.searchView:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?n:"")+'" aria-label="'+this.escapeExpression((o=null!=(o=i.nodePickerChoices||(null!=e?e.nodePickerChoices:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"nodePickerChoices","hash":{}}):o))+'" role="listbox"></ul>\r\n  <div class="binf-search-location-group"></div>\r\n</div>\r\n'}});return t.registerPartial("csui_dialogs_node.picker_impl_node.list_node.list",s),s}),csui.define("hbs!csui/dialogs/node.picker/impl/node.list/empty.node.list",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"1":function(e,i,t,s){var n;return'    <p class="csui-no-result-message">\r\n      '+this.escapeExpression((n=null!=(n=i.noSearchResultMessage||(null!=e?e.noSearchResultMessage:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"noSearchResultMessage","hash":{}}):n))+"\r\n    </p>\r\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){var n;return'<div class="csui-no-result-wrapper">\r\n'+(null!=(n=i.if.call(e,null!=(n=null!=e?e.noSearchResultMessage:e)?n.length:n,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?n:"")+"</div>\r\n\r\n\r\n\r\n"}});return t.registerPartial("csui_dialogs_node.picker_impl_node.list_empty.node.list",s),s}),csui.define("css!csui/dialogs/node.picker/impl/search.list/search.list",[],function(){}),csui.define("csui/dialogs/node.picker/impl/search.list/search.location.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","i18n!csui/dialogs/node.picker/impl/nls/lang","hbs!csui/dialogs/node.picker/impl/search.list/search.location.item","csui/behaviors/keyboard.navigation/tabable.region.behavior","csui/behaviors/default.action/default.action.behavior","csui/models/node/node.model","csui/controls/node-type.icon/node-type.icon.view","csui/utils/node.links/node.links","css!csui/dialogs/node.picker/impl/search.list/search.list"],function(e,i,t,s,n,o,l,r,a,c,u){"use strict";var d=s.ItemView.extend({"constructor":function(e){e||(e={}),s.View.prototype.constructor.apply(this,arguments)},"triggers":{"click":"click:location"},"tagName":"a","template":o,"className":"search-location-name","behaviors":{"DefaultAction":{"behaviorClass":r}},"templateHelpers":function(){return{"name":this.model.parent.get("name")?this.model.parent.get("name"):n.noValue}},"onRender":function(e){if(this.model.parent){var i=new a(this.model.get("parent_id_expand"),{"connector":this.model.connector}),t=u.getUrl(i);this.$el.prop("href",t),this._nodeIconViewLocation=new c({"el":this.$(".csui-type-location-icon").get(0),"node":this.model.parent}),this._nodeIconViewLocation.render()}}});return s.CollectionView.extend({"childView":d,"childEvents":{"click:location":"onLocationClick"},"events":{"keydown":"onKeyInView"},"onAddChild":function(e){e.$el.addClass("csui-acc-focusable")},"childViewOptions":function(){return{"notTabableRegion":this.options.notTabableRegion}},"updateChildOptions":function(e){this.childViewOptions.notTabableRegion=!0},"constructor":function(e){e||(e={}),s.CollectionView.prototype.constructor.apply(this,arguments),this.focusIndex=0,this.on("render",function(){var e=this;setTimeout(function(){e.trigger("dom:refresh")},100)})},"onLocationClick":function(e){this.trigger("click:location",e.model.parent)},"behaviors":{"TabableRegion":{"behaviorClass":l}},"isTabable":function(){return this.children.find(function(e){var i=e.$el;return i.is(":visible")&&!i.is(":disabled")})},"currentlyFocusedElement":function(){var e=this.$el.find(".search-location-name.csui-acc-focusable");if(e.length)return i(e[this.focusIndex])},"setFocus":function(){var e=this.$el.find(".search-location-name.csui-acc-focusable");i(e[this.focusIndex]).focus()},"onKeyInView":function(e){var t=e.keyCode,s=this.$el.find(".search-location-name.csui-acc-focusable");switch(t){case 38:case 40:38===t?this.focusIndex>0&&--this.focusIndex:this.focusIndex<s.length-1&&++this.focusIndex,document.activeElement.classList.contains("search-location-name")&&(s=this.$el.find(".search-location-name.csui-acc-focusable")),this.trigger("changed:focus"),i(s[this.focusIndex]).focus()}}})}),csui.define("css!csui/dialogs/node.picker/impl/node.list/node.list",[],function(){}),csui.define("csui/dialogs/node.picker/impl/node.list/node.list.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/lib/backbone","csui/dialogs/node.picker/impl/node.list/list.item.view","csui/controls/progressblocker/blocker","csui/behaviors/keyboard.navigation/tabable.region.behavior","csui/controls/tile/behaviors/perfect.scrolling.behavior","csui/models/node/node.model","hbs!csui/dialogs/node.picker/impl/node.list/node.list","hbs!csui/dialogs/node.picker/impl/node.list/empty.node.list","csui/dialogs/node.picker/impl/search.list/search.location.view","i18n!csui/dialogs/node.picker/impl/nls/lang","css!csui/dialogs/node.picker/impl/node.list/node.list"],function(e,i,t,s,n,o,l,r,a,c,u,d,h){"use strict";var p=t.ItemView.extend({"template":u,"constructor":function(e){t.ItemView.prototype.constructor.apply(this,arguments),this.listenTo(this.model,"change",this.render)}});return t.CompositeView.extend({"className":"cs-list","template":c,"emptyView":p,"emptyViewOptions":function(){return{"model":this.emptyModel}},"templateHelpers":function(){return{"searchView":this.options.searchView}},"childViewContainer":".binf-list-group","childView":n,"childViewOptions":function(){return{"searchView":this.options.searchView,"locationEle":this.ui.location,"resolveShortcuts":this.options.resolveShortcuts}},"childEvents":{"click:item":"onItemClick","before:add:child":"onBeforeAddChild","change:child":"onChangeChild"},"ui":{"listParent":".list-content","list":".binf-list-group","location":".binf-search-location-group"},"events":{"keydown":"onKeyInView"},"onBeforeAddChild":function(i){var t=i.model,s=this.commandType.validateTarget(t),n=t.get("id");s=s&&e.every(this.commandType.unselectableNodes,function(e){return n!==e}),i.setValidity(s)},"onChangeChild":function(e){if(e!==this.collection){var i=this.children.findByModel(e);i.render(),this.validateAndUpdateChild(i)}},"onAddChild":function(e){var i=e.model.get("id");return this.selectItems[i]&&(this.selectItems[i]=e,this.toggleSelectedChild(e)),this.validateAndUpdateChild(e),this.browsedChild&&this.browsedChild.model.get("id")===i&&(this.browsedChild=e,this.toggleBrowsedChild(e)),!0},"shouldDisable":function(e){return void 0===e||(!!this.commandType.isActionNode(e)||(this.options.resolveShortcuts&&1===e.get("type")&&void 0!==e.original?this.shouldDisable(e.original):!this.commandType.isSelectable(e)&&!this._isBrowsable(e)))},"validateAndUpdateChild":function(e){this.options.searchView||this.commandType.validateNode(e.getResolvedModel())?e.$el.addClass("csui-acc-focusable"):e.$el.hide();var i=this.shouldDisable(e.model);e.setEnable(!i),this._isBrowsable(e.model)?(e.ui.link.attr("aria-haspopup","true"),e.ui.link.attr("aria-expanded","false")):(e.ui.link.removeAttr("aria-haspopup"),e.ui.link.removeAttr("aria-expanded"))},"collectionEvents":{"sync":"syncUpdate","change":"onChangeChild"},"behaviors":{"PerfectScrolling":{"behaviorClass":r,"contentParent":"> .list-content","suppressScrollX":!0},"TabableRegion":{"behaviorClass":l}},"isTabable":function(){return this.children.find(function(e){var i=e.$el;return i.is(":visible")&&!i.is(":disabled")})},"currentlyFocusedElement":function(){var e=this.$el.find(".binf-list-group-item.csui-acc-focusable");if(e.length)return i(e[this.focusIndex])},"setFocus":function(){var e=this.$el.find(".binf-list-group-item.csui-acc-focusable");i(e[this.focusIndex]).focus()},"onKeyInView":function(e){var t=e.keyCode,s=this.$el.find(".binf-list-group-item.csui-acc-focusable");switch(t){case 9:document.activeElement.classList.contains("search-location-name")||(this.locationView.focusIndex=this.focusIndex);break;case 38:case 40:38===t?this.focusIndex>0&&--this.focusIndex:this.focusIndex<s.length-1&&++this.focusIndex,document.activeElement.classList.contains("search-location-name")&&(s=this.$el.find(".search-location-name.csui-acc-focusable")),this.trigger("changed:focus"),i(s[this.focusIndex]).focus();break;case 35:this.focusIndex=this.collection.length-1,this.trigger("changed:focus"),i(s[this.focusIndex]).focus();break;case 36:this.focusIndex=0,this.trigger("changed:focus"),i(s[this.focusIndex]).focus()}},"constructor":function(n){n||(n={}),e.defaults(n,{"pageSize":30}),t.CompositeView.prototype.constructor.apply(this,arguments),this.jQuery=i,o.imbue(this),this.selectItems=e.extend({},n.selection),this.blockScroll=!0,this.notFetching=!0,this.init=!0,this.nextCollectionPage=e.bind(this.addNextCollectionPage,this),this.commandType=n.commandType,this.focusIndex=0,this.emptyModel=new s.Model({"noSearchResultMessage":""}),this.listenTo(this.collection,"sync",function(){0===this.collection.length?(i(".binf-list-group").removeClass("search-left-item"),this.$el.find(".binf-list-group").addClass("csui-no-results")):this.$el.find(".binf-list-group").removeClass("csui-no-results"),this.emptyModel.set("noSearchResultMessage",h.noSearchResultMessage)}),this.locationView=new d({"collection":this.collection}),this.listenTo(this.locationView,"click:location",this.onClickLocation),this.listenTo(this.collection,"request",this.setBlocker),this.listenTo(this.collection,"reset",this.setBlocker),this.listenTo(this,"browse:complete",function(){this.notFetching=!0})},"onRender":function(e){var i=new t.Region({"el":this.ui.location});this.options.searchView&&i.show(this.locationView)},"onClickLocation":function(e){this.trigger("click:location",e)},"syncUpdate":function(){this.nextTriggerSetting=this.options.pageSize/2,this.blockScroll=!0,this.notFetching=!0,this.init=!0,this.unblockActions(),this.confirmSelectionList(),this.trigger("dom:refresh")},"reset":function(){this.init=!0,this.scrollBar&&this.scrollBar.scrollTop(0)},"stopBlocker":function(){return this.unblockActions(),!0},"setBlocker":function(){return this.blockScroll&&(this.blockScroll=!1,this.blockActions()),!0},"addNextCollectionPage":function(e,i){var t=this.collection.length,s=this.ui.list.height()-this.ui.listParent.height(),n=this.ui.listParent.scrollTop()/s,o=(t-this.nextTriggerSetting)/t;if(t<this.collection.totalCount&&n>=o){var l=this;this.notFetching&&(this.notFetching=!1,this.collection.setSkip(t,!1),this.collection.fetch({"reset":!1,"remove":!1,"merge":!1}).done(function(){if(l.options.resolveShortcuts){var e=l.collection.filter(function(e,i){return i>=t&&l.commandType.shouldResolveShortcut(e)});l.resolveShortcuts(e)}})),n>.98&&this.init&&(this.setBlocker(),this.init=!1)}},"resolveShortcuts":function(e){var t=this,s=[];return t.options.resolveShortcuts?(e.filter(t.commandType.shouldResolveShortcut).forEach(function(e){var i=void 0!==e.original?e.original.get("id"):e.original_id,t=new a({"id":i},{"connector":e.connector});s.push(t.fetch().done(function(){e.original=t,e.trigger("change",e)}))}),i.whenAll.apply(i,s)):i.Deferred().resolve()},"onDomRefresh":function(){this.scrollBar||(this.scrollBar=this.ui.listParent,this.scrollBar.on("scroll",this.nextCollectionPage))},"onItemClick":function(e){if(s.trigger("closeToggleAction"),!e.$el.hasClass("csui-disabled")){this.options.searchView?(this.childView=n,this._processClickedItem(e),e.getResolvedModel().get("container")&&(this.jQuery(".csui-node-picker .binf-search-location-group").addClass("binf-hidden"),this.jQuery(".csui-node-picker .csui-search-item-right-panel").addClass("binf-hidden"))):(this._processClickedItem(e),this.options.searchView=!1,e.options.searchView=!1);var t=this.$el.find(".binf-list-group-item.csui-acc-focusable");this.focusIndex=i(t).index(e.el),this.trigger("changed:focus"),i(t[this.focusIndex]).focus()}},"_processClickedItem":function(e){var i=this._isBrowsable(e.getResolvedModel());return this.notFetching&&(this.notFetching=!1,i?this._browseSelection(e):this._targetSelection(e),e.$el.blur()),this.$el.trigger("setCurrentTabFocus"),!0},"clearSelect":function(){var i=this;return e.each(this.selectItems,function(e){i.toggleSelectedChild(e)}),this.selectItems={},!0},"toggleSelectedChild":function(e){this.commandType.isSelectable(e.getResolvedModel())&&e.toggleSelect()},"toggleBrowsedChild":function(e){e&&e.toggleBrowse()},"confirmSelectionList":function(){e.each(this.selectItems,function(i,t){e.find(this.collection.models,function(e){return e.get("id").toString()===t})||this.commandType.multiSelect||(delete this.selectItems[t],this.trigger("selection:change",{"node":this._getNodeForSelection(i),"add":!1}))},this)},"_isBrowsable":function(e){return this.options.resolveShortcuts&&1===e.get("type")&&void 0!==e.original?this.commandType.browseAllowed(e.original):this.commandType.browseAllowed(e)},"_targetSelection":function(e){var i=this._getNodeForSelection(e),t=i.get("id"),s=e.isSelected();s?(this.toggleSelectedChild(e),delete this.selectItems[t]):(this.commandType.multiSelect||this.clearSelect(),this.selectItems[t]=e,this.toggleSelectedChild(e)),this.trigger("selection:change",{"node":i,"add":!s}),this.notFetching=!0},"_browseSelection":function(e){var i=e.getResolvedModel(),t=this.commandType.isSelectableType(i),s=this.commandType.browseAllowed(i),n=this.commandType.isSelectable(i),o=e.isBrowsed(),l=e.isSelected(),r=!1;o||l?(n&&this._targetSelection(e),this.notFetching=!0):(n?(this._browseNSelect(e),r=!0):((s||t)&&(this.clearSelect(),r=!0),this.toggleBrowsedChild(e)),this.options.searchView=!1,e.options.searchView=!1,this._browse(e,r),r&&this.trigger("selection:change",{"node":this._getNodeForSelection(e),"silent":!0,"add":r}))},"_browse":function(e,i){this.browsedChild&&this.browsedChild.toggleBrowse(),this.browsedChild=e,e.ui.link.attr("aria-expanded","true"),this.trigger("browse:select",{"node":e.getResolvedModel(),"add":i})},"_browseNSelect":function(e){var i=this._getNodeForSelection(e).get("id");this.commandType.multiSelect||this.clearSelect(),this.selectItems[i]=e,e.assignedBrowseNSelect()},"_getNodeForSelection":function(e){var i=e.model;return this.options.resultOriginalNode&&null!=e.model.original&&(i=e.model.original),i}})}),csui.define("hbs!csui/dialogs/node.picker/impl/select.view/impl/header/header",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"1":function(e,i,t,s){var n;return'  <div class="csui-search-item-left-panel">\r\n    <div class="csui-search-item-type">\r\n      <span class="csui-type-label"> '+this.escapeExpression((n=null!=(n=i.type||(null!=e?e.type:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"type","hash":{}}):n))+' </span>\r\n    </div>\r\n    <div class="csui-search-item">\r\n      <div class="csui-search-item-name">\r\n        '+this.escapeExpression((n=null!=(n=i.name||(null!=e?e.name:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"name","hash":{}}):n))+'\r\n      </div>\r\n    </div>\r\n  </div>\r\n  <div class="csui-search-item-right-panel">\r\n    <div class="csui-search-item-location">\r\n      <div class="csui-search-toolbar-container">\r\n        '+this.escapeExpression((n=null!=(n=i.location||(null!=e?e.location:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"location","hash":{}}):n))+"\r\n      </div>\r\n    </div>\r\n  </div>\r\n"},"3":function(e,i,t,s){var n;return'  <div class="csui-folder-name">\r\n    <h3 class="folder-name" title="'+this.escapeExpression((n=null!=(n=i.title||(null!=e?e.title:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"title","hash":{}}):n))+'">'+this.escapeExpression((n=null!=(n=i.title||(null!=e?e.title:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"title","hash":{}}):n))+'</h3>\r\n    <span class="cs-icon icon-sv-search csui-acc-focusable" tabindex="0" data-cstabindex="-1"\r\n          role="button" aria-expanded="false" aria-haspopup="true" title="'+this.escapeExpression((n=null!=(n=i.searchInButtonAria||(null!=e?e.searchInButtonAria:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"searchInButtonAria","hash":{}}):n))+'" aria-label="'+this.escapeExpression((n=null!=(n=i.searchInButtonAria||(null!=e?e.searchInButtonAria:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"searchInButtonAria","hash":{}}):n))+'"></span>\r\n  </div>\r\n\r\n  <form class="cs-modal-filter">\r\n    <div class="binf-form-group">\r\n      <input class="binf-form-control cs-filter-input" placeholder="'+this.escapeExpression((n=null!=(n=i.search_placeholder||(null!=e?e.search_placeholder:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"search_placeholder","hash":{}}):n))+'"\r\n             tabindex="0" data-cstabindex="-1" aria-label="'+this.escapeExpression((n=null!=(n=i.search_placeholder||(null!=e?e.search_placeholder:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"search_placeholder","hash":{}}):n))+'">\r\n      <span class="binf-form-control-feedback cs-icon icon-formfield-clear" role="button"\r\n            title="'+this.escapeExpression((n=null!=(n=i.clearSearchButtonAria||(null!=e?e.clearSearchButtonAria:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"clearSearchButtonAria","hash":{}}):n))+'" aria-label="'+this.escapeExpression((n=null!=(n=i.clearSearchButtonAria||(null!=e?e.clearSearchButtonAria:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"clearSearchButtonAria","hash":{}}):n))+'" tabindex="0" data-cstabindex="-1"></span>\r\n\r\n      <button class="binf-btn csui-form-control-search" title="'+this.escapeExpression((n=null!=(n=i.collapseSearch||(null!=e?e.collapseSearch:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"collapseSearch","hash":{}}):n))+'" aria-label="'+this.escapeExpression((n=null!=(n=i.collapseSearch||(null!=e?e.collapseSearch:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"collapseSearch","hash":{}}):n))+'" aria-expanded="true" aria-haspopup="true"\r\n              tabindex="0" data-cstabindex="-1">\r\n        <span class="form-control-search cs-icon icon-sv-search-hide"></span>\r\n      </button>\r\n    </div>\r\n  </form>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){var n,o;return'  <div class="csui-targetbrowse-history">\r\n      <span class="csui-targetbrowse-arrow-back">\r\n        <span class="icon arrow_back cs-go-back" title="'+this.escapeExpression((o=null!=(o=i.backButtonTooltip||(null!=e?e.backButtonTooltip:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"backButtonTooltip","hash":{}}):o))+'"\r\n              aria-label="'+this.escapeExpression((o=null!=(o=i.backButtonAria||(null!=e?e.backButtonAria:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"backButtonAria","hash":{}}):o))+'" tabindex="0" data-cstabindex="-1"\r\n              role="link"></span>\r\n      </span>\r\n  </div>\r\n'+(null!=(n=i.if.call(e,null!=e?e.searchView:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.program(3,s,0)}))?n:"")}});return t.registerPartial("csui_dialogs_node.picker_impl_select.view_impl_header_header",s),s}),csui.define("css!csui/dialogs/node.picker/impl/select.view/impl/header/header",[],function(){}),csui.define("csui/dialogs/node.picker/impl/select.view/impl/header/header.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/lib/backbone","csui/behaviors/input/placeholder","i18n!csui/controls/table/impl/nls/lang","csui/behaviors/keyboard.navigation/tabable.region.behavior","hbs!csui/dialogs/node.picker/impl/select.view/impl/header/header","i18n!csui/dialogs/node.picker/impl/nls/lang","css!csui/dialogs/node.picker/impl/select.view/impl/header/header","csui/lib/jquery.ui/js/jquery-ui"],function(e,i,t,s,n,o,l,r,a){return t.ItemView.extend({"template":r,"tagName":"div","templateHelpers":function(){return{"search_icon_tooltip":e.str.sformat(o.searchIconTooltip,this.options.columnTitle),"search_placeholder":o.searchByNamePlaceholder,"search_clear_icon_tooltip":o.searchClearIconTooltip,"title":this.title,"backButtonTooltip":a.backButtonTooltip,"type":a.Type,"name":a.Name,"location":a.Location,"searchView":this.options.searchView,"searchInButtonAria":e.str.sformat(o.searchPlaceholder,this.title),"clearSearchButtonAria":a.clearSearchButtonAria,"collapseSearch":a.collapseSearch,"backButtonAria":a.backButtonTooltip}},"ui":{"searchBox":"> form.cs-modal-filter","closeSearchIcon":"> form .csui-form-control-search","openSearchIcon":"> .csui-folder-name .icon-sv-search","headerTitle":"> .csui-folder-name","searchInput":"> form .cs-filter-input","clearer":"> form .binf-form-control-feedback","tabElements":"> *[tabindex]","backBtn":".csui-targetbrowse-history"},"events":{"click .icon-sv-search":"searchClicked","click .csui-form-control-search":"searchClicked","paste @ui.searchInput":"contentPasted","change @ui.searchInput":"filterChanged","click @ui.clearer":"searchFieldClearerClicked","submit @ui.searchBox":"filterChanged","keydown":"onKeyInView"},"behaviors":{"Placeholder":{"behaviorClass":n},"TabableRegionBehavior":{"behaviorClass":l}},"constructor":function(e){this.options=e||{},this.container=e.container,this.lastFilterValue="",this.title=e.title,t.ItemView.prototype.constructor.apply(this,arguments),this.container&&this.listenTo(this.container,"change:name",function(e){this.title=e.get("name"),this.render()})},"currentlyFocusedElement":function(e){var i=this.$el.find("*[data-cstabindex=-1]");return i.length&&i.prop("tabindex",0),i.length>1?this.$el.find(".cs-go-back:visible").length&&!e.shiftKey?this.$el.find(".cs-go-back"):this.$el.find(".csui-folder-name.binf-hidden").length&&!e.shiftKey?this.$el.find("input"):this.$el.find(".csui-folder-name.binf-hidden").length&&e.shiftKey?this.$el.find("button"):this.$el.find(".csui-folder-name .icon-sv-search"):i[0]},"onLastTabElement":function(e){var t=this.$("[data-cstabindex=-1]"),s=t.length-1;if(t.length){var n=e?t[0]:t[s];return this.$(".csui-focus").removeClass("csui-focus"),i(n).hasClass(l.accessibilityActiveElementClass)&&!e}return!0},"onKeyInView":function(e){var t=i(e.target);switch(e.keyCode){case 13:t.removeClass(l.accessibilityActiveElementClass),i(e.target).trigger("click");break;case 27:i(e.target).hasClass(".icon-sv-search")||this.$el.trigger("tabNextRegion");break;default:return!0}return!1},"onRender":function(){this.ui.clearer.toggle(!1),this.ui.searchBox.toggleClass("binf-hidden"),this.ui.closeSearchIcon.toggleClass("binf-hidden"),this.ui.searchInput.hide();var e=this;this.ui.searchInput.keyup(function(i){e.filterChanged(i)}),this.$el.find("*[data-cstabindex]").on("focus",function(){var t=i(this);e.focusedElement&&e.focusedElement.removeClass(l.accessibilityActiveElementClass),t.addClass(l.accessibilityActiveElementClass),e.focusedElement=t})},"searchClicked":function(t){t.preventDefault(),t.stopPropagation(),s.trigger("closeToggleAction"),this.ui.headerTitle.toggleClass("binf-hidden"),this.ui.searchInput.toggleClass(l.accessibilityFocusableClass),this.ui.clearer.toggle(!1),this.getValue().length&&(this.ui.searchInput.val(""),this.filterChanged(t)),this.ui.searchInput.toggle(200,"linear",e.bind(function(){this.ui.searchInput.focus(),this.ui.closeSearchIcon.toggleClass("binf-hidden")},this)),this.ui.closeSearchIcon.toggleClass(l.accessibilityFocusableClass),this.ui.closeSearchIcon.removeClass(l.accessibilityActiveElementClass),this.ui.openSearchIcon.toggleClass(l.accessibilityFocusableClass),this.ui.searchBox.toggleClass("binf-hidden"),i(t.target).hasClass("form-control-search")?(this.ui.searchInput.removeClass(l.accessibilityActiveElementClass),this.ui.openSearchIcon.addClass(l.accessibilityActiveElementClass),this.$el.trigger("setCurrentTabFocus")):(this.ui.searchInput.addClass(l.accessibilityActiveElementClass),this.ui.openSearchIcon.removeClass(l.accessibilityActiveElementClass)),this.trigger("changed:focus"),this.focusElement&&this.focusElement.focus()},"searchFieldClearerClicked":function(e){e.preventDefault(),e.stopPropagation(),this.ui.clearer.removeClass(l.accessibilityFocusableClass),this.ui.clearer.removeClass(l.accessibilityActiveElementClass),this.ui.searchInput.val(""),this.filterChanged(e),this.ui.searchInput.focus(),this.ui.searchInput.addClass(l.accessibilityActiveElementClass)},"getColumn":function(){return this.options.column},"getValue":function(){var e;return e=this.ui.searchInput.val(),e===this.ui.searchInput.attr("placeholder")&&(e=""),e},"setValue":function(e){e&&e.length&&(this.ui.searchInput.val(e),this.lastFilterValue=e)},"getShown":function(){return this.ui.searchInput.hasClass("binf-show")},"setShown":function(e){!0===e&&this.ui.searchInput.hasClass("binf-hidden")?this.ui.searchInput.toggleClass("show binf-hidden"):!1===e&&this.ui.searchInput.hasClass("binf-show")&&this.ui.searchInput.toggleClass("show binf-hidden")},"setFocus":function(){var e=this.ui.searchInput.val().length;this.ui.searchInput.focus(),
this.ui.searchInput[0].setSelectionRange(e,e)},"contentPasted":function(e){this.applyFilter()},"filterChanged":function(e){return this.applyFilter(),!1},"applyFilter":function(){var e=this.getValue(),i=!!e.length;if(this.ui.clearer.toggle(i),i?this.ui.clearer.addClass(l.accessibilityFocusableClass):this.ui.clearer.removeClass(l.accessibilityFocusableClass),this.lastFilterValue!=e){this.lastFilterValue=e;var t=this;this.filterTimeout&&clearTimeout(this.filterTimeout),this.filterTimeout=setTimeout(function(){t.filterTimeout=void 0,t.trigger("change:filterValue",{"name":t.getValue()})},1e3)}}})}),csui.define("hbs!csui/dialogs/node.picker/impl/select.view/impl/select.view",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){return'<div>\r\n  <div class="csui-np-header cs-folder-name"></div>\r\n</div>\r\n<div class="csui-np-content"></div>\r\n\r\n'}});return t.registerPartial("csui_dialogs_node.picker_impl_select.view_impl_select.view",s),s}),csui.define("css!csui/dialogs/node.picker/impl/select.view/impl/select.view",[],function(){}),csui.define("csui/dialogs/node.picker/impl/select.view/select.view",["module","csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/utils/log","csui/utils/base","csui/dialogs/node.picker/impl/node.list/node.list.view","csui/dialogs/node.picker/impl/select.view/impl/header/header.view","hbs!csui/dialogs/node.picker/impl/select.view/impl/select.view","csui/controls/mixins/layoutview.events.propagation/layoutview.events.propagation.mixin","csui/behaviors/keyboard.navigation/tabable.region.behavior","i18n!csui/dialogs/node.picker/impl/nls/lang","css!csui/controls/list/impl/list","css!csui/dialogs/node.picker/impl/select.view/impl/select.view"],function(e,i,t,s,n,o,l,r,a,c,u,d,h){var p=n.LayoutView.extend({"template":c,"templateHelpers":function(){var e,i="";return this.options.targetBrowseHistory.length&&(e=this.options.targetBrowseHistory[this.options.targetBrowseHistory.length-1],i="search"===e[0]?h.backToSearchAria:"location"===e[0]?h.backToFolderView:"node"===e[0]?h.backToFolderView:""),{"backButtonTooltip":h.backButtonTooltip,"backButtonAria":""!=i?i:h.backToFolderView}},"regions":{"viewHeaderRegion":".csui-np-header","viewContentRegion":".csui-np-content"},"ui":{"backSearchButton":".csui-targetbrowse-arrow-back"},"events":{"tabNextRegion":"tabNextRegion","click @ui.backSearchButton":"onClickFolderBack","keydown @ui.backSearchButton":"selectFolderBack"},"behaviors":{"TabableRegion":{"behaviorClass":d,"recursiveNavigation":!0,"containTabFocus":!0}},"constructor":function(e){e||(e={}),t.defaults(e,{"pageSize":30}),n.LayoutView.prototype.constructor.call(this,e),this.search=!1,this.rendered=!1,this.selectList={},this.collection=e.collection,this.container=e.container,this.propagateEventsToRegions(),this.listenTo(this.collection,"sync",this._handlePendingFilter),this.setHeader(e),this.setListView(e),this.onWinRefresh=t.bind(this.windowRefresh,this),i(window).bind("resize.app",this.onWinRefresh)},"tabNextRegion":function(e){this.listView.currentlyFocusedElement()&&(e.preventDefault(),e.stopPropagation(),this.listView.setFocus())},"windowRefresh":function(){var e=this.options.parentEl.height();(window.chrome||navigator.userAgent.indexOf("Firefox")>0)&&e>0&&this.$el.css("height",e+"px")},"onDestroy":function(){this.$el.off(),i(window).unbind("resize.app",this.onWinRefresh)},"onRender":function(){var e=this,t=e.$el.find(".csui-np-content");this.viewHeaderRegion.show(this.headerView),this.viewContentRegion.show(this.listView),this.$el.hover(function(){t.addClass("binf-focus")},function(){t.removeClass("binf-focus")}),this.$el.find("*[data-cstabindex]").on("focus",function(){var t=i(this);e.focusedElement&&e.focusedElement.removeClass(d.accessibilityActiveElementClass),t.addClass(d.accessibilityActiveElementClass),e.focusedElement=t}),this.rendered=!0,this.trigger("dom:refresh")},"onDomRefresh":function(){this.windowRefresh()},"onShow":function(){this.rendered||this.render(),t.each(this.regionManager._regions,function(e){e.currentView&&e.currentView.trigger("show")})},"getNumberOfSelectItems":function(){return t.size(this.selectList)},"setNewSelect":function(e,i){this.clearSelect(),this._setSelection({"node":e,"add":!0,"silent":i})},"isTabable":function(){return this.$("*[tabindex]").length>0},"currentlyFocusedElement":function(e){var i=this.$el.find("*[tabindex=-1]");return i.length&&i.prop("tabindex",0),this.$el.find(".csui-folder-name.binf-hidden").length?this.$el.find("input"):this.$el.find(".csui-targetbrowse-arrow-back .cs-go-back:visible").length&&!e.shiftKey?this.$el.find(".csui-targetbrowse-arrow-back .cs-go-back"):this.$el.find(".csui-folder-name .icon-sv-search")},"onLastTabElement":function(e){var t=this.$("[data-cstabindex=-1]"),s=t.length-1;if(t.length){var n=e?t[0]:t[s];return this.$(".csui-focus").removeClass("csui-focus"),i(n).hasClass(d.accessibilityActiveElementClass)}return!0},"clearSelect":function(){this.listView.clearSelect(),this.selectList={}},"setListView":function(e){e||(e={});var i={"collection":this.collection,"container":this.container,"commandType":e.commandType,"pageSize":e.pageSize,"searchView":e.searchView,"resolveShortcuts":e.resolveShortcuts,"resultOriginalNode":e.resultOriginalNode,"context":e.context},s=this.listView=new r(i);this.listenTo(s,"selection:change",this._setSelection).listenTo(s,"click:location",this._clickLocation).listenTo(s,"browse:select",t.bind(this.trigger,this,"browse:select",this)).listenTo(this,"browse:complete",t.bind(s.trigger,s,"browse:complete"))},"selectFolderBack":function(e){13!==e.keyCode&&32!==e.keyCode||this.trigger("backbutton:click",this)},"onClickFolderBack":function(e){this.trigger("backbutton:click",this)},"setHeader":function(e){var i=this.container&&(this.container.get("name")||"");i=null==i?this.options.locationName:i,this.headerView=new a({"title":i,"container":this.container,"searchView":e.searchView}),this.listenTo(this.headerView,"change:filterValue",this.applyFilter)},"applyFilter":function(e){if(t.extend(e,{"type":this.options.listTypes}),this.collection.fetching)this.filterValuePending=e;else{var i=this;this.collection.setLimit(0,this.options.pageSize,!1),this.collection.setFilter(e,!1),this.collection.fetch({"reset":!0}).fail(function(e){i.listView.stopBlocker(),i.trigger("search:failed",{"resp":e,"view":i})}),this.listView.reset()}},"refresh":function(){var e=this;this.collection.fetch({"reset":!0}).fail(function(){e.listView.stopBlocker()})},"addFolderSelection":function(e){this._setSelection({"browse":!0,"add":!0,"node":e})},"_handlePendingFilter":function(){t.isEmpty(this.filterValuePending)||(this.collection.setFilter(this.filterValuePending),this.filterValuePending={})},"_setSelection":function(e){var i=e.node.get("id"),s=this.options.commandType;if(!s.multiSelect&&(this.selectList={}),e.add&&s.isSelectable(e.node)){if(s.multiSelect){var n=this;t.each(this.selectList,function(i){var t=e.node.parent;i.get("id")===t.get("id")&&(n.selectList={})})}this.selectList[i]=e.node}else delete this.selectList[i],s.multiSelect||this.trigger("clear:selectList",e,this);e.silent||this.trigger("selection:change",e,this)},"_clickLocation":function(e){this.trigger("click:location",e,this)}});return t.extend(p.prototype,u),p}),csui.define("hbs!csui/dialogs/node.picker/impl/select.views/selectviews",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){return"\r\n"}});return t.registerPartial("csui_dialogs_node.picker_impl_select.views_selectviews",s),s}),csui.define("csui/dialogs/node.picker/impl/search.list/search.results.model",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/utils/url","csui/models/node/node.model","csui/models/mixins/connectable/connectable.mixin","csui/models/mixins/fetchable/fetchable.mixin","csui/models/browsable/browsable.mixin","csui/models/browsable/v1.request.mixin","csui/models/browsable/v2.response.mixin","csui/utils/deepClone/deepClone"],function(e,i,t,s,n,o,l,r,a,c){"use strict";var u=t.Collection.extend({"model":n,"constructor":function(e,i){this.options=i||(i={}),t.Collection.prototype.constructor.call(this,e,i),this.makeConnectable(i).makeFetchable(i).makeBrowsable(i).makeBrowsableV1Request(i).makeBrowsableV2Response(i)},"clone":function(){return new this.constructor(this.models,{"connector":this.connector,"skip":this.skipCount,"top":this.topCount,"filter":e.deepClone(this.filters),"orderBy":e.clone(this.orderBy)})}});return r.mixin(u.prototype),a.mixin(u.prototype),c.mixin(u.prototype),o.mixin(u.prototype),l.mixin(u.prototype),e.extend(u.prototype,{"isFetchable":function(){return!!this.options.query.get("where")},"cacheId":"","url":function(){var e=this.connector.connection.url.replace("/v1","/v2"),i=this.options.query.toJSON();return i.where="OTName:"+i.where,this.orderBy="OTName",i=s.combineQueryString(this.getBrowsableUrlQuery(),{"actions":"open","expand":"properties{parent_id}"},i),s.combine(e,"search?"+i)},"parse":function(e,i){return this.parseBrowsedState(e.collection,i),e.results.sorting=e.collection.sorting,this.cacheId=e.collection&&e.collection.searching&&e.collection.searching.cache_id?e.collection.searching.cache_id:"",this.parseBrowsedItems(e,i)}}),u}),csui.define("css!csui/dialogs/node.picker/impl/select.views/selectviews",[],function(){}),csui.define("css!csui/dialogs/node.picker/impl/select.views/slider",[],function(){}),csui.define("csui/dialogs/node.picker/impl/select.views/select.views",["module","csui/lib/jquery","csui/lib/underscore","csui/lib/marionette","csui/utils/log","csui/utils/base","i18n!csui/dialogs/node.picker/impl/nls/lang","csui/models/node/node.model","csui/models/nodechildren","csui/dialogs/node.picker/impl/select.view/select.view","csui/dialogs/modal.alert/modal.alert","csui/utils/commands","hbs!csui/dialogs/node.picker/impl/select.views/selectviews","csui/controls/mixins/view.events.propagation/view.events.propagation.mixin","csui/behaviors/keyboard.navigation/tabable.region.behavior","csui/dialogs/node.picker/impl/search.list/search.results.model","csui/lib/binf/js/binf","csui/lib/jquery.ui/js/jquery-ui","css!csui/dialogs/node.picker/impl/select.views/selectviews","css!csui/dialogs/node.picker/impl/select.views/slider"],function(e,i,t,s,n,o,l,r,a,c,u,d,h,p,m,f){"use strict";var g=s.ItemView.extend({"className":"csui-select-lists","template":h,"constructor":function(e){e||(e={}),t.defaults(e,{"pageSize":30}),s.ItemView.prototype.constructor.call(this,e),this.commandType=e.commandType,this.selectableTypes=this.commandType.getSelectableNodeTypes(),this.listTypes=t.isEmpty(this.selectableTypes)?[]:t.contains(this.selectableTypes,-1)?this.selectableTypes:t.union(this.selectableTypes,[-1]),this.leftView=this.rightView=null,this.invalidNodes=[],this.connector=e.connector},"onRender":function(){this.setLeftOnly(),this.leftView&&this.leftView.render(),this.rightView&&this.rightView.render()},"onDomRefresh":function(){this.leftView.triggerMethod("dom:refresh",this.leftView),this.rightView&&this.rightView.triggerMethod("dom:refresh",this.rightView)},"onShow":function(){this.leftView.triggerMethod("show"),this.rightView&&this.rightView.triggerMethod("show")},"setParentNodeAsTarget":function(e){var i=this.commandType.isSelectable(e);return this.rightView&&this.rightView.clearSelect(),this.commandType.multiSelect||this.leftView&&this.leftView.setNewSelect(e,!0),i},"getSelection":function(){var e={},i=this.rightView?this.rightView.selectList:{},s=this.leftView.selectList;return t.extend(e,s,i),e},"getNumberOfSelectItems":function(){var e=this.leftView.getNumberOfSelectItems();return this.rightView&&(e+=this.rightView.getNumberOfSelectItems()||0),e},"leftNodeId":function(){var e=this.leftView.container;return e?e.get("id"):-1},"setLeftOnly":function(){var e=this._setView(-1,"cs-start-locations left-only",this.options.searchView,!1,this.options),i=e.view.container,t=this;return e.promise.done(function(){i&&!t.commandType.multiSelect&&t.leftView.addFolderSelection(i),t.options.searchView&&t.trigger("update:searchHeader",this),0===t.options.targetBrowseHistory.length&&t.options.searchView&&t.options.targetBrowseHistory.push(["location",t.options.previousLocation.id]),t.options.targetBrowseHistory.length>0?t.showBackButton():(t.options.targetBrowseHistory.length>1||1===t.options.targetBrowseHistory.length&&t.options.navigateFromHistory)&&t.showBackButton()}).fail(function(e){t.forceClose(e)}),this.leftView=e.view,e.promise},"forceClose":function(e){this._displayAlert(e).always(this.trigger("close"))},"newLeftView":function(e,i){var t=e.get("id"),s=this;return this.options.pageSize=i,this._drillUp(t).done(function(i){if(s.leftView=i,s.commandType.multiSelect||s.leftView.addFolderSelection(e),s.onDomRefresh(),0===s.options.targetBrowseHistory.length){var t=Math.floor((s.leftView.collection.skipCount||0)/s.leftView.collection.topCount)+1,n=parseInt(s.leftView.collection.topCount)*parseInt(t),o={"leftId":s.leftView&&s.leftView.container?s.leftView.container.get("id"):e.parent?e.parent.get("id"):void 0,"rightId":s.rightView&&s.rightView.container?s.rightView.container.get("id"):void 0,"pageSize":n};s.options.targetBrowseHistory.push(["node",o])}}).fail(function(e){s._displayAlert(e)})},"onSelectionChange":function(e,i){var t=i&&this._isRightView(i);return e&&e.add&&(t?this.leftView.clearSelect():this.rightView&&this.rightView.clearSelect()),i.options.searchView&&e.node.get("container")?this.trigger("update:searchHeader",e.node):this.trigger("change:complete",e.node),!0},"onBrowse":function(e,i){var t=this._isRightView(e),s=null;return this.trigger("changing:selection"),s=t?this.selectRight(i):this.selectLeft(i),s.done(function(){e.trigger("browse:complete")}).fail(function(){e.clearSelect()}),s},"onClickLocation":function(e,i){this.trigger("click:location",e)},"selectLeft":function(e,i){var t=this;return this.options.searchView&&this.options.targetBrowseHistory.push(["search",this.options.query.clone()]),this._runSelection(e,".cs-pane-view","right").done(function(e){e&&(t.rightView=e,t.onDomRefresh())})},"selectRight":function(e,i){var t=this;if(0===this.options.targetBrowseHistory.length)this.options.targetBrowseHistory.push(["location",this.options.previousLocation.id]);else{var s=Math.floor((this.leftView.collection.skipCount||0)/this.leftView.collection.topCount)+1,n=parseInt(this.leftView.collection.topCount)*parseInt(s),o=this.leftView.listView.browsedChild,l={"leftId":o?o.model.parent.get("id"):void 0,"rightId":o?o.model.get("id"):void 0,"pageSize":n};this.options.targetBrowseHistory.push(["node",l])}return this._runSelection(e,".csui-panel.cs-start-locations","left").done(function(e){e&&(t.leftView=t.rightView,t.rightView=e,t.onDomRefresh(),t.showBackButton())})},"showBackButton":function(){this.leftView&&this.options.targetBrowseHistory.length>=1&&this.leftView.headerView&&this.leftView.headerView.ui.backBtn.show()},"hideBackButton":function(){this.leftView&&this.options.targetBrowseHistory.length<1&&this.leftView.headerView&&this.leftView.headerView.ui.backBtn.hide()},"_runSelection":function(e,t,s){var n=e.node,o=this,l=i.Deferred(),r=n.get("id");return this._drillDown(r,t).done(function(e){"left"===s?o.onClearLeftViewSelectList():"right"===s&&o.onClearRightViewSelectList();var i=("left"===s?o.rightView:o.leftView).listView.browsedChild.model;o.trigger("changed",i.get("id")),o.trigger("change:complete",n),l.resolve(e)}).fail(function(e){o._displayAlert(e),o.trigger("change:complete"),l.reject()}),l},"_drillUp":function(e,t){this.trigger("drill:up",e);var s=this._setView(e,"csui-new-view left-only binf-hidden",this.options.searchView,"prepend"),n=s.view,o=this,l=i.Deferred();return n.$el.addClass("zeroWidth").removeClass("binf-hidden"),n.render(),t||o._removeRightView(s.promise).done(function(){l.resolve(s.view)}).fail(function(e){l.reject(e)}),l},"_drillDown":function(e,t){var s=this._setView(e,"csui-new-view",!1),n=null,o=s.view;return o.render(),null==this.rightView?(o.options.searchView=!1,i(".binf-list-group").removeClass("search-left-item"),i(".csui-search-item-left-panel").is(":visible")&&i(".binf-list-group").addClass("search-left-folder-right"),n=this._addRightView(s.promise,o)):n=this._replaceView(s.promise,o,t),n},"_showLeftOnly":function(){function e(){if(null!=t){var e=t[0].selectView;s.cancelEventsToViewsPropagation(e),e.destroy(),t.remove(),s.rightView=null}}var i=this.leftView,t=this.rightView,s=this;i.animate({"width":"100%"},{"duration":200,"complete":e})},"_removeRightView":function(e){var t=this.$el.find(".csui-new-view"),s=this.$el.find(".csui-panel.cs-start-locations"),n=this.$el.find(".cs-pane-view"),o=i.Deferred(),l=this;return s.hide(),n.hide(),t[0].className="csui-panel cs-start-locations left-only",e.done(function(){l._finishRightRemove(t,s,n),o.resolve()}).fail(function(e){l._removeNewView(t,s,n),o.reject(e)}),o},"_removeNewView":function(e,i,t){e||(e=this.$el.find(".csui-new-view"));var s=e[0].selectView;this.cancelEventsToViewsPropagation(s),s.destroy(),e.remove(),i&&i.show(),t&&t.show()},"_finishRightRemove":function(e,i,t){var s;return t.length>0&&(s=t[0].selectView,this.cancelEventsToViewsPropagation(s),s.destroy(),t.remove(),this.rightView=null),s=i[0].selectView,this.cancelEventsToViewsPropagation(s),s.destroy(),i.remove(),this.leftView=null,!0},"_addRightView":function(e,t){var s=this.$el.find(".csui-panel.cs-start-locations"),n=this.$el.find(".csui-new-view"),o=i.Deferred(),l=this;return s[0].className="csui-panel cs-start-locations",n[0].className="csui-panel cs-pane-view csui-slideMidLeft",e.done(function(){o.resolve(t)}).fail(function(e){l._removeNewView(n),s.animate({"width":"100%"},{"duration":200,"complete":function(){s.addClass("left-only").css("width","")}}),l.leftView.clearSelect(),l.leftView.refresh(),o.reject(e)}),o},"_replaceView":function(e,t,s){var n=this.$el.find(s),o=i(".csui-new-view"),l=i(".cs-pane-view"),r=i.Deferred(),a=this;switch(n.hide(),s){case".csui-panel.cs-start-locations":l[0].className="csui-panel cs-start-locations csui-slideLeft",o[0].className="csui-panel cs-pane-view csui-slideMidLeft";break;case".cs-pane-view":o[0].className="csui-panel cs-pane-view csui-slideMidLeft"}return this.$el.find(".left-only").removeClass("left-only"),e.done(function(){a._removeView(n),r.resolve(t)}).fail(function(e){a._reverseRemoveView(o,s,l),".csui-panel.cs-start-locations"===s&&n.show(),r.reject(e)}),r},"_reverseRemoveView":function(e,i,t){switch(this._removeNewView(e),i){case".csui-panel.cs-start-locations":t[0].className="csui-panel cs-pane-view csui-slideRight",this.rightView.refresh();break;case".cs-pane-view":this._removeView(t),this.leftView.$el[0].className="csui-panel cs-start-locations left-only",this.leftView.clearSelect(),this.leftView.refresh()}return!0},"_removeView":function(e){if(e.length){var i=e[0].selectView;return this.cancelEventsToViewsPropagation(i),i.destroy(),e.remove(),!0}return!1},"_setView":function(e,i,s,n,o){o||(o=this._getViewOptions(e,this.connector)),this.options.searchView=s,t.defaults(o,this.options,{"invalidNodes":this.invalidNodes}),n||(n="append");var l=this._newView(o,i),r=this._fetchView(l);return this.options.fromSearch=!!s,l.el.selectView=l,this.$el[n](l.el),{"view":l,"promise":r}},"_fetchView":function(e){return this._fetchContainer(e),this._fetchCollection(e)},"_fetchContainer":function(e){return e.container&&e.container.get("id")&&e.container.fetch(),!0},"_fetchCollection":function(e){e.collection.setOrder(this.options.orderBy,!1),e.collection.setFilter({"type":this.listTypes},!1),e.collection.setLimit(0,this.options.pageSize||e.options.pageSize,!1);var t=i.Deferred();return e.collection.fetch({"reset":!1,"merge":!1,"remove":!1}).done(function(i){e.listView.resolveShortcuts(e.collection).always(function(){t.resolve(e.collection)})}).fail(function(e){t.reject(e)}),t},"_newView":function(e,i){var s=t.extend({"listTypes":this.listTypes,"className":i+" csui-panel","parentEl":this.$el},e),n=new c(s);return this.propagateEventsToViews(n),this.listenTo(n,"selection:change",this.onSelectionChange),this.listenTo(n,"search:failed",this._searchFailed),this.listenTo(n,"backbutton:click",this._onClickBackButton),this.listenTo(n,"clear:selectList",this.onClearLeftViewSelectList),this.listenTo(n,"browse:select",t.bind(this.onBrowse,this)),this.listenTo(n,"click:location",t.bind(this.onClickLocation,this)),n},"onClearLeftViewSelectList":function(){this.leftView&&(this.leftView.selectList={})},"onClearRightViewSelectList":function(){this.rightView&&(this.rightView.selectList={})},"_onClickBackButton":function(e){var i=this,t=this.options.targetBrowseHistory.length>0?this.options.targetBrowseHistory.pop():void 0;if(1===this.options.targetBrowseHistory.length?this.options.navigateFromHistory=!0:this.options.navigateFromHistory=!1,t&&"search"===t[0])this.requestedQueryModel=t[1],this.trigger("back:toSearch",this),this.options.targetBrowseHistory.length>0&&this.showBackButton();else if(t&&"location"===t[0])this.onClearLeftViewSelectList(),this.onClearRightViewSelectList(),this.trigger("change:location",t);else if(this.options.searchView&&t&&"node"===t[0]||t&&"node"===t[0]){this.options.searchView=!1;var s=new r({"id":t[1].leftId},{"connector":this.connector}),n=new r({"id":t[1].rightId},{"connector":this.connector});this.newLeftView(s,t[1].pageSize).done(function(e){i.setParentNodeAsTarget(s),i.trigger("change:complete"),i.trigger("toggle:breadcrumbs",i.leftNodeId()),i.options.targetBrowseHistory&&i.hideBackButton(),i.options.targetBrowseHistory.length>0&&n&&n.get("id")?(i.$el.find(".cs-left-item-"+n.get("id")).length>0&&i.$el.find(".cs-left-item-"+n.get("id")).trigger("click"),i.showBackButton()):i.hideBackButton()})}this.options.backBtn=!0},"_searchFailed":function(e){this._isRightView(e.view)?this._displayAlert(e.resp):this.forceClose(e.resp)},"_isRightView":function(e){var i=e.$el[0].className.split(" ");return t.contains(i,"cs-pane-view")},"_addNewPanel":function(e,i){var t=document.createElement("div");return t.className=e,this.$el[i](t),t},"_getViewOptions":function(e,i){var t=new r({"id":e},{"connector":i});return{"container":t,"collection":new a(void 0,{"node":t,"autofetch":!0,"orderBy":this.options.orderBy,"expand":["node"],"commands":d.getAllSignatures()})}},"_displayAlert":function(e){var i=t.str.sformat(l.serverError,"unknown");return e&&(e instanceof c?i=t.str.sformat(l.ViewDenied,e.node.get("name")):e.responseJSON&&(i=e.responseJSON.error)),u.showInformation(i)}});return t.extend(g.prototype,p),g}),csui.define("hbs!csui/dialogs/node.picker/impl/node.picker",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){var n;return'<div id="csui-np-breadcrumbs" class="cs-breadcrumb">\r\n  <div class="breadcrumb-inner" role="navigation" aria-label="'+this.escapeExpression((n=null!=(n=i.breadcrumbAria||(null!=e?e.breadcrumbAria:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"breadcrumbAria","hash":{}}):n))+'"></div>\r\n  <div class="searchheader-inner"></div>\r\n</div>\r\n<div id="csui-np-selectviews"></div>\r\n'}});return t.registerPartial("csui_dialogs_node.picker_impl_node.picker",s),s}),csui.define("hbs!csui/dialogs/node.picker/impl/search.list/header/search.result.header",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){var n;return'<div class="csui-search-header">\r\n    <span class="csui-search-header-title">\r\n        <span class="results-title searchResultsTitle">'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.searchResults:n,e))+'</span>\r\n        <span class="headerCount searchHeaderCount" aria-live="polite"></span>\r\n    </span>\r\n</div>\r\n'}});return t.registerPartial("csui_dialogs_node.picker_impl_search.list_header_search.result.header",s),s}),csui.define("csui/dialogs/node.picker/impl/search.list/header/search.result.header.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","i18n!csui/dialogs/node.picker/impl/nls/lang","hbs!csui/dialogs/node.picker/impl/search.list/header/search.result.header","css!csui/dialogs/node.picker/impl/search.list/search.list"],function(e,i,t,s,n){"use strict";return t.ItemView.extend({"className":"csui-search-data-header","template":n,"templateHelpers":function(){return{"messages":{"searchResults":s.searchResults}}},"constructor":function(e){e||(e={}),t.View.prototype.constructor.apply(this,arguments)},"onRender":function(){var e=this.collection;this.rendered=!0,this.$el.show(),this._assignTotalItemElem(e)},"_assignTotalItemElem":function(i){this.totalCount=0,i&&i.length>0&&(this.totalCount=i.totalCount);var t=this.$el.find(".searchHeaderCount"),n=s.searchFoundZero;return null!==this.totalCount&&(n=e.str.sformat(s.searchFoundAbout,this.totalCount)),t.empty(),t.append(n),!0}})}),csui.define("csui/dialogs/node.picker/impl/node.picker.view",["module","csui/lib/jquery","csui/lib/underscore","csui/lib/marionette","csui/utils/log","csui/utils/base","csui/models/node/node.model","csui/models/nodechildren","csui/dialogs/node.picker/impl/select.views/select.views","csui/controls/breadcrumbs/breadcrumbs.view","csui/utils/contexts/factories/ancestors","csui/models/nodeancestors","hbs!csui/dialogs/node.picker/impl/node.picker","i18n!csui/dialogs/node.picker/impl/nls/lang","csui/controls/mixins/layoutview.events.propagation/layoutview.events.propagation.mixin","csui/dialogs/node.picker/impl/search.list/header/search.result.header.view"],function(e,i,t,s,n,o,l,r,a,c,u,d,h,p,m,f){var g=s.LayoutView.extend({"template":h,"className":"csui-node-picker","regions":{"breadcrumbRegion":"#csui-np-breadcrumbs > div.breadcrumb-inner","searchHeaderRegion":"#csui-np-breadcrumbs > div.searchheader-inner","selectViewRegion":"#csui-np-selectviews"},"ui":{"breadcrumb":"#csui-np-breadcrumbs","breadcrumbContent":".breadcrumb-inner","searchHeaderContent":".searchheader-inner","selectViews":"#csui-np-selectviews"},"templateHelpers":function(){return{"breadcrumbAria":p.breadcrumbAria,"nodePickerChoices":p.nodePickerChoices}},"constructor":function(e){e||(e={}),s.LayoutView.prototype.constructor.call(this,e),this.propagateEventsToRegions(),this.setViews(e),this.setBreadcrumbs(e),e.searchView&&(this.updatedBreadcrumbId=e.locationID,this.setSearchResultsHeader(e)),this.onWinRefresh=t.bind(this.windowRefresh,this),i(window).bind("resize.app",this.onWinRefresh)},"windowRefresh":function(){var e=i(".cs-breadcrumb"),t=e.is(":visible")?e.height():0,s=this.$el.height()-t;window.chrome&&s>0&&this.selectViews.$el.css("height",s+"px"),this.selectViews.triggerMethod("dom:refresh",this.selectViews),this.breadcrumbs&&this.breadcrumbs.refresh()},"onBeforeDestroy":function(){this.selectViews&&(this.selectViews.leftView&&this.selectViews.leftView.clearSelect(),this.selectViews.rightView&&this.selectViews.rightView.clearSelect())},"onDestroy":function(){i(window).unbind("resize.app",this.onWinRefresh)},"onRender":function(){this.options.searchView&&this.searchHeaderRegion.show(this.searchHeaderView),this.breadcrumbs&&this.breadcrumbRegion.show(this.breadcrumbs),this.selectViews.options.navigateFromHistory=this.options.navigateFromHistory,this.selectViewRegion.show(this.selectViews)},"onDomRefresh":function(){this.windowRefresh()},"onShow":function(){t.each(this.regionManager.regions,function(e){e.currentView&&e.currentView.trigger("show")}),this.options.container||this.options.searchView||(this.ui.breadcrumb.hide(),this.ui.selectViews.addClass("csui-full-height"))},"setViews":function(e){var i=this.selectViews=new a(e);this.listenTo(i,"changed",this.updateBreadcrumbs),this.listenTo(i,"update:searchHeader",this.updateSearchResultHeader),this.listenTo(i,"change:complete",t.bind(this.trigger,this,"change:complete")),this.listenTo(i,"click:location",t.bind(this.trigger,this,"open:location")),this.listenTo(i,"change:location",t.bind(this.trigger,this,"change:location")),this.listenTo(i,"back:toSearch",function(e){this.trigger("back:toSearch",e)}),this.listenTo(i,"backto:folder",function(e){this.trigger("backto:folder",e)}),this.listenTo(i,"close",this.close).listenTo(i,"toggle:breadcrumbs",this.updateBreadcrumbs)},"getSelection":function(){return t.values(this.selectViews.getSelection())},"getNumberOfSelectItems":function(){return this.selectViews.getNumberOfSelectItems()},"close":function(){this.destroy(),this.trigger("close")},"updateBreadcrumbs":function(e){if(this.updatedBreadcrumbId=void 0,this.breadcrumbNode&&this.breadcrumbNode.set("id",e),e){this.getAncestors(e).fetch()}return this.listenTo(this.breadcrumbs,"after:synchronized",this.onAfterBreadcrumbsSynchronized),!0},"getAncestors":function(e){var i=new l({"id":e},{"connector":this.options.connector}),t={"node":i,"autofetch":!0},s=new d(void 0,t);return this.breadcrumbs=new c({"node":i,"collection":s}),this.breadcrumbs.synchronizeCollections(),this.breadcrumbNode||(this.breadcrumbNode=i),s},"setBreadcrumbs":function(e){var i=e.container||e.initialContainer,t=i?i.get("id"):0;if(!t||0===t)return this.getAncestors(0),void this.setBreadcrumbEvents();if(e.container){this.getAncestors(t).fetch()}else this.getAncestors(0),this.setBreadcrumbEvents();return this.setBreadcrumbEvents(),!0},"showBackButton":function(){this.selectViews.showBackButton()},"setBreadcrumbEvents":function(){this.listenTo(this.breadcrumbs,"before:defaultAction",function(e){var i=this.selectViews,t=this;i.newLeftView(e.node).done(function(e){i.setParentNodeAsTarget(e.container),t.trigger("change:complete",e.container)})}),this.listenTo(this.breadcrumbs,"after:synchronized",this.onAfterBreadcrumbsSynchronized)},"onAfterBreadcrumbsSynchronized":function(){this.ui.breadcrumb.hasClass("cs-breadcrumb")&&(this.ui.breadcrumb.show(),this.ui.breadcrumbContent.show(),this.ui.searchHeaderContent.hide(),this.ui.selectViews.removeClass("csui-full-height"),1===this.breadcrumbs.collection.length&&(this.options.targetBrowseHistory=[]),this.windowRefresh())},"setSearchResultsHeader":function(e){return this.searchHeaderView=new f({"collection":this.collection}),!0},"updateSearchResultHeader":function(){this.options.searchView&&(this.options.container?this.ui.searchHeaderContent.removeClass("csui-non-container-padding"):this.ui.searchHeaderContent.addClass("csui-non-container-padding"),this.ui.breadcrumbContent.hide(),this.ui.searchHeaderContent.show(),this.searchHeaderView._assignTotalItemElem(this.collection))}});return t.extend(g.prototype,m),g}),csui.define("csui/dialogs/node.picker/start.locations/start.location.collection",["require","module","csui/lib/underscore","csui/lib/jquery","csui/lib/backbone"],function(e,i,t,s,n){"use strict";function o(e){return e.lastIndexOf("/")>=0?e:"csui/dialogs/node.picker/start.locations/"+e}function l(e){return!t.contains(c.blacklist,e)&&(!c.whitelist.length||t.contains(c.whitelist,e))}var r=i.config(),a=r.startLocations||[],c=r.masks||{};t.isArray(a)||(a=Array.prototype.concat.apply([],t.values(a))),c=t.reduce(t.values(c),function(e,i){return{"blacklist":e.blacklist.concat(i.blacklist||[]),"whitelist":e.whitelist.concat(i.whitelist||[])}},{"blacklist":[],"whitelist":[]}),c={"blacklist":t.unique(c.blacklist),"whitelist":t.unique(c.whitelist)},a=t.chain(a).map(o).filter(l).unique().value();var u=n.Model.extend({"defaults":{"id":null,"name":null,"icon":null,"invalid":!1,"factory":null,"unselectable":!0},"constructor":function(e,i){n.Model.prototype.constructor.apply(this,arguments)},"sync":function(e,i,t){if("read"!==e)throw new Error("Only fetching the widget is supported.");var n=this;return t||(t={}),this._resolveFactory(t).then(function(){return n.get("factory").updateLocationModel(n)}).then(function(){var e=n.toJSON();t.success&&t.success(e,t),n.trigger("sync",n,e,t)},function(){var e=n.get("error")
;return t.error&&t.error(e,t),n.trigger("error",n,e,t),s.Deferred().reject(e)})},"_resolveFactory":function(i){var t=this,n=s.Deferred(),o=this.getFactoryData(),l=this.getFactoryModulePath(o);return e([l],function(e){t.set("factory",new e(i)),n.resolve()},function(e){t.set("error",e),i.ignoreErrors?n.resolve():n.reject(e)}),n.promise()},"getFactoryData":function(){var e,i=this.get("id"),t=i.lastIndexOf("/");return t<0?e="csui/dialogs/node.picker/start.locations/"+i:(e=i,i=i.substring(t+1)),{"name":i,"path":e}},"getFactoryModulePath":function(e){return e.path+"/"+e.name+".factory"}});return n.Collection.extend({"model":u,"constructor":function(e){e||(e={});var i=e.startLocations;i=i?t.chain(i).concat(["search.location","default.location"]).map(o).filter(l).unique().value():a;var s=t.map(i,function(e){return{"id":e}});n.Collection.prototype.constructor.call(this,s,e)},"sync":function(e,i,t){if("read"!==e)throw new Error("Only fetching the start locations is supported.");var s=this;return t||(t={}),this._resolveFactories(t).then(function(){if(!1!==t.removeInvalid){var e=s.where({"invalid":!0});s.remove(e)}var i=s.toJSON();t.success&&t.success(i,t),s.trigger("sync",s,i,t)})},"_resolveFactories":function(e){var i=this.filter(function(e){return e.has("id")&&!(e.has("factory")||e.has("error"))}),n=t.defaults({"ignoreErrors":!0},t.omit(e,"success","error")),o=t.invoke(i,"fetch",n);return s.when.apply(s,o)}})}),csui.define("hbs!csui/dialogs/node.picker/impl/header/apply.properties.selector/impl/apply.properties.selector",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"1":function(e,i,t,s){return'    <li role="presentation" data-optionid="'+this.escapeExpression(this.lambda(null!=e?e.id:e,e))+'">\r\n      <a role="menuitem" tabindex="-1" href="#">\r\n        <span class="cs-label">'+this.escapeExpression(this.lambda(null!=e?e.name:e,e))+"</span>\r\n      </a>\r\n    </li>\r\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){var n,o;return'<button id="'+this.escapeExpression((o=null!=(o=i.id||(null!=e?e.id:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"id","hash":{}}):o))+'" class="binf-btn binf-btn-default binf-dropdown-toggle csui-acc-focusable" data-binf-toggle="dropdown"\r\n        aria-haspopup="true" aria-expanded="false" aria-label="'+this.escapeExpression((o=null!=(o=i.applyPropertiesAria||(null!=e?e.applyPropertiesAria:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"applyPropertiesAria","hash":{}}):o))+'">\r\n  <span class="cs-label">'+this.escapeExpression((o=null!=(o=i.name||(null!=e?e.name:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"name","hash":{}}):o))+'</span>\r\n  <span class="cs-icon icon-caret-down"></span>\r\n</button>\r\n<ul class="binf-dropdown-menu" role="menu" aria-labelledby="'+this.escapeExpression((o=null!=(o=i.id||(null!=e?e.id:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"id","hash":{}}):o))+'">\r\n'+(null!=(n=i.each.call(e,null!=e?e.applyPropertiesOptions:e,{"name":"each","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?n:"")+'  <li class="binf-divider"></li>\r\n  <li role="presentation" class="open-selected-properties">\r\n    <a role="menuitem"  tabindex="-1" href="#">\r\n      <span class="cs-icon"></span>\r\n      <span class="cs-label">'+this.escapeExpression((o=null!=(o=i.openSelectedProperties||(null!=e?e.openSelectedProperties:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"openSelectedProperties","hash":{}}):o))+"</span>\r\n    </a>\r\n  </li>\r\n</ul>\r\n"}});return t.registerPartial("csui_dialogs_node.picker_impl_header_apply.properties.selector_impl_apply.properties.selector",s),s}),csui.define("csui/dialogs/node.picker/impl/header/apply.properties.selector/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/dialogs/node.picker/impl/header/apply.properties.selector/impl/nls/root/lang",{"ApplyPropertiesAria":"Select properties handling","KeepOriginalProperties":"Keep original properties","ApplyDestinationProperties":"Apply destination properties","CombineAllProperties":"Combine all properties","OpenSelectedProperties":"Open selected properties"}),csui.define("css!csui/dialogs/node.picker/impl/header/apply.properties.selector/impl/apply.properties.selector",[],function(){}),csui.define("csui/dialogs/node.picker/impl/header/apply.properties.selector/apply.properties.selector.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/behaviors/keyboard.navigation/tabable.region.behavior","hbs!csui/dialogs/node.picker/impl/header/apply.properties.selector/impl/apply.properties.selector","i18n!csui/dialogs/node.picker/impl/header/apply.properties.selector/impl/nls/lang","css!csui/dialogs/node.picker/impl/header/apply.properties.selector/impl/apply.properties.selector","csui/lib/binf/js/binf"],function(e,i,t,s,n,o,l){"use strict";var r=s.ItemView.extend({"_applyOptions":void 0,"selected":void 0,"openSelectedProperties":!1,"className":"cs-apply-properties-selector binf-dropdown","template":o,"behaviors":{"TabableRegion":{"behaviorClass":n}},"ui":{"toggle":">.binf-dropdown-toggle","selectedLabel":">.binf-dropdown-toggle >.cs-label","iconOpenSelectedProperties":"li.open-selected-properties > a > span.cs-icon"},"events":{"click li[data-optionid]":"onClickPropertiesOption","click li.open-selected-properties":"onClickOpenSelectedProperties","keydown":"onKeyInView","keyup":"onKeyUpInView"},"constructor":function i(t){t||(t={}),e.defaults(t,{"startSelection":i.KEEP_ORIGINAL_PROPERTIES}),s.ItemView.prototype.constructor.apply(this,arguments)},"onKeyInView":function(e){if(27===e.keyCode&&this.$el.hasClass("binf-open"))return this.$el.removeClass("binf-open"),this.$('*[tabindex = "0"]').focus(),this.isKeydownClosedDropDown=!0,!1;27!==e.keyCode||this.$el.hasClass("binf-open")||(this.isKeydownClosedDropDown=!1)},"onKeyUpInView":function(e){return!this.isKeydownClosedDropDown&&27===e.keyCode||27!==e.keyCode&&void 0},"onClickPropertiesOption":function(e){e.preventDefault(),e.stopPropagation(),this._setSelected(parseInt(i(e.currentTarget).attr("data-optionid"))),this._showSelected(),this.ui.toggle.click(),this.trigger("property:click:event"),this.$el.find("button.binf-dropdown-toggle").focus()},"onClickOpenSelectedProperties":function(e){e.preventDefault(),e.stopPropagation(),this.openSelectedProperties=!this.openSelectedProperties,this._showOpenSelectedProperties(),this.ui.toggle.click(),this.$el.find("button.binf-dropdown-toggle").focus()},"initialize":function(){this._setupApplyOptions(),-1!==e.indexOf(e.pluck(this._applyOptions,"id"),this.options.selected)?this._setSelected(this.options.selected):this._setSelected(r.KEEP_ORIGINAL_PROPERTIES),this.listenTo(t,"closeToggleAction",this._closeToggle)},"templateHelpers":function(){return{"id":e.uniqueId("optionsDropdown"),"applyPropertiesOptions":this._applyOptions,"applyPropertiesAria":l.ApplyPropertiesAria,"openSelectedProperties":l.OpenSelectedProperties}},"currentlyFocusedElement":function(){return this.$el.find("button")},"accDeactivateTabableRegion":function(){this._closeToggle()},"onRender":function(){this.ui.toggle.binf_dropdown(),this._showSelected(),this._showOpenSelectedProperties()},"_getOptionName":function(i){var t;return t=e.indexOf(e.pluck(this._applyOptions,"id"),i),-1===t?"":this._applyOptions[t].name},"_setupApplyOptions":function(){this._applyOptions=[{"id":r.KEEP_ORIGINAL_PROPERTIES,"name":l.KeepOriginalProperties},{"id":r.APPLY_DESTINATION_PROPERTIES,"name":l.ApplyDestinationProperties}],!0===this.options.includeCombineProperties&&this._applyOptions.push({"id":r.COMBINE_ALL_PROPERTIES,"name":l.CombineAllProperties})},"_setSelected":function(e){this.selected=e},"_showSelected":function(){this.ui.selectedLabel.text(this._getOptionName(this.selected)),this.$el.find("li[data-optionid]").removeClass("binf-active"),this.$el.find("li[data-optionid="+this.selected+"]").addClass("binf-active")},"_showOpenSelectedProperties":function(){!0===this.openSelectedProperties?(this.ui.toggle.attr("aria-expanded","true"),this.ui.iconOpenSelectedProperties.removeClass("icon-checkbox").addClass("icon-checkbox-selected")):(this.ui.toggle.attr("aria-expanded","false"),this.ui.iconOpenSelectedProperties.removeClass("icon-checkbox-selected").addClass("icon-checkbox"))},"_closeToggle":function(){this.ui.toggle.parent&&this.ui.toggle.parent().hasClass("binf-open")&&this.ui.toggle.binf_dropdown("toggle")}});return r.KEEP_ORIGINAL_PROPERTIES=1,r.APPLY_DESTINATION_PROPERTIES=2,r.COMBINE_ALL_PROPERTIES=3,r}),csui.define("csui/dialogs/node.picker/impl/search.list/search.query.model",["module","csui/lib/underscore","csui/lib/backbone"],function(e,i,t){var s=t.Model.extend({"constructor":function e(i,t){e.__super__.constructor.apply(this,arguments)},"toJSON":function(){return s.__super__.toJSON.apply(this,arguments)}});return s}),csui.define("csui/dialogs/node.picker/impl/header/search.box/impl/search.box.model",["module","csui/lib/underscore","csui/lib/backbone"],function(e,i,t){var s=t.Model.extend({"constructor":function e(i,t){e.__super__.constructor.apply(this,arguments)},"toJSON":function(){return s.__super__.toJSON.apply(this,arguments)}});return s}),csui.define("csui/dialogs/node.picker/impl/header/search.box/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/dialogs/node.picker/impl/header/search.box/impl/nls/root/lang",{"placeholder":"Search","clearerTitle":"Clear keywords","searchBoxTitle":"Enter your search term","searchOptionsTitle":"Show search options","searchFromHere":"Search from here","searchFromHereAria":"Select: search from here","searchIconTitle":"Search","searchIconAria":"Open searchbar","searchOptionsSelect":"Select: ","startSearch":"Start search"}),csui.define("hbs!csui/dialogs/node.picker/impl/header/search.box/impl/search.box",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){var n;return'<div class="search-bar">\r\n  <div class="search-bar-content">\r\n    <div class="csui-search-input-container">\r\n      <input type="search" class="csui-input csui-acc-focusable"\r\n             placeholder="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.placeholder:n,e))+'" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.searchBoxTitle:n,e))+'" tabindex="0"\r\n             data-cstabindex="-1" aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.searchBoxTitle:n,e))+'">\r\n      <div class="csui-search-options-dropdown"></div>\r\n    </div>\r\n    <span class="csui-clearer formfield_clear csui-acc-focusable" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.clearerTitle:n,e))+'"\r\n          aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.clearerTitle:n,e))+'" role="button" tabindex="0" data-cstabindex="-1"></span>\r\n  </div>\r\n</div><a href="javascript:void(0);"\r\n         class="icon icon-global-search csui-header-search-icon csui-acc-focusable"\r\n         title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.searchIconTitle:n,e))+'" aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.searchIconAria:n,e))+'"\r\n         tabindex="0" data-cstabindex="-1" role="button" aria-haspopup="true" aria-expanded="false"></a>\r\n'}});return t.registerPartial("csui_dialogs_node.picker_impl_header_search.box_impl_search.box",s),s}),csui.define("hbs!csui/dialogs/node.picker/impl/header/search.box/impl/search.slice.dropdown",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){return'<div class="csui-selected-checkbox csui-slice-checkbox csui-checkbox-primary" tabindex="0"\r\n     data-cstabindex="-1" aria-label="'+this.escapeExpression(this.lambda(null!=e?e.searchFromHereAria:e,e))+'">\r\n  <input type="checkbox" class="csui-searchbox-option" name="'+this.escapeExpression(this.lambda(null!=e?e.nodeId:e,e))+'" id="'+this.escapeExpression(this.lambda(null!=e?e.nodeIdSO:e,e))+'"\r\n         value="'+this.escapeExpression(this.lambda(null!=e?e.nodeId:e,e))+'">\r\n  <label class="csui-search-slice-name csui-selectlabel" for="'+this.escapeExpression(this.lambda(null!=e?e.nodeIdSO:e,e))+'"\r\n         title="'+this.escapeExpression(this.lambda(null!=e?e.select:e,e))+this.escapeExpression(this.lambda(null!=e?e.fromHere:e,e))+'">\r\n    <span class="cs-ellipsis">'+this.escapeExpression(this.lambda(null!=e?e.fromHere:e,e))+"</span>\r\n  </label>\r\n</div>\r\n"}});return t.registerPartial("csui_dialogs_node.picker_impl_header_search.box_impl_search.slice.dropdown",s),s}),csui.define("css!csui/dialogs/node.picker/impl/header/search.box/impl/search.box",[],function(){}),csui.define("csui/dialogs/node.picker/impl/header/search.box/search.box.view",["module","csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/dialogs/node.picker/impl/search.list/search.query.model","csui/dialogs/node.picker/impl/header/search.box/impl/search.box.model","csui/behaviors/keyboard.navigation/tabable.region.behavior","i18n!csui/dialogs/node.picker/impl/header/search.box/impl/nls/lang","hbs!csui/dialogs/node.picker/impl/header/search.box/impl/search.box","hbs!csui/dialogs/node.picker/impl/header/search.box/impl/search.slice.dropdown","i18n","css!csui/dialogs/node.picker/impl/header/search.box/impl/search.box","csui/lib/jquery.ui/js/jquery-ui"],function(e,i,t,s,n,o,l,r,a,c,u){"use strict";var d=i.defaults({},e.config(),{"showInput":!1,"inputValue":"","nodeName":"","searchFromHere":!0});return s.ItemView.extend({"className":"csui-search-box","template":a,"templateHelpers":function(){return{"messages":{"placeholder":r.placeholder,"clearerTitle":r.clearerTitle,"searchIconTitle":r.searchIconTitle,"searchBoxTitle":r.searchBoxTitle,"searchOptionsTitle":r.searchOptionsTitle,"searchOptionsSelect":r.searchOptionsSelect,"startSearch":r.startSearch,"searchIconAria":r.searchIconAria}}},"sliceDropDownTemplate":c,"ui":{"input":".csui-input","clearer":".csui-clearer","searchIcon":".csui-header-search-icon"},"events":{"click .csui-header-search-icon":"searchIconClicked","focusin @ui.input":"hideStartLocations","click @ui.input":"hidePopover","keyup @ui.input":"inputTyped","paste @ui.input":"inputChanged","keydown @ui.clearer":"clearerClicked","change @ui.input":"inputChanged","click @ui.clearer":"clearerClicked","click .csui-searchbox-option":"selectSearchOption","keydown .csui-slice-checkbox":"changeSearchOption","focusout @ui.input":"hideSearchOptionsDropDown","focusout .csui-search-options-dropdown":"hideSearchOptionsDropDown","mouseleave .csui-search-options-dropdown":"hideSearchOptionsDropDown"},"behaviors":{"TabableRegion":{"behaviorClass":l}},"constructor":function(e){e||(e={}),e.data=i.defaults({},e.data,d),this.direction=u.settings.rtl?"left":"right",s.ItemView.prototype.constructor.apply(this,arguments),this.model=new n(void 0,e),this.searchboxModel=new o(void 0,e),this.listenTo(this.searchboxModel,"change",this.prepareTargetBrowsedropdown),this.listenTo(this.searchboxModel,"change",this.searchIconToggle),this.listenTo(this.searchboxModel,"change",this.hideSearchBar),this.model.get("where")&&t(document).bind("click."+this.cid+" keydown."+this.cid,this,this._hideSearchBar)},"isSearchbarVisible":function(){return this.$(".search-bar").is(":visible")},"onRender":function(){var e=this.options.data.inputValue||this.model.get("where");e&&(this._setInputValue(e),this.$el.find(".search-bar").show()),(this.options.data.showInput||e)&&(this.triggerMethod("before:show:input",this),this.ui.input.show(),this.triggerMethod("show:input",this)),this.ui.searchIcon.removeClass("icon-header-search_enabled").addClass("icon-header-search");var i=this;this.$el.find("*[data-cstabindex]").on("focus",function(){i._updateFocusables(this)})},"_updateFocusables":function(e){var i=t(e);this.focusedElement&&this.focusedElement.removeClass(l.accessibilityActiveElementClass),i.addClass(l.accessibilityActiveElementClass),this.focusedElement=i},"currentlyFocusedElement":function(e){if(this.$el){var i=this.$el.find("*[data-cstabindex=-1]");i.length&&i.prop("tabindex",0);!(!!e&&e.shiftKey)&&this.$el.find(".search-bar").length&&this.$el.find(".search-bar").is(":visible")?this.focusElement=this.$el.find(".csui-input"):this.$el.find("a.csui-acc-focusable").length&&(this.focusElement=this.$el.find("a.csui-acc-focusable"))}return this.focusElement},"onLastTabElement":function(e){var i=this.$("[data-cstabindex=-1]"),s=i.length-1,n=this;if(this.$el.find("*[data-cstabindex]").on("focus",function(){n._updateFocusables(this)}),i.length){var o=e?i[0]:i[s];return this.$(".csui-focus").removeClass("csui-focus"),t(o).hasClass(l.accessibilityActiveElementClass)}return!0},"resetPageDefaults":function(e){this.model.resetDefaults=!0},"searchIconClicked":function(e){if(t(document).bind("click."+this.cid+" keydown."+this.cid,this,this._hideSearchBar),this.ui.input.toggleClass(l.accessibilityFocusableClass),this.resetPageDefaults(e),this.searchboxModel.nodeId&&this.$el.find(".csui-searchbox-option").length>0&&(this.$el.find(".csui-searchbox-option")[0].checked=this.options.data.searchFromHere),this.$el.find(".search-bar").is(":visible")){this.$el.find("a.icon-global-search").attr("aria-expanded","true");var i=this.ui.input.val().trim();i&&(this._setInputValue(i),t(e.currentTarget).attr("title",r.startSearch).attr("aria-label",r.startSearch));var s="",n=this.$el.find(".csui-searchbox-option:checked");if(n&&(s=n.val()),history.state&&history.state.search&&(this.previousState=history.state.search),i){this.model.clear({"silent":!0});var o={};o.location_id1=s,i&&(o.where=i),this.model.set(o),this.trigger("change:searchterm",this.model),this._updateInput(e)}this.previousState&&(this.model.prevSearchState=this.previousState)}else if(this.$el&&this.$el.parents()){var a=this.$el.parents(".target-browse ").find("div[class='load-container']");if(a&&!a.hasClass("binf-hidden")){this.$el.find("a.icon-global-search").attr("aria-expanded","true");var c=this;this.hideStartLocations(),this.$el.find(".search-bar").show("blind",{"direction":this.direction},"200",function(){c.ui.input.focus()}),""===this.model.attributes.where&&(t(e.currentTarget).title="",t(e.currentTarget).addClass("icon-header-search-nohover"))}}},"showStartLocations":function(e){this.trigger("show:startLocation")},"hideStartLocations":function(e){this.trigger("hide:startLocation")},"inputTyped":function(e){var i=this.ui.input.val().trim();13===e.which?(e.preventDefault(),e.stopPropagation(),this._setInputValue(i),i&&this.searchIconClicked(e),this.previousValue!=i&&(this.previousValue=i)):27==e.keyCode?this.ui.searchIcon.is(":focus")?(e.preventDefault(),e.stopImmediatePropagation()):(this.hideSearchBar(),this.ui.searchIcon.focus(),e&&e.stopPropagation()):40===e.which&&t(".csui-search-options-dropdown").is(":visible")?this.$el.find(".csui-selected-checkbox").focus().focus():this.inputChanged(e)},"inputChanged":function(e){var i=this.ui.input.val();this.searchIconToggle(),this.ui.clearer.toggle(!!i.length),this.showOptionsDropdown(e)},"showOptionsDropdown":function(e){var i=e||window.event;this.searchboxModel.nodeId&&27!==i.which&&(this.$el.find(".csui-search-options-dropdown").show(),this.$el.find(".csui-searchbox-option").length>0&&(this.$el.find(".csui-searchbox-option")[0].checked=this.options.data.searchFromHere))},"prepareTargetBrowsedropdown":function(e){if(this.searchboxModel.nodeId){this.searchOptions={},this.searchOptions.nodeId=this.searchboxModel.nodeId,this.searchOptions.nodeIdSO=i.uniqueId("csui-so-"+this.searchboxModel.nodeId),this.searchOptions.select=r.searchOptionsSelect,this.searchOptions.fromHere=r.searchFromHere,this.searchOptions.selectFromHereAria=r.searchFromHereAria;var t=this.sliceDropDownTemplate(this.searchOptions);this.$el.find(".csui-search-options-dropdown").html(t),this.hideSearchOptionsDropDown(),this.ui.searchIcon.show(),this.ui.searchIcon.removeClass("icon-header-search_enabled").addClass("icon-header-search")}else this.destroyOptionspopover()},"destroyOptionspopover":function(e){this.$el.find(".csui-search-options-dropdown").html(""),this.$el.find(".csui-search-options-dropdown").hide()},"changeSearchOption":function(e){if(13===e.keyCode||32===e.keyCode){this.$el.find(".csui-searchbox-option:checked").length>0?this.$el.find(".csui-searchbox-option")[0].checked=!1:this.$el.find(".csui-searchbox-option")[0].checked=!0,this.selectSearchOption(e)}},"selectSearchOption":function(e){this.$el.find(".csui-searchbox-option:checked").length>0?this.options.data.searchFromHere=!0:this.options.data.searchFromHere=!1},"hideSearchOptionsDropDown":function(){var e=this;e.$el.find(".csui-searchbox-option").attr("tabindex",-1),setTimeout(function(){if(e.$el.find(".csui-selected-checkbox")[0]===document.activeElement)return!1;var i=e;return e.popoverTimer&&clearTimeout(e.popoverTimer),e.popoverTimer=setTimeout(function(){i.showSearchOptionDropDown()},800),!0},100)},"showSearchOptionDropDown":function(){this.$el.find(".csui-search-options-dropdown").is(":hover")?this.popoverTimer&&clearTimeout(this.popoverTimer):t(".csui-search-options-dropdown").hide()},"clearerClicked":function(e){"click"!==e.type&&13!==e.keyCode||(e.preventDefault(),e.stopPropagation(),this._setInputValue(""),this.ui.searchIcon.removeClass("icon-header-search_enabled").addClass("icon-header-search"),this.hidePopover(e),this.ui.input.focus())},"setSlices":function(e){e.preventDefault(),e.stopPropagation();var i=t(e.target).data("sliceid"),s=this.$el.find(".csui-search-popover-checked"),n=this.$el.find(".icon-listview-checkmark"),o=n.length>0&&n.attr("id")===t(e.target).data("sliceid")+"";this.options.sliceString="",t(s).removeClass("icon-listview-checkmark"),o||(t("#"+i).addClass("icon-listview-checkmark"),this.options.sliceString="{"+i+"}"),this.slice=this.options.sliceString},"hidePopover":function(e){"block"===t(".csui-search-box-slice-popover").css("display")&&t(".csui-search-box-slice-popover").binf_popover("hide"),this.showOptionsDropdown(e)},"hideSearchBar":function(e){var i=this.$el.find(".search-bar"),t=this;this.ui.input.val(""),i.hide("blind",{"direction":this.direction},"200",function(){t.showStartLocations()}),this.$el.find(".csui-header-search-icon").removeClass("icon-header-search_enabled").addClass("icon-header-search")},"_hideSearchBar":function(e){var i=e||window.event,s=t(".search-bar"),n=e.data;s.is(":visible")&&(("keydown"!==i.type||27!==i.keyCode&&27!==i.which)&&(t(i.target).closest(s).length||"click"!==i.type||t(i.target).closest(".csui-header-search-icon").length||t(i.target).closest(".esoc-activityfeed-invisiblebutton").length)||(t(this).find(".icon-header-search-nohover").removeClass("icon-header-search-nohover"),t(this).find(".csui-input").val(""),n.$el.find(s).hide("blind",{"direction":e.data.direction},"200",function(){n.showStartLocations(),n.focusedElement=void 0,n.currentlyFocusedElement().focus()}),t(this).find(".csui-search-box-slice-popover").binf_popover("hide"),t(this).find(".csui-search-box .csui-header-search-icon").attr("title",r.searchIconTitle),t(this).find(".csui-search-box .csui-header-search-icon").attr("aria-label",r.searchIconAria),t(this).find(".csui-search-box .csui-header-search-icon").attr("aria-expanded","false"),e.data.slice=e.data.model.get("slice"),e.data.options.data.searchFromHere=!0,this.$el&&this.$el.parents(".csui-navbar").find(".binf-navbar-brand").addClass("binf-navbar-collapse"),t(this).find(".csui-search-options-dropdown").hide(),t(this).find(".csui-search-box .csui-header-search-icon").removeClass("icon-header-search_enabled").addClass("icon-header-search"),t(document).unbind("click."+this.cid+" keydown."+this.cid)))},"_updateInput":function(e){if(this._isRendered){var i=this.model.get("where")||"";this._setInputValue(i)}},"_setInputValue":function(e){this.ui.input.val(e),this.ui.clearer.toggle(!!e.length),this.searchIconToggle()},"searchIconToggle":function(){this.ui.input.val().trim()?(this.ui.searchIcon.removeClass("icon-header-search").addClass("icon-header-search_enabled"),this.ui.input.addClass("csui-input-focus"),t(this.ui.searchIcon).attr("title",r.startSearch).attr("aria-label",r.startSearch),t(this.ui.searchIcon).removeClass("icon-header-search-nohover")):(this.ui.searchIcon.removeClass("icon-header-search_enabled").addClass("icon-header-search"),this.ui.input.removeClass("csui-input-focus"),this.$el.find(".search-bar").is(":visible")&&(t(this.ui.searchIcon).addClass("icon-header-search-nohover"),t(this.ui.searchIcon).attr("title",r.searchBoxTitle).attr("aria-label",r.searchBoxTitle)))}})}),csui.define("hbs!csui/dialogs/node.picker/impl/header/header",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"1":function(e,i,t,s){var n,o;return'  <h2 id="nodePickerHeader" class="csui-title">'+(null!=(o=null!=(o=i.title||(null!=e?e.title:e))?o:i.helperMissing,n="function"==typeof o?o.call(e,{"name":"title","hash":{}}):o)?n:"")+"</h2>\r\n  <div class='csui-filtername-container'>\r\n    <span class=\"cs-icon-required category_required\" title=\"\"></span>\r\n    <input type='text' class='csui-filtername' placeholder=\""+this.escapeExpression((o=null!=(o=i.placeHolderName||(null!=e?e.placeHolderName:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"placeHolderName","hash":{}}):o))+'" tabindex="-1"\r\n           data-cstabindex="-1" />\r\n    <span class="csui-filtername-error binf-hidden" title=""></span>\r\n  </div>\r\n'},"3":function(e,i,t,s){var n;return'  <h2 id="nodePickerHeader" class="csui-title">'+this.escapeExpression((n=null!=(n=i.title||(null!=e?e.title:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"title","hash":{}}):n))+'</h2><span class="csui-separator"></span>\r\n'},"5":function(e,i,t,s){return"csui-no-search"},"7":function(e,i,t,s){return'    <div class="csui-start-locations binf-dropdown" ></div>\r\n'},"9":function(e,i,t,s){var n;return'      <div class="csui-global-search '+(null!=(n=i.if.call(e,null!=e?e.saveFilter:e,{"name":"if","hash":{},"fn":this.program(10,s,0),"inverse":this.noop}))?n:"")+(null!=(n=i.if.call(e,null!=e?e.propertiesSeletor:e,{"name":"if","hash":{},"fn":this.program(12,s,0),"inverse":this.program(14,s,0)}))?n:"")+'"></div>\r\n'},"10":function(e,i,t,s){return"csui-save-filter "},"12":function(e,i,t,s){return""},"14":function(e,i,t,s){return"csui-no-properties-selector for-shortcut"},"16":function(e,i,t,s){return'      <div class="apply-properties-selector"></div>\r\n'},"18":function(e,i,t,s){return"csui-no-properties-selector"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){var n;return(null!=(n=i.if.call(e,null!=e?e.saveFilter:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.program(3,s,0)}))?n:"")+'\r\n<div class="csui-target-controls '+(null!=(n=(i.xif||e&&e.xif||i.helperMissing).call(e,"this.globalSearch !== false",{"name":"xif","hash":{},"fn":this.program(5,s,0),"inverse":this.noop}))?n:"")+'">\r\n'+(null!=(n=i.if.call(e,null!=e?e.locationSelector:e,{"name":"if","hash":{},"fn":this.program(7,s,0),"inverse":this.noop}))?n:"")+'\r\n  <div class="csui-target-search-property-container">\r\n'+(null!=(n=(i.xif||e&&e.xif||i.helperMissing).call(e,"this.globalSearch !== false",{"name":"xif","hash":{},"fn":this.program(9,s,0),"inverse":this.noop}))?n:"")+"\r\n"+(null!=(n=i.if.call(e,null!=e?e.propertiesSeletor:e,{"name":"if","hash":{},"fn":this.program(16,s,0),"inverse":this.noop}))?n:"")+'    <span class="csui-separator '+(null!=(n=i.if.call(e,null!=e?e.propertiesSeletor:e,{"name":"if","hash":{},"fn":this.program(12,s,0),"inverse":this.program(18,s,0)}))?n:"")+'"></span>\r\n  </div>\r\n</div>\r\n'}});return t.registerPartial("csui_dialogs_node.picker_impl_header_header",s),s}),csui.define("css!csui/dialogs/node.picker/impl/header/header",[],function(){}),csui.define("csui/dialogs/node.picker/impl/header/header.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/dialogs/node.picker/impl/header/apply.properties.selector/apply.properties.selector.view","csui/dialogs/node.picker/impl/header/start.location.selector/start.location.selector.view","csui/dialogs/node.picker/impl/header/search.box/search.box.view","csui/behaviors/keyboard.navigation/tabable.region.behavior","hbs!csui/dialogs/node.picker/impl/header/header","i18n!csui/dialogs/node.picker/impl/nls/lang","csui/lib/handlebars.helpers.xif","css!csui/dialogs/node.picker/impl/header/header"],function(e,i,t,s,n,o,l,r,a){return t.LayoutView.extend({"template":r,"className":"cs-header-control","regions":{"startLocations":".csui-start-locations","globalSearch":".csui-global-search","properties":".apply-properties-selector"},"ui":{"saveFilter":".csui-filtername","saveFilterError":".csui-filtername-error","startlocations":".csui-start-locations"},"events":{"keyup @ui.saveFilter":"onChangeFilterName","keydown @ui.startlocations":"onStartLoaction","focusout @ui.saveFilter":"onFocusoutFilterName"},"templateHelpers":function(){var e=this.options;return{"title":e.title,"locationSelector":e.locationSelector,"propertiesSeletor":e.propertiesSeletor,"saveFilter":e.saveFilter,"placeHolderName":a.placeHolderName,"globalSearch":e.globalSearch,"backButtonTooltip":a.backButtonTooltip}},"behaviors":{"TabableRegion":{"behaviorClass":l}},"initialize":function(){var e=this.options,i=s.KEEP_ORIGINAL_PROPERTIES;if(e.propertiesSeletor&&(this.propertiesView=new s({"selected":i,"includeCombineProperties":this.options.includeCombineProperties})),e.locationSelector&&(this.startLocationView=new n({"collection":this.options.locations,"title":this.options.dialogTitle,"selected":this.options.initialLocation})),!1!==e.globalSearch){var t,l;if(this.options.initialLocation){var r=this.options.initialLocation.get("factory");t=r&&r.options.container?r.options.container.get("id"):null,l=r&&r.options.container?r.options.container.get("name"):null}this.searchBoxView=new o({"targetBrowseSearch":!0,"locationID":t,"locationName":l}),this.searchboxModel=this.searchBoxView.searchboxModel,this.searchQueryModel=this.searchBoxView.model}},"onRender":function(){this.options;this.startLocationView&&this.startLocations.show(this.startLocationView),this.propertiesView&&this.properties.show(this.propertiesView),this.searchBoxView&&this.globalSearch.show(this.searchBoxView),this.searchBoxView.on("show:startLocation",this.showStartLocations,this),this.searchBoxView.on("hide:startLocation",this.hideStartLocations,this),this.searchBoxView.on("close:dialog",this.onApplyProperties,this);var e=this;this.$el.find("*[data-cstabindex]").on("focus",function(){var t=i(this);e.focusedElement&&e.focusedElement.removeClass(l.accessibilityActiveElementClass),t.addClass(l.accessibilityActiveElementClass),e.focusedElement=t})},"currentlyFocusedElement":function(e){if(this.$el){var t=this.$("*[tabindex]");t.length&&t.prop("tabindex",0);return!(!!e&&e.shiftKey)&&this.$el.find(".csui-filtername").length?this.$el.find(".csui-filtername"):!!t[0]&&i(t[0]).focus()}},"onLastTabElement":function(e,i){return e&&i.target===this.$("*[tabindex]")[0]},"onStartLoaction":function(e){27===e.keyCode&&(this.ui.startlocations.is(":focus")||e.stopImmediatePropagation())},"onApplyProperties":function(){this.trigger("parent:destroydialog")},"showStartLocations":function(){this.startLocationView.$el.removeClass("binf-hidden")},"hideStartLocations":function(){this.startLocationView.$el.addClass("binf-hidden")},"onDomRefresh":function(){this.startLocationView&&this.startLocationView.trigger("dom:refresh"),this.propertiesView&&this.propertiesView.trigger("dom:refresh"),this.searchBoxView&&this.searchBoxView.trigger("dom:refresh")},"hideStartLocationLabel":function(e){this.startLocationView.hideDropDownLabel(e)},"reset":function(){this.startLocationView.reset()},"onChangeFilterName":function(){this.trigger("change:filterName")
},"onFocusoutFilterName":function(){this.trigger("focusout:filterName")},"showErrorMessage":function(e){this.$(this.ui.saveFilterError).html(e),this.ui.saveFilterError.removeClass("binf-hidden")},"removeErrorMessage":function(){this.$(this.ui.saveFilterError).html(""),this.ui.saveFilterError.addClass("binf-hidden")}})}),csui.define("hbs!csui/dialogs/node.picker/impl/footer/footer",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){return'<div class="csui-selected-items"></div>\r\n<div class="csui-footer-buttons"></div>'}});return t.registerPartial("csui_dialogs_node.picker_impl_footer_footer",s),s}),csui.define("hbs!csui/dialogs/node.picker/impl/footer/selectedItems.info",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"1":function(e,i,t,s){var n;return this.escapeExpression((n=null!=(n=i.selectedItemsMessage||(null!=e?e.selectedItemsMessage:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"selectedItemsMessage","hash":{}}):n))},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){var n;return"<span>"+(null!=(n=i.if.call(e,null!=e?e.isMultiSelectEnabled:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?n:"")+"</span>\r\n"}});return t.registerPartial("csui_dialogs_node.picker_impl_footer_selectedItems.info",s),s}),csui.define("css!csui/dialogs/node.picker/impl/footer/footer",[],function(){}),csui.define("csui/dialogs/node.picker/impl/footer/footer.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/lib/backbone","csui/controls/mixins/layoutview.events.propagation/layoutview.events.propagation.mixin","csui/behaviors/keyboard.navigation/tabable.region.behavior","csui/controls/dialog/impl/footer.view","hbs!csui/dialogs/node.picker/impl/footer/footer","hbs!csui/dialogs/node.picker/impl/footer/selectedItems.info","i18n!csui/dialogs/node.picker/impl/nls/lang","csui/lib/handlebars.helpers.xif","css!csui/dialogs/node.picker/impl/footer/footer"],function(e,i,t,s,n,o,l,r,a,c){var u=t.ItemView.extend({"template":a,"className":"csui-selectedItems-message","templateHelpers":function(){var i=this.selectedItemsCnt||this.options.selectedItemsCnt,t="";return t=1===i?e.str.sformat(c.SelectOneItemMessage,i):e.str.sformat(c.SelectManyItemsMessage,i),{"isMultiSelectEnabled":this.options.isMultiSelectEnabled,"selectedItemsMessage":t}},"constructor":function(e){e||(e={}),t.ItemView.prototype.constructor.call(this,e)},"onRender":function(){this.selectedItemsCnt||this.options.selectedItemsCnt?this.$el.removeClass("binf-hidden"):this.$el.addClass("binf-hidden")}}),d=t.LayoutView.extend({"template":r,"className":"cs-footer-control","behaviors":{"TabablesBehavior":{"behaviorClass":o,"recursiveNavigation":!0,"containTabFocus":!0}},"regions":{"selectedItemsInfoRegion":".csui-selected-items","buttonsRegion":".csui-footer-buttons"},"isTabable":function(){return this.$("*[tabindex]").length>0},"constructor":function(e){t.LayoutView.prototype.constructor.apply(this,arguments),this.propagateEventsToRegions()},"initialize":function(){var i=this.options,t=i.buttons?i.buttons:[],n=this.footerView=new l({"collection":new s.Collection(t)});this.messageView=new u(e.extend({},{"selectedItemsCnt":0})),this.listenTo(n,"childview:click",this.onClickButton),this.listenTo(this,"selectedItems:updateCount",this.updateSelectedItems)},"onRender":function(){this.buttonsRegion.show(this.footerView)},"updateButton":function(e,i){this.footerView.updateButton(e,i)},"onClickButton":function(e){var i=e.model.attributes;i.click&&i.click({"dialog":this,"button":this.$el}),i.close&&this.destroy()},"updateSelectedItems":function(i){this.messageView=new u(e.extend({},{"selectedItemsCnt":i,"isMultiSelectEnabled":this.options.isMultiSelectEnabled})),this.selectedItemsInfoRegion.show(this.messageView)},"onBeforeDestroy":function(){this.footerView.destroy(),this.messageView.destroy()}});return e.extend(d.prototype,n),d}),csui.define("csui/dialogs/node.picker/impl/command.type",["module","csui/lib/underscore","i18n!csui/dialogs/node.picker/impl/nls/lang"],function(e,i,t){var s=e.config();i.defaults(s,{"addable_types":{"899":[899,480,146]}});var n=function(e){var s=e.initialContainer;switch(this.actionNodes=e.initialSelection?i.isArray(e.initialSelection)?e.initialSelection:e.initialSelection.models:[],this.unselectableNodes=e.unselectableNodes,this.invalidNodes=e.invalidNodes,this.selectableTypes=e.selectableTypes||[],this.unselectableTypes=e.unselectableTypes||[],this.showAllTypes=e.showAllTypes||!1,this.multiSelect=!!e.selectMultiple,this.action=e.command,this.parentId=null!=s?s.get("id"):-1,this.selectButtonLabel=e.selectButtonLabel||t.selectButtonLabel,this.action){case"copy":this.selectButtonLabel=e.selectButtonLabel||t.copyButtonLabel;break;case"move":this.selectButtonLabel=e.selectButtonLabel||t.moveButtonLabel;break;case"addCategories":this.selectableTypes=e.selectableTypes||[131],this.multiSelect=!0,this.actionNodes=[];break;case"savefilter":this.selectButtonLabel=e.selectButtonLabel||t.saveFilterButtonLabel,this.actionNodes=[];break;case"collect":this.selectableTypes=e.selectableTypes,this.multiSelect=!0,this.actionNodes=[];break;default:this.actionNodes=[]}};return i.extend(n.prototype,{"getSelectableNodeTypes":function(){return this.showAllTypes?[]:this.selectableTypes},"validateTarget":function(e){var t=e.data?e.data.id:e.get("id"),n=e.get("type"),o=s.addable_types[n],l=i.every(this.unselectableNodes,function(e){return t!==e});if(this.browseAllowed(e)&&(l=i.every(this.unselectableTypes,function(e){return n!==e})),o&&(l=i.every(this.actionNodes,function(e){return i.contains(o,e.get("type"))})),l)switch(this.action){case"copy":l=!this.isVirtualNode(e)&&this.validateNode(e);break;case"move":l=!this.isVirtualNode(e)&&this.validId(e),l&&(l=this.validateAddableTypes(e));break;case"savefilter":l=!this.isVirtualNode(e)}return l},"validId":function(e){return(e.data?e.data.id:e.get("id"))!==this.parentId},"validateAddableTypes":function(e){var t=e.addable_types;return!t||i.every(this.actionNodes,function(e){return i.some(t,function(i){return i.type===e.get("type")})})},"isSelectableType":function(e){var t=e.get("type"),s=i.every(this.unselectableTypes,function(e){return t!==e});return s&&!i.isEmpty(this.selectableTypes)&&!(s=-1!==i.indexOf(this.selectableTypes,t))&&this.browseAllowed(e)&&i.indexOf(this.selectableTypes,-1)>-1&&(s=!0),s},"isSelectable":function(e){var t=e.data?e.data.id:e.get("id"),n=e.get("type"),o=s.addable_types[n];if(e.get("unselectable"))return!1;var l=this.isSelectableType(e);if(l&&o&&(l=i.every(this.actionNodes,function(e){return i.contains(o,e.get("type"))})),l&&(l=i.every(this.unselectableNodes,function(e){return t!==e})),l&&(l=!this.isActionNode(e)),l)switch(this.action){case"copy":l=!this.isVirtualNode(e)&&this.validateNode(e);break;case"move":l=!this.isVirtualNode(e)&&this.validId(e);break;case"addCategories":l=!this.browseAllowed(e);break;case"savefilter":l=!this.isVirtualNode(e)}return l},"browseAllowed":function(e){var t=e.actions&&i.find(e.actions.models,function(e){return"open"===e.id});return e.get("container")&&(!1!==e.get("perm_see_contents")||t)},"validateNode":function(e){var i=this._hasValidId(e);return i&&!this.showAllTypes&&(this.browseAllowed(e)?"move"!==this.action&&"copy"!==this.action||!this.isActionNode(e)||(i=!1):this.selectableTypes.length>0&&-1===this.selectableTypes.indexOf(e.get("type"))&&(i=!1)),i},"isActionNode":function(e){var t=e.get("id"),s=e.get("parent_id");return i.any(this.actionNodes,function(e){var i=e.get("id"),n=i===t;return n||i===s})},"isVirtualNode":function(e){var i=e.get("type"),t=!1;return 899===i&&(t=!0),t},"_hasValidId":function(e){return i.every(this.invalidNodes,function(i){return i.get("id")!==e.get("id")})},"shouldResolveShortcut":function(e){return 1===e.get("type")&&"number"==typeof e.get("original_id")}}),n}),csui.define("css!csui/dialogs/node.picker/impl/node.picker",[],function(){}),csui.define("csui/dialogs/node.picker/node.picker",["module","csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/controls/dialog/dialog.view","csui/dialogs/node.picker/impl/node.picker.view","csui/utils/contexts/factories/connector","csui/utils/contexts/factories/node","csui/models/node/node.model","csui/dialogs/node.picker/start.locations/start.location.collection","csui/dialogs/node.picker/impl/header/header.view","csui/dialogs/node.picker/impl/footer/footer.view","csui/dialogs/node.picker/impl/command.type","i18n!csui/dialogs/node.picker/impl/nls/lang","csui/utils/log","csui/controls/progressblocker/blocker","css!csui/dialogs/node.picker/impl/node.picker"],function(e,i,t,s,n,o,l,r,a,c,u,d,h,p,m,f,g,b){"use strict";function v(e){if(e||(e={}),this.options=i.defaults(e,y,{"pageSize":30}),this.options.connector||(this.options.connector=this._getConnector(this.options)),!this.options.connector){var t="Node Picker: insufficient options";throw f.error(t)&&console.error(t),new Error(t)}this.options.targetBrowseHistory=[],this.options.navigateFromHistory=!1,this.options.initialContainer=this._getInitalContainer(this.options),this.options.unselectableNodes=this._getArrayOfNodeIds(e.unselectableNodes),this.options.commandType=new p(this.options)}var w=i.extend({"initialLocationLookupOrder":["csui/dialogs/node.picker/start.locations/recent.containers","csui/dialogs/node.picker/start.locations/current.location","csui/dialogs/node.picker/start.locations/favorites"]},e.config()),y={"initialSelection":[],"selectMultiple":!1,"unselectableNodes":[],"dialogTitle":m.dialogTitle,"orderBy":"name asc"};return i.extend(v.prototype,{"show":function(){return this._locations=new u(this.options),this._locations.fetch({"connector":this.options.connector,"container":this.options.initialContainer,"removeInvalid":!1}).always(i.bind(this._showDialog,this)),this._deferred=t.Deferred(),this._deferred.promise()},"_showDialog":function(){this.recentLocations=this._locations.get("csui/dialogs/node.picker/start.locations/recent.containers");var e=this._locations.where({"invalid":!0});this._locations.remove(e);var i=this._getInitialLocation();this.searchLocation=i,this._headerControl=this._createHeaderControl(i),this._view=this._createNodePickerView(i),this._footerView=this._createFooterViewControl(),this._dialog=this._createDialog(),this._dialog.show()},"_createHeaderControl":function(e){var i=this.options,t=null==i.locationSelector||i.locationSelector;this.options.previousLocation=e;var s=new d({"locations":this._locations,"title":i.dialogTitle,"initialLocation":e,"includeCombineProperties":i.includeCombineProperties,"propertiesSeletor":i.propertiesSeletor,"saveFilter":i.saveFilter,"locationSelector":t,"initialSelection":i.initialSelection,"globalSearch":i.globalSearch});return s.startLocationView.on("change:location",this.onChangeLocation,this),s.on("change:filterName",this.onChangeFilterName,this),s.on("focusout:filterName",this.onFocusOutFilterName,this),s.searchBoxView&&s.searchBoxView.on("change:searchterm",this.onChangeSearchTerm,this),s},"_createNodePickerView":function(e){this.options.searchView=!1;var t=e.get("factory"),s=t.getLocationParameters(this.options);i.defaults(s,this.options);var n=new l(s);return n.on("change:complete",this.onSelectionChange,this).on("changing:selection",this._blockDialog,this).on("back:toSearch",this.onClickBackFromFolderToSearch,this).on("change:location",this.onChangeLocationFromBack,this).on("backto:folder",this.onClickBackFromSearch,this).on("close",this.forceClosed,this),n.selectViews.on("drill:up",this.onDrillUp,this),n},"_createFooterViewControl":function(){var e=this.options;return new h({"isMultiSelectEnabled":this.options.commandType.multiSelect,"buttons":[{"id":"select","label":e.selectButtonLabel||e.commandType.selectButtonLabel,"default":!0,"disabled":!0,"click":i.bind(this.onClickSelectButton,this)},{"id":"cancel","label":m.cancelButtonLabel,"close":!0,"click":i.bind(this.onClickCancelButton,this)}]})},"_blockDialog":function(){return this._dialog.blockWithoutIndicator(),!0},"dialogClassName":function(){var e="target-browse";return this.options&&this.options.view&&this.options.view.options&&this.options.view.options.saveFilter&&(e+=" csui-save-filter-browse"),e},"_createDialog":function(){var e=this.options,t=new o({"title":e.dialogTitle,"headerView":this._headerControl,"view":this._view,"className":this.dialogClassName,"attributes":{"aria-label":e.dialogTitle},"largeSize":!0,"footerView":this._footerView});return t.listenTo(t,"hide",i.bind(this.onHideDialog,this)),g.imbue(t),t},"onChangeLocation":function(e){this.options.targetBrowseHistory=[],this._view.destroy(),this.updateFooterSelectedList(),this._dialog.updateButton("select",{"disabled":!0}),this.options.previousLocation=e,this._view=this._createNodePickerView(e);var i=e.get("factory").container;this.updateSearch(i),this._dialog.showView(this._view)},"onChangeSearchTerm":function(e){if(this._headerControl.searchQueryModel=e,this._view.destroy(),this.updateFooterSelectedList(),this._dialog.updateButton("select",{"disabled":!0}),0===this.options.targetBrowseHistory.length&&this.options.targetBrowseHistory.push(["location",this.options.previousLocation.id]),!this._view.options.navigateFromHistory&&!this.options.searchView){var i=this._view.selectViews.leftView,t=this._view.selectViews.rightView,s=Math.floor((i.collection.skipCount||0)/i.collection.topCount)+1,n=parseInt(i.collection.topCount)*parseInt(s);if(i.container&&t){var o={"leftId":t&&t.container&&t.container.parent?t.container.parent.get("id"):void 0,"rightId":t&&t.container?t.container.get("id"):void 0,"pageSize":n};this.options.targetBrowseHistory.push(["node",o])}else if(i.container&&null===t&&["csui/dialogs/node.picker/start.locations/current.location","csui/dialogs/node.picker/start.locations/enterprise.volume"].indexOf(this.options.previousLocation.get("id"))<0){var l={"leftId":i.container.get("id"),"rightId":void 0,"pageSize":n};this.options.targetBrowseHistory.push(["node",l])}}this.options.locationID=this._view.breadcrumbNode?this._view.breadcrumbNode.get("id"):this.options.locationID,this.searchLocation=this.options.previousLocation;var r=this._locations.get("csui/dialogs/node.picker/start.locations/search.location");this._view=this._createSearchResultsView(r),this._dialog.showView(this._view)},"_createSearchResultsView":function(e,t){this._headerControl.searchQueryModel&&(this.options.query=this._headerControl.searchQueryModel),this.options.searchView=!0;var s=e.get("factory"),n=s.getLocationParameters(this.options);i.defaults(n,this.options);var o=new l(n);return o.on("change:complete",this.onSelectionChange,this).on("changing:selection",this._blockDialog,this).on("open:location",this.onClickLocationFromSearch,this).on("change:location",this.onChangeLocationFromBack,this).on("back:toSearch",this.onClickBackFromFolderToSearch,this).on("backto:folder",this.onClickBackFromSearch,this).on("close",this.forceClosed,this),o},"onChangeLocationFromBack":function(e){this.options.targetBrowseHistory=[];var i=this._locations.get(e[1]);this._view.destroy(),this.updateFooterSelectedList(),this._dialog.updateButton("select",{"disabled":!0}),this.options.previousLocation=i,this._view=this._createNodePickerView(i);var t=i.get("factory").container;this.updateSearch(t),this._dialog.showView(this._view),this._view.selectViews.options.backBtn=!0},"onClickBackFromSearch":function(){this._view.destroy(),this.updateFooterSelectedList(),this._dialog.updateButton("select",{"disabled":!0});var e=this.options.locationID?this.options.locationID:this.options.container?this.options.container.get("id"):this.options.nodes.models.length>0?this.options.nodes.models[0].get("id"):null,i=new c({"id":e},{"connector":this.options.connector});this.updateSearch(i,void 0,!0);var t=this._locations.get("csui/dialogs/node.picker/start.locations/search.location");if(0===this.options.locationID&&(t=this.options.previousLocation),t){t.get("factory").options.container=i,this._view=this._createNodePickerView(t),this._view&&this._dialog.showView(this._view)}this._view.selectViews.options.backBtn=!0},"onClickLocationFromSearch":function(e){this._view.destroy(),this.updateFooterSelectedList(),this._dialog.updateButton("select",{"disabled":!0});var i=this._locations.get("csui/dialogs/node.picker/start.locations/default.location");i.get("factory").options.container=e,this.options.targetBrowseHistory.push(["search",this.options.query.clone()]),this._view=this._createNodePickerView(i),this._view&&(this._dialog.showView(this._view),this._view.showBackButton())},"onClickBackFromFolderToSearch":function(e){this._view.destroy(),this._headerControl.searchQueryModel=e.requestedQueryModel,this.updateSearch(e.options.container,e.requestedQueryModel,!0),this.updateFooterSelectedList(),this._dialog.updateButton("select",{"disabled":!0});var i=this._locations.get("csui/dialogs/node.picker/start.locations/search.location");this._view=this._createSearchResultsView(i,!0),this._view.options.navigateFromHistory=e.options.navigateFromHistory,this._dialog.showView(this._view),this._view.selectViews.options.backBtn=!0},"onSelectionChange":function(e){var i,t=this._view.getNumberOfSelectItems()>0;e&&e.get("id")&&e.get("name")&&(this.options.locationID=e.get("id"),this.updateSearch(e),this.updateHeaderStartLocation(e)),this.updateFooterSelectedList(),this._dialog.destroyBlockingView(),this.options.saveFilter&&this._headerControl&&this._headerControl.ui.saveFilter?(i=!!this._headerControl.ui.saveFilter.val().trim(),i&&t?this._dialog.updateButton("select",{"disabled":!1}):this._dialog.updateButton("select",{"disabled":!0})):this._dialog.updateButton("select",{"disabled":!t}),this._view.selectViews.options.backBtn&&(this._view.selectViews.options.backBtn=!1,this._view.$el.find(".list-content li:first-child").focus())},"onChangeFilterName":function(){var e=this._dialog.$el.find("div[class='load-container']");if(this.options.saveFilter&&e&&0===e.length){var i,t,s=!0;this._headerControl.ui.saveFilter&&(s=this._headerControl.ui.saveFilter.val().trim().length<1),t=this._view.getNumberOfSelectItems()>0,this.updateFooterSelectedList(),this._headerControl&&this._headerControl.ui.saveFilter&&(i=!s),i&&t?this._dialog.updateButton("select",{"disabled":!1}):this._dialog.updateButton("select",{"disabled":!0})}},"onFocusOutFilterName":function(){this.isValidVirtualFolderName()},"isValidVirtualFolderName":function(){var e=!1,i=!1;return this._headerControl.ui.saveFilter&&1===this._headerControl.ui.saveFilter.length&&void 0!==this._headerControl.ui.saveFilter.val()&&null!==this._headerControl.ui.saveFilter.val()&&(e=this._headerControl.ui.saveFilter.val().trim().length<1,i=this._headerControl.ui.saveFilter.val().indexOf(":")>=0),e?this._headerControl.showErrorMessage(m.nameCannotBeEmpty):i?this._headerControl.showErrorMessage(m.nameCannotContainColon):this._headerControl.removeErrorMessage(),!e&&!i},"updateHeaderStartLocation":function(e){this.options.commandType.browseAllowed(e)&&this._headerControl.hideStartLocationLabel(e)},"updateSearch":function(e,i,t){var s=e?e.get("id"):void 0,n=e?e.get("name"):"";if(this._headerControl.searchBoxView&&this._headerControl.searchboxModel){if(t){var o=i?i.get("location_id1"):this._headerControl.searchBoxView.model.get("location_id1");this._headerControl.searchboxModel.nodeId=o}else this._headerControl.searchboxModel.nodeId=s;this._headerControl.searchboxModel.nodeName=n,this._headerControl.searchboxModel.trigger("change")}},"updateFooterSelectedList":function(){var e=this._view.getNumberOfSelectItems();this._footerView.trigger("selectedItems:updateCount",e)},"onClickSelectButton":function(){if(this&&this._view&&this._view.getSelection().length>0){var e,i=this._view.getSelection(),t=this._headerControl.propertiesView;if(this._headerControl.searchQueryModel&&this._headerControl.searchQueryModel.clear({"silent":!0}),!(this._headerControl.ui&&this._headerControl.ui.saveFilter&&this.isValidVirtualFolderName()))return;e=this._headerControl.ui.saveFilter.val(),this._result={"nodes":i,"applyProperties":t&&t.selected,"openSelectedProperties":t&&t.openSelectedProperties,"filterName":e},this._dialog.destroy()}else this._dialog.updateButton("select",{"disabled":!0})},"onHideDialog":function(){this._deferred&&(this._result?this._deferred.resolve(this._result):"pending"===this._deferred.state()&&this._deferred.reject({"cancelled":!0})),this._headerControl.searchQueryModel&&this._headerControl.searchQueryModel.clear({"silent":!0})},"onDrillUp":function(e){this.options.container=new c({"id":e},{"connector":this.options.connector}),this._locations.get("csui/dialogs/node.picker/start.locations/search.location").get("factory").options.container=this.options.container},"_getConnector":function(e){var t;if(e.context)t=e.context.getObject(r);else if(e.initialSelection||e.initialContainer){var s=e.initialSelection,n=s?i.isArray(s)?s:s.models:void 0,o=e.initialContainer||n[0];t=o&&o.connector}return t},"_getInitalContainer":function(e){var t=this.options.initialContainer;if(null==t||i.isEmpty(t)){var n=e.context&&e.context.getModel(a);t=null!=n&&null!=n.parent&&n.parent.isFetchable()?1===n.parent.get("id")||n.get("container")?n.clone():n.parent.clone():null}else t instanceof s.Model||(t=new c(t,{"connector":this.options.connector}));return t},"_getArrayOfNodeIds":function(e){return e&&!i.isEmpty(e)&&e[0]instanceof s.Model?i.map(e,function(e){return e.get("id")}):e},"_getInitialLocation":function(){var e,t=this.options.startLocation;if(t){t.lastIndexOf("/")<0&&(t="csui/dialogs/node.picker/start.locations/"+t),e=this._locations.get(t)}return e||(e=!i.isEmpty(this.options.initialContainer)&&this._locations.get("csui/dialogs/node.picker/start.locations/current.location"))||(i.find(w.initialLocationLookupOrder,function(i){return e=this._locations.get(i)},this),e||(e=this._locations.first())),e},"onClickCancelButton":function(){this._dialog.destroy()}}),v.defaults={"containers":{"selectableTypes":[-1],"dialogTitle":m.dialogTitleForContainers},"documents":{"selectableTypes":[144],"dialogTitle":m.dialogTitleForDocuments},"categories":{"initialContainer":{"id":"volume","type":133},"selectableTypes":[131],"dialogTitle":m.dialogTitleForCategories}},v}),csui.define("csui/dialogs/members.picker/members.picker.wizard",["module","csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/dialogs/members.picker/impl/members.picker.view","csui/utils/contexts/factories/connector","csui/utils/contexts/factories/member","csui/models/member/member.model","csui/models/member/membercollection","csui/models/permission/nodepermission.model","csui/dialogs/members.picker/start.locations/start.location.collection","csui/dialogs/members.picker/impl/command.type","csui/dialogs/members.picker/impl/header/members.picker.header.view","i18n!csui/dialogs/members.picker/impl/nls/lang","csui/utils/log","csui/controls/progressblocker/blocker","csui/controls/wizard/wizard.view","csui/widgets/permissions/impl/edit/permission.level.selector/permission.level.selector.view","csui/widgets/permissions/impl/edit/permission.attributes/permission.attributes.view","csui/widgets/permissions/impl/edit/apply.permission/apply.permission.view","csui/utils/taskqueue","csui/controls/globalmessage/globalmessage","i18n","css!csui/dialogs/members.picker/impl/members.picker","csui/dialogs/node.picker/node.picker"],function(e,i,t,s,n,o,l,r,a,c,u,d,h,p,m,f,g,b,v,w,y,_,C,T){"use strict";function x(e){if(e||(e={}),this.options=i.defaults(e,S,{"pageSize":30}),this.options.connector||(this.options.connector=this._getConnector(this.options)),!this.options.connector){var t=m.missingConnector;throw f.error(t)&&console.error(t),new Error(t)}this.options.targetBrowseHistory=[],this.options.navigateFromHistory=!1,this.options.initialContainer=this._getInitalContainer(this.options),this.options.unselectableMembers=this._getArrayOfNodeIds(e.unselectableMembers),this.options.selectableMembers=this._getArrayOfNodeIds(e.selectableMembers),this.options.commandType=new h(this.options)}var k=i.extend({"initialLocationLookupOrder":["csui/dialogs/members.picker/start.locations/recent.groups","csui/dialogs/members.picker/start.locations/member.groups","csui/dialogs/members.picker/start.locations/acl.groups","csui/dialogs/members.picker/start.locations/all.members"]},e.config());i.defaults(k,{"parallelism":3});var S={"initialSelection":[],"dialogTitle":m.dialogTitle,"orderBy":"name asc"};return i.extend(x.prototype,{"show":function(){return this._locations=new d(this.options),this._locations.fetch({"connector":this.options.connector,"container":this.options.initialContainer,"nodeId":this.options.nodeModel?this.options.nodeModel.get("id"):void 0,"removeInvalid":!1}).done(i.bind(this._showWizard,this)),this._deferred=t.Deferred(),this._deferred.promise()},"_showWizard":function(){this._steps=this._createWizardSteps(),this._wizard=new b({"steps":this._steps}),g.imbue(this._wizard),this._wizard.options.editpermission=this.membersPickerView.options.edit_permission,this._wizard.options.groupId=this.membersPickerView.options.groupId,this._wizard.options.id=this.membersPickerView.options.groupId,this._wizard.options.add=this.membersPickerView.options.add,this._wizard.show(this._wizard.options),this._wizard.on("save:result",this.onClickFinishButton,this),this._wizard.on("add:member",this.onClickAddButton,this),this._wizard.currentView.headerView.on("show:selectItem",this.selectUsers,this),this._wizard.currentView.headerView.on("enable:add",this.enableAdd,this),this.options.selectedMember&&this.selectUsers(this.options.selectedMember)},"_createHeaderControl":function(e){var i=this.options,t=null==i.locationSelector||i.locationSelector,s=null!=i.displayStartLocation&&i.displayStartLocation,n=new p({"locations":this._locations,"headerViewoptions":this.options,"title":i.dialogTitle,"context":i.context,"node":this.options.node,"authUser":this.options.authUser,"hasEditPermissionAction":this.options.edit_permission,"initialLocation":e,"displayStartLocation":s,"adduserorgroup":!!i.adduserorgroup&&i.adduserorgroup,"showUserPicker":i.showUserPicker,"locationSelector":t,"selectedMember":i.selectedMember,"initialSelection":i.initialSelection});return i.adduserorgroup&&n.startLocationView.on("change:location",this.onChangeLocation,this),n.on("hide:parentDialog",this.parentdialogdestroy,this),n},"parentdialogdestroy":function(e){this._wizard.destroy()},"_createPickerView":function(e){this.options.startLocation||(this.options.startLocation=this._locations.at(0));var t=this.options,s=e.get("factory"),n=s.getLocationParameters(this.options);i.defaults(n,this.options);var l=new o(n);return l.on("update:button",this.updateButton,this),l.on("changing:selection",this._blockDialog,this).on("change:location",this.onChangeLocation,this),t.adduserorgroup&&l.on("change:complete",this.onSelectionChange,this),this.membersPickerView=l,l},"_createPermissionLevelSelectorView":function(){var e=new v({"selected":1,"isContainer":!this.options.nodeModel||this.options.nodeModel.get("container"),"isAdvancedVersioning":this.options.isAdvancedVersioning});return e.on("permission:level:selected",this.onPermissionLevelSelection,this),e},"_createPermissionLevelSubItemsView":function(){var e=new y({"selected":2,"context":this.options.context,"model":this.options.nodeModel,"applyTo":this.options.applyTo});return e.on("permission:level:selected",this.onPermissionLevelSelection,this),e},"dialogClassName":function(){var e="target-browse";return this.options&&this.options.userClassName&&(e=e+" "+this.options.userClassName),e},"_createWizardSteps":function(){var e,t,s,n=this.options,o=this._getInitialLocation(),l=this._createHeaderControl(o),r=this._createPickerView(o),a=!(!n.nodeModel||!n.nodeModel.get("container")||"advanced"!==n.nodeModel.get("permissions_model")),c=i.uniqueId("permissionLevel");if(n.adduserorgroup&&!n.showUserPicker&&a)return e={"title":n.dialogTitle,"adduserorgroup":!!n.adduserorgroup&&n.adduserorgroup,"headerView":l,"view":r,"className":this.dialogClassName,"nextButton":!0,"userClassName":this.options.dialogClass,"attributes":{"aria-labelledby":"memberPickerHeader"},"largeSize":!0},t={"title":n.dialogTitle,"headers":[{"label":m.selectPermissionLevel,"class":"csui-permission-level-select","id":c}],"nextButtonLabel":m.nextButtonLabel,"nextButton":!0,"disableNext":!1,"view":this._createPermissionLevelSelectorView(),"className":this.dialogClassName()+" csui-permissions-level","attributes":{"aria-labelledby":"memberPickerHeader","aria-describedby":c}},s={"title":n.dialogTitle,"doneButtonLabel":m.doneButtonLabel,"disableDone":!1,"doneButton":!0,"view":this._createPermissionLevelSubItemsView(),"className":this.dialogClassName()+" csui-permissions-apply-dialog","attributes":{"aria-labelledby":"memberPickerHeader"}},[e,t,s];if(!n.adduserorgroup||n.showUserPicker||a){return[{"title":n.dialogTitle,"adduserorgroup":!!n.adduserorgroup&&n.adduserorgroup,"showUserPicker":n.showUserPicker,"headerView":l,"view":r,"className":this.dialogClassName,"userClassName":this.options.dialogClass,"attributes":{"aria-labelledby":"memberPickerHeader"},"largeSize":!0,"buttons":n.buttons}]}return e={"title":n.dialogTitle,"adduserorgroup":!!n.adduserorgroup&&n.adduserorgroup,"headerView":l,"view":r,"className":this.dialogClassName,"nextButton":!0,"userClassName":this.options.dialogClass,"attributes":{"aria-labelledby":"memberPickerHeader"},"largeSize":!0},t={"title":n.dialogTitle,"headers":[{"label":m.selectPermissionLevel,"class":"csui-permission-level-select","id":c}],"doneButtonLabel":m.doneButtonLabel,"disableDone":!1,"doneButton":!0,"view":this._createPermissionLevelSelectorView(),"className":this.dialogClassName()+" csui-permissions-level","attributes":{"aria-labelledby":"memberPickerHeader","aria-describedby":c}},[e,t]},"_blockDialog":function(){return this._wizard.blockWithoutIndicator(),!0},"onHideDialog":function(){this._deferred&&(this._result?this._deferred.resolve(this._result):"pending"===this._deferred.state()&&this._deferred.reject({"cancelled":!0}))},"onChangeLocation":function(e){e.get||(e=this._locations.get("csui/dialogs/members.picker/start.locations/"+e)),this.options.targetBrowseHistory=[];var i=this.membersPickerView&&this.membersPickerView.selectedMemberList&&this.membersPickerView.selectedMemberList.collection.models;this._steps[0].view.destroy(),this.membersPickerView.trigger("change:complete"),this.options.previousLocation=e,this._steps[0].view=this._createPickerView(e);e.get("factory").container;this._wizard.currentView.showView(this._steps[0].view),i&&this.selectUsers(i)},"selectUsers":function(e){this.membersPickerView&&this.membersPickerView.selectedMemberList&&this.membersPickerView.selectedMemberList.trigger("show:selectItem",e)},"enableAdd":function(){var e=this._wizard.currentView.footerView.children._views;i.each(e,function(e){"Add"===e.model.get("id")&&e.$el.removeClass("binf-hidden")},this)},"updateButton":function(e){this._wizard.currentView.footerView&&this._wizard.currentView.footerView.trigger("update:button",e),this.locationId=!!this._wizard.currentView.headerView.options&&!!this._wizard.currentView.headerView.options.headerViewoptions&&this._wizard.currentView.headerView.options.headerViewoptions.locationID;var t=this._wizard.currentView.footerView.children._views;i.each(t,function(i){"Add"===i.model.get("id")&&(e.models.length>0&&this._wizard.options.add?this.options.selectedMember&&!this.locationId?i.$el.attr("disabled","disabled"):i.$el.removeAttr("disabled"):i.$el.attr("disabled","disabled"))},this);var s=e.models.length>0;this._wizard.currentView.headerView&&this._wizard.currentView.headerView.userSearchView&&this._wizard.currentView.headerView.userSearchView.updatePlaceHolder(s)},"onClickFinishButton":function(){var e,i,t,s
;this&&this.getMemberPickerView()&&this.getMemberPickerView().getSelection()?(e=this.getMemberPickerView().getSelection(),i=this.getPermissionLevelView().getSelectedPermissions(),s=!(!this.options.nodeModel.get("container")||"advanced"!==this.options.nodeModel.get("permissions_model")),s&&(t=this.getPermissionsApplyView().getApplyToFlag()),this._result={"members":e,"permissions":i,"apply_to":s?t?2:3:0},this._wizard.destroy(),this.onHideDialog()):this._wizard.currentView.updateButton("next",{"disabled":!0})},"onClickAddButton":function(){var e=this._wizard.options.groupId,s=this.options.connector.connection.url;s=s.replace("v1","v2");var n=this,o=this.getMemberPickerView().getSelection()&&this.getMemberPickerView().getSelection().get("name_formatted")||this.membersPickerView.options.displayName,l={},r={},a=this.options.connector,c=!!this._wizard.currentView.headerView.options&&!!this._wizard.currentView.headerView.options.headerViewoptions&&this._wizard.currentView.headerView.options.headerViewoptions.locationID;e=c||e,n.groupName=o,n.failedUsers=[],n.passcount=0,n.failcount=0;var u=new _({"parallelism":k.parallelism}),d=0,h=this.membersPickerView&&this.membersPickerView.selectedMemberList&&this.membersPickerView&&this.membersPickerView.selectedMemberList.collection.models,p=i.map(h,function(i){var o=t.Deferred();return u.pending.add({"worker":function(){return l={"member_id":i.id},r={"type":"POST","id":e,"url":s+"/members/"+e+"/members","data":l},n.userName=i.get("name_formatted")||i.get("name"),a.makeAjaxCall(r).done(function(e){n.passcount+=1,o.resolve(i)},n).fail(function(e){n.failcount+=1,n.failedUsers.push(n.userName),o.resolve(i)},n),o.promise()}}),d++,o.promise(p)});t.whenAll.apply(t,p).then(function(e){1===n.passcount&&0===n.failcount?C.showMessage("success",i.str.sformat(m.singleUserText,n.userName,n.groupName)):0===n.passcount&&1===n.failcount?C.showMessage("error",i.str.sformat(m.singleUserFailureText,n.userName,n.groupName)):1===n.passcount&&n.failcount>0?C.showMessage("success",i.str.sformat(m.SinglePassMoreThanOneFail,n.userName,n.groupName,n.failcount)):n.passcount>0&&n.failcount>0?C.showMessage("success",i.str.sformat(m.manyUserText,n.passcount,n.failcount,n.groupName)):n.passcount>0&&0===n.failcount?C.showMessage("success",i.str.sformat(m.onlyAllSuccessText,n.passcount,n.groupName)):0===n.passcount&&n.failcount>0&&C.showMessage("error",i.str.sformat(m.onlyAllFailureText,n.failcount,n.groupName)),n._wizard.destroy()})},"_getArrayOfNodeIds":function(e){return e&&!i.isEmpty(e)&&e[0]instanceof s.Model?i.map(e,function(e){return e.get("right_id")}):e},"_getInitalContainer":function(e){var t=this.options.initialContainer;return null!=t&&!i.isEmpty(t)&&t instanceof s.Model||(t=new a({"groupId":e.groupId,"displayName":e.displayName},{"connector":e.connector})),t},"_getConnector":function(e){var t;if(e.context)t=e.context.getObject(l);else if(e.initialSelection||e.initialContainer){var s=e.initialSelection,n=s?i.isArray(s)?s:s.models:void 0,o=e.initialContainer||n[0];t=o&&o.connector}return t},"_getInitialLocation":function(){var e,i=this.options.startLocation;if(i){i.lastIndexOf("/")<0&&(i="csui/dialogs/members.picker/start.locations/"+i),e=this._locations.get(i)}return!i&&this.options.groupId&&(e=this._locations.get("csui/dialogs/members.picker/start.locations/current.group")),e},"onSelectionChange":function(e){var i,t=this.getMemberPickerView().getNumberOfSelectItems()>0;e&&e.get("id")&&(this.options.locationID=e.get("id")),this._wizard.options.add=e&&e.add,this._wizard.destroyBlockingView();var s=this.getMemberPickerHeader();if(this.options.saveFilter&&s&&s.ui.saveFilter?(i=!!s.ui.saveFilter.val().trim(),i&&t?this._wizard.updateButton("next",{"disabled":!1}):this._wizard.updateButton("next",{"disabled":!0})):(this._wizard.updateButton("next",{"disabled":!t}),this.membersPickerView&&this.membersPickerView.selectedMemberList.collection.models.length>0&&e&&e.get("id")&&e.add&&!e.get("deleted")?this._wizard.updateButton("Add",{"disabled":!1}):this._wizard.updateButton("Add",{"disabled":!0})),this.isCustom){this._steps[1].view=this._createPermissionLevelSelectorView();this._wizard.getStepViewByStepNumber(1).showView(this._steps[1].view),this.isCustom=!1}},"onPermissionLevelSelection":function(){if(this.getPermissionLevelView().selected===u.PERMISSION_LEVEL_CUSTOM){var e=new w({"permissions":[],"readonly":!1,"showButtons":!1,"node":this.options.nodeModel,"isAdvancedVersioning":this.options.isAdvancedVersioning});this._steps[1].view=e,this._wizard.currentView.showView(this._steps[1].view),this.isCustom=!0;for(var i,s,n,o=e.$el.find(".csui-permission-attribute-tree"),l=o.find(".csui-tree-split"),r=l.length-1,a=0;a<l.length;r--,a++)s=t(l[r]).width()*a,n=t(l[r]).closest(".csui-tree-child").find(".csui-separator"),l[r]===l[l.length-1]?i=o.outerHeight():(i=Math.round(t(l[r]).closest("li").position().top+t(l[r]).closest(".csui-tree-child").outerHeight()),s+=a),T&&T.settings.rtl?(t(l[r]).css({"height":i,"left":s}),n.css({"width":o.find(".csui-tree-container").width(),"left":s}),t(l[r]).closest(".csui-tree-child").css({"padding-left":s+t(l[r]).width()})):(t(l[r]).css({"height":i,"right":s}),n.css({"width":o.find(".csui-tree-container").width(),"right":s}),t(l[r]).closest(".csui-tree-child").css({"padding-right":s+t(l[r]).width()}))}this._wizard.updateButton("next",{"disabled":!1})},"getMemberPickerView":function(){return this._steps[0].view},"getMemberPickerHeader":function(){return this._steps[0].headerView},"getPermissionLevelView":function(){return this._steps[1].view},"getPermissionsApplyView":function(){return this._steps[2].view}}),x}),csui.define("csui/controls/table/cells/user/impl/nls/localized.strings",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/table/cells/user/impl/nls/root/localized.strings",{"publicAccess":"Public Access","noOwnerAssigned":"No owner assigned","noGroupAssigned":"No group assigned","addOwnerOrGroup":"Add owner or owner group","ownerAccessTitle":"Owner access","groupOwnerAccessTitle":"Group owner access","addButtonLabel":"Add","cancelButtonLabel":"Cancel","addButtonTooltip":"Add member to group","cancelButtonTooltip":"Close dialog"}),csui.define("hbs!csui/controls/table/cells/user/impl/user",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"1":function(e,i,t,s){var n,o;return'  <div class="csui-profileimg binf-pull-left">\r\n    <span class="csui-icon-paceholder csui-icon icon_permmision_public"></span>\r\n  </div>\r\n  <div class="member-info csui-fadeout'+(null!=(n=i.if.call(e,null!=e?e.disabled:e,{"name":"if","hash":{},"fn":this.program(2,s,0),"inverse":this.noop}))?n:"")+' ">\r\n    <div class="">\r\n      <span class="csui-user-display-name csui-public"\r\n            aria-label="'+this.escapeExpression((o=null!=(o=i.ariaUserLabel||(null!=e?e.ariaUserLabel:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"ariaUserLabel","hash":{}}):o))+'">'+this.escapeExpression((o=null!=(o=i.publicAccesslabel||(null!=e?e.publicAccesslabel:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"publicAccesslabel","hash":{}}):o))+"</span>\r\n    </div>\r\n  </div>\r\n"},"2":function(e,i,t,s){return" binf-disabled"},"4":function(e,i,t,s){var n;return(null!=(n=i.if.call(e,null!=e?e.showProfileImg:e,{"name":"if","hash":{},"fn":this.program(5,s,0),"inverse":this.noop}))?n:"")+'  <div class="member-info csui-fadeout ">\r\n'+(null!=(n=i.if.call(e,null!=e?e.addOwnerOrGroup:e,{"name":"if","hash":{},"fn":this.program(22,s,0),"inverse":this.program(24,s,0)}))?n:"")+"  </div>\r\n"},"5":function(e,i,t,s){var n,o;return'    <div class="csui-profileimg'+(null!=(n=i.if.call(e,null!=e?e.disabled:e,{"name":"if","hash":{},"fn":this.program(2,s,0),"inverse":this.noop}))?n:"")+' binf-pull-left">\r\n    <span class="csui-icon '+(null!=(n=i.if.call(e,null!=e?e.isOwner:e,{"name":"if","hash":{},"fn":this.program(6,s,0),"inverse":this.program(8,s,0)}))?n:"")+'" title="'+this.escapeExpression((o=null!=(o=i.title||(null!=e?e.title:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"title","hash":{}}):o))+'"\r\n          aria-label="'+this.escapeExpression((o=null!=(o=i.ariaUserType||(null!=e?e.ariaUserType:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"ariaUserType","hash":{}}):o))+'">'+(null!=(n=i.if.call(e,null!=e?e.isUser:e,{"name":"if","hash":{},"fn":this.program(16,s,0),"inverse":this.noop}))?n:"")+"</span>\r\n"+(null!=(n=i.if.call(e,null!=e?e.isOwner:e,{"name":"if","hash":{},"fn":this.program(18,s,0),"inverse":this.program(20,s,0)}))?n:"")+"    </div>\r\n"},"6":function(e,i,t,s){return" icon_permmision_owner "},"8":function(e,i,t,s){var n;return"\r\n      "+(null!=(n=i.if.call(e,null!=e?e.isOwnerGroup:e,{"name":"if","hash":{},"fn":this.program(9,s,0),"inverse":this.program(11,s,0)}))?n:"")},"9":function(e,i,t,s){return" icon_permmision_owner_group "},"11":function(e,i,t,s){var n;return" csui-icon-paceholder\r\n      "+(null!=(n=i.if.call(e,null!=e?e.isGroup:e,{"name":"if","hash":{},"fn":this.program(12,s,0),"inverse":this.program(14,s,0)}))?n:"")},"12":function(e,i,t,s){return" image_group_placeholder_permission\r\n      "},"14":function(e,i,t,s){return" image_user_placeholder_permission"},"16":function(e,i,t,s){var n;return" "+this.escapeExpression((n=null!=(n=i.initials||(null!=e?e.initials:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"initials","hash":{}}):n))},"18":function(e,i,t,s){return""},"20":function(e,i,t,s){var n;return'        <img class="csui-icon-user csui-icon binf-img-circle binf-hidden" src="'+this.escapeExpression((n=null!=(n=i.usrImgSrc||(null!=e?e.usrImgSrc:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"usrImgSrc","hash":{}}):n))+'"\r\n             alt="'+this.escapeExpression((n=null!=(n=i.name||(null!=e?e.name:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"name","hash":{}}):n))+'" title="'+this.escapeExpression((n=null!=(n=i.name||(null!=e?e.name:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"name","hash":{}}):n))+'" aria-label="'+this.escapeExpression((n=null!=(n=i.ariaUserType||(null!=e?e.ariaUserType:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"ariaUserType","hash":{}}):n))+'">\r\n'},"22":function(e,i,t,s){var n;return'      <div class="csui-add-owner-or-group">\r\n        <span class="csui-user-display-name binf-disabled"\r\n              aria-label="'+this.escapeExpression((n=null!=(n=i.ariaUserLabel||(null!=e?e.ariaUserLabel:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"ariaUserLabel","hash":{}}):n))+'">'+this.escapeExpression((n=null!=(n=i.name||(null!=e?e.name:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"name","hash":{}}):n))+'</span>\r\n        <span class="csui-icon"></span>\r\n      </div>\r\n'},"24":function(e,i,t,s){var n,o;return'      <div class="">\r\n        <span class="csui-user-display-name  '+(null!=(n=i.if.call(e,null!=e?e.disabled:e,{"name":"if","hash":{},"fn":this.program(2,s,0),"inverse":this.noop}))?n:"")+'"\r\n              aria-label="'+this.escapeExpression((o=null!=(o=i.ariaUserLabel||(null!=e?e.ariaUserLabel:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"ariaUserLabel","hash":{}}):o))+'">'+this.escapeExpression((o=null!=(o=i.name||(null!=e?e.name:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"name","hash":{}}):o))+"</span>\r\n      </div>\r\n"},"26":function(e,i,t,s){var n;return(null!=(n=i.if.call(e,null!=e?e.isOwnerOrOwnerGroup:e,{"name":"if","hash":{},"fn":this.program(27,s,0),"inverse":this.noop}))?n:"")+(null!=(n=i.unless.call(e,null!=e?e.addOwnerOrGroup:e,{"name":"unless","hash":{},"fn":this.program(29,s,0),"inverse":this.noop}))?n:"")},"27":function(e,i,t,s){return'    <div class="csui-inline-owner-change"></div>\r\n'},"29":function(e,i,t,s){var n;return'    <div class="'+this.escapeExpression((n=null!=(n=i.inlineToolBarPlaceholderClass||(null!=e?e.inlineToolBarPlaceholderClass:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"inlineToolBarPlaceholderClass","hash":{}}):n))+' binf-hidden"></div>\r\n'},"31":function(e,i,t,s){var n;return'  <div class="csui-selected-user-ingroup">\r\n    <span class="icon icon-toolbar-more"></span>\r\n    <span class="csui-selected-username">'+this.escapeExpression((n=null!=(n=i.selectedUsername||(null!=e?e.selectedUsername:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"selectedUsername","hash":{}}):n))+"</span>\r\n  </div>\r\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){var n;return'<div class="csui-user-container">\r\n'+(null!=(n=i.if.call(e,null!=e?e.isPublicPermission:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.program(4,s,0)}))?n:"")+(null!=(n=i.if.call(e,null!=e?e.includeInlineToolBarPlaceholder:e,{"name":"if","hash":{},"fn":this.program(26,s,0),"inverse":this.noop}))?n:"")+"</div>\r\n"+(null!=(n=i.if.call(e,null!=e?e.selectedUsername:e,{"name":"if","hash":{},"fn":this.program(31,s,0),"inverse":this.noop}))?n:"")}});return t.registerPartial("csui_controls_table_cells_user_impl_user",s),s}),csui.define("csui/controls/table/cells/user/user.view",["require","csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/controls/table/cells/templated/templated.view","csui/controls/table/cells/cell.registry","csui/utils/base","csui/utils/commands","csui/utils/url","csui/dialogs/members.picker/members.picker.wizard","csui/utils/contexts/factories/connector","csui/utils/user.avatar.color","i18n!csui/controls/table/cells/user/impl/nls/localized.strings","hbs!csui/controls/table/cells/user/impl/user"],function(e,i,t,s,n,o,l,r,a,c,u,d,h,p,m){var f=o.extend({"template":m,"ui":{"personalizedImage":".csui-icon-user","defaultImage":".csui-icon-paceholder","userDisplayName":".csui-user-display-name","addOwnerOrGroup":".csui-add-owner-or-group","addOwnerOrGroupIcon":".csui-add-owner-or-group .icon-edit","userPlaceHolder":".image_user_placeholder_permission"},"events":function(){var e=r.isTouchBrowser()?{"click @ui.addOwnerOrGroup":"addOwnerOrGroupIconClicked"}:{"mouseover @ui.personalizedImage":"showMiniProfilePopup","mouseover @ui.defaultImage":"showMiniProfilePopup","mouseover @ui.userDisplayName":"showMiniProfilePopup","mouseover @ui.addOwnerOrGroup":"showAddOwnerOrGroupIcon","mouseleave @ui.personalizedImage":"removeUnderline","mouseleave @ui.defaultImage":"removeUnderline","mouseleave @ui.userDisplayName":"removeUnderline","mouseleave @ui.addOwnerOrGroup":"removeAddOwnerOrGroupIcon","click @ui.addOwnerOrGroupIcon":"addOwnerOrGroupIconClicked","keydown":"onKeyInView"};return t.extend(e,{"click @ui.userDisplayName":"showUserProfileDialog","click @ui.personalizedImage":"showUserProfileDialog","click @ui.defaultImage":"showUserProfileDialog"}),e},"getValueData":function(){var e=this.model.get("type"),i=this.model.get("right_id_expand");return{"includeInlineToolBarPlaceholder":this.options.includeInlineToolBarPlaceholder,"inlineToolBarPlaceholderClass":this.options.inlineToolBarPlaceholderClass,"name":this.getDispalyName(),"disabled":this.hasPermissions(),"showProfileImg":!this.options.showOnlyUserName,"isPublicPermission":"public"===e,"publicAccesslabel":p.publicAccess,"isOwner":"owner"===e,"ariaUserLabel":this.prepareUserName(),"ariaUserType":this.prepareUserType(),"isOwnerGroup":"group"===e,"isOwnerOrOwnerGroup":"owner"===e||"group"===e,"initials":i?i.initials:"","isUser":"owner"!==e&&"group"!==e&&i&&0===i.type,"title":"owner"===e?p.ownerAccessTitle:"group"===e?p.groupOwnerAccessTitle:"","isGroup":this.model.get("right_id_expand")&&1===this.model.get("right_id_expand").type,"addOwnerOrGroup":this.addOwnerOrGroup,"usrImgSrc":"data:image/gif;base64,R0lGODlhAQABAIAAAAUEBAAAACwAAAAAAQABAAACAkQBADs=","selectedUsername":this.model.selectedUser&&this.model.selectedUser.get("name")}},"constructor":function e(i){e.__super__.constructor.apply(this,arguments);var t=this.options.column.attributes;this.options.connector=this.options.context.getModel(d),void 0===this.options.includeInlineToolBarPlaceholder&&(this.options.includeInlineToolBarPlaceholder=t&&t.containsInlineActions),this.options.inlineToolBarPlaceholderClass||(this.options.inlineToolBarPlaceholderClass="csui-inlinetoolbar"),this.noOwnerOrGroup="owner"===this.model.get("type")&&this.hasPermissions(),this.noOwnerOrGroup&&(this.commands=a,this.addOwnerOrGroupCommand=this.commands.findWhere({"signature":"addownerorgroup"}),this.status={"context":this.options.context,"permissionCollection":this.model.collection,"connector":this.options.connector,"applyTo":this.options.applyTo,"nodeId":this.model.collection.options.nodeId,"nodeModel":this.model.collection.options.node},this.addOwnerOrGroup=this.noOwnerOrGroup&&this.addOwnerOrGroupCommand&&this.addOwnerOrGroupCommand.enabled(this.status)),this.listenTo(this,"render",this._assignUserColor)},"onRender":function(){var e=this.model.get("right_id_expand");e?(this.isGroup=1===e.type,this.userId=e.id):(this.isGroup=!0,this.userId=-1);var i=this.options.showOnlyUserName,t="owner"===this.model.get("type")||"group"===this.model.get("type");i||t||this._displayProfileImage()},"onDestroy":function(){this._releasePhotoUrl()},"prepareUserName":function(){var e=!!this.model.attributes&&!!this.model.attributes.right_id_expand&&this.model.attributes.right_id_expand.name;return!!e&&e},"prepareUserType":function(){return!!this.model&&this.model.get("type")},"hasPermissions":function(){var e=!1;return this.model.get("permissions")||(e=!0),e},"getDispalyName":function(){var e;return this.model.get("right_id_expand")?e=r.formatMemberName(this.model.get("right_id_expand")):"owner"===this.model.get("type")&&this.hasPermissions()?e=this.addOwnerOrGroup?p.addOwnerOrGroup:p.noOwnerAssigned:"group"===this.model.get("type")&&this.hasPermissions()&&(e=p.noGroupAssigned),e},"_displayProfileImage":function(){var e=this._getUserPhotoUrl();if(this.ui.personalizedImage.addClass("esoc-userprofile-img-"+this.userId),this.ui.defaultImage.addClass("esoc-user-default-avatar-"+this.userId),e){var i={"url":e,"dataType":"binary"};this._releasePhotoUrl(),this.options.connector.makeAjaxCall(i).always(t.bind(function(e,i,t){200===t.status?this._showPersonalizedImage(e):this._showDefaultImage()},this))}else this._showDefaultImage()},"_getUserPhotoUrl":function(){var e=this.options.connector.connection,i=new c(e.url).getCgiScript(),t=this.model.get("right_id_expand")?this.model.get("right_id_expand").photo_url:null;if(t&&t.indexOf("?")>0)return c.combine(i,t)},"_showPersonalizedImage":function(e){this._releasePhotoUrl(),this._photoUrl=URL.createObjectURL(e),"object"==typeof this.ui.personalizedImage&&(this.ui.personalizedImage.attr("src",this._photoUrl),this.ui.personalizedImage.removeClass("binf-hidden")),"object"==typeof this.ui.defaultImage&&this.ui.defaultImage.addClass("binf-hidden")},"_showDefaultImage":function(e){this._releasePhotoUrl(),"object"==typeof this.ui.personalizedImage&&this.ui.personalizedImage.addClass("binf-hidden"),"object"==typeof this.ui.defaultImage&&this.ui.defaultImage.removeClass("binf-hidden")},"showAddOwnerOrGroupIcon":function(){this.addOwnerOrGroupCommand&&this.addOwnerOrGroupCommand.enabled(this.status)&&this.ui.addOwnerOrGroup.find(".csui-icon").addClass("icon-edit")},"removeAddOwnerOrGroupIcon":function(){this.ui.addOwnerOrGroup.find(".csui-icon").removeClass("icon-edit")},"addOwnerOrGroupIconClicked":function(){var e=this;this.addOwnerOrGroupCommand&&this.addOwnerOrGroupCommand.enabled(this.status)&&this.addOwnerOrGroupCommand.execute(this.status).done(t.bind(function(i){if(i.get("addOwnerGroup")){var t=!!e.options.updateModelSilent&&e.options.updateModelSilent;e.model&&e.model.collection&&e.model.collection.addOwnerOrGroup(i,t)}}))},"_releasePhotoUrl":function(){this._photoUrl&&(URL.revokeObjectURL(this._photoUrl),this._photoUrl=void 0)},"removeUnderline":function(e){this.isGroup||-3===this.userId||(this.ui.personalizedImage.removeClass("cs-user-photo-hover"),this.ui.defaultImage.removeClass("cs-user-photo-hover"),this.ui.userDisplayName.removeClass("cs-user-container-hover").addClass("cs-user-container-no-hover"))},"onKeyInView":function(e){32!==e.keyCode&&13!==e.keyCode||this.showUserProfileDialog(e)},"showUserProfileDialog":function(e){if(this.userId<0);else{if(this.isGroup){var t=this,s=this;return void new u({"context":t.options.context,"connector":t.options.connector,"groupId":t.model.attributes.right_id,"edit_permission":t.options.hasEditPermissionAction||t.options.column.attributes.containsInlineActions,"dialogClass":"cs-permission-group-picker","startLocations":["current.group"],"authUser":t.options.originatingView.user,"selectedGroup":t.model,"node":t.options.originatingView&&t.options.originatingView.model,"displayName":r.formatMemberName(this.model.get("right_id_expand")),"unselectableTypes":[0,1],"add":!0,"buttons":[{"id":"Add","label":p.addButtonLabel,"default":!0,"hidden":!0,"disabled":!0,"toolTip":p.addButtonTooltip},{"id":"Cancel","label":p.cancelButtonLabel,"disabled":!1,"close":!0,"toolTip":p.cancelButtonTooltip}]}).show().always(function(){s.$el.focus()}).done()}e.preventDefault(),e.stopPropagation(),this.userWidgetView?(this.dialogOpen=!0,this.ui.personalizedImage.addClass("cs-user-photo-hover"),this.ui.defaultImage.addClass("cs-user-photo-hover"),this.ui.userDisplayName.removeClass("cs-user-container-no-hover").addClass("cs-user-container-hover"),i(".popover.esoc-mini-profile-popover").hide(),this.userWidgetView.showUserProfileDialog(e)):this.setUserWidget("showUserProfileDialog",e)}},"showMiniProfilePopup":function(e){this.isGroup||-3===this.userId||(this.userWidgetView?(this.ui.personalizedImage.addClass("cs-user-photo-hover"),this.ui.defaultImage.addClass("cs-user-photo-hover"),this.ui.userDisplayName.removeClass("cs-user-container-no-hover").addClass("cs-user-container-hover"),this.userWidgetView.showMiniProfilePopup(e)):this.setUserWidget("showMiniProfilePopup",e))},"setUserWidget":function(e,i){var t=this;csui.require(["esoc/controls/userwidget/userwidget.view"],function(s){t.userWidgetView=new s({"userid":t.userId,"context":t.options.context,"baseElement":t.ui.userDisplayName,"showUserProfileLink":!0,"showMiniProfile":!0,"loggedUserId":t.userId,"connector":t.options.connector}),t[e](i)})},"_assignUserColor":function(){var e=this.model.get("right_id_expand"),i=h.getUserAvatarColor(e);this.ui.userPlaceHolder.css("background",i)}},{"hasFixedWidth":!1,"widthFactor":2});return l.registerByColumnKey("right_id",f),f}),csui.define("hbs!csui/widgets/permissions/impl/edit/apply.permission/impl/header/apply.permission.header",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){var n;return'<h4 class="binf-modal-title">\r\n  <span class="icon icon-notification-information"></span>\r\n  <span class="title-text csui-apply-permission-header-title" title="'+this.escapeExpression((n=null!=(n=i.title||(null!=e?e.title:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"title","hash":{}}):n))+'">'+this.escapeExpression((n=null!=(n=i.title||(null!=e?e.title:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"title","hash":{}}):n))+"</span>\r\n</h4>"}});return t.registerPartial("csui_widgets_permissions_impl_edit_apply.permission_impl_header_apply.permission.header",s),s}),csui.define("csui/widgets/permissions/impl/edit/apply.permission/impl/header/apply.permission.header.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","hbs!csui/widgets/permissions/impl/edit/apply.permission/impl/header/apply.permission.header","i18n!csui/widgets/permissions/impl/edit/apply.permission/impl/nls/lang","css!csui/widgets/permissions/impl/permissions"],function(e,i,t,s,n){"use strict";return t.ItemView.extend({"template":s,"templateHelpers":function(){var i="";if(this.options.removePermission){var t=this.options.permissionModel&&this.options.permissionModel.get("right_id_expand")&&this.options.permissionModel.get("right_id_expand").name_formatted;t=this.options.permissionModel&&"public"===this.options.permissionModel.get("type")?n.publicAccess:t,i=e.str.sformat(n.removePermissionHeaderTitle,t)}else i=this.options.restorePublicAccess?n.restorePublicAccessHeaderTitle:n.applyPermissionHeaderTitle;return{"title":i}},"constructor":function(e){e||(e={}),t.ItemView.prototype.constructor.apply(this,arguments)}})}),csui.define("csui/widgets/permissions/impl/edit/edit.permission.helper",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/utils/base","csui/controls/dialog/dialog.view","i18n","csui/models/permission/nodepermission.model","csui/widgets/permissions/impl/edit/permission.level.selector/permission.level.selector.view","csui/widgets/permissions/impl/edit/permission.attributes/permission.attributes.view","csui/widgets/permissions/impl/edit/apply.permission/apply.permission.view","csui/widgets/permissions/impl/edit/apply.permission/impl/header/apply.permission.header.view","csui/controls/progressblocker/blocker","i18n!csui/widgets/permissions/impl/nls/lang"],function(e,i,t,s,n,o,l,r,a,c,u,d,h){"use strict";return t.Object.extend({"constructor":function(e){t.Object.prototype.constructor.apply(this,arguments)},"initialize":function(i){this.uniqueViewId="view"+e.uniqueId()},"_showSelectPermissionLevelPopover":function(){this.permissionLevelSelectorView&&this.permissionLevelSelectorView.destroy(),this.permissionLevelSelectorView=new r({"permissionModel":this.options.permissionModel}),this.permissionLevelSelectorView.render(),this.listenTo(this.permissionLevelSelectorView,"permission:level:selected",this._permissionLevelSelected),this.currentPopoverView=this.permissionLevelSelectorView,this.popoverContainerClassname="",this.showPopover()},"showCustomPermissionPopover":function(){this.permissionAttributesView&&this.permissionAttributesView.destroy(),this.permissionAttributesView=new a({"model":this.options.permissionModel,"readonly":this.options.readonly,"node":this.options.originatingView&&this.options.originatingView.model}),this.permissionAttributesView.render(),this.listenTo(this.permissionAttributesView,"permission:attribute:save:clicked",this.permissionAttributesSelected),this.listenTo(this.permissionAttributesView,"permission:attribute:cancel:clicked",this.closePopover),this.currentPopoverView=this.permissionAttributesView,this.popoverContainerClassname="csui-permission-attribute-popover-container ",this.showPopover()},"_permissionLevelSelected":function(){var e=this.permissionLevelSelectorView.selected;e!==l.PERMISSION_LEVEL_CUSTOM?(this.showingPopover&&this.closePopover(!0),this.permissions=l.getPermissionsByLevelExceptCustom(e,!this.options.originatingView||this.options.originatingView.model.get("container"),this.options.permissionModel.collection.isAdvancedVersioning),this.options.originatingView&&this.options.originatingView.model&&this.options.originatingView.model.get("container")&&"advanced"===this.options.originatingView.model.get("permissions_model")?(this._applyDialog=this.showApplyPermissionDialog(),this._applyDialog.show()):this.triggerMethod("permissions:selected",{"permissions":this.permissions})):this.showCustomPermissionPopover()},"showApplyPermissionDialog":function(){var i=new u;this._view=new c({"context":this.options.context||this.options.originatingView.context,"model":this.options.nodeModel||this.options.originatingView.model,"applyTo":this.options.applyTo,"permissionModel":this.options.permissionModel});var t=new n({"headerView":i,"view":this._view,"className":"csui-permissions-apply-dialog","midSize":!0,"buttons":[{"id":"apply","label":h.applyButtonLabel,"toolTip":h.applyButtonLabel,"default":!0,"click":e.bind(this.onClickApplyButton,this)},{"label":h.cancelButtonLabel,"toolTip":h.cancelButtonLabel,"close":!0}]});return t.listenTo(t,"hide",e.bind(this.onHideDialog,this)),d.imbue(t),t},"onClickApplyButton":function(e){var i=e.dialog.$el.find(".csui-subtypes-option:checked").map(function(){return this.value}).toArray(),t=e.dialog.options.view.model.get("container"),s=e.dialog.options.view.options.permissionModel&&e.dialog.options.view.options.permissionModel.get("right_id"),n=e.dialog.options.view.model.get("permissions_model"),o=t&&"advanced"===n&&e.dialog.options.view.subFolderSelected?2:t&&"advanced"===n?3:0;this.triggerMethod("permissions:selected",{"permissions":this.permissions,"apply_to":o,"right_id":s,"include_sub_types":i});this._applyDialog.destroy(),this._blockActions()},"onHideDialog":function(){var e=this.options.originatingView;e&&e.trigger("unblock:view:actions")},"_blockActions":function(){var e=this.options.originatingView;e&&e.blockActions&&e.blockActions()},"_unblockActions":function(){var e=this.options.originatingView;e&&e.unblockActions&&e.unblockActions()},"unblockActions":function(){this._unblockActions()},"permissionAttributesSelected":function(e){this.permissions=e,this.showingPopover&&this.closePopover(!0),(this.options.nodeModel?this.options.nodeModel:this.options.originatingView&&this.options.originatingView.model).get("container")?(this._applyDialog=this.showApplyPermissionDialog(),this._applyDialog.show()):this.triggerMethod("permissions:selected",{"permissions":this.permissions})},"showPopover":function(){var t=this.options.popoverPlacement,s=!1;o&&o.settings.rtl&&(t="left"===t?"right":"left",s=!0);var n={"html":!0,"content":e.bind(function(){return this.currentPopoverView.el},this),"trigger":"manual","placement":t};this.options.popoverAtBodyElement&&(this.popoverContainerClassname+="csui-edit-permission-popover-container "+this.uniqueViewId,this.popoverContainerSelector=".csui-edit-permission-popover-container."+this.uniqueViewId,this.$popoverEl?this._getPopoverParent().addClass(this.popoverContainerClassname):i("body").append('<div class="binf-widgets '+this.popoverContainerClassname+'"></div>'),n=e.extend(n,{"container":this.popoverContainerSelector})),this.$popoverEl=this.options.popoverTragetElement,this.$popoverEl.binf_popover(n).binf_popover("show");for(var l,r,a,c,u=this._getPopoverParent().find(".binf-popover"),d=this._getPopoverParent().find(".binf-popover").find(".csui-tree-split"),h=d.length-1,p=0;p<d.length;h--,p++)r=i(d[h]).width()*p,a=i(d[h]).closest(".csui-tree-child").find(".csui-separator"),d[h]===d[d.length-1]?l=u.find(".csui-permission-attribute-tree").outerHeight():(l=Math.round(i(d[h]).closest("li").position().top+i(d[h]).closest(".csui-tree-child").outerHeight()),r+=p),s?(i(d[h]).css({"height":l,"left":r}),a.css({"width":u.find(".csui-tree-container").width()-r,"left":r}),i(d[h]).closest(".csui-tree-child").css({"padding-left":r+i(d[h]).width()})):(i(d[h]).css({"height":l,"right":r}),a.css({"width":u.find(".csui-tree-container").width()-r,"right":r}),i(d[h]).closest(".csui-tree-child").css({"padding-right":r+i(d[h]).width()}));c=o&&o.settings.rtl?parseInt(u.css("left"))+u.find(".binf-arrow").outerWidth():parseInt(u.css("left"))-u.find(".binf-arrow").outerWidth(),u.css("left",c),this.$popoverEl.on("shown.binf.popover",e.bind(function(e){this.currentPopoverView&&this.currentPopoverView.currentlyFocusedElement&&this.currentPopoverView.currentlyFocusedElement().focus(),i(document).on("mousedown."+this.uniqueViewId,{"view":this},this._handleClickEvent),i(window).bind("resize."+this.uniqueViewId,{"view":this},this._onWindowResize),this.options.popoverAtBodyElement&&(i(document).on("scroll",{"view":this},this._handleScrollEvent),this.options.originatingView&&this.listenToOnce(this.options.originatingView,"scroll",function(e){e.data={"view":this},this._handleScrollEvent(e)})),i("body").on("keydown."+this.uniqueViewId,{"view":this},this._handleKeyEvents),this.triggerMethod("shown:permission:level:popover")},this)),this.$popoverEl.on("hidden.binf.popover",e.bind(function(e){this.$popoverEl.focus(),this.currentPopoverView&&this.currentPopoverView.destroy(),this.currentPopoverView=void 0,
this.options.popoverAtBodyElement&&i(this.popoverContainerSelector).remove()},this)),this.showingPopover=!0},"_onWindowResize":function(e){if(e&&e.data&&e.data.view){var i=e.data.view;i.showingPopover&&i.closePopover()}},"_handleKeyEvents":function(e){if(e&&e.data&&e.data.view){var i=e.data.view;(i.getOption("readonly")&&(9===e.keyCode||13===e.keyCode)||27===e.keyCode)&&i.showingPopover&&i.closePopover()}},"_handleClickEvent":function(e){if(!i(e.target).closest(".binf-popover").length){var t;e&&e.data&&e.data.view&&(t=e.data.view,i(document).off("mousedown."+this.uniqueViewId,t._handleClickEvent)),t&&t.closePopover()}},"_handleScrollEvent":function(e){if(!i(e.target).closest(".binf-popover").length){var t;e&&e.data&&e.data.view&&(t=e.data.view,i(document).off("scroll",t._handleScrollEvent)),t&&t.closePopover()}},"closePopover":function(e){this.$popoverEl&&this.$popoverEl.data("binf.popover")&&(i(document).off("mousedown."+this.uniqueViewId,this._handleClickEvent),i(document).off("scroll",this._handleScrollEvent),i(window).unbind("resize."+this.uniqueViewId,this._onWindowResize),this.currentPopoverView&&this.currentPopoverView.$el.off("keydown",this._handleKeyEvents),this.$popoverEl.binf_popover("destroy"),this.showingPopover=!1,e||this.triggerMethod("closed:permission:level:popover"),this.$popoverEl.focus())},"_getPopoverParent":function(){return this.options.popoverAtBodyElement?i(this.popoverContainerSelector):this.$popoverEl.parent()},"onBeforeDestroy":function(){this.closePopover(!0)}})}),csui.define("csui/controls/table/cells/permission/impl/nls/localized.strings",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/table/cells/permission/impl/nls/root/localized.strings",{"FullControl":"Full control","Write":"Write","Read":"Read","Custom":"Custom","None":"None","see":"See","see_contents":"See contents","modify":"Modify","edit_attributes":"Edit attributes","add_items":"Add items","reserve":"Reserve","delete_versions":"Delete version","delete":"Delete","permissionfor":"{0} Permission for {1}","publicaccess":"Public Access","edit_permissions":"Edit permissions"}),csui.define("hbs!csui/controls/table/cells/permission/impl/permission.level",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"1":function(e,i,t,s){var n;return'  <div class="csui-permission-level-container csui-fadeout">\r\n    <span class="csui-permission-level" aria-label="'+this.escapeExpression((n=null!=(n=i.permissionLevelAria||(null!=e?e.permissionLevelAria:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"permissionLevelAria","hash":{}}):n))+'">'+this.escapeExpression((n=null!=(n=i.value||(null!=e?e.value:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"value","hash":{}}):n))+'</span>\r\n    <div class="csui-tree"></div>\r\n  </div>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){var n;return null!=(n=i.if.call(e,null!=e?e.value:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?n:""}});return t.registerPartial("csui_controls_table_cells_permission_impl_permission.level",s),s}),csui.define("csui/controls/table/cells/permission/permission.level.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/controls/table/cells/templated/templated.view","csui/controls/table/cells/cell.registry","csui/widgets/permissions/impl/edit/edit.permission.helper","csui/utils/commandhelper","csui/utils/commands","i18n!csui/controls/table/cells/permission/impl/nls/localized.strings","hbs!csui/controls/table/cells/permission/impl/permission.level"],function(e,i,t,s,n,o,l,r,a,c,u){"use strict";var d=n.extend({"template":u,"ui":{"permissionLevel":".csui-permission-level","permissionTree":".csui-tree"},"events":{"click @ui.permissionLevel":"onClickPermissionLevel","keydown":"onKeyInView"},"onKeyInView":function(e){32!==e.keyCode&&13!==e.keyCode||this.$el.find(".csui-permission-level").click()},"getValueData":function(){var e,t=this.model.get("permissions"),s=this.getPermissionLevel(t);return e="public"===this.model.get("type")?c.publicaccess:this.model&&this.model.get("right_id_expand")?this.model.get("right_id_expand").name:"",null===s?n.prototype.getValueData.apply(this,arguments):{"value":s,"permissionLevelAria":i.str.sformat(c.permissionfor,s,e),"formattedValue":s}},"getPermissionLevel":function(e){var i=null,t=9;return this.model.collection.isContainer?t++:this.model.collection.isAdvancedVersioning||t--,e&&e.length>0?i=e.indexOf("edit_permissions")>=0&&e.length===t?c.FullControl:e.indexOf("edit_permissions")<0&&e.indexOf("delete")>=0&&e.length===t-1?c.Write:e.indexOf("see_contents")>=0&&2===e.length?c.Read:c.Custom:("public"===this.model.get("type")||this.model.get("right_id"))&&(i=c.None),i},"constructor":function i(t){i.__super__.constructor.apply(this,arguments),this.$=e},"onClickPermissionLevel":function(e){[0,1].indexOf(this.options.model.get("right_id_expand")&&this.options.model.get("right_id_expand").type)<0&&"custom"===this.options.model.get("type")?this._handlePermissionLevelFocus({"cellView":this}):(this._handlePermissionLevelClicked({"cellView":this}),this.trigger("cell:content:clicked",this))},"_handlePermissionLevelClicked":function(e){this._hidePopovers();var i=this.options.originatingView,t=e.cellView;if(!t.$el.data("binf.popover")){var s=a.get("EditPermission"),n={"model":t.model,"targetView":{"permissions":t},"originatingView":this.options.originatingView,"applyTo":i&&i.options.applyTo,"authUser":this.options.authUser,"admin_permissions":this.options.hasEditPermissionAction&&this.options.authUser&&this.options.authUser.get("privilege_user_admin_rights")&&"simple"!==this.options.originatingView.model.get("permissions_model")},o=t.$el.closest(".csui-table-row");if(o.addClass("active-row"),i&&i.trigger("block:view:actions"),s.enabled(n)){var c=s.execute(n);r.handleExecutionResults(c,{"command":s,"suppressSuccessMessage":n.suppressSuccessMessage,"suppressFailMessage":n.suppressFailMessage}).done(function(e){s.allowCollectionRefetch&&i.collection.totalCount>i.collection.topCount&&i&&i.collection.fetch()}).always(function(){i&&i.trigger("unblock:view:actions",t.options),o.removeClass("active-row"),i&&i.unblockActions(),t.$el.focus()})}else{var u=new l({"permissionModel":t.model,"popoverPlacement":"left","popoverAtBodyElement":!i||!i.options.originatingView||!(i&&i.options.originatingView.options.isExpandedView),"popoverTragetElement":t.$el,"readonly":!0,"originatingView":i});u.showCustomPermissionPopover(),u.listenTo(u,"closed:permission:level:popover",function(){u.destroy(),i&&i.trigger("unblock:view:actions"),t.$el.closest(".csui-table-row").removeClass("active-row")})}}},"_handlePermissionLevelFocus":function(e){this._hidePopovers();var i=this.options.originatingView,t=e.cellView;if(!t.$el.data("binf.popover")){t.$el.closest(".csui-table-row").addClass("active-row"),i&&i.trigger("block:view:actions");var s=new l({"permissionModel":t.model,"popoverPlacement":"left","popoverAtBodyElement":!i||!i.options.originatingView||!(i&&i.options.originatingView.options.isExpandedView),"popoverTragetElement":t.$el,"readonly":!0,"originatingView":i&&i});s.showCustomPermissionPopover(),s.listenTo(s,"closed:permission:level:popover",function(){s.destroy(),i&&i.trigger("unblock:view:actions"),t.$el.closest(".csui-table-row").removeClass("active-row"),t.$el.focus()})}},"_hidePopovers":function(){if(this.$el.parents("body")&&this.$el.parents("body").find(".csui-edit-permission-popover-container .binf-popover")){var e=this.$el.parents("body").find(".csui-edit-permission-popover-container .binf-popover");e.data("binf.popover")&&e.binf_popover("destroy")}}},{"hasFixedWidth":!1,"columnClassName":"csui-permission-level","widthFactor":1});return o.registerByColumnKey("permissions",d),d}),csui.define("csui/controls/table/cells/add.permission/add.permission.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/controls/table/cells/templated/templated.view","csui/controls/table/cells/cell.registry"],function(e,i,t,s,n,o){"use strict";var l=n.extend({"className":"csui-row-inlinetoolbar","events":{"keydown":"onKeyInView"},"onKeyInView":function(e){32!==e.keyCode&&13!==e.keyCode||document.activeElement===this.el&&(this.options.originatingView&&this.options.originatingView.trigger("permission:inlineaction:clicked",{"cellView":this}),this.$el.find("a.binf-dropdown-toggle").click(),e.preventDefault(),e.stopPropagation())},"renderValue":function(){var e=i.result(this,"className");e&&this.$el.addClass(e)},"constructor":function e(i){e.__super__.constructor.apply(this,arguments)}},{"hasFixedWidth":!0,"noTitleInHeader":!0,"isToolbar":!0,"columnClassName":"csui-add-permission","widthFactor":1/3});return o.registerByColumnKey("addpermissions",l),l}),csui.define("css!csui/controls/table/cells/versionnumber/impl/versionnumber",[],function(){}),csui.define("csui/controls/table/cells/versionnumber/versionnumber.view",["csui/controls/table/cells/templated/templated.view","csui/controls/table/cells/cell.registry","csui/utils/base","css!csui/controls/table/cells/versionnumber/impl/versionnumber"],function(e,i,t){"use strict";var s=e.extend({"className":"csui-nowrap","needsAriaLabel":!0},{"hasFixedWidth":!0,"columnClassName":"csui-table-cell-version_number_name"});return i.registerByColumnKey("version_number_name",s),s}),csui.define("csui/controls/table/cells/cell.factory",["csui/lib/underscore","csui/controls/table/cells/cell.registry","csui/controls/table/cells/text/text.view","csui/controls/table/cells/name/name.view","csui/controls/table/cells/date/date.view","csui/controls/table/cells/datetime/datetime.view","csui/controls/table/cells/duedate/duedate.view","csui/controls/table/cells/member/member.view","csui/controls/table/cells/node.state/node.state.view","csui/controls/table/cells/parent/parent.view","csui/controls/table/cells/priority/priority.view","csui/controls/table/cells/select/select.view","csui/controls/table/cells/toggledetails/toggledetails.view","csui/controls/table/cells/size/size.view","csui/controls/table/cells/status/status.view","csui/controls/table/cells/favorite/favorite.view","csui/controls/table/cells/favorite/favorite.name.view","csui/controls/table/cells/type.icon/type.icon.view","csui/controls/table/cells/user/user.view","csui/controls/table/cells/permission/permission.level.view","csui/controls/table/cells/add.permission/add.permission.view","csui/controls/table/cells/versionnumber/versionnumber.view","csui-ext!csui/controls/table/cells/cell.factory"],function(e,i,t,s){function n(){}return e.extend(n.prototype,{"hasCellViewByOtherKey":function(e){return i.hasCellViewByOtherKey(e)},"getCellView":function(e){return!0===e.get("isNaming")?s:i.getCellView(e)||t}}),new n}),csui.define("hbs!csui/controls/table/cells/searchbox/searchbox",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"1":function(e,i,t,s){return'class="search-box csui-table-searchbox" '},"3":function(e,i,t,s){return'class="search-box csui-table-searchbox\r\nbinf-hidden"'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){var n,o;return"<div "+(null!=(n=i.if.call(e,null!=e?e.show_input:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.program(3,s,0)}))?n:"")+'>\r\n  <input type="search" class="csui-table-search-input" placeholder="'+this.escapeExpression((o=null!=(o=i.search_placeholder||(null!=e?e.search_placeholder:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"search_placeholder","hash":{}}):o))+'"\r\n         title="'+this.escapeExpression((o=null!=(o=i.search_placeholder||(null!=e?e.search_placeholder:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"search_placeholder","hash":{}}):o))+'" value="'+this.escapeExpression((o=null!=(o=i.search_value||(null!=e?e.search_value:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"search_value","hash":{}}):o))+'">\r\n  <span class="fadeout csui-icon" title="'+this.escapeExpression((o=null!=(o=i.search_placeholder||(null!=e?e.search_placeholder:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"search_placeholder","hash":{}}):o))+'"></span>\r\n  <span class="sbclearer formfield_clear" role="button" aria-expanded="false"\r\n        title="'+this.escapeExpression((o=null!=(o=i.search_clear_icon_tooltip||(null!=e?e.search_clear_icon_tooltip:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"search_clear_icon_tooltip","hash":{}}):o))+'" aria-label="'+this.escapeExpression((o=null!=(o=i.search_clear_icon_tooltip||(null!=e?e.search_clear_icon_tooltip:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"search_clear_icon_tooltip","hash":{}}):o))+'"\r\n        tabindex="0"></span>\r\n</div>\r\n<div class="csui-table-search-icon" role="button" aria-expanded="false"\r\n     aria-label="'+this.escapeExpression((o=null!=(o=i.search_icon_tooltip||(null!=e?e.search_icon_tooltip:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"search_icon_tooltip","hash":{}}):o))+'" title="'+this.escapeExpression((o=null!=(o=i.search_icon_tooltip||(null!=e?e.search_icon_tooltip:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"search_icon_tooltip","hash":{}}):o))+'" tabindex="0">\r\n  <span class="icon icon-search"></span>\r\n</div>\r\n\r\n'}});return t.registerPartial("csui_controls_table_cells_searchbox_searchbox",s),s}),csui.define("css!csui/controls/table/cells/searchbox/searchbox",[],function(){}),csui.define("csui/controls/table/cells/searchbox/searchbox.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/marionette","i18n!csui/controls/table/impl/nls/lang","hbs!csui/controls/table/cells/searchbox/searchbox","css!csui/controls/table/cells/searchbox/searchbox"],function(e,i,t,s,n){return t.ItemView.extend({"className":"csui-table-column-search","template":n,"templateHelpers":function(){return{"search_value":this.lastFilterValue,"show_input":void 0!==this.lastFilterValue,"search_icon_tooltip":i.str.sformat(s.searchIconTooltip,this.options.columnTitle.toLowerCase()),"search_placeholder":i.str.sformat(s.searchPlaceholder,this.options.columnTitle.toLowerCase()),"search_clear_icon_tooltip":s.searchClearIconTooltip}},"ui":{"searchBox":".csui-table-searchbox","searchInput":".csui-table-search-input","clearer":".sbclearer","searchGlass":".icon-search","searchGlassContainer":".csui-table-search-icon"},"events":{"keyup @ui.searchInput":"filterChanged","keydown":"onKeyInView","paste @ui.searchInput":"filterChanged","change @ui.searchInput":"filterChanged","click @ui.searchInput":"_searchFieldInputClicked","click @ui.clearer":"_searchFieldClearerClicked","click @ui.searchGlassContainer":"_searchFieldGlassClicked","click":"_searchBoxClicked"},"constructor":function(e,i){this.options=i||{},t.ItemView.prototype.constructor.apply(this,arguments),this.lastFilterValue=e,this.lastFocused="I"},"onRender":function(){this.ui.searchBox.hasClass("binf-hidden")||(this.showClearerIfFilterHasValue(),this.triggerMethod("opened"),this.triggerMethod("changed:focus",this.lastFocused),this.setIconAndState())},"onDestroy":function(){this.filterTimeout&&(clearTimeout(this.filterTimeout),this.filterTimeout=void 0)},"onKeyInView":function(i){if(this.getShown()){if(27===i.keyCode)return void this.hideAndClear();switch(13!==i.keyCode&&32!==i.keyCode||(e(i.target).hasClass("sbclearer")&&this._searchFieldClearerClicked(i),e(i.target).hasClass("csui-table-search-icon")&&this._searchFieldGlassClicked(i)),this.lastFocused){case"I":var t=this.ui.searchInput[0].selectionStart,s=this.ui.searchInput.val();switch(i.keyCode){case 13:i.stopPropagation(),i.preventDefault(),s.length>0&&this.triggerMethod("change:filterValue",{"column":this.options.column,"keywords":s});break;case 37:t>0&&i.stopPropagation();break;case 39:s.length>0&&t<s.length?i.stopPropagation():(this._moveFocusRight(),i.stopPropagation(),i.preventDefault());break;case 35:this.ui.searchInput[0].selectionStart=s.length,this.ui.searchInput[0].selectionEnd=s.length,i.stopPropagation(),i.preventDefault();break;case 36:this.ui.searchInput[0].selectionStart=0,this.ui.searchInput[0].selectionEnd=0,i.stopPropagation(),i.preventDefault()}break;case"C":switch(i.keyCode){case 13:case 32:this._searchFieldClearerClicked(i);break;case 37:this.lastFocused="I",this.triggerMethod("changed:focus",this.lastFocused),i.stopPropagation(),i.preventDefault();break;case 39:this.lastFocused="G",this.triggerMethod("changed:focus",this.lastFocused),i.stopPropagation(),i.preventDefault()}break;case"G":switch(i.keyCode){case 13:case 32:this.hideAndClear(),i.stopPropagation(),i.preventDefault();break;case 37:this._moveFocusLeft(),i.stopPropagation(),i.preventDefault();break;case 39:i.preventDefault()}}}else 13!==i.keyCode&&32!==i.keyCode||(i.preventDefault(),i.stopPropagation(),this.showSearchInput())},"currentlyFocusedElement":function(){if(!this.getShown())return this.ui.searchGlassContainer;switch(this.lastFocused){case"I":return this.ui.searchInput;case"C":return this.ui.clearer;case"G":return this.ui.searchGlassContainer;default:return e()}},"setFocusToInput":function(){this.lastFocused="I",this.triggerMethod("changed:focus",this.lastFocused),this.ui.searchInput.focus()},"setFocusToGlass":function(){this.lastFocused="G",this.triggerMethod("changed:focus",this.lastFocused)},"showSearchInput":function(){this.ui.searchBox.removeClass("binf-hidden"),this.$el.addClass("csui-searchbox-shown"),this.setIconAndState(),this.setFocusToInput(),this.triggerMethod("opened")},"setIconAndState":function(){this.ui.searchGlassContainer.attr("title",s.collapseSearch),this.ui.searchGlassContainer.attr("aria-label",s.collapseSearchAria),this.ui.searchGlassContainer.attr("aria-expanded","true"),this.ui.searchGlass.addClass("icon-search-hide")},"hideAndClear":function(e){this.ui.searchBox.addClass("binf-hidden"),this.$el.removeClass("csui-searchbox-shown"),this.ui.searchGlassContainer.attr("title",this.templateHelpers().search_icon_tooltip),this.ui.searchGlassContainer.attr("aria-label",this.templateHelpers().search_icon_tooltip),this.ui.searchGlassContainer.attr("aria-expanded","false"),this.ui.searchGlass.removeClass("icon-search-hide"),this.lastFocused="I",this.filterTimeout&&(clearTimeout(this.filterTimeout),this.filterTimeout=void 0),this.ui.searchInput.val().length&&!e&&(this.ui.searchInput.val(""),this.triggerMethod("change:filterValue",{"column":this.options.column,"keywords":""})),this.lastFilterValue=void 0,this.triggerMethod("closed")},"toggleSearch":function(){this.ui.searchBox.hasClass("binf-hidden")?this.showSearchInput():this.hideAndClear()},"showClearerIfFilterHasValue":function(){var e=this.ui.searchInput.val(),i=!!e.length;return this.ui.clearer.toggle(i),e},"getColumn":function(){return this.options.column},"getValue":function(){return this.ui.searchInput.val()},"setValue":function(e){e&&e.length&&(this.ui.searchInput.val(e),this.lastFilterValue=e)},"getShown":function(){return!this.ui.searchBox.hasClass("binf-hidden")},"setFocus":function(){var e=this.ui.searchInput.val().length;this.lastFocused="I",setTimeout(i.bind(function(){this.ui.searchInput[0].setSelectionRange&&(this.ui.searchInput.focus(),this.ui.searchInput[0].setSelectionRange(e,e))},this),500)},"filterChanged":function(){var e=this.showClearerIfFilterHasValue();if(this.lastFilterValue!=e){this.lastFilterValue=e;var i=this;this.filterTimeout&&clearTimeout(this.filterTimeout),this.filterTimeout=setTimeout(function(){i.filterTimeout=void 0,i.triggerMethod("change:filterValue",{"column":i.options.column,"keywords":i.ui.searchInput.val()})},1e3)}},"_hasFilterValue":function(){return!!this.ui.searchInput.val().length},"_moveFocusLeft":function(){this._hasFilterValue()?(this.lastFocused="C",this.triggerMethod("changed:focus",this.lastFocused)):(this.lastFocused="I",this.triggerMethod("changed:focus",this.lastFocused))},"_moveFocusRight":function(){this._hasFilterValue()?(this.lastFocused="C",this.triggerMethod("changed:focus",this.lastFocused)):(this.lastFocused="G",this.triggerMethod("changed:focus",this.lastFocused))},"_searchFieldInputClicked":function(e){e.stopPropagation(),this.setFocusToInput()},"_searchFieldClearerClicked":function(e){e.preventDefault(),e.stopPropagation(),this.ui.searchInput.val(""),this.ui.clearer.hide(),this.lastFilterValue="",this.setFocusToInput(),this.triggerMethod("change:filterValue",{"column":this.options.column,"keywords":""})},"_searchFieldGlassClicked":function(e){e.stopPropagation(),this.toggleSearch()},"_searchBoxClicked":function(e){e.stopPropagation(),this.getShown()||this.toggleSearch()}})}),csui.define("csui/controls/table/inlineforms/inlineform.registry",["csui/lib/underscore"],function(e){function i(){this._addableTypes={}}return e.extend(i.prototype,{"getInlineFormView":function(e){return this._addableTypes[e]},"registerByAddableType":function(i,t){if(!e.isNumber(i))throw new Error("addableType key must be a number");this._addableTypes[i]=t}}),new i}),csui.define("csui/controls/table/inlineforms/folder/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/table/inlineforms/folder/impl/nls/root/lang",{"CancelButtonLabel":"Cancel","NewNamePlaceholder":"Enter name"}),csui.define("csui/controls/table/inlineforms/inlineform/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/table/inlineforms/inlineform/impl/nls/root/lang",{"EditCancelTooltip":"Cancel","CancelButtonLabel":"Cancel","SaveButtonLabel":"Save","AddButtonLabel":"Add","ExtendedAdd":"Extended add dialog","ExtendedAddAria":"Open extended add dialog","ActionFailedMessage":"Action failed"}),csui.define("css!csui/controls/table/inlineforms/inlineform/impl/inlineform",[],function(){}),csui.define("csui/controls/table/inlineforms/inlineform/impl/inlineform.view",["csui/lib/jquery","csui/lib/underscore","csui/utils/base","csui/utils/log","i18n!csui/controls/table/inlineforms/inlineform/impl/nls/lang","csui/lib/marionette","csui/models/nodechildren","csui/utils/commands/add.item.metadata","csui/utils/commands/properties","csui/models/nodes","csui/utils/commandhelper","csui/behaviors/keyboard.navigation/tabkey.behavior","csui/lib/jsonpath","css!csui/controls/table/inlineforms/inlineform/impl/inlineform"],function(e,i,t,s,n,o,l,r,a,c,u,d,h){return o.ItemView.extend({"className":"csui-inlineform","ui":{"inputFieldName":".csui-inlineform-input-name","cancelButton":".csui-btn-cancel","editCancelButton":".csui-btn-edit-cancel","saveButton":".csui-btn-save","metadataButton":".csui-btn-metadata"},"events":{"keyup @ui.inputFieldName":"keyReleased","paste @ui.inputFieldName":"mouseRightCicked","cut @ui.inputFieldName":"mouseRightCicked","focusin @ui.inputFieldName":"onFocusInWrite","keydown @ui.editCancelButton":"cancelEditKeyPressed","submit form":"saveClicked","click @ui.saveButton":"saveClicked","click @ui.cancelButton":"cancelClicked","click @ui.editCancelButton":"cancelClicked","click @ui.metadataButton":i.debounce(function(e){this.metadataIconClicked(e)},500),"keydown":"onKeyInView"},"behaviors":{"TabKeyBehavior":{"behaviorClass":d}},"_templateHelpers":function(){var e=this.model.get("csuiInlineFormErrorMessage"),i=!1;this.model.get("type");i=!this.model.get("name"),i=i||this.checkCustomFieldsModel();var t={"name":this.model.get("name"),"EditCancelTooltip":n.EditCancelTooltip,"CancelButtonLabel":n.CancelButtonLabel,"disableSavebtn":i,"SaveButtonLabel":this._isEditMode()?n.SaveButtonLabel:n.AddButtonLabel,"formModeIsEdit":this._isEditMode(),"haveErrorMessage":!!e,"extendedAdd":n.ExtendedAdd,"extendedAddAria":n.ExtendedAddAria};return t.haveErrorMessage&&(t.errorMessage=e),t},"constructor":function(e){this.options=e||{},o.ItemView.prototype.constructor.apply(this,arguments)},"onDomRefresh":function(){this.refershTabableElements();var e=this.model.get("csuiInlineFormErrorMessage");!!this.tabableElements&&!!this.tabableElements[0]&&this.tabableElements[0].focus(),this.ui.metadataButton.length&&(this.ui.metadataButton.attr("title",this.options.ExtendedAdd||n.ExtendedAdd),this.ui.metadataButton.attr("aria-label",this.options.ExtendedAddAria||n.ExtendedAddAria),void 0===this.options.AriaHasPopUp?this.ui.metadataButton.attr("aria-haspopup",!0):this.ui.metadataButton.attr("aria-haspopup",this.options.AriaHasPopUp)),!!e&&this.addInlineRole(e)},"cancelClicked":function(e){e.preventDefault(),e.stopPropagation(),this.cancel()},"onKeyInView":function(e){if(this.clearInlineRole(),9===e.keyCode)return this._moveTab(e),!0},"refershTabableElements":function(){this.tabableElements=this.$el.find("input:not([disabled]),  button:not([disabled])").filter(":visible").toArray()},"_moveTab":function(i){this.currentlyFocusedElementIndex=this.tabableElements.indexOf(i.target),i.shiftKey?this.currentlyFocusedElementIndex>0?(this.currentlyFocusedElementIndex-=1,e(this.tabableElements[this.currentlyFocusedElementIndex]).focus()):(this.currentlyFocusedElementIndex=this.tabableElements.length-1,e(this.tabableElements[this.currentlyFocusedElementIndex]).focus()):this.currentlyFocusedElementIndex<this.tabableElements.length-1?(this.currentlyFocusedElementIndex+=1,e(this.tabableElements[this.currentlyFocusedElementIndex]).focus()):(this.currentlyFocusedElementIndex=0,e(this.tabableElements[this.currentlyFocusedElementIndex]).focus()),i.stopPropagation(),i.preventDefault()},"saveClicked":function(e){if(e.preventDefault(),e.stopPropagation(),this.clearInlineRole(),this.model.get("id"))this._saveIfOk();else{var i=this;i.required=!1,i._getCategoryID().done(function(){i.required?i._openMetadataPage():i._saveIfOk()})}},"_getCategoryID":function(){var t=this,s=t.options.model.collection.node.get("id"),n=this.model.get("type"),o=t.options.model.connector,l=o.connection.url+"/forms/nodes/create?parent_id="+s+"&type="+n,r=e.Deferred(),a={"type":"GET","url":l},c=o.makeAjaxCall(a).done(i.bind(function(e){i.any(e.forms,function(e){if("categories"==e.role_name){var s=t._checkForAlpacaRequiredFields(e),n=h(e.schema.properties,"$..[?(@.required===true)]");i.isArray(n)&&n.length>0&&!s&&(t.required=!0)}}),t.model.attributes.forms=e,t.model.attributes.xhr=c,r.resolve()})).fail(function(e){r.reject()});return r.promise()},"_checkForAlpacaRequiredFields":function(e){var t=!0,s=e.data||e.get("data"),n=e.options||e.get("options"),o=e.schema||e.get("schema"),l=[],r=h(o,"$..[?(@.required===true)]",{"resultType":"PATH"}),a=h(n,"$..[?(@.validate===false)]",{"resultType":"PATH"}),c=[];i.each(a,function(e){var i=e.toString().match(/(\'[\w]*\')/g);i&&c.push(i[i.length-1].replace(/'/g,""))});var u=[];i.each(r,function(e){var i=e.toString().match(/(\'[\w]*\')/g);i&&u.push(i[i.length-1].replace(/'/g,""))});var d=function(e,i){var t=e.filter(function(e){return-1!=i.indexOf(e)});return t.length>0?t:i}(c,u);if(d){var p=!1;i.each(d,function(e){if(l=h(s,"$.."+e.toString(),{"resultType":"PATH"}.toArray),i.each(l,function(e){var s=function(e){if(e instanceof Array&&(null!==e||""!==e))i.each(e,function(e){s(e)});else if(null===e||""===e)return void(p=!0)};if(p)return void(t=!1);s(e)}),p)return void(t=!1)})}return t},"_openMetadataPage":function(){var e=this;e.viewToModelData();var t=new c;t.push(e.options.model);var s={"nodes":t,"container":e.options.model.collection.node,"collection":e.options.model.collection},n={"context":e.options.context};n=i.extend(n,{"addableType":e.constructor.CSSubType}),(new r).execute(s,n).then(function(i){if(delete e.model.inlineFormView,e.model.unset("csuiInlineFormErrorMessage",{"silent":!0}),e.trigger("editEnded",this),i.name)return e.model.fetch()}).fail(function(i){e.cancel()})},"cancelEditKeyPressed":function(e){this.clearInlineRole(),9===e.keyCode&&(e.shiftKey||(e.preventDefault(),e.stopPropagation(),this._saveIfOk()))},"onFocusInWrite":function(i){var t=e(i.target)[0],s=t.value,n=s?s.length:0;144===this.model.get("type")&&s.lastIndexOf(".")>0&&s.lastIndexOf(".")<s.length-1&&(n=s.lastIndexOf(".")),t.selectionEnd=n},"toggleButton":function(e){if(this.ui.saveButton.length){var i=this.ui.inputFieldName.val().trim(),t=!1;t=0!==i.length,t=t&&this.checkCustomFieldsInputVal(),t?this.ui.saveButton.removeAttr("disabled").addClass("binf-btn-default"):this.ui.saveButton.attr("disabled","disabled").removeClass("binf-btn-default")}this.refershTabableElements()},"checkCustomFieldsModel":function(){return!1},"checkCustomFieldsInputVal":function(){return!0},"mouseRightCicked":function(e){this.clearInlineRole();var i=this;setTimeout(function(){i.toggleButton(e)},100)},"keyReleased":function(e){if(this.leftInputFieldTimer&&clearTimeout(this.leftInputFieldTimer),27===e.keyCode)return this.cancel(),e.preventDefault(),void e.stopPropagation();this.toggleButton(e)},"cancel":function(e){e||(e={}),this.destroy(),void 0===this.model.get("id")?this.model.destroy():(delete this.model.inlineFormView,this.model.set("csuiInlineFormErrorMessage","dummy",{"silent":!0}),this.model.unset("csuiInlineFormErrorMessage",{"silent":e.silent}))},"_isEditMode":function(){return void 0!==this.model.get("id")},"viewToModelData":function(){this._viewToModelData(),this._viewToModelDataExtended()},"_viewToModelData":function(){this.model.set("name",this._getInputName(),{"silent":!0})},"_viewToModelDataExtended":function(){},"_getInputName":function(){var e=this.ui.inputFieldName,i=e.val();return i=i.trim()},"_saveIfOk":function(){},"_save":function(e){var t=this.options.originatingView;t&&t.blockActions&&t.blockActions();var s=void 0===this.model.get("id")?"_saveNewModel":"_updateModel",n=this[s](e);return t&&t.unblockActions&&n.always(i.bind(t.unblockActions,t)),n.done(i.bind(this.destroy,this)),n},"_updateModel":function(e){var t=this.model.inlineFormView;delete this.model.inlineFormView;var n=!1!==this.model.mustRefreshAfterPut?e:void 0,o=!1!==this.model.mustRefreshAfterPut?void 0:e,l=this,r=l.options.originatingView&&l.options.originatingView.thumbnailView;return this.model.save(o,{"data":n,"patch":!0,"wait":!0,"silent":!0,"skipSetValue":r}).then(function(){if(l.model.set(e,{"silent":!0}),!1!==l.model.mustRefreshAfterPut)return l.model.fetch();l.model.set("csuiInlineFormErrorMessage","dummy",{"silent":!0}),l.model.unset("csuiInlineFormErrorMessage")}).fail(function(n){l.model.inlineFormView=t;var o=i.keys(e),r=i.pick(i.clone(l.model.attributes),o);l.model.set(e,{"silent":!0});var a=l._getErrorMessageFromResponse(n);l.model.set("csuiInlineFormErrorMessage",a),s.error("Saving failed. ",a)&&console.error(s.last),l.model.set(r,{"silent":!0})})},"onRender":function(){var e=this,i=e.options.originatingView&&e.options.originatingView.thumbnailView;this.model.get("csuiInlineFormErrorMessage")&&i&&setTimeout(function(){var i=e.$el.find(".csui-inlineform-group-error").height(),t=e.$el.find(".csui-text-danger").height();e._isEditMode()?e.$el.addClass("csui-inlineform-edit"):e.$el.removeClass("csui-inlineform-edit"),i<t?e.$el.find(".binf-text-danger").addClass("add-ellipsis"):e.$el.find(".binf-text-danger").removeClass("add-ellipsis")})},"_saveNewModel":function(e){var t=this.model.inlineFormView;delete this.model.inlineFormView,this.model.set(e,{"silent":!0});var n=i.clone(this.model.attributes);delete n.hasMetadataRow,delete n.csuiInlineFormErrorMessage,delete n.forms,delete n.xhr;var o=this;return this.model.save(void 0,{"data":n,"wait":!0,"silent":!0}).then(function(){if(!1!==o.model.mustRefreshAfterPut)return o.model.fetch();o.model.set("csuiInlineFormErrorMessage","dummy",{"silent":!0}),o.model.unset("csuiInlineFormErrorMessage")}).fail(function(e){o.model.inlineFormView=t,o.model.trigger("error",o.model);var i=o._getErrorMessageFromResponse(e);o.model.set("csuiInlineFormErrorMessage",i),s.error("Saving failed. ",i)&&console.error(s.last)})},"_getErrorMessageFromResponse":function(i){var s;if(i&&i.responseJSON&&i.responseJSON.error)s=i.responseJSON.error;else{var n=t.MessageHelper.toHtml();t.MessageHelper.reset(),s=e(n).text()}return s},"metadataIconClicked":function(e){e.preventDefault(),e.stopPropagation(),this.clearInlineRole(),this.viewToModelData()
;var t=this,s=new c;s.push(this.model);var n={"nodes":s,"container":this.model.collection.node,"collection":this.model.collection},o={"context":this.options.context};if(void 0===this.model.get("id")){o=i.extend(o,{"addableType":this.constructor.CSSubType});(new r).execute(n,o).then(function(e){if(delete t.model.inlineFormView,t.model.unset("csuiInlineFormErrorMessage",{"silent":!0}),t.trigger("editEnded",this),e.name)return t.model.fetch()}).done(function(){t.options.originatingView.$el.find(".csui-nodetable .csui-new-item a.csui-table-cell-name-value").first().focus()}).fail(function(e){t.cancel(),t.options.originatingView.$el.find(".csui-addToolbar .binf-dropdown-toggle").focus()})}else{n=i.extend(n,{"originatingView":this.options.originatingView});(new a).execute(n,o).always(function(e){t.cancel()})}},"addInlineRole":function(e){this.ui.inputFieldName.attr("title",n.ActionFailedMessage+e),this.ui.inputFieldName.attr("role","alert")},"clearInlineRole":function(){!!this.model.get("csuiInlineFormErrorMessage")&&(this.ui.inputFieldName.attr("title",""),this.ui.inputFieldName.removeAttr("role"))}},{"CSSubType":void 0})}),csui.define("hbs!csui/controls/table/inlineforms/folder/impl/folder",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"1":function(e,i,t,s){return"csui-inlineform-error"},"3":function(e,i,t,s){var n;return this.escapeExpression((n=null!=(n=i.name||(null!=e?e.name:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"name","hash":{}}):n))+"\r\n  "},"5":function(e,i,t,s){var n;return this.escapeExpression((n=null!=(n=i.namePlaceholder||(null!=e?e.namePlaceholder:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"namePlaceholder","hash":{}}):n))},"7":function(e,i,t,s){var n;return'    <button type="button" class="csui-btn-edit-cancel binf-btn">\r\n      <span class="icon edit-cancel" title="'+this.escapeExpression((n=null!=(n=i.EditCancelTooltip||(null!=e?e.EditCancelTooltip:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"EditCancelTooltip","hash":{}}):n))+'"></span>\r\n    </button>\r\n'},"9":function(e,i,t,s){var n;return'    <button type="button" class="csui-btn-metadata binf-btn"><span\r\n        class="icon icon-toolbar-metadata"></span></button>\r\n    <div class="csui-inline-action-container">\r\n      <button type="submit" class="csui-btn-save csui-btn binf-btn"\r\n              disabled>'+this.escapeExpression((n=null!=(n=i.SaveButtonLabel||(null!=e?e.SaveButtonLabel:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"SaveButtonLabel","hash":{}}):n))+'</button>\r\n      <button type="button" class="csui-btn-cancel csui-btn binf-btn">'+this.escapeExpression((n=null!=(n=i.CancelButtonLabel||(null!=e?e.CancelButtonLabel:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"CancelButtonLabel","hash":{}}):n))+"</button>\r\n    </div>\r\n"},"11":function(e,i,t,s){var n;return'  <div class="csui-inlineform-group csui-inlineform-group-error" role="alert">\r\n    <div class="binf-text-danger" title="'+this.escapeExpression((n=null!=(n=i.errorMessage||(null!=e?e.errorMessage:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"errorMessage","hash":{}}):n))+'"><span class="csui-text-danger">'+this.escapeExpression((n=null!=(n=i.errorMessage||(null!=e?e.errorMessage:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"errorMessage","hash":{}}):n))+"</span></div>\r\n  </div>\r\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){var n,o;return'<form class="csui-inlineform-group csui-inlineform-group-folder-name">\r\n  <input type="text" value="'+this.escapeExpression((o=null!=(o=i.name||(null!=e?e.name:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"name","hash":{}}):o))+'" placeholder="'+this.escapeExpression((o=null!=(o=i.namePlaceholder||(null!=e?e.namePlaceholder:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"namePlaceholder","hash":{}}):o))+'"\r\n         class="binf-form-control csui-inlineform-input-name '+(null!=(n=i.if.call(e,null!=e?e.haveErrorMessage:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?n:"")+'"\r\n         aria-label="'+(null!=(n=i.if.call(e,null!=e?e.name:e,{"name":"if","hash":{},"fn":this.program(3,s,0),"inverse":this.program(5,s,0)}))?n:"")+'">\r\n'+(null!=(n=i.if.call(e,null!=e?e.formModeIsEdit:e,{"name":"if","hash":{},"fn":this.program(7,s,0),"inverse":this.program(9,s,0)}))?n:"")+"</form>\r\n"+(null!=(n=i.if.call(e,null!=e?e.haveErrorMessage:e,{"name":"if","hash":{},"fn":this.program(11,s,0),"inverse":this.noop}))?n:"")}});return t.registerPartial("csui_controls_table_inlineforms_folder_impl_folder",s),s}),csui.define("css!csui/controls/table/inlineforms/folder/impl/folder",[],function(){}),csui.define("csui/controls/table/inlineforms/generic/generic.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/marionette","i18n!csui/controls/table/inlineforms/folder/impl/nls/lang","csui/controls/table/inlineforms/inlineform.registry","csui/controls/table/inlineforms/inlineform/impl/inlineform.view","hbs!csui/controls/table/inlineforms/folder/impl/folder","css!csui/controls/table/inlineforms/folder/impl/folder"],function(e,i,t,s,n,o,l){var r=o.extend({"className":function(){var e="csui-inlineform-generic";return o.prototype.className&&(e+=" "+i.result(o.prototype,"className")),e},"template":l,"templateHelpers":function(){var e=this._templateHelpers();return i.extend(e,{"namePlaceholder":s.NewNamePlaceholder})},"ui":{},"events":{},"constructor":function(e){this.options=e||{},this.ui=i.extend({},this.ui,o.prototype.ui),this.events=i.extend({},this.events,o.prototype.events),t.ItemView.prototype.constructor.apply(this,arguments)},"_saveIfOk":function(){var e=this._getInputName(),i=this.model.get("name");e.length>0&&e===i?this.cancel():e.length>0&&this._save({"name":e})}},{"CSSubType":-1});return n.registerByAddableType(r.CSSubType,r),r}),csui.define("csui/controls/table/inlineforms/folder/folder.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/marionette","i18n!csui/controls/table/inlineforms/folder/impl/nls/lang","csui/controls/table/inlineforms/inlineform.registry","csui/controls/table/inlineforms/inlineform/impl/inlineform.view","hbs!csui/controls/table/inlineforms/folder/impl/folder","css!csui/controls/table/inlineforms/folder/impl/folder"],function(e,i,t,s,n,o,l){var r=o.extend({"className":function(){var e="csui-inlineform-folder";return o.prototype.className&&(e+=" "+i.result(o.prototype,"className")),e},"template":l,"templateHelpers":function(){var e=this._templateHelpers();return i.extend(e,{"namePlaceholder":s.NewNamePlaceholder})},"ui":{},"constructor":function(e){this.options=e||{},this.ui=i.extend({},this.ui,o.prototype.ui),this.events=i.extend({},this.events,o.prototype.events),t.ItemView.prototype.constructor.apply(this,arguments)},"_saveIfOk":function(){var e=this._getInputName(),i=this.model.get("name");e.length>0&&e===i?this.cancel():e.length>0&&this._save({"name":e}).fail(function(e){this.model.set({"name":i},{"silent":!0})}.bind(this))}},{"CSSubType":0});return n.registerByAddableType(r.CSSubType,r),r}),csui.define("csui/controls/table/inlineforms/shortcut/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/table/inlineforms/shortcut/impl/nls/root/lang",{"ShortcutPickerTitle":"Shortcut","ShortcutNamePlaceholder":"Enter a new Shortcut name","NameMustNotBeEmpty":"Shortcut name cannot be empty.","NoShortcutSelected":"No Shortcut target selected."}),csui.define("hbs!csui/controls/table/inlineforms/shortcut/impl/shortcut",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"1":function(e,i,t,s){var n;return'    <button type="button" class="csui-btn-edit-cancel binf-btn">\r\n      <span class="icon edit-cancel" title="'+this.escapeExpression((n=null!=(n=i.EditCancelTooltip||(null!=e?e.EditCancelTooltip:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"EditCancelTooltip","hash":{}}):n))+'"></span>\r\n    </button>\r\n'},"3":function(e,i,t,s){var n;return'    <button type="button" class="csui-btn-metadata binf-btn"><span\r\n        class="icon icon-toolbar-metadata"></span></button>\r\n    <div class="csui-inline-action-container">\r\n      <button type="submit" class="csui-btn-save csui-btn binf-btn\r\n    binf-btn-default">'+this.escapeExpression((n=null!=(n=i.SaveButtonLabel||(null!=e?e.SaveButtonLabel:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"SaveButtonLabel","hash":{}}):n))+'</button>\r\n      <button type="button" class="csui-btn-cancel csui-btn binf-btn">'+this.escapeExpression((n=null!=(n=i.CancelButtonLabel||(null!=e?e.CancelButtonLabel:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"CancelButtonLabel","hash":{}}):n))+"</button>\r\n    </div>\r\n"},"5":function(e,i,t,s){var n;return'  <div class="csui-inlineform-group csui-inlineform-group-error" role="alert">\r\n    <div class="binf-text-danger" title="'+this.escapeExpression((n=null!=(n=i.errorMessage||(null!=e?e.errorMessage:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"errorMessage","hash":{}}):n))+'"><span class="csui-text-danger">'+this.escapeExpression((n=null!=(n=i.errorMessage||(null!=e?e.errorMessage:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"errorMessage","hash":{}}):n))+"</span></div>\r\n  </div>\r\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){var n,o;return'<form class="csui-inlineform-group csui-inlineform-group-url-name">\r\n  <input type="text" value="'+this.escapeExpression((o=null!=(o=i.name||(null!=e?e.name:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"name","hash":{}}):o))+'" placeholder="'+this.escapeExpression((o=null!=(o=i.namePlaceholder||(null!=e?e.namePlaceholder:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"namePlaceholder","hash":{}}):o))+'"\r\n         class="binf-form-control csui-inlineform-input-name">\r\n'+(null!=(n=i.if.call(e,null!=e?e.formModeIsEdit:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.program(3,s,0)}))?n:"")+"</form>\r\n"+(null!=(n=i.if.call(e,null!=e?e.haveErrorMessage:e,{"name":"if","hash":{},"fn":this.program(5,s,0),"inverse":this.noop}))?n:"")}});return t.registerPartial("csui_controls_table_inlineforms_shortcut_impl_shortcut",s),s}),csui.define("css!csui/controls/table/inlineforms/shortcut/impl/shortcut",[],function(){}),csui.define("csui/controls/table/inlineforms/shortcut/shortcut.view",["csui/lib/underscore","csui/lib/marionette","i18n!csui/controls/table/inlineforms/shortcut/impl/nls/lang","csui/controls/table/inlineforms/inlineform.registry","csui/controls/table/inlineforms/inlineform/impl/inlineform.view","hbs!csui/controls/table/inlineforms/shortcut/impl/shortcut","css!csui/controls/table/inlineforms/shortcut/impl/shortcut"],function(e,i,t,s,n,o){var l=n.extend({"className":function(){var i="csui-inlineform-shortcut";return n.prototype.className&&(i+=" "+e.result(n.prototype,"className")),i},"template":o,"templateHelpers":function(){var i=this._templateHelpers();return e.extend(i,{"namePlaceholder":t.ShortcutNamePlaceholder})},"ui":{"inputFieldName":".csui-inlineform-input-name"},"events":{},"constructor":function(t){this.options=t||{},this.ui=e.extend({},this.ui,n.prototype.ui),this.events=e.extend({},this.events,n.prototype.events),i.ItemView.prototype.constructor.apply(this,arguments)},"_saveIfOk":function(){var e=this._getInputName();if(e&&e.length>0)if(void 0===this.model.get("original_id"))this.model.set("csuiInlineFormErrorMessage",t.NoShortcutSelected);else{var i;i=void 0===this.model.get("id")?{"name":e,"original_id":this.model.get("original_id")}:{"name":e},this._save(i)}else this.model.set("csuiInlineFormErrorMessage",t.NameMustNotBeEmpty)}},{"CSSubType":1});return s.registerByAddableType(l.CSSubType,l),l}),csui.define("csui/controls/table/inlineforms/url/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/table/inlineforms/url/impl/nls/root/lang",{"UrlNamePlaceholder":"Enter website name","UrlAddressPlaceholder":"Web address","UrlInvalidFormat":"The format of the Web address is invalid."}),csui.define("hbs!csui/controls/table/inlineforms/url/impl/url",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"1":function(e,i,t,s){return"hasError"},"3":function(e,i,t,s){return"csui-inlineform-error"},"5":function(e,i,t,s){return'      <span class="formfield_error csui-inlineform-input-error"></span>\r\n'},"7":function(e,i,t,s){return" "},"9":function(e,i,t,s){return"binf-btn-default "},"11":function(e,i,t,s){return" disabled "},"13":function(e,i,t,s){var n;return'  <div class="csui-inlineform-group csui-inlineform-group-error" role="alert">\r\n    <div class="binf-text-danger" title="'+this.escapeExpression((n=null!=(n=i.errorMessage||(null!=e?e.errorMessage:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"errorMessage","hash":{}}):n))+'"><span class="csui-text-danger">'+this.escapeExpression((n=null!=(n=i.errorMessage||(null!=e?e.errorMessage:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"errorMessage","hash":{}}):n))+"</span></div>\r\n  </div>\r\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){var n,o;return'<form>\r\n  <div class="binf-hidden-md binf-hidden-lg hidden-xl hidden-xxl\r\n       csui-inlineform-vertical-spacer"></div>\r\n  <div class="csui-inlineform-group csui-inlineform-group-url">\r\n    <input type="text" value="'+this.escapeExpression((o=null!=(o=i.name||(null!=e?e.name:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"name","hash":{}}):o))+'" placeholder="'+this.escapeExpression((o=null!=(o=i.namePlaceholder||(null!=e?e.namePlaceholder:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"namePlaceholder","hash":{}}):o))+'"\r\n           class="binf-form-control csui-inlineform-input-name '+(null!=(n=i.if.call(e,null!=e?e.validationFailed_Name:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?n:"")+'">\r\n    <input type="text" value="'+this.escapeExpression((o=null!=(o=i.url||(null!=e?e.url:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"url","hash":{}}):o))+'" placeholder="'+this.escapeExpression((o=null!=(o=i.urlPlaceholder||(null!=e?e.urlPlaceholder:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"urlPlaceholder","hash":{}}):o))+'"\r\n           class="binf-hidden-xs binf-hidden-sm binf-form-control csui-inlineform-input-url '+(null!=(n=i.if.call(e,null!=e?e.haveErrorMessage:e,{"name":"if","hash":{},"fn":this.program(3,s,0),"inverse":this.noop}))?n:"")+'">\r\n'+(null!=(n=i.if.call(e,null!=e?e.haveErrorMessage:e,{"name":"if","hash":{},"fn":this.program(5,s,0),"inverse":this.noop}))?n:"")+'    <button type="button" class="binf-hidden-xs\r\n    binf-hidden-sm csui-btn-metadata binf-btn">\r\n      <span class="icon icon-toolbar-metadata"></span></button>\r\n    <div class="csui-inline-action-container">\r\n      <button type="submit" class="binf-hidden-xs\r\n    binf-hidden-sm csui-btn-save csui-btn binf-btn\r\n            '+(null!=(n=i.if.call(e,null!=e?e.disableSavebtn:e,{"name":"if","hash":{},"fn":this.program(7,s,0),"inverse":this.program(9,s,0)}))?n:"")+'"\r\n        '+(null!=(n=i.if.call(e,null!=e?e.disableSavebtn:e,{"name":"if","hash":{},"fn":this.program(11,s,0),"inverse":this.noop}))?n:"")+">"+this.escapeExpression((o=null!=(o=i.SaveButtonLabel||(null!=e?e.SaveButtonLabel:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"SaveButtonLabel","hash":{}}):o))+'</button>\r\n      <button type="button" class="binf-hidden-xs binf-hidden-sm csui-btn-cancel csui-btn binf-btn\r\n            binf-btn-default">'+this.escapeExpression((o=null!=(o=i.CancelButtonLabel||(null!=e?e.CancelButtonLabel:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"CancelButtonLabel","hash":{}}):o))+'</button>\r\n    </div>\r\n\r\n  </div>\r\n  <div class="binf-hidden-md binf-hidden-lg hidden-xl hidden-xxl\r\n       csui-inlineform-vertical-spacer"></div>\r\n  <div class="binf-hidden-md binf-hidden-lg hidden-xl hidden-xxl csui-inlineform-group\r\ncsui-inlineform-group-url-wrapped">\r\n    <input type="text" value="'+this.escapeExpression((o=null!=(o=i.url||(null!=e?e.url:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"url","hash":{}}):o))+'" placeholder="'+this.escapeExpression((o=null!=(o=i.urlPlaceholder||(null!=e?e.urlPlaceholder:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"urlPlaceholder","hash":{}}):o))+'"\r\n           class="binf-form-control csui-inlineform-input-url '+(null!=(n=i.if.call(e,null!=e?e.haveErrorMessage:e,{"name":"if","hash":{},"fn":this.program(3,s,0),"inverse":this.noop}))?n:"")+'">\r\n    <button type="button" class="csui-btn-metadata binf-btn">\r\n      <span class="icon icon-toolbar-metadata"></span></button>\r\n    <div class="csui-inline-action-container">\r\n      <button type="submit" class="csui-btn-save csui-btn binf-btn\r\n            '+(null!=(n=i.if.call(e,null!=e?e.disableSavebtn:e,{"name":"if","hash":{},"fn":this.program(7,s,0),"inverse":this.program(9,s,0)}))?n:"")+'"\r\n        '+(null!=(n=i.if.call(e,null!=e?e.disableSavebtn:e,{"name":"if","hash":{},"fn":this.program(11,s,0),"inverse":this.noop}))?n:"")+">"+this.escapeExpression((o=null!=(o=i.SaveButtonLabel||(null!=e?e.SaveButtonLabel:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"SaveButtonLabel","hash":{}}):o))+'</button>\r\n      <button type="button"\r\n              class="csui-btn-cancel csui-btn binf-btn binf-btn-default">'+this.escapeExpression((o=null!=(o=i.CancelButtonLabel||(null!=e?e.CancelButtonLabel:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"CancelButtonLabel","hash":{}}):o))+'</button>\r\n    </div>\r\n  </div>\r\n  <div class="binf-hidden-md binf-hidden-lg hidden-xl hidden-xxl\r\n       csui-inlineform-vertical-spacer"></div>\r\n</form>\r\n'+(null!=(n=i.if.call(e,null!=e?e.haveErrorMessage:e,{"name":"if","hash":{},"fn":this.program(13,s,0),"inverse":this.noop}))?n:"")}});return t.registerPartial("csui_controls_table_inlineforms_url_impl_url",s),s}),csui.define("css!csui/controls/table/inlineforms/url/impl/url",[],function(){}),csui.define("csui/controls/table/inlineforms/url/url.view",["require","csui/lib/jquery","csui/lib/underscore","csui/lib/marionette","i18n!csui/controls/table/inlineforms/url/impl/nls/lang","csui/controls/table/inlineforms/inlineform.registry","csui/controls/table/inlineforms/inlineform/impl/inlineform.view","hbs!csui/controls/table/inlineforms/url/impl/url","css!csui/controls/table/inlineforms/url/impl/url"],function(e,i,t,s,n,o,l,r){var a=l.extend({"className":function(){var e="csui-inlineform-url";return l.prototype.className&&(e+=" "+t.result(l.prototype,"className")),e},"template":r,"templateHelpers":function(){var e=this._templateHelpers(),i=this.model.get("url");return t.extend(e,{"url":i,"namePlaceholder":n.UrlNamePlaceholder,"urlPlaceholder":n.UrlAddressPlaceholder})},"ui":{"urlFieldName":".csui-inlineform-input-url"},"events":{"keyup @ui.urlFieldName":"keyReleased"},"constructor":function(e){this.options=e||{},this.ui=t.extend({},this.ui,l.prototype.ui),this.events=t.extend({},this.events,l.prototype.events),this.relativeUrlRegexp=this.options.relativeUrlRegexp||/^\?func=[a-z0-9]/i,s.ItemView.prototype.constructor.apply(this,arguments)},"checkCustomFieldsInputVal":function(){return 0!==this._getInputUrl().trim().length},"checkCustomFieldsModel":function(){return!this.model.get("url")},"_viewToModelDataExtended":function(){this.model.set("url",this._getInputUrl(),{"silent":!0})},"_getInputUrl":function(){var e="";return this.ui.urlFieldName.each(t.bind(function(t,s){s.offsetHeight>0&&(e=i(s).val().trim(),e.length&&!e.match(this.relativeUrlRegexp)&&(e=e.match(/^[a-zA-Z]+:\/\//)?e:"http://"+e))},this)),e},"_saveIfOk":function(){var e=this._getInputName(),i=this._getInputUrl();if(e.length>0&&i.length>0)if(i.match(this.relativeUrlRegexp))this._save({"name":e,"url":i});else{var t=this;csui.require(["csui/lib/alpaca/js/alpaca"],function(s){var o=s.regexps.url;i.match(o)?t._save({"name":e,"url":i}):(t.model.set({"name":e,"url":i},{"silent":!0}),t.model.set("csuiInlineFormErrorMessage",n.UrlInvalidFormat))},function(e){t.model.set("csuiInlineFormErrorMessage",e.message)})}}},{"CSSubType":140});return o.registerByAddableType(a.CSSubType,a),a}),csui.define("csui/controls/table/inlineforms/collection/collection.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/marionette","csui/controls/table/inlineforms/inlineform.registry","csui/controls/table/inlineforms/folder/folder.view"],function(e,i,t,s,n){var o=n.extend({"className":function(){var e="csui-inlineform-collection";return n.prototype.className&&(e+=" "+i.result(n.prototype,"className")),e}},{"CSSubType":298});return s.registerByAddableType(o.CSSubType,o),o}),csui.define("csui/controls/table/inlineforms/inlineform.factory",["csui/lib/underscore","csui/controls/table/inlineforms/inlineform.registry","csui/controls/table/inlineforms/generic/generic.view","csui/controls/table/inlineforms/folder/folder.view","csui/controls/table/inlineforms/shortcut/shortcut.view","csui/controls/table/inlineforms/url/url.view","csui/controls/table/inlineforms/collection/collection.view","csui-ext!csui/controls/table/inlineforms/inlineform.factory"],function(e,i,t,s,n,o,l){function r(){}return e.extend(r.prototype,{"getInlineFormView":function(e){return i.getInlineFormView(e)}}),new r}),csui.define("hbs!csui/controls/table/rows/metadata/impl/metadatarow",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"1":function(e,i,t,s){var n,o;return'      <div class="binf-form-group binf-col-xs-12"\r\n           data-csui-attribute="'+this.escapeExpression((o=null!=(o=i.name||(null!=e?e.name:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"name","hash":{}}):o))+'">\r\n'+(null!=(n=i.if.call(e,null!=e?e.isRegion:e,{"name":"if","hash":{},"fn":this.program(2,s,0),"inverse":this.program(4,s,0)}))?n:"")+"      </div>\r\n"},"2":function(e,i,t,s){return'              <div title="'+this.escapeExpression(this.lambda(null!=e?e.label:e,e))+'" id="'+this.escapeExpression(this.lambda(null!=e?e.regionLabelId:e,e))+'"\r\n                     class="binf-col-xs-4 binf-col-sm-3 binf-col-md-2 binf-control-label">'+this.escapeExpression(this.lambda(null!=e?e.label:e,e))+'</div>\r\n\r\n              <div id="'+this.escapeExpression(this.lambda(null!=e?e.id:e,e))+'" class="binf-col-xs-8 binf-col-sm-9 binf-col-md-10\r\n              binf-form-control-static csui-content-view" aria-labelledby="'+this.escapeExpression(this.lambda(null!=e?e.regionLabelId:e,e))+'"></div>\r\n'},"4":function(e,i,t,s){var n;return'              <label for="'+this.escapeExpression(this.lambda(null!=e?e.id:e,e))+'" title="'+this.escapeExpression(this.lambda(null!=e?e.label:e,e))+'"\r\n                     class="binf-col-xs-4 binf-col-sm-3 binf-col-md-2 binf-control-label">'+this.escapeExpression(this.lambda(null!=e?e.label:e,e))+'</label>\r\n              <input id="'+this.escapeExpression(this.lambda(null!=e?e.id:e,e))+'" type="text" readonly value="'+this.escapeExpression(this.lambda(null!=e?e.value:e,e))+'"\r\n                     '+(null!=(n=i.if.call(e,null!=e?e.tooltip:e,{"name":"if","hash":{},"fn":this.program(5,s,0),"inverse":this.noop}))?n:"")+'\r\n                     class="binf-col-xs-8 binf-col-sm-9 binf-col-md-10 binf-form-control-static">\r\n'},"5":function(e,i,t,s){return'title="'+this.escapeExpression(this.lambda(null!=e?e.tooltip:e,e))+'"'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){var n;return'<div class="binf-row">\r\n  <div class="cs-form binf-form-horizontal">\r\n'+(null!=(n=i.each.call(e,null!=e?e.meta:e,{"name":"each","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?n:"")+"  </div>\r\n</div>"}});return t.registerPartial("csui_controls_table_rows_metadata_impl_metadatarow",s),s}),csui.define("css!csui/controls/table/rows/metadata/impl/metadatarow",[],function(){}),csui.define("csui/controls/table/rows/metadata/metadatarow.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/marionette","hbs!csui/controls/table/rows/metadata/impl/metadatarow","css!csui/controls/table/rows/metadata/impl/metadatarow","css!csui/controls/form/impl/form"],function(e,i,t,s){"use strict";return t.ItemView.extend({"className":"csui-table-metadata-view binf-container-fluid","template":s,"templateHelpers":function(){var e,t=this,s=[];return i.each(this.options.columns,function(i){e=new i.CellView({"context":this.options.context,"column":i,"model":this.options.model,"nameEdit":!1}),s=s.concat(this._getColumnAttributes(i,e))},this),this._contentViews=[],i.each(s,function(e){e.id=i.uniqueId(e.name),e.contentView&&(e.id=i.uniqueId(e.name),e.isRegion=!0,e.regionLabelId=i.uniqueId("rl_"+e.id),t._contentViews.push({"view":e.contentView,"regionElementId":e.id}))}),{"meta":s}},"_getColumnAttributes":function(e,t){var s=[];if(i.isFunction(t.getAttributes))s=t.getAttributes();else{var n=t.getValueText(),o=i.isFunction(t.getTooltipValueText)?t.getTooltipValueText():n;("size"!==e.name||0!==n&&null!==n&&""!==n)&&s.push({"label":e.title,"value":n,"tooltip":o,"name":e.name,"contentView":i.isFunction(t.getContentView)?t.getContentView():void 0})}return s},"constructor":function(e){t.ItemView.prototype.constructor.apply(this,arguments)},"onRender":function(){i.each(this._contentViews,function(e){var i=this.$el.find("#"+e.regionElementId);new t.Region({"el":i}).show(e.view)},this)},"currentlyFocusedElement":function(){return e()}})}),csui.define("hbs!csui/controls/table/rows/error/impl/errorrow",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){var n;return'<div class="binf-text-danger" title="'+this.escapeExpression((n=null!=(n=i.errorMessage||(null!=e?e.errorMessage:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"errorMessage","hash":{}}):n))+'><span class="csui-text-danger">'+this.escapeExpression((n=null!=(n=i.errorMessage||(null!=e?e.errorMessage:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"errorMessage","hash":{}}):n))+"</span></div>\r\n"}});return t.registerPartial("csui_controls_table_rows_error_impl_errorrow",s),s}),csui.define("css!csui/controls/table/rows/error/impl/errorrow",[],function(){}),csui.define("csui/controls/table/rows/error/errorrow.view",["csui/lib/underscore","csui/lib/marionette","hbs!csui/controls/table/rows/error/impl/errorrow","css!csui/controls/table/rows/error/impl/errorrow"],function(e,i,t){return i.ItemView.extend({"className":"csui-table-error-view binf-container-fluid","template":t,"templateHelpers":function(){return{"errorMessage":this.options.errorMessage?this.options.errorMessage:""}},"ui":{},"events":{},"constructor":function(e){this.options=e||{},i.ItemView.prototype.constructor.apply(this,arguments)}})}),csui.define("csui/controls/table/impl/table.header.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/marionette","csui/utils/base"],function(e,i,t,s){"use strict";function n(){this.accFocusedColumn>=this.displayedColumns.length&&(this.displayedColumns>0?this.accFocusedColumn=this.displayedColumns.length-1:this.accFocusedColumn=0)}return t.View.extend({"constructor":function i(t){i.__super__.constructor.apply(this,arguments),this._getActiveInlineForm=t._getActiveInlineForm,this.searchBoxes=t.searchBoxes,this.alternativeHeaderView=t.alternativeHeaderView,this.displayedColumns=t.displayedColumns,this.accFocusedColumn=t.accFocusedColumn||0,this.accSearchFocused=t.accSearchFocused||!1,this.alternativeHeaderView&&(this.listenTo(this.alternativeHeaderView,"focusout",function(t){var s,n,o=this.$(">tr>th:not(.csui-alternative-table-header)"),l=-1;if("left"===t.direction){for(s=0;s<o.length;s++)if(n=e(o[s]),n.hasClass(i.ClassNameColumnForAlternativeHeader)){l=s-1;break}}else for(s=o.length-1;s>0;s--)if(n=e(o[s]),n.hasClass(i.ClassNameColumnForAlternativeHeader)&&s+1<o.length){l=s+1;break}l>=0&&(this.accFocusedColumn=l),this._accSetFocusToCurrentlyFocusedElement()}),this.listenTo(this.alternativeHeaderView,"changed:focus",this._accSetFocusToCurrentlyFocusedElement))},"events":{"keydown":"onKeyInView"},"render":function(){this.triggerMethod("before:render",this);var e=this.$(">tr>th"),i=this.$(">tr>th>.csui-table-column-search");this._columnCount=e.length,this._searchBoxCount=i.length,this.triggerMethod("render",this)},"remove":function(){return this.stopListening(),this.undelegateEvents(),this},"currentlyFocusedElement":function(){n.call(this);var i=this._getColumnSelector(this.displayedColumns[this.accFocusedColumn]),t=this.$(i);if(t.is(":visible"))if(this.accSearchFocused){var s=this._findActiveSearchBoxView();t=s?s.currentlyFocusedElement():e()}else{var o=e(t[0]).find(".csui-focusable-table-column-header");o.length>0&&(t=o)}return t},"_getColumnSelector":function(e){return'tr>th[data-csui-attribute="'+e.attributes.column_key+'"]'},"_rightIsNextColumn":function(){var e=this.displayedColumns[this.accFocusedColumn],i=this._getColumnSelector(e),t=i+" .csui-table-column-search",s=this.$(t);return this.accSearchFocused||0===s.length},"onKeyInView":function(e){function i(){for(l=this.accFocusedColumn-1;l>=0;){if(t=this._getColumnSelector(this.displayedColumns[l]),s=this.$(t),s.is(":visible")&&s.find(".csui-focusable-table-column-header").length>0){this.accFocusedColumn=l,o=s.find(".csui-table-column-search"),this.accSearchFocused=o.length>0,this.accSearchFocused&&(r=this._findActiveSearchBoxView())&&r.getShown()&&r.setFocusToGlass();break}l--}}var t,s,n,o,l,r;if(!this._getActiveInlineForm())switch(e.keyCode){case 32:case 13:e.ctrlKey||e.metaKey||this.accSearchFocused||this.options.displayedColumns[this.accFocusedColumn].bSortable&&(e.preventDefault(),e.stopPropagation(),this.trigger("sorting:toggle",this.accFocusedColumn));break;case 37:this.accSearchFocused?(r=this._findActiveSearchBoxView(),r&&r.getShown()?i.call(this):this.accSearchFocused=!1):i.call(this),e.preventDefault(),e.stopPropagation(),this.trigger("closeOtherControls"),this._accSetFocusAfterTabableRegionActivated();break;case 39:if(this._rightIsNextColumn()){for(n=this.accFocusedColumn+1;n<this.displayedColumns.length;){if(t=this._getColumnSelector(this.displayedColumns[n]),s=this.$(t),this._isHeaderCellFocusable(s)){this.accFocusedColumn=n,this.accSearchFocused=!1;break}n+=1}r=this._findActiveSearchBoxView(),r&&r.getShown()&&(this.accSearchFocused=!0,r.setFocusToInput())}else this.accSearchFocused=!0,(r=this._findActiveSearchBoxView())&&r.getShown()&&r.setFocusToInput();e.preventDefault(),e.stopPropagation(),this.trigger("closeOtherControls"),this._accSetFocusAfterTabableRegionActivated();break;case 35:this.accFocusedColumn=this.displayedColumns.length-1,n=this.accFocusedColumn+1,o=this.$(">tr>th:nth-child("+n+") .csui-table-column-search"),this.accSearchFocused=o.length>0,this.accSearchFocused&&(r=this._findActiveSearchBoxView())&&r.getShown()&&r.setFocusToInput(),e.preventDefault(),e.stopPropagation(),this.trigger("closeOtherControls"),this._accSetFocusAfterTabableRegionActivated();break;case 36:this.accFocusedColumn=0,this.accSearchFocused=!1,e.preventDefault(),e.stopPropagation(),this.trigger("closeOtherControls"),this._accSetFocusAfterTabableRegionActivated();break;case 121:e.shiftKey&&(this.searchBoxes&&this.searchBoxes.length>0&&(r=this.searchBoxes[0],r.showSearchInput(),this.listenToOnce(r,"closed",this._accSetFocusAfterTabableRegionActivated)),e.stopPropagation(),e.preventDefault())}},"_accSetFocusToCurrentlyFocusedElement":function(){var i=this.currentlyFocusedElement();i.length>0&&(i=e(i[0]),this.trigger("changed:focus",this),s.isVisibleInWindowViewport(i)&&i.focus())},"_accSetFocusAfterTabableRegionActivated":function(){if(!this._getActiveInlineForm()){var e=this._findActiveSearchBoxView();e&&e.getShown()||this._accSetFocusToCurrentlyFocusedElement()}},"_accSearchBoxFocused":function(e){
this.accFocusedColumn=e.columnIndex,this.accSearchFocused=!0,this._accSetFocusToCurrentlyFocusedElement()},"_findActiveSearchBoxView":function(){var e=this.searchBoxes,t=this.displayedColumns,s=t[this.accFocusedColumn].name.toLowerCase();return i.find(e,function(e){return e.options.column===s})},"_isHeaderCellFocusable":function(e){return e.is(":visible")&&e.find(".csui-focusable-table-column-header").length>0}},{"ClassNameColumnForAlternativeHeader":"csui-undefined"})}),csui.define("csui/controls/table/impl/table.body.view",["csui/lib/jquery","csui/lib/marionette","csui/utils/focusable"],function(e,i,t){"use strict";function s(e){var i;return e&&(i=this._detailRowViewsByModelId[e.id||e.get("id")]),i||{"views":[]}}return i.View.extend({"constructor":function e(i){e.__super__.constructor.apply(this,arguments),this._getActiveInlineForm=i._getActiveInlineForm,this.startInlineFormForEdit=i.startInlineFormForEdit,this.collection=i.collection,this.displayedColumns=i.displayedColumns,this.nameColumnIndex=e.getNameColumnIndex(i.displayedColumns)||0,this.accFocusedCell=i.accFocusedCell||{"column":this.nameColumnIndex,"row":0},this.tableView=i.tableView},"ui":{"description":".csui-details-row-description"},"events":{"keydown":"onKeyInView","focus @ui.description":"descriptionRowFocus"},"render":function(){this.triggerMethod("before:render",this);var e=this.$el.parent().find("thead>tr>th");this._columnCount=e.length,this.triggerMethod("render",this)},"remove":function(){return this.stopListening(),this.undelegateEvents(),this},"currentlyFocusedElement":function(){if(!this.tableView.table)return e();if(this.accFocusedCell){var i=this.collection.at(this.accFocusedCell.row),n=s.call(this.tableView,i);if(void 0!==n.accFocusedViewIndex){var o=n.views[n.accFocusedViewIndex];return o.$el.is(":visible")?o.currentlyFocusedElement():e()}var l=e(this.tableView.table.row(this.accFocusedCell.row).node()),r=l.children()[this.accFocusedCell.column],a=t.findFocusables(r);return e(1===a.length?a[0]:r)}return e()},"onClickedCell":function(e){this.accFocusedCell.row=e.rowIndex,this.accFocusedCell.column=e.colIndex,this._accSetFocusAfterTabableRegionActivated()},"_findDetailRowFromEnd":function(){var e=this.collection.at(this.accFocusedCell.row),i=s.call(this.tableView,e);if(i.views.length>0)for(void 0===i.accFocusedViewIndex&&(i.accFocusedViewIndex=i.views.length-1);;){var t=i.views[i.accFocusedViewIndex];if(t.$el.is(":visible")){var n=t.currentlyFocusedElement();if(n.length>0)break}if(!(i.accFocusedViewIndex>0)){delete i.accFocusedViewIndex;break}i.accFocusedViewIndex--}},"onKeyInView":function(i){var t,n,o=e();if(!this._getActiveInlineForm())if(37===i.keyCode){for(;this.accFocusedCell.column>0&&(this.accFocusedCell.column--,!this._isCurrentBodyCellFocusable()););i.preventDefault(),i.stopPropagation(),this.trigger("closeOtherControls"),this._accSetFocusAfterTabableRegionActivated()}else if(38===i.keyCode){if(i.preventDefault(),i.stopPropagation(),this.trigger("closeOtherControls"),t=this.collection.at(this.accFocusedCell.row),n=s.call(this.tableView,t),void 0===n.accFocusedViewIndex){if(!(this.accFocusedCell.row>0))return;this.accFocusedCell.row--,this._findDetailRowFromEnd()}else n.accFocusedViewIndex>0?(n.accFocusedViewIndex--,this._findDetailRowFromEnd()):delete n.accFocusedViewIndex;this._accSetFocusAfterTabableRegionActivated()}else if(39===i.keyCode){for(;this.accFocusedCell.column<this.displayedColumns.length-1&&(this.accFocusedCell.column++,!this._isCurrentBodyCellFocusable()););i.preventDefault(),i.stopPropagation(),this.trigger("closeOtherControls"),this._accSetFocusAfterTabableRegionActivated()}else if(40===i.keyCode){t=this.collection.at(this.accFocusedCell.row),n=s.call(this.tableView,t);var l=n.accFocusedViewIndex;for(void 0===n.accFocusedViewIndex&&n.views.length>0&&(n.accFocusedViewIndex=-1);0===o.length;){if(void 0!==n.accFocusedViewIndex&&n.accFocusedViewIndex+1<n.views.length)n.accFocusedViewIndex=n.accFocusedViewIndex+1;else{if(!(this.accFocusedCell.row+1<this.collection.length)){n.accFocusedViewIndex=l;break}delete n.accFocusedViewIndex,this.accFocusedCell.row++,(t=this.collection.at(this.accFocusedCell.row))&&(n=s.call(this.tableView,t))}o=this.currentlyFocusedElement()}i.preventDefault(),i.stopPropagation(),this.trigger("closeOtherControls"),this._accSetFocusAfterTabableRegionActivated()}else 33===i.keyCode?(this.accFocusedCell.row=0,t=this.collection.at(this.accFocusedCell.row),n=s.call(this.tableView,t),delete n.accFocusedViewIndex,i.preventDefault(),i.stopPropagation(),this.trigger("closeOtherControls"),this._accSetFocusAfterTabableRegionActivated()):34===i.keyCode?(this.collection.length>0?(this.accFocusedCell.row=this.collection.length-1,t=this.collection.at(this.accFocusedCell.row),n=s.call(this.tableView,t),delete n.accFocusedViewIndex,this._findDetailRowFromEnd()):this.accFocusedCell.row=0,i.preventDefault(),i.stopPropagation(),this.trigger("closeOtherControls"),this._accSetFocusAfterTabableRegionActivated()):35===i.keyCode?(this.accFocusedCell.column=this.displayedColumns.length-1,i.preventDefault(),i.stopPropagation(),this.trigger("closeOtherControls"),this._accSetFocusAfterTabableRegionActivated()):36===i.keyCode?(this.accFocusedCell.column=0,i.preventDefault(),i.stopPropagation(),this.trigger("closeOtherControls"),this._accSetFocusAfterTabableRegionActivated()):113===i.keyCode&&(t=this.collection.at(this.accFocusedCell.row),t&&this.startInlineFormForEdit(t),i.preventDefault(),i.stopPropagation())},"descriptionRowFocus":function(i){e(i.target).find(".description-readmore, .description-showless").focus()},"_accSetFocusAfterTabableRegionActivated":function(){if(!this._getActiveInlineForm()){var i=this.currentlyFocusedElement();if(i.length>0){var t=e(i);this.trigger("changed:focus",this),this._isVisible(t)&&t.focus()}}},"_isVisible":function(i){return e(i).is(":visible")},"_isCurrentBodyCellFocusable":function(){return!("description"===this.displayedColumns[this.accFocusedCell.column].name&&!this.hasCustomDescriptionColumn)}},{"getNameColumnIndex":function(e){if(e)for(var i=0;i<e.length;i++){var t=e[i];if(t.isNaming)return i}}})}),csui.define("css!csui/controls/table/impl/table",[],function(){}),csui.define("csui/controls/table/table.view",["module","csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/lib/jquery.dataTables.bootstrap/js/dataTables.bootstrap","csui/lib/jquery.dataTables.tableTools/js/dataTables.tableTools","i18n!csui/controls/table/impl/nls/lang","csui/utils/log","csui/utils/base","csui/utils/focusable","csui/controls/tile/behaviors/perfect.scrolling.behavior","csui/behaviors/keyboard.navigation/tabable.region.behavior","csui/controls/table/cells/cell.factory","csui/models/nodechildrencolumn","csui/controls/progressblocker/blocker","csui/utils/contexts/factories/connector","csui/behaviors/default.action/impl/defaultaction","csui/controls/checkbox/checkbox.view","csui/controls/table/cells/select/select.view","csui/controls/table/cells/searchbox/searchbox.view","csui/controls/table/inlineforms/inlineform.factory","csui/controls/table/rows/metadata/metadatarow.view","csui/controls/table/rows/error/errorrow.view","csui/controls/table/impl/table.header.view","csui/controls/table/impl/table.body.view","csui/controls/mixins/view.events.propagation/view.events.propagation.mixin","csui/controls/toolbar/toolitems.filtered.model","csui/controls/toolbar/toolbar.command.controller","csui/controls/mixins/global.alert/global.alert.mixin","csui/models/mixins/v2.fields/v2.fields.mixin","i18n!csui/controls/table/cells/toggledetails/impl/nls/lang","css!csui/controls/table/impl/table","csui/lib/perfect-scrollbar","csui/lib/jquery.mousehover","csui/lib/jquery.scrollbarwidth","csui/lib/jquery.renametag"],function(e,i,t,s,n,o,l,r,a,c,u,d,h,p,m,f,g,b,v,w,y,_,C,T,x,k,S,I,V,A,M,E){"use strict";function D(e,t,s){var n=0,o=this.$el.find("thead th"),l=o.length;if(0===this.wrappedColumns.length&&o.last().hasClass("csui-table-cell-_toggledetails")&&(l-=1),s&&s.firstColumnIndex>=0){if(l>0&&s.firstColumnIndex<l){var r=i(t.children()[0]);s.lastColumnIndex&&s.lastColumnIndex>=s.firstColumnIndex&&(n=s.lastColumnIndex-s.firstColumnIndex+1,n>1&&r.attr("colspan",n),t.attr("style",""));for(var a=0;a<s.firstColumnIndex;a++)t.prepend("<td></td>");var c=l-s.firstColumnIndex-n;if(c>0)for(var u=0;u<c;u++)t.append("<td></td>")}}else{var d=i(e).children(),h=t.children();1===h.length&&d.length>1&&(n=d.length,0===this.wrappedColumns.length&&n>0&&(n-=1),h.attr("colspan",n))}}function F(e,i){var t=e.id||e.get("id"),s=this._detailRowViewsByModelId[t];s||(s={"views":[]},this._detailRowViewsByModelId[t]=s),s.views.push(i)}function P(e,t,s,n){var o,l=n.get("csuiErrorMessage");if(l){var r=new T({"errorMessage":l});r.render(),e.row(t).child(r.el,"csui-details-row").show(),i(s).addClass("csui-has-details-row"),o=e.row(t).child(),n.isLocallyCreated&&o.addClass("csui-new-item"),void 0!==n.get("id")&&o.addClass("csui-saved-item")}else{var a,c,u=[];if(ae)o=i();else{if(this.options.descriptionRowView&&n.get("description")&&n.get("description").length>0){var d=!1;this.options.descriptionRowViewOptions&&this.options.descriptionRowViewOptions.collapsedHeightIsOneLine&&(d=!0);var h=new this.options.descriptionRowView({"model":n,"collapsedHeightIsOneLine":d,"tableView":this});h.render(),c=i('<td class="csui-details-row"></td>'),a=i('<tr class="csui-details-row csui-details-row-description"></tr>'),c.appendTo(a),h.triggerMethod("before:show"),h.$el.appendTo(c),h.triggerMethod("show"),D.call(this,s,a,this.options.descriptionRowViewOptions),this.options.descriptionRowViewOptions&&(this.options.descriptionRowViewOptions.showDescriptions||a.addClass("binf-hidden")),h.triggerMethod("row:toggle",!!this.detailsRowsAreExpanded),this._detailRowsDescriptionTRs.push({"rowEl":a,"view":h}),F.call(this,n,h),u.push(a[0])}if(this.wrappedColumns.length>0){var p=new C({"context":this.context,"model":n,"columns":this.wrappedColumns});p.render(),c=i('<td class="csui-details-row"></td>'),a=i('<tr class="csui-details-row csui-details-row-metadata"></tr>'),c.appendTo(a),this.options.haveDetailsRowExpandCollapseColumn&&this.options.haveToggleAllDetailsRows?this.detailsRowsAreExpanded||this.expandedDetailRows[n.id||n.get("id")]?a.addClass("binf-collapse binf-in"):a.addClass("binf-collapse"):a.addClass("binf-collapse binf-in"),a.attr("id","csui-details-row-"+n.cid),p.triggerMethod("before:show"),p.$el.appendTo(c),p.triggerMethod("show"),D.call(this,s,a),n.set("hasMetadataRow",!0,{"silent":!0}),F.call(this,n,p),u.push(a[0])}else n.set("hasMetadataRow",!1,{"silent":!0});e.row(t).child(u,"csui-details-row").show(),o=e.row(t).child()}}return o.length>0&&i(s).addClass("csui-has-details-row"),o}function R(){function e(){this.res=this.collection.state.split("_"),this.order=this.order||[[]],s.foundcolumn=!1;var e=this.collection.state.substring(this.collection.state.indexOf("_")+1,this.collection.state.length).trim();return this.displayedColumns.some(function(i,t){if(i.name==e)return s.index=t,!0},this)?(this.order[0].push(this.index),this.order[0].push(this.res[0]),this.foundcolumn=!0):this.foundcolumn=!1,this.order}if(this.allColumns.length){this.trigger("creatingTable",{"sender":this});var s=this;s.hoveredRowDataId=void 0,this._detailRowsDescriptionTRs=[],this._detailRowViewsByModelId={};ee.call(this);var o=new c.Url(this.connector.connection.url).getOrigin(!0),l=c.Url.combine(o,this.connector.connection.supportPath),u=O.call(this);this.csuiDestroyRowCallbacks=[];var d=t.extend({"columns":t.map(this.displayedColumns,function(e){return e.attributes.initialSortingDescending&&(e.asSorting=["desc","asc"]),e}),"jQueryUI":!1,"autoWidth":!1,"deferRender":!0,"serverSide":!0,"language":s.localizableLabels,"ajax":function(e,i,t){if(!1!==this.refreshEnabled){var n=this.api();n.context.length>0&&(s.options.clientSideDataOperation?ne.call(s,n,e,t,i):se.call(s,n,e,t,i))}},"initComplete":function(e,i){s.trigger("tableFrameRendered",{"sender":s,"target":this[0]})},"drawCallback":function(e){var n=i(this);if(s.collection&&(0===s.collection.length||1===s.collection.length&&s.collection.at(0).inlineFormView?n.addClass("csui-table-empty"):n.removeClass("csui-table-empty")),ae&&(n.css("display","table"),n.find("thead").css("display","table-header-group"),n.find("tbody").css("display","table-row-group"),n.find("tr").css("display","table-row"),n.find("td,th").css("display","table-cell"),n.find("thead > tr").children().each(function(){var e=i(this);if(e.find(".csui-table-column-search").length){var t=i("<div>",{"style":"display: flex"});e.wrapInner(t)}}),n.parent().css({"display":"block","width":"100%","overflow-x":"auto"})),s.hoveredRowDataId=void 0,s.hoveredRow=void 0,s.options.haveDetailsRowExpandCollapseColumn&&s.options.haveToggleAllDetailsRows&&!n.find("td.csui-table-cell-_toggledetails > .expand-details-row-toggle").length&&s.collection.length){s.displayedColumns=t.filter(s.displayedColumns,function(e){return"_toggledetails"!==e.sName});n.find(".csui-table-cell-_toggledetails").remove()}n.find("thead th").each(function(){var e=i(this).attr("aria-label");e||(e=i(this).text()),e&&i(this).attr({"title":e});var t=i(this).find("> div").attr("aria-label");!i(this).attr("aria-label")&&t&&i(this).attr("aria-label",t)}),n.find("th[aria-sort]").each(function(){i(this).removeAttr("aria-sort")}),n.find("tr:not(.csui-details-row)").each(function(){i(this).find("> *").last().addClass("csui-table-cell-last-visible")}),s.trigger("tableBodyRendered",{"sender":s,"target":i("tbody",this)[0]}),s._plugHeaderBodyViews(),s.table&&setTimeout(function(){s.trigger("update:scrollbar")})},"headerCallback":function(e,n,o,l,a){if(!t.find(s.searchBoxes,function(e){return e.getShown()})){var c=[w.columnClassName,"csui-table-cell-_toggledetails"];i(e).find(">th").each(function(e){var n=i(this);if(s.displayedColumns.length>e){var o=s.displayedColumns[e],l=o.title,a=l;if(!0===o.noTitleInHeader&&(a=""),n.attr("data-csui-attribute",o.name),void 0===t.find(c,function(e){return n.hasClass(e)})){i(this).empty();var u,d;if(""===a)u=i('<div class="csui-focusable-table-column-header csui-empty"></div>').attr("aria-label",l),d=i('<div class="csui-table-column-text"></div>'),u.append(d),i(this).append(u);else{var h=a;s.displayedColumns[e].bSortable&&(h=t.str.sformat(r.NodeTableSortByAria,a)),u=i('<div class="csui-focusable-table-column-header"></div>').attr("aria-label",h),o.attributes.sort&&u.attr("role","button"),d=i('<div class="csui-table-column-text"></div>').text(a),u.append(d),i(this).append(u)}}}}),U.call(s,e),j.call(s,e);var u=this.api().order();if(u&&u.length>0&&u[0].length>1){var d=u[0],h=d[0],p=d[1],m="icon-sortArrowUnknown",f=s.displayedColumns.some(function(e){return e===s.allColumns[h]});"asc"===p?m="icon-sortArrowUp":"desc"===p&&(m="icon-sortArrowDown");var g='<span class="csui-sort-arrow '+m+'"></span>',b=s.$("th:eq("+h+")>.csui-focusable-table-column-header");f&&b.append(g)}G.call(s),s.trigger("tableHeaderRendered",{"sender":s,"target":e})}},"footerCallback":function(e,i,t,n,o){s.trigger("tableFooterRendered",{"sender":s,"target":e})},"rowCallback":function(e,r,a){function c(){var e=s._detailRowViewsByModelId||{};Object.keys(e).forEach(function(i){e[i].views.forEach(function(e){s.stopListening(e),e.destroy()})}),s._detailRowsDescriptionTRs=[],s._detailRowViewsByModelId={},s.hoveredRowDataId=void 0}function u(){t.each(f,function(e){s.stopListening(e),e.destroy()}),f=null}function d(e,t){void 0===t&&(t=i());var n=!0,o=e._DT_RowIndex;if(s.hoveredRowDataId&&s.hoveredRowDataId===o&&(n=!1),s.hoveredRowDataId=o,n){if(s.hoveredRow){i(s.hoveredRow).removeClass("csui-state-hover");s.table.row(s.hoveredRow).child().removeClass("csui-state-hover")}var l=s.table.row(e).data();if(l){if(void 0!==(l.id||l.get("id"))){var r={"sender":s,"targets":[e],"nodes":J.call(s,[e])};s.trigger("selectingTableRow",r),r.cancel||(s.hoveredRow=e,i(e).addClass("csui-state-hover"),t.addClass("csui-state-hover"))}}}}function h(e,t){void 0===t&&(t=i()),i(e).removeClass("csui-state-hover"),t.removeClass("csui-state-hover"),s.hoveredRowDataId=void 0,s.hoveredRow=void 0}var p=i(e),m=P.call(s,this.api(),a,e,r);r.get(w.isSelectedModelAttributeName)?(p.addClass("binf-active"),t.each(m,function(e){i(e).addClass("binf-active")})):(p.removeClass("binf-active"),t.each(m,function(e){i(e).removeClass("binf-active")})),r.isLocallyCreated&&(p.addClass("csui-new-item"),m.addClass("csui-new-item")),void 0!==r.get("id")?(p.addClass("csui-saved-item"),m.addClass("csui-saved-item"),r.set("inactive",!s.checkModelHasAction(r),{"silent":!0})):r.set("inactive",!0,{"silent":!0}),!0===r.get("isCut")&&(p&&p.addClass("csui-cut-row"),m&&m.addClass("csui-cut-row"));var f=[],g=void 0!==r.inlineFormView;g&&p.addClass("csui-table-row-shows-inlineform");var b,v=0,y=[];if(s.csuiDestroyRowCallbacks.push(u,c),t.each(s.displayedColumns,function(n,c){if(n.CellView){var u=i(p.children()[c]);if(s.cachedColumnWidths&&s.cachedColumnWidths[n.className]){var d=s.cachedColumnWidths[n.className];u.css(d)}var h={"el":u,"tableView":s,"column":n,"model":r,"context":s.context,"originUrl":o,"supportUrl":l,"nameEdit":s.options.nameEdit,"favoritesTableOptions":s.options.favoritesTableOptions,"rowIndex":a};"_toggledetails"===n.name&&(h.rowIsExpanded=s.detailsRowsAreExpanded||s.expandedDetailRows[r.id||r.get("id")]);var m=new n.CellView(h);"_toggledetails"===n.name&&s.listenTo(m,"toggle:detailsrow",function(e){var i=t.find(this._detailRowsDescriptionTRs,function(i){return i.view.model.cid===e.model.cid});i&&i.view.trigger("row:toggle",e.detailsRowIsExpanded),delete s.detailsRowsAreExpanded,z.call(s),s.expandedDetailRows[e.model.id||e.model.get("id")]=e.detailsRowIsExpanded,s.trigger("update:scrollbar")}),g?"type"===n.name?(m.render(),s.listenTo(m,"type:clicked",function(){s.triggerMethod("type:clicked")})):!n.isNaming&&"name"!==n.name||b?"_select"!==n.name&&(v++,y.push(u)):(v=1,b=u):m.render(),s.listenTo(m,"cellCloseOther",function(){s.cancelAnyExistingInlineForm(),s.trigger("closeOther",m),s.lockedForOtherContols=!0,t.each(f,function(e){e!==m&&e.triggerMethod("closeOther")})}),s.listenTo(m,"cellAllowOther",function(){s.trigger("allowOther",m),s.lockedForOtherContols=!1,t.each(f,function(e){e!==m&&e.triggerMethod("allowOther")})}),s.listenTo(m,"cancelEdit",function(){var e=s.collection.at(0);e&&void 0===e.get("id")&&(e.csuiIsRemoved=!0,s.collection.remove(e))}),s.listenTo(m,"show:add:favorite:form",function(){s._destroyInlineBar(),s.lockedForOtherContols=!0}),s.listenTo(m,"close:add:favorite:form",function(){s.lockedForOtherContols=!1}),a>=0&&(s.listenTo(m,"clicked:cell",function(e){s.trigger("clicked:cell",{"cellView":m,"rowIndex":a,"colIndex":c,"model":r})}),s.listenTo(m,"clicked:checkbox",function(i){if(!1!==r.get("selectable")){var t=L.call(s);"false"===i.checked?t.fnSelect(e):t.fnDeselect(e)}})),f.push(m)}}),g&&b&&v>1){t.each(y,function(e){e.remove()}),b.attr("colspan",v),b.addClass("csui-inlineform-parent"),s.trigger("closeOther"),r.inlineFormView&&(s.activeInlineForm&&s.activeInlineForm.destroy(),s.activeInlineForm=new r.inlineFormView({"model":r,"originatingView":s.options.originatingView,"context":s.context})),s.activeInlineForm.listenTo(s.activeInlineForm,"destroy",function(){s.lockedForOtherContols=!1,s.activeInlineForm.model.get("id")&&setTimeout(function(){s.accFocusedState.focusView="tableBody",s.trigger("changed:focus"),s.currentlyFocusedElement().focus()},1),delete s.activeInlineForm});new n.Region({"el":b}).show(s.activeInlineForm)}else p.mousehover(function(){var i={"sender":s,"target":e,"node":s.table.row(e).data()};s.trigger("enterTableRow",i)},function(){var i={"sender":s,"target":e,"node":s.table.row(e).data()};s.trigger("leaveTableRow",i)},{"namespace":s.cid}),p.mousehover(function(){d.call(s,e,m)},function(){h.call(s,e,m)},{"namespace":s.cid}),m.mousehover(function(){d.call(s,e,m)},function(){},{"namespace":s.cid});s.trigger("tableRowRendered",{"sender":s,"target":e,"node":r,"expandedRows":m})}},u);this.collection.state&&t.extend(d,{"order":e.call(this),"ordering":!0});var h=i("<table></table>").addClass("binf-table");if(ae||this.$el.addClass("csui-not-ready"),h.appendTo(this.el),this.table=h.DataTable(d),i(this.$el.children()[0]).attr("tabindex","-1"),W.call(this,u.selectedNodesById),this.collection.length>0&&void 0!==u.currentScollPosition&&this.$("tbody").scrollTop(u.currentScollPosition),this.$("tbody").on("scroll",function(){s.trigger("scroll")}),this.table.on("click",".csui-table-cell-default-action",function(e){oe.call(s,e,"DefaultPre")}).on("click","a#parentAction",function(e){oe.call(s,e,"Parent")}).on("click","a#menuAction",function(e){oe.call(s,e,"Menu")}).on("click","input[id^='selectAction']",function(e){e.stopPropagation(),i(e.target).closest("td,th").click()}).on("processing",function(e,i,t){B.call(s,i,t)}).on("destroy",function(e,i){N.call(s,i),Y.call(s),s._destroyTableHeaderAndBodyViews()}).on("preDraw",function(e,i){i.oFeatures.bServerSide&&!i.bDrawing||(Y.call(s),s.activeInlineForm&&s.activeInlineForm.destroy(),s._destroyTableHeaderAndBodyViews())}),h.on("order.dt",function(){s.table.order();if(s.displayedColumns){var e=[];t.each(s.table.order(),function(i){var t=i[0],n=s.displayedColumns[t].data(void 0,"orderBy");n&&(i[1]?e.push(n+" "+i[1]):e.push(n))}),e.length?s.collection.setOrder(e.join()):s.collection.resetOrder()}}),this.options.alternativeHeader){a.warn("Using of options.alternativeHeader with table.view is deprecated. Please use csui/controls/table.rowselection.toolbar/table.rowselection.toolbar.view instead and render this view ouside of table.view. The behavior csui/behaviors/table.rowselection.toolbar/table.rowselection.toolbar.behavior might help using it.")&&console.log(a.last),this.$el.find(".csui-table-alternative-header").remove();var p=i('<div class="csui-table-alternative-header"></div>');this.$el.prepend(p),this._alternativeHeaderRegion=new n.Region({"el":p});var m=this._createAlternativeHeaderView();this._alternativeHeaderRegion.show(m),this.triggerMethod("alternativeHeader:show",m),this.listenTo(m,"childview:toolitem:action",this._toolbarItemClicked)}this.trigger("tableCreated",{"sender":this})}}function B(e,t){this.disablingOverlay||(this.disablingOverlay=i("<div id='disabling_overlay'></div>").hide().prependTo(this.table)),t?this.disablingOverlay.show():this.disablingOverlay.hide()}function N(e){this.disablingOverlay&&(this.disablingOverlay.remove(),this.disablingOverlay=void 0)}function L(){return this.tableTools||(this.tableTools=l.fnGetInstance(this.table.table().node()))}function O(){var e;switch(this.options.paginationStyle){case"all_buttons":e={"pagingType":"full_numbers"};break;case"two_buttons":e={"pagingType":"two_button"};break;case"infinite_scrolling":e={"scrollCollapse":!0,"scrollY":this.options.pageSize?25*this.options.pageSize-1+"px":"249px"};break;default:e={"paging":!1}}this.recreated||(this.recreated=this.columns.length||this.columns.fetched),e.order=$.call(this,this.collection.orderBy),e.ordering=H.call(this);var s;switch(this.options.selectRows){case"single":s="single";break;case"multiple":s="multi";break;default:s="none",this.options.selectAllColumnHeader=!1,this.options.selectColumn=!1}if("none"===s)e.dom='<"H"lfr>t<"F"ip>';else{e.dom='<"H"lTfr>t<"F"ip>';var o=this;e.tableTools={"aButtons":[],"sRowSelect":s,"fnPreRowSelect":function(e,t,s){function l(){var e=J.call(o,t),i={"sender":o,"targets":t,"nodes":e};return o.trigger(s?"selectingTableRow":"unselectingTableRow",i),!i.cancel}if(!o._rebuildingTable){if(n.triggerMethodOn(o.tableBodyView,"before:render"),t&&t.length>0){if(function(){var e=o.table.row(t[0]).data();if(!e.inlineFormView){var i={"sender":o,"target":t[0],"node":e};return o.triggerMethod("row:clicked",i),!i.cancel}}()){if(o.options.selectColumn&&o.options.selectAllColumnHeader){return!!(!(e&&e.target)||i(e.target).hasClass(w.columnClassName))&&l()}return l()}return!1}return!0}},"fnRowSelected":function(e){o._rebuildingTable||t.isArray(e)&&e.length>0&&(t.each(e,function(e){var t=o.table.row(e).data();i(e);t.set(w.isSelectedModelAttributeName,!0)}),K.call(o),n.triggerMethodOn(o.tableBodyView,"render"),o.trigger("closeOther"),o.selectedChildren.reset(o.getSelectedChildren()),o.trigger("tableRowSelected",{"sender":o,"targets":e,"nodes":J.call(o,e)}))},"fnRowDeselected":function(e){o._rebuildingTable||t.isArray(e)&&e.length>0&&(t.each(e,function(e){var t=o.table.row(e).data();i(e);t.set(w.isSelectedModelAttributeName,!1)}),K.call(o),n.triggerMethodOn(o.tableBodyView,"render"),o.selectedChildren.reset(o.getSelectedChildren()),o.trigger("tableRowUnselected",{"sender":o,"targets":e,"nodes":J.call(o,e)}))}}}return e.searching||e.lengthChange||(e.dom=e.dom.replace('"H"',"").replace("l","").replace("f","")),e.info||e.pagingType||(e.dom=e.dom.replace('"F"',"").replace("i","").replace("p","")),te.call(this,e),e}function $(e){var i=[];return e&&(i=t.map(e.split(","),function(e){e=e.split(" ");var i=e[0],t=X.call(this,i);if(void 0!==t&&(i=this.displayedColumns[t].attributes.column_key,this.columns.findWhere({"column_key":i}).get("sort")))return[t,e[1]||"asc"]},this)),t.filter(i,function(e){return!!e})}function H(){return!0===this.options.enableSorting&&!!t.find(this.displayedColumns,function(e){return e.attributes&&!0===e.attributes.sort})}function z(){this.toggleExpandDetailsRowEl&&(this.detailsRowsAreExpanded?(this.toggleExpandDetailsRowEl.removeClass("icon-expandArrowDown"),this.toggleExpandDetailsRowEl.addClass("icon-expandArrowUp"),this.toggleExpandDetailsRowEl.attr("title",E.collapseAllTooltip),this.toggleExpandDetailsRowEl.attr("aria-label",E.collapseAllAria)):(this.toggleExpandDetailsRowEl.removeClass("icon-expandArrowUp"),this.toggleExpandDetailsRowEl.addClass("icon-expandArrowDown"),this.toggleExpandDetailsRowEl.attr("title",E.expandAllTooltip),this.toggleExpandDetailsRowEl.attr("aria-label",E.expandAllAria)))}function U(e){function s(e){e.stopPropagation(),e.preventDefault(),this.detailsRowsAreExpanded=!this.detailsRowsAreExpanded,this._clearExpandedRows(),this._detailRowsDescriptionTRs=[],z.call(this),this._drawTable(),this.options.descriptionRowViewOptions&&this.options.descriptionRowViewOptions.showDescriptions?this.showDetailRowDescriptions(!0):this.trigger("dom:refresh"),this._adjustColumns()}var n,o,l=this;this.options.haveDetailsRowExpandCollapseColumn&&this.options.haveToggleAllDetailsRows&&(n=i("th.csui-table-cell-_toggledetails",e),n.length>0&&(o=i("a",n),o.length?(this.toggleExpandDetailsRowEl=o.find(".csui-button-icon"),z.call(this)):this.collection.length?(n.addClass("csui-table-cell-_toggledetails"),o=i('<a class="csui-focusable-table-column-header expand-details-row-toggle" title="'+E.expandAllTooltip+'" aria-label="'+E.expandAllAria+'" href="#" aria-expanded="false"><span class="csui-button-icon icon-expandArrowDown"></span></a>'),this.toggleExpandDetailsRowEl=o.find(".csui-button-icon"),z.call(this),o.prependTo(n),n.click(t.bind(s,this)),o.click(t.bind(s,this)),n.keypress(function(e){var i=e.keyCode||e.charCode;e.ctrlKey||e.metaKey||32!==i&&13!==i||s.call(l,e)})):o.remove()))}function j(e){function t(){var e,i,t=[],n=[],o=[],r=[];if(l._selectAllCheckboxRegion&&l._selectAllCheckboxRegion.currentView){s.trigger("closeToggleAction");switch(l._selectAllCheckboxRegion.currentView.model.get("checked")){case"true":l.collection.each(function(t){t.get(w.isSelectedModelAttributeName)&&(e=l.collection.indexOf(t),i=l.table.row(e),r.push(t),o.push(i.node())),t.set(w.isSelectedModelAttributeName,!1)});break;default:l.collection.each(function(s){!1!==s.get("selectable")?(s.get(w.isSelectedModelAttributeName)||(e=l.collection.indexOf(s),i=l.table.row(e),n.push(s),t.push(i.node())),s.set(w.isSelectedModelAttributeName,!0)):(s.get(w.isSelectedModelAttributeName)&&(e=l.collection.indexOf(s),i=l.table.row(e),r.push(s),o.push(i.node())),s.set(w.isSelectedModelAttributeName,!1))})}l.selectedChildren.reset(l.getSelectedChildren()),K.call(this),o.length>0&&l.trigger("tableRowUnselected",{"sender":l,"targets":o,"nodes":r}),t.length>0&&l.trigger("tableRowSelected",{"sender":l,"targets":t,"nodes":n}),l.trigger("dom:refresh")}}function o(){var e=u.findFocusables(c.el);i(e).addClass("csui-focusable-table-column-header")}var l=this,a=i("th:first-child",e);if(0!==a.length&&this.options.selectColumn&&this.options.selectAllColumnHeader){if(!this._selectAllCheckboxRegion){var c=new v({"checked":!1,"disabled":!1,"ariaLabel":r.selectAllAria,"title":r.selectAll});this.listenTo(c,"clicked",function(e){e.cancel=!0,t.call(l)}),this.listenTo(c,"render",function(){o()}),this._selectAllCheckboxRegion=new n.Region({"el":a}),this._selectAllCheckboxRegion.show(c),o()}if(this.collection.length){this._selectAllCheckboxRegion.currentView.setDisabled(!1);this.collection.where({"csuiIsSelected":!0}).length>0&&K.call(this)}else this._selectAllCheckboxRegion.currentView.setDisabled(!0)}}function q(){t.each(this.searchBoxes,function(e){e.destroy()}),this.searchBoxes.splice(0,this.searchBoxes.length)}function G(){var e=this;q.call(e),this.$("thead th").each(function(s){if(0===i(this).find(".csui-table-column-search").length&&e.displayedColumns.length>s){var n=e.displayedColumns[s].name.toLowerCase(),o=e.displayedColumns[s].title;!0===e.displayedColumns[s].noTitleInHeader&&(o="");if(t.indexOf(e.columnsWithSearch,n)>-1||!0===e.displayedColumns[s].filterable){var l=e.displayedColumns[s].data&&e.displayedColumns[s].data(void 0,"filterBy"),a=new y(e.collection.filters&&e.collection.filters[n],{"column":l,"columnTitle":o});e.searchBoxes.push(a),a.on("change:filterValue",function(i){e.applyFilter(i)});var c=i(this).find(".csui-table-column-search"),u=i(this).find(".csui-table-column-text"),d=i(this).find(".csui-sort-arrow");a.on("opened",function(){u.addClass("binf-hidden"),d.addClass("binf-hidden"),e.searchColumn=n}),a.on("closed",function(){u.removeClass("binf-hidden"),d.removeClass("binf-hidden"),e.collection.filters[n]=void 0}),a.on("changed:focus",function(){e.tableCaptionView&&e.tableCaptionView._accSearchBoxFocused({"columnName":n,"columnIndex":s})}),a.render(),i(this).append(a.el),n===e.searchColumn&&a.setFocus(),c=i(this).find(".csui-table-column-search"),c&&c.attr("aria-label",t.str.sformat(r.searchIconTooltip,o.toLowerCase()))}}})}function W(e){this.table&&e&&t.each(this.table.rows(),function(i){t.each(i,function(i){var t=this.table.row(i).data(),s=t.id||t.get("id");if(e[s]){var n=L.call(this),o=this.table.row(i).node();n.fnSelect(o)}},this)},this)}function K(){if(this._selectAllCheckboxRegion&&this._selectAllCheckboxRegion.currentView){var e=this._selectAllCheckboxRegion.currentView,i=this.collection.filter(function(e){return e.get(w.isSelectedModelAttributeName)}),t=this.table?this.table.rows().nodes():this.collection,s=i.length===t.length;i.length>0&&!s?e.setChecked("mixed"):e.setChecked(i.length>0)}}function J(e){return t.map(e,function(e){var i=this.table.row(e).index();return this.table.row(i).data()},this)}function X(e){e=e.toLowerCase();var i;return t.find(this.displayedColumns,function(t,s){if(t.attributes.sort_key===e||t.name.toLowerCase()===e||t.attributes.column_key===e)return i=s,!0}),i}function Z(e,i){var s=e.options;if(s.selectColumn&&i.unshift(new m({"column_key":"_select","name":"","sortable":!1,"alignment":"center","permanentColumn":!0})),s.additionalColumns&&s.additionalColumns.length>0&&t.each(s.additionalColumns,function(e,t){i.push(new m(e))}),ae){i.some(function(e){return"description"===e.get("column_key")})||i.push(new m({"column_key":"description","name":r.descriptionColumnTitle,"sortable":!1,"permanentColumn":!0}))}return s.haveDetailsRowExpandCollapseColumn&&i.push(new m({"column_key":"_toggledetails","name":"","sortable":!1,"alignment":"center","permanentColumn":!0})),i}function Q(){this.table&&(this.trigger("destroyingTable",{"sender":this}),this._inlineBarShouldDestroy(),q.call(this),this._alternativeHeaderRegion&&(this._alternativeHeaderRegion.empty(),
delete this._alternativeHeaderRegion),this._selectAllCheckboxRegion&&(this._selectAllCheckboxRegion.empty(),delete this._selectAllCheckboxRegion),delete this._detailRowsDescriptionTRs,delete this._detailRowViewsByModelId,this.table.destroy(),ee.call(this),delete this.table,delete this.tableTools,this.trigger("tableDestroyed",{"sender":this}))}function Y(){t.each(this.csuiDestroyRowCallbacks,function(e){e()}),this.csuiDestroyRowCallbacks=[]}function ee(){i("> table , > #message",this.$el).remove()}function ie(){var e=this.collection,i=this.table.rows(".selected").data(),s={};t.each(i,function(e){s[e.id||e.get("id")]=!0}),this.stateBeforeRebuild={"pageLength":e?e.topCount:this.options.pageSize,"selectedNodesById":s,"currentScollPosition":this.$("tbody").scrollTop()}}function te(e){this.stateBeforeRebuild&&(t.extend(e,this.stateBeforeRebuild),delete this.stateBeforeRebuild)}function se(e,i,t,s){if(!1!==this.refreshEnabled&&(this.columns.length||this.columns.fetched)){le.call(this,i,t)&&this.collection.fetch();var n={"sEcho":re(i,"sEcho"),"data":this.collection.models};this.trigger("settingServerData",{"sender":this,"result":n}),s(n)}}function ne(e,i,t,s){if(this.options.clientSideDataOperation){le.call(this,i,t);var n={"sEcho":re(i,"sEcho"),"data":this.collection.models};this.trigger("settingServerData",{"sender":this,"result":n}),s(n)}}function oe(e,t){e.preventDefault(),e.stopPropagation();var s=i(e.target),n=s.closest("tr"),o=n[0]._DT_RowIndex;if(void 0!==o){var l=this.table.row(o).data();this.trigger("click"+t+"Action",{"sender":this,"target":s[0],"node":l,"event":e})}}function le(e,i){var s=i.aoColumns,n=[],o=i.oInstance.api(),l=o.table();return t.each(l.order(),function(e){var i=e[0],t=s[i].data(void 0,"orderBy");t&&(e[1]?n.push(t+" "+e[1]):n.push(t))}),!!n.length&&this.collection.setOrder(n.join(),!1)}function re(e,i){return e?e[i]:void 0}a=a(e.id);var ae=/\baccessibleTable\b(?:=([^&]*)?)?/i.exec(location.search);ae=ae&&"false"!==ae[1];var ce=n.View.extend({"className":"csui-nodetable","constructor":function(e){if(this.accFocusedState={"focusView":"tableBody","headerColumn":0,"body":{"column":0,"row":0}},e||(e={}),this.context=e.context,this.expandedDetailRows={},this._showEmptyViewText=!0,this.columnHeadersVisible=!0,this.columnsWithSearch=e.columnsWithSearch||[],t.each(this.columnsWithSearch,t.bind(function(e,i){this.columnsWithSearch[i]=this.columnsWithSearch[i].toLowerCase()},this)),this.searchBoxes=[],e.filterBy&&t.each(e.filterBy,t.bind(function(i,t){e.collection.filters&&(e.collection.filters[t]=i)},this)),e.actionItems&&e.commands?(this.defaultActionController=new b({"actionItems":e.actionItems,"commands":e.commands}),this.checkModelHasAction=this.defaultActionController.hasAction.bind(this.defaultActionController)):this.checkModelHasAction=function(){return!0},this.additionalColumns=e.additionalColumns||[],!e.collection)throw new Error("table.view options require a collection to be set");if(n.View.prototype.constructor.apply(this,arguments),t.defaults(this.options,{"orderBy":"name asc","enableSorting":!0,"selectColumn":!0,"haveToggleAllDetailsRows":!0,"haveDetailsRowExpandCollapseColumn":!0,"selectRows":"multiple","selectAllColumnHeader":!0,"nameEdit":!0,"maxColumnsDisplayed":25}),ae&&(this.options.haveToggleAllDetailsRows=!1,this.options.haveDetailsRowExpandCollapseColumn=!1),this.collection.setOrder(this.options.orderBy,!1),delete this.options.orderBy,this.options.blockingParentView?f.delegate(this,this.options.blockingParentView):f.imbue(this),this.connector=this.options.connector,this.connector||(this.connector=this.context.getObject(g)),this.columns=this.options.columns,!this.columns&&(this.columns=this.collection.columns,!this.columns))throw new Error("table.view options require columns or collection.columns to be set");this._ViewCollection=s.Collection.extend({"model":this.collection.model}),this.selectedChildren=new this._ViewCollection,this.listenTo(this.selectedChildren,"reset",function(){this._showOrHideAlternativeHeaderView()}),this.listenTo(this.collection,"reset",this._handleModelsReset).listenTo(this.collection,"update",this._handleModelsUpdate).listenTo(this.collection,"remove",this._handleModelRemove).listenTo(this.collection,"change",this.updateRow).listenTo(this.collection,"request",this.blockActions).listenTo(this.collection,"sync",this.unblockActions).listenTo(this.collection,"sync",this._handlePendingFilter).listenTo(this.collection,"new:page",this.resetScrollToTop).listenTo(this.collection,"reset",this._updateSelectedChildren).listenTo(this.collection,"remove",this._updateSelectedChildren).listenTo(this.collection,"destroy",this.unblockActions).listenTo(this.collection,"error",this.unblockActions).listenTo(this.columns,"reset remain",this._handleColumnsReset),this.options.tableColumns&&this.listenTo(this.options.tableColumns,"reset update",this._handleTableColumnsReset),this.context&&this.listenTo(this.context,"request:perspective",this._handlePerspectiveContextRequest).listenTo(this.context,"request request:perspective",this._handleContextRequest).listenTo(this.context,"sync",this._handleContextSync).listenTo(this.context,"sync error error:perspective",this._handleContextFinish),this.listenTo(this.collection,"reset",function(){this.isRendered&&this.table&&K.call(this)}),this.listenTo(this.collection,"reset",this.setFocusToFirstRow).listenTo(this.collection,"add",this.setFocusToFirstRow).listenTo(this.collection,"remove",this.setFocusToFirstRow).listenTo(this.collection,"destroy",this.setFocusToFirstRow),this.collection.fetching&&(this.blockActions(),this.disableEmptyViewText()),this.disableEmptyViewText(),this.listenTo(this,"dom:refresh",this._handleDomRefresh),this.listenTo(this,"clickDefaultPreAction",function(e){this.triggerMethod("execute:defaultAction",e.node)}),this.collection.node&&(this.listenTo(this.collection.node,"change:id",this.setFocusToFirstRow),this.listenTo(this.collection.node,"change:id",this._clearSearchBoxes),this.listenTo(this.collection.node,"change:id",this._clearExpandedRows),this.listenTo(this.collection.node,"change:id",function(){}));i(window).bind("resize.tableview."+this.cid,t.debounce(t.bind(this._adjustColumnsIfViewResized,this),50)),this.options.inlineBar&&this._setInlineBarEvents(),this.prepareForGlobalAlert()},"behaviors":{"PerfectScrolling":{"behaviorClass":d,"contentParent":"tbody","suppressScrollX":!0},"TabableRegion":{"behaviorClass":h,"initialActivationWeight":100}},"events":{"keydown":"onKeyInView"},"destroy":function(){return i(window).unbind("resize.tableview."+this.cid),Q.call(this),n.View.prototype.destroy.apply(this,arguments)},"render":function(){return this._renderingTableDelayedAsync?void(a.debug("render: currently in async render -> skip")&&console.log(a.last)):(this._initializeLocalizableLabels(),this.columns&&this.columns.length?(a.debug("render")&&console.log(a.last),this._startTableRendering=new Date,this._ensureViewIsIntact(),this.table&&(ie.call(this),Y.call(this),Q.call(this)),this._getColumns(),this.updateCollectionParameters(),void(this._canMeasureTableSize()?(this._renderTableDelayed=!1,this._preRenderTable(),this._renderTable()):(this._renderTableDelayed=!0,this._renderingTableDelayedAsync=!1,this._renderFake()))):void(this.collection&&this.collection.length?(a.debug("No columns -> skip render")&&console.log(a.last),this._renderFake()):(a.debug("No columns and no rows -> render empty text")&&console.log(a.last),this._renderEmpty())))},"onBeforeRender":function(){this._startBeforeTableRendering=new Date},"onRender":function(){var e=new Date,i=e-this._startBeforeTableRendering;if(this._startTableRendering){var t=e-this._startTableRendering;a.debug("TIMINGS: rendering totally "+t+"ms. beforeRender...render "+i+"ms")&&console.log(a.last)}else a.debug("TIMINGS: beforeRender...render took "+i+"ms")&&console.log(a.last);delete this._startTableRendering},"_handleDomRefresh":function(){if(this._renderingTableDelayedAsync)a.debug("onDomRefresh: currently in async render -> skip")&&console.log(a.last);else{if(this._renderTableDelayed)if(a.debug("onDomRefresh -> need to render table delayed")&&console.log(a.last),this._startTableRendering=new Date,this._canMeasureTableSize()){this._renderingTableDelayedAsync=!0,a.debug("onDomRefresh: el is visible -> start rendering (async)")&&console.log(a.last);var e=this;setTimeout(function(){e._renderTableDelayed=!1,e._renderingTableDelayedAsync=!1,e._preRenderTable(),e._renderTable()})}else a.warn("WARNING: onDomRefresh: el is still not measurable -> skip")&&console.log(a.last);else a.debug("dom:refresh -> checking if columns must be adjusted")&&console.log(a.last),this._adjustColumnsIfViewResized();this.activeInlineForm&&this.activeInlineForm.triggerMethod("dom:refresh",this.activeInlineForm)}},"_canMeasureTableSize":function(){return document.body.contains(this.el)&&(this.el.offsetWidth||this.el.offsetHeight||this.el.getClientRects().length)},"_renderFake":function(){a.debug("_renderFake")&&console.log(a.last),this.triggerMethod("before:render",this),this.isRendered=!0,this.triggerMethod("render",this)},"_renderEmpty":function(){a.debug("_renderEmpty")&&console.log(a.last),this.triggerMethod("before:render",this),this.showOrHideZeroRecordsMessage(),this.isRendered=!0,this.triggerMethod("render",this)},"_preRenderTable":function(){a.debug("_preRenderTable")&&console.log(a.last),this.isRendered=!1,this.triggerMethod("before:render",this);var e=this.$el.outerWidth();e-=i.scrollbarWidth(),this.maxColumnsDisplayed=this._calculateMaxColumnsDisplayed(e),a.debug("Table width is "+e+". Displaying max. "+this.maxColumnsDisplayed+" columns")&&console.log(a.last),this._setColumnsWrappedByAvailableWidth(),a.debug("Columns displayed: "+this.displayedColumns.length+", wrapped: "+this.wrappedColumns.length)&&console.log(a.last)},"_renderTable":function(){if(a.debug("_renderTable")&&console.log(a.last),this.$el.addClass("csui-nodetable"),R.call(this),this.accFocusedState.body.row=0,this.accFocusedState.body.column=k.getNameColumnIndex(this.displayedColumns)||0,this.showOrHideZeroRecordsMessage(),this.$el.parent().length>0){this.$el.parent().css("display").indexOf("flex")<0&&this.$el.addClass("csui-not-in-flex-container")}this.$el.removeClass("csui-not-ready"),this._adjustColumns(),this._previousViewWidth=this.$el.outerWidth(),this.isRendered=!0,this.triggerMethod("render",this)},"_drawTable":function(){this.table?(this.triggerMethod("before:render",this),this.showOrHideZeroRecordsMessage(),this.table.draw(),this.triggerMethod("render",this)):this.render()},"_calculateMaxColumnsDisplayed":function(e){var s,n,o,l=0,r=0,a=this.$el.find("table.binf-table");a.length>0&&this.collection.length>0&&(o=i(a[0])),t.each(this.allColumns,function(e){e.attributes&&!0===e.attributes.permanentColumn&&(s=e.attributes&&e.attributes.widthFactor,n=s?120*s:120,r+=n,l++)},this);for(var c=0;c<this.allColumns.length;c++){var u,d,h=this.allColumns[c];if(h.attributes&&!h.attributes.permanentColumn){if(s=h.attributes&&h.attributes.widthFactor,u=120,h.CellView.flexibleWidth&&o&&(d=o.find(">tbody>tr>:nth-child("+(c+1)+")>*"),u=d.length>0?120:0),n=s?u*s:u,(r+=n)>e)break;l++}}return l>this.options.maxColumnsDisplayed&&(l=this.options.maxColumnsDisplayed),l<1&&(l=1),l},"_getColumns":function(){this.trigger("buildingColumnDefinitions",{"sender":this});var e=[];if(this.options.tableColumns){var i,s,n=this.options.tableColumns.deepClone(),o={};this.columns.each(function(e){var l=e.get("column_key"),r=e.get("definitions_order");if(!0===e.get("isNaming")&&(s=l,e.unset("isNaming",{"silent":!0})),o[l]=e,e.get("type")&&r){var a=n.findWhere({"key":l});if(a){!0===a.get("isNaming")&&(i=a.get("key"));var c=a.get("sequence"),u=t.extend({"sequence":c},e.attributes);a.set(u)}else{p.hasCellViewByOtherKey(l)||n.add({"key":l,"sequence":r,"permanentColumn":!1})}}},this);var l=i||s||"name",r=[];n.each(function(e){var i=e.get("key");if(i===l&&e.set("isNaming",!0),o[i]){var s=o[i];i===l&&s.set("isNaming",!0);var n=p.getCellView(s),a=["permanentColumn","noTitleInHeader","title","align","widthFactor","isNaming"];t.each(a,function(i){var t=e.get(i);t?s.set(i,t,{"silent":!0}):n[i]&&s.set(i,n[i],{"silent":!0})}),r.push(s)}},this),r.length>0&&(r=Z(this,r)),e=t.map(r,function(e){var i=e.get("column_key"),s=p.getCellView(e),n={"CellView":s,"name":i,"noTitleInHeader":e.get("noTitleInHeader"),"isNaming":e.get("isNaming"),"title":e.get("title")||e.get("name"),"orderable":!!e.get("sort"),"filterable":!!e.get("filter"),"className":s.columnClassName,"defaultAction":e.get("default_action"),"contextualMenu":e.get("contextual_menu"),"data":function(i,t){if("orderBy"===t)return e.get("sort_key")||e.get("column_key");if("filterBy"===t)return e.get("filter_key")||e.get("column_key");if("set"===t)throw new Error("Setting column value not implemented");return s.getValue(i,n)},"render":function(){return""}},o=e.get("align");return o&&(window.csui&&window.csui.rtl&&("left"===o&&(o="right")||"right"===o&&(o="left")),n.className+=" csui-align-"+o),e.attributes&&(n.attributes=n.attributes||{},t.extend(n.attributes,e.attributes)),n},this)}this.allColumns=e,this.displayedColumns=[],this.wrappedColumns=[],t.each(e,function(e){e.attributes&&!0===e.attributes.permanentColumn&&(e.columnWrapped=!1,this.displayedColumns.push(e))},this),this.trigger("columnDefinitionsBuilt",{"sender":this,"columns":e})},"_setColumnsWrappedByAvailableWidth":function(){if(this.allColumns.length&&(this.maxColumnsDisplayed||this.options.maxColumnsDisplayed)){var e=this.maxColumnsDisplayed||this.options.maxColumnsDisplayed;this.displayedColumns=[],this.wrappedColumns=[];var i=0;t.each(this.allColumns,function(e){e.attributes&&!0===e.attributes.permanentColumn&&(e.columnWrapped=!1,i++)},this),ae?(this.displayedColumns=t.clone(this.allColumns),this.wrappedColumns=[]):(t.each(this.allColumns,function(t){t.attributes&&!0===t.attributes.permanentColumn||(i++,t.columnWrapped=!!e&&i>e)},this),this.displayedColumns=t.where(this.allColumns,{"columnWrapped":!1}),this.wrappedColumns=t.where(this.allColumns,{"columnWrapped":!0}))}},"_adjustColumnsIfViewResized":function(){if(this.isRendered){var e=this.$el.outerWidth();if((e-=i.scrollbarWidth())&&e!=this._previousViewWidth){var t=1.1*this._previousViewWidth,s=.9*this._previousViewWidth;if(e>t||e<s){this._previousViewWidth=e;this._calculateMaxColumnsDisplayed(e)!=this.maxColumnsDisplayed?(a.debug("_adjustColumnsIfViewResized: maxColumnsDisplayed differ -> render new table")&&console.log(a.last),this.render()):(a.debug("_adjustColumnsIfViewResized: maxColumnsDisplayed equal -> adjust columns")&&console.log(a.last),this._adjustColumns())}else a.debug("_adjustColumnsIfViewResized: table width changed minimally -> adjust columns")&&console.log(a.last),this._adjustColumns()}else a.debug("_adjustColumnsIfViewResized: width not changed -> skip")&&console.log(a.last)}},"enableEmptyViewText":function(){this._showEmptyViewText=!0},"disableEmptyViewText":function(){this._showEmptyViewText=!1},"_updateSelectedChildren":function(e){if(this.isRendered&&!this.deletingNodes&&this.table){var i=L.call(this),s=this.getSelectedChildren();this.selectedChildren.reset(s),t.each(this.selectedChildren.models,function(e){var t=this.collection.indexOf(e),s=this.table.row(t).node();s&&e.get(w.isSelectedModelAttributeName)&&!1===i.fnIsSelected(s)&&i.fnSelect(s)},this)}},"_setInlineBarEvents":function(){this.listenTo(this,"closeOther",this._inlineBarShouldDestroy),this.options.inlineBar.options.forceInlineBarOnClick?this.listenTo(this,"row:clicked",function(e){if(this.inlineBarView){if(this.inlineBarView.model.get("id")===e.node.get("id"))return}this.options.inlineBar.viewClass&&this._destroyOldAndCreateNewInlineBarWithoutDelay(e)}):this.options.inlineBar.options.showInlineBarOnHover&&(this.listenTo(this,"enterTableRow",this._destroyOldAndCreateNewInlineBarWithDelay),this.listenTo(this,"leaveTableRow",this._inlineBarShouldDestroy)),this.listenTo(this.collection,"reset",this._destroyInlineBar),this.collection.node&&this.listenTo(this.collection.node,"change:id",this._destroyInlineBar)},"_showInlineBar":function(e){if(!(this.getSelectedChildren().length>0))if(this.inlineBarView)this._savedHoverEnterArgs=e;else{this._savedHoverEnterArgs=null,this.inlineBarView=new this.options.inlineBar.viewClass(t.extend({"context":this.options.context,"originatingView":this.options.originatingView,"commands":this.defaultActionController.commands,"model":e.node},this.options.inlineBar.options)),this.listenToOnce(this.inlineBarView,"destroy",function(){this.inlineBarView&&this.stopListening(this.inlineBarView),this._savedHoverEnterArgs&&this._destroyOldAndCreateNewInlineBarWithDelay(this._savedHoverEnterArgs)},this);var i=this.getNameCell(e.target);if(i&&1===i.length){var s=i.find(".csui-table-cell-name-appendix"),o=new n.Region({"el":s});o.show(this.inlineBarView),this.inlineBarView.$el.parent().length>0&&s.addClass("csui-table-cell-name-appendix-full"),i.addClass("csui-table-actionbar-shown")}}},"_destroyOldAndCreateNewInlineBarWithDelay":function(e){this._inlineBarShouldDestroy(),this._showInlineBarTimeout&&clearTimeout(this._showInlineBarTimeout);var i=this;this._showInlineBarTimeout=setTimeout(function(){i._showInlineBarTimeout=null,i.lockedForOtherContols||i._showInlineBar.call(i,e)},200)},"_inlineBarShouldDestroy":function(){this._showInlineBarTimeout&&(clearTimeout(this._showInlineBarTimeout),this._showInlineBarTimeout=null),this._destroyInlineBar()},"_destroyOldAndCreateNewInlineBarWithoutDelay":function(e){this._inlineBarShouldDestroy(),this.lockedForOtherContols||this._showInlineBar.call(this,e)},"_destroyInlineBar":function(){if(this.inlineBarView){var e=this.inlineBarView.$el.parent();e.removeClass("csui-table-cell-name-appendix-full"),e.closest(".csui-table-actionbar-shown").removeClass("csui-table-actionbar-shown"),this.inlineBarView.destroy(),this.inlineBarView=null}},"_clearExpandedRows":function(){this.isRendered&&(this.expandedDetailRows={})},"onKeyInView":function(e){if(9===e.keyCode){if(this.activeInlineForm)return e.preventDefault(),void e.stopPropagation();e.shiftKey?"tableBody"===this.accFocusedState.focusView&&(e.preventDefault(),e.stopPropagation(),this.accFocusedState.focusView="tableHeader",this.trigger("changed:focus"),this.currentlyFocusedElement().focus()):"tableHeader"===this.accFocusedState.focusView&&(e.preventDefault(),e.stopPropagation(),this.accFocusedState.focusView="tableBody",this.trigger("changed:focus"),this.currentlyFocusedElement().focus())}},"currentlyFocusedElement":function(){if("tableHeader"===this.accFocusedState.focusView){if(this.tableCaptionView)return this.tableCaptionView.currentlyFocusedElement()}else if(this.tableBodyView)return this.tableBodyView.currentlyFocusedElement();return i()},"setFocusToFirstRow":function(){this.isRendered&&(this.accFocusedState.body.row=0,this.accFocusedState.body.column=k.getNameColumnIndex(this.displayedColumns)||0)},"renderError":function(){this.table||(ee.call(this),i("<div></div>",{"id":"message"}).html(c.MessageHelper.toHtml()).appendTo(this.$el))},"_plugHeaderBodyViews":function(){var e=this;this.tableCaptionView=new x({"el":this.$("thead"),"displayedColumns":this.displayedColumns,"searchBoxes":this.searchBoxes,"_getActiveInlineForm":t.bind(function(){return this.activeInlineForm},this),"accFocusedColumn":this.accFocusedState.headerColumn,"accSearchFocused":this.accFocusedState.accSearchFocused}),this.propagateEventsToViews(this.tableCaptionView),this.tableCaptionView.listenTo(this.tableCaptionView,"closeOtherControls",function(){e.trigger("closeOther")}),this.tableCaptionView.listenTo(this.tableCaptionView,"sorting:toggle",function(i){if(e.displayedColumns[i].bSortable){var s="asc",n=e.table.order();if(t.isArray(n)&&n.length>0){var o=n[0][0],l=n[0][1];o===i&&l===s&&(s="desc")}e.table.order([i,s]).draw()}}),this.tableCaptionView.listenTo(this.tableCaptionView,"changed:focus",function(){e.accFocusedState.focusView="tableHeader",e.trigger("changed:focus")}),this.tableCaptionView.render(),n.triggerMethodOn(this.tableCaptionView,"before:show"),n.triggerMethodOn(this.tableCaptionView,"show"),this.tableBodyView=new k({"el":this.$("tbody"),"collection":this.collection,"displayedColumns":this.displayedColumns,"_getActiveInlineForm":t.bind(function(){return this.activeInlineForm},this),"startInlineFormForEdit":t.bind(this.startInlineFormForEdit,this),"accFocusedCell":this.accFocusedState.body,"tableView":this}),this.propagateEventsToViews(this.tableBodyView),this.tableBodyView.listenTo(this.tableBodyView,"closeOtherControls",function(){e.trigger("closeOther")}),this.tableBodyView.listenTo(this.tableBodyView,"changed:focus",function(){e.accFocusedState.focusView="tableBody",e.trigger("changed:focus")}),this.tableBodyView.render(),n.triggerMethodOn(this.tableBodyView,"before:show"),this.tableBodyView.triggerMethod("show")},"_destroyTableHeaderAndBodyViews":function(){this.tableCaptionView&&(this.accFocusedState.headerColumn=this.tableCaptionView.accFocusedColumn,this.accFocusedState.accSearchFocused=this.tableCaptionView.accSearchFocused,this.tableCaptionView.destroy(),this.tableCaptionView=null),this.tableBodyView&&(this.tableBodyView.destroy(),this.tableBodyView=null)},"setDeletingNodesState":function(e){this.deletingNodes=e},"_handleContextRequest":function(){this._fetchingContext||(this._fetchingContext=!0,this._columnsReset=!1,this._collectionReset=!1,this.context.perspective&&!this._fetchingPerspectiveContext&&(this._columnsReset=this.columns.length>0))},"_handlePerspectiveContextRequest":function(){this._fetchingPerspectiveContext=!0},"_handleContextSync":function(){this._fetchingContext&&(this._fetchingContext=!1,this._columnsReset?(a.debug("_handleContextSync: columns reset -> full render")&&console.log(a.last),this.render()):this._collectionReset&&this.isRendered&&(a.debug("_handleContextSync: collection reset -> draw")&&console.log(a.last),this._drawTable()))},"_handleContextFinish":function(){this._fetchingContext=!1,this._fetchingPerspectiveContext=!1},"_handleTableColumnsReset":function(){this._fetchingContext?(this._columnsReset=!0,a.debug("_handleTableColumnsReset: fetching -> skip")&&console.log(a.last)):(a.debug("_handleTableColumnsReset -> full render")&&console.log(a.last),this.render())},"_handleColumnsReset":function(){this._fetchingContext?(this._columnsReset=!0,this._collectionReset?(a.debug("_handleColumnsReset: fetching -> collection was reset -> handleContextSync")&&console.log(a.last),this._handleContextSync()):a.debug("_handleColumnsReset: fetching -> skip")&&console.log(a.last)):(a.debug("_handleColumnsReset -> full render")&&console.log(a.last),this.render())},"_handleModelsReset":function(){this.enableEmptyViewText(),this._fetchingContext?(this._collectionReset=!0,this._columnsReset?(a.debug("ModelsReset: fetching and columns reset -> handleContextSync")&&console.log(a.last),this._handleContextSync()):a.debug("ModelsReset: fetching -> skip")&&console.log(a.last)):this.isRendered?(a.debug("ModelsReset: -> draw")&&console.log(a.last),this._drawTable()):(a.debug("ModelsReset: table not rendered -> full render")&&console.log(a.last),this.render())},"_handleModelsUpdate":function(e,i){if(this.isRendered){var s=i.changes.added;s.length>0&&this.table&&t.each(s,function(e){e.unset(w.isSelectedModelAttributeName)}),a.debug("_handleModelsUpdate: -> draw")&&console.log(a.last),this._drawTable()}},"_handleModelRemove":function(e){if(this.isRendered)if(!0===this.deletingNodes){if(e){var t;this.table.rows(function(i,s,n){return s.get("id")===e.get("id")&&(t=i,!0)}).data(),void 0!==t&&i(this.$el.find(this.table.row(t).node())).hide()}}else a.debug("_handleModelRemove: -> draw")&&console.log(a.last),this._drawTable()},"updateRow":function(e){if(this.isRendered&&this.table){var s=this.collection.indexOf(e);if(this.childWithBlockingView&&(this.childWithBlockingView.updateRowIndex=s),void 0!==s){if(this.table){var n=i(this.table.row(s).node()),o=this.table.row(s).child();if(1===t.keys(e.changed).length&&null!=e.changed[w.isSelectedModelAttributeName]){e.get(w.isSelectedModelAttributeName)?(n.addClass("binf-active"),t.each(o,function(e){i(e).addClass("binf-active")})):(n.removeClass("binf-active"),t.each(o,function(e){i(e).removeClass("binf-active")}))}!0===e.get("isCut")?(n&&n.addClass("csui-cut-row"),o&&o.addClass("csui-cut-row")):(n&&n.removeClass("csui-cut-row"),o&&o.removeClass("csui-cut-row"))}if(1!==t.keys(e.changed).length||null==e.changed[w.isSelectedModelAttributeName]&&null==e.changed.csuiDelayedActionsRetrieved){this.activeInlineForm&&this.activeInlineForm.model!==e&&this.cancelAnyExistingInlineForm({"silent":!0});var l=this.$("tbody").scrollTop();a.debug("updateRow: -> draw")&&console.log(a.last),this.triggerMethod("before:render"),this.table.row(s).invalidate(),this.table.draw(),this.$("tbody").scrollTop(l),this.triggerMethod("render"),this.table&&(L.call(this),this._updateSelectedChildren(e),this.activeInlineForm&&this.activeInlineForm.triggerMethod("dom:refresh",this.activeInlineForm),this._adjustColumns())}}}},"onAfterShow":function(){this._adjustColumns()},"getNameCell":function(e){var t=k.getNameColumnIndex(this.displayedColumns);if(void 0!==t){var s=i(e).children()[t];return i(s)}},"updateCollectionParameters":function(){var e=this.collection,i=this.context,s=e.makeFieldsV2,n=e.makeExpandableV2,o={},l={};this.collection.setFields&&((s||n)&&e.getResourceScope&&e.setResourceScope&&(this._originalCollectionScope?e.setResourceScope(this._originalCollectionScope):this._originalCollectionScope=e.getResourceScope()),t.each(this.allColumns,function(t){var r=t.CellView;if(r){if(s&&r.getModelFields){var a=r.getModelFields({"collection":e,"context":i,"column":t});a&&M.mergePropertyParameters(o,a)}if(n&&r.getModelExpand){var c=r.getModelExpand({"collection":e,"context":i,"column":t});c&&M.mergePropertyParameters(l,c)}r.updateCollectionParameters&&r.updateCollectionParameters({"collection":e,"context":i,"column":t})}},this),t.isEmpty(o)||e.setFields(o),t.isEmpty(l)||e.setExpand(l))},"clearFilter":function(e,s){return this.table&&(s&&!i.isEmptyObject(this.options.filter)&&(this.options.filter=t.omit(this.options.filter,s.split(","))),this.options.filter&&delete this.options.filter.name,this.table.search("").columns().search("").draw()),this},"setFilter":function(e){this.table&&(i.isEmptyObject(this.options.filter)?this.options.filter=e:this.options.filter=t.extend(this.options.filter,e),this._drawTable())},"resetOrder":function(e){return this.collection.resetOrder(),this},"getScreenRowCount":function(e){var t=this.table&&L.call(this);if(t){var s=i("#"+t.dom.table.id),n=s&&s[0].childNodes[1]&&s[0].childNodes[1].clientHeight||0,o=s&&s.dataTable().$("tbody tr"),l=o[0]&&o[0].clientHeight||0;return l>0?Math.floor(n/l):0}return 0},"getSelectedChildren":function(){var e={};return e[w.isSelectedModelAttributeName]=!0,this.collection.where(e)},"clearChildrenSelection":function(){var e=this.table&&L.call(this);e&&e.fnSelectNone()},"getFocusedChild":function(){return this.accFocusedState.body.row?this.collection.at(this.accFocusedState.body.row):void 0},"cancelFetch":function(){this.table&&this.table.clear()},"showDetailRowDescriptions":function(e){this.options.descriptionRowView&&(this.options.descriptionRowViewOptions.showDescriptions=e,t.each(this._detailRowsDescriptionTRs,function(i){e?i.rowEl.removeClass("binf-hidden"):i.rowEl.addClass("binf-hidden"),i.view.trigger("dom:refresh")}),this.trigger("dom:refresh"))},"enableLocationColumn":function(e){this.options.locationColumn!==e&&(this.options.locationColumn=e)},"enableRefresh":function(e){this.refreshEnabled=e},"applyFilter":function(e){if(this.options.clientSideDataOperation)this.clientSideSearch(e.column);else{var i={};i[e.column]=e.keywords,this.collection.fetching?this.filterValuePending=i:(this.collection.resetLimit(!1),this.collection.setFilter(i))}},"cancelAnyExistingInlineForm":function(e){this.activeInlineForm&&this.activeInlineForm.cancel(e)},"startCreateNewModel":function(e,i){this.cancelAnyExistingInlineForm(),this.collection&&this.collection.node&&(e.set("parent_id",this.collection.node.get("id")),e.isLocallyCreated=!0,e.inlineFormView=i,this.collection.add(e,{"at":0}))},"startInlineFormForEdit":function(e){if(this.collection.contains(e)){this.cancelAnyExistingInlineForm();var i=_.getInlineFormView(e.get("type"));i||(i=_.getInlineFormView(-1)),i&&(e.inlineFormView=i,e.set("csuiInlineFormErrorMessage","dummy",{"silent":!0}),e.unset("csuiInlineFormErrorMessage"))}},"showOrHideZeroRecordsMessage":function(){if(this.$el.find("div.csui-table-empty").remove(),0===this.collection.length){this.$el.find("tbody").empty();var e=this.collection.node&&this.collection.node.get("type_name")?this.collection.node.get("type_name"):"default",t="";if(e=e.replace(/\s+/g,"-").toLowerCase(),this.$el.addClass("csui-table-empty"),this._showEmptyViewText){var s=this.options.customLabels?this.options.customLabels:this.localizableLabels;t=this.collection.filters&&this.collection.filters.name?s.emptyTable:s.zeroRecords}var n="csui-table-empty csui-table-empty-default csui-table-empty-"+e+(this.options.canDragAndDrop?" csui-can-add-items":""),o=i("<div class='"+n+"'><p class='csui-no-result-message' title='"+t+"'>"+t+"</p></div>");this._showEmptyViewText||o.addClass("csui-state-loading"),this.$el.append(o)}else this.$el.removeClass("csui-table-empty"),this._renderedEmptyTable&&(this._previousViewWidth=0);this._renderedEmptyTable=0===this.collection.length},"setCustomLabels":function(e){function i(e,s){return t.reduce(t.keys(e),function(n,o){var l=e[o];if(t.isObject(l)){var r=s[o]||(s[o]={});return n||i(l,r)}var a=s[o]!=l;return s[o]=l,n||a},!1)}var s=this.getOption("customLabels")||this.getOption("tableTexts")||{};if(t.isFunction(s)&&(s=s.call(this)),this.options.customLabels=this._fillDefaultLocalizableLabels(e,s),this.table){var n=t.deepClone(this.options.customLabels);o.camelToHungarian(o.defaults.oLanguage,n);i(n,this.table.settings()[0].oLanguage)&&this._drawTable()}},"_fillDefaultLocalizableLabels":function(){function e(i){t.each(t.keys(i),function(s){var n=i[s];t.isObject(n)?e(n):!1!==n&&null!==n||delete i[s]})}var i=Array.prototype.slice.call(arguments),s={"paginate":{},"aria":{}};return t.each(i,function(e){null!=e.zeroRecordsMsg&&null==e.zeroRecords&&(e.zeroRecords=e.zeroRecordsMsg,delete e.zeroRecordsMsg),t.defaults(s,e),t.defaults(s.paginate,e.paginate),t.defaults(s.aria,e.aria)}),e(s),t.defaults(s,{"emptyTable":r.NodeTableNoItems,"zeroRecords":r.NodeTableNoItems,"loadingRecords":r.NodeTableLoadingItems,"processing":r.NodeTableProcessingItems,"info":r.NodeTablePageInfo,"infoEmpty":r.NodeTableEmptyPageInfo,"infoFiltered":r.NodeTableFilteredPageInfo,"infoThousands":r.NodeTablePageThousandsSeparator,"infoPostFix":r.NodeTablePageInfoSuffix,"lengthMenu":r.NodeTablePageSizeSelector,"search":r.NodeTablePageFilterLabel}),t.defaults(s.paginate,{"first":r.NodeTablePagingFirst,"last":r.NodeTablePagingLast,"previous":r.NodeTablePagingPrevious,"next":r.NodeTablePagingNext}),t.defaults(s.aria,{"sortAscending":r.NodeTableSortAscending,"sortDescending":r.NodeTableSortDescending}),s},"_initializeLocalizableLabels":function(){var e=this.getOption("customLabels")||this.getOption("tableTexts")||{};t.isFunction(e)&&(e=e.call(this)),this.localizableLabels=this._fillDefaultLocalizableLabels(e)},"_handlePendingFilter":function(){this.isRendered&&(t.isEmpty(this.filterValuePending)||(this.collection.resetLimit(!1),this.collection.setFilter(this.filterValuePending),this.filterValuePending={}))},"clientSideSearch":function(e){var i={};t.each(this.searchBoxes,function(e){var t=e.getColumn(),s=e.getValue();s.length&&(i[t]=s)}),this.collection.resetLimit(!1),this.collection.setFilter(i)},"resetScrollToTop":function(){if(this.isRendered){this.$("tbody").scrollTop(0)}},"_clearSearchBoxes":function(){this.isRendered&&t.each(this.searchBoxes,function(e){e.hideAndClear()})},
"_adjustColumns":function(){if(!ae&&this.displayedColumns&&this.$el.is(":visible")){var e=this.$el.width();d.usePerfectScrollbar()||this.$el.find(".csui-normal-scrolling").hasScroll()&&(e-=i.scrollbarWidth());var s,n=0,o=0,l=this.$el.find("table>thead>tr>th");s=this.collection.length>0&&!this.activeInlineForm?this.$el.find("table>tbody>tr:first-child").children():l;var r,a={},c=[],u=this.displayedColumns,h=0,p=0,m=0,f=0;s.each(function(e){if(e<u.length){var t=i(this),s=Math.max(t.outerWidth(),i(l[e]).outerWidth()),d=u[e];if(d.CellView.hasFixedWidth)o+=s,n++;else{var g=d.attributes&&d.attributes.widthFactor||1;g&&1!==g?(a[e]=g,h+=g):d.CellView&&d.CellView.flexibleWidth?(m+=s,f++):(c.push(e),h+=1),g>p&&(p=g,r=e)}}});var g=e-o-m,b=u.length-n-f,v=b>0?g/b:0,w=0,y=h/b;t.each(a,function(e,i){var t=e/y,s=v*t;w+s>g&&(s=g-w)<0&&(s=0),s=Math.floor(s),a[i]=s,w+=s});var _;c.length>0?(v=(g-w)/c.length/y,v=Math.floor(v),_=g-w-v*c.length):(v=0,_=g-w),_=Math.floor(_);var C=this.$el.find("table>tbody"),T={};s.each(function(e){if(e<u.length){var t=i(this),s=u[e],n=Math.max(t.outerWidth(),i(l[e]).outerWidth()),o={"width":n+"px"};if(!s.CellView.hasFixedWidth){var c;c=a[e]&&a[e]>0?a[e]:v,e===r&&_&&(c+=_);var d=c+"px";s.CellView.flexibleWidth?i(l[e]).css(o):(o={"min-width":d,"max-width":d},i(l[e]).css(o))}C.find("tr:not(.csui-details-row)>:not(.csui-inlineform-parent):nth-child("+(e+1)+")").css(o),T[s.className]=o}}),this.cachedColumnWidths=T,this.accFocusedState.body.column>u.length-1&&(this.accFocusedState.body.column=u.length-1),this._showOrHideAlternativeHeaderView()}},"_showOrHideAlternativeHeaderView":function(){this._alternativeHeaderRegion&&(this.selectedChildren.length>0?this._alternativeHeaderRegion.$el.addClass("csui-table-alternative-header-visible"):this._alternativeHeaderRegion.$el.removeClass("csui-table-alternative-header-visible"))},"_createAlternativeHeaderView":function(){var e,i,s=this.options.alternativeHeader.options;if(s&&s.toolbarItems&&s.toolbarItems.tableHeaderToolbar){var n=s.toolbarItems.tableHeaderToolbar;e=n?n.options:void 0;var o={"nodes":this.selectedChildren,"container":this.collection.node,"context":this.context,"collection":this.collection};this._alternativeHeaderCommandController=s.toolbarCommandController||new V({"commands":s.commands}),i=new I(n,{"status":o,"commands":this._alternativeHeaderCommandController.commands,"delayedActions":this.collection.delayedActions,"mask":s.toolbarItemsMask})}var l=new this.options.alternativeHeader.viewClass(t.extend({"collection":i,"toolbarName":"tableHeader","originatingView":this.options.parentView,"keyboardNavigationEnabled":!0,"selectedNodes":this.selectedChildren},e));return this._alternativeHeaderCommandController&&(this.listenTo(this._alternativeHeaderCommandController,"before:execute:command",function(e){a.debug("command "+e.commandSignature+" is starting")&&console.log(a.last),this.lockedForOtherContols=!0,this._destroyInlineBar(),l.trigger("before:execute:command",e)}),this.listenTo(this._alternativeHeaderCommandController,"after:execute:command",function(e){a.debug("command is finished")&&console.log(a.last),this.lockedForOtherContols=!1,l.trigger("after:execute:command",e)})),l},"_toolbarItemClicked":function(e,i){var t=this.getSelectedChildren(),s={"context":this.context,"nodes":new this._ViewCollection(t),"container":this.collection.node,"collection":this.collection,"originatingView":this.options.originatingView,"toolItemView":e};this._alternativeHeaderCommandController.toolitemClicked(i.toolItem,s)}});return ce.version="1.0",t.extend(ce.prototype,S),t.extend(ce.prototype,A),ce.prototype._eventsToPropagateToViews.push("clicked:cell"),ce}),csui.define("hbs!csui/controls/table.list/impl/table.list.row",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"1":function(e,i,t,s){return'  <div class="csui-table-cell csui-table-cell-'+this.escapeExpression(this.lambda(null!=e?e.name:e,e))+" "+this.escapeExpression(this.lambda(null!=e?e.class:e,e))+'" role="cell"></div>\r\n'},"3":function(e,i,t,s){return'  <div class="csui-table-extra-cols csui-column-wrapped" role="cell"></div>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){var n;return(null!=(n=i.each.call(e,null!=e?e.columns:e,{"name":"each","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?n:"")+(null!=(n=i.if.call(e,null!=e?e.hasWrappedColumns:e,{"name":"if","hash":{},"fn":this.program(3,s,0),"inverse":this.noop}))?n:"")}});return t.registerPartial("csui_controls_table.list_impl_table.list.row",s),s}),csui.define("hbs!csui/controls/table.list/impl/table.list.header",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"1":function(e,i,t,s){var n;return null!=(n=i.if.call(e,null!=e?e.noTitleInHeader:e,{"name":"if","hash":{},"fn":this.program(2,s,0),"inverse":this.program(7,s,0)}))?n:""},"2":function(e,i,t,s){var n;return null!=(n=i.if.call(e,null!=e?e.isToolbar:e,{"name":"if","hash":{},"fn":this.program(3,s,0),"inverse":this.program(5,s,0)}))?n:""},"3":function(e,i,t,s){var n;return'      <div class="csui-table-header-cell csui-table-header-toolbar" tabindex="-1"\r\n           data-cstabindex="-1" role="columnheader">\r\n        <span class="'+this.escapeExpression(this.lambda(null!=e?e.className:e,e))+'" title="'+this.escapeExpression((n=null!=(n=i.addTitle||(null!=e?e.addTitle:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"addTitle","hash":{}}):n))+'"></span>\r\n      </div>\r\n'},"5":function(e,i,t,s){return'      <div class="csui-table-header-cell '+this.escapeExpression(this.lambda(null!=e?e.className:e,e))+'" role="columnheader"></div>\r\n'},"7":function(e,i,t,s){return'    <div class="csui-table-header-cell '+this.escapeExpression(this.lambda(null!=e?e.className:e,e))+'" title="'+this.escapeExpression(this.lambda(null!=e?e.title:e,e))+'" tabindex="-1"\r\n         data-cstabindex="-1" role="columnheader">\r\n      <div class="csui-table-header-cell-container csui-fadeout">\r\n        <span>\r\n          '+this.escapeExpression(this.lambda(null!=e?e.title:e,e))+"\r\n        </span>\r\n      </div>\r\n    </div>\r\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){var n;return(null!=(n=i.each.call(e,null!=e?e.columns:e,{"name":"each","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?n:"")+"\r\n\r\n"}});return t.registerPartial("csui_controls_table.list_impl_table.list.header",s),s}),csui.define("hbs!csui/controls/table.list/impl/table.list",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){return'<div class="csui-table-list-header" role="rowgroup"></div>\r\n<div class="csui-table-list-body"></div>'}});return t.registerPartial("csui_controls_table.list_impl_table.list",s),s}),csui.define("hbs!csui/controls/table.list/impl/empty.table",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){var n;return this.escapeExpression((n=null!=(n=i.message||(null!=e?e.message:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"message","hash":{}}):n))}});return t.registerPartial("csui_controls_table.list_impl_empty.table",s),s}),csui.define("csui/controls/table.list/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/table.list/impl/nls/root/lang",{"addTitle":"Add"}),csui.define("css!csui/controls/table.list/impl/table.list",[],function(){}),csui.define("csui/controls/table.list/table.list.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/utils/base","csui/utils/commands","csui/controls/mixins/layoutview.events.propagation/layoutview.events.propagation.mixin","csui/controls/table/cells/cell.factory","csui/controls/progressblocker/blocker","csui/controls/globalmessage/globalmessage","csui/controls/tableactionbar/tableactionbar.view","csui/controls/table/rows/metadata/metadatarow.view","csui/controls/tile/behaviors/perfect.scrolling.behavior","csui/behaviors/keyboard.navigation/tabable.region.behavior","hbs!csui/controls/table.list/impl/table.list.row","hbs!csui/controls/table.list/impl/table.list.header","hbs!csui/controls/table.list/impl/table.list","hbs!csui/controls/table.list/impl/empty.table","i18n!csui/controls/table.list/impl/nls/lang","css!csui/controls/table.list/impl/table.list","csui/lib/jquery.mousehover"],function(e,i,t,s,n,o,l,r,a,c,u,d,h,p,m,f,g,b,v){"use strict";var w=s.ItemView.extend({"className":"csui-table-empty","template":b,"constructor":function(e){s.ItemView.prototype.constructor.apply(this,arguments)},"templateHelpers":function(){return{"message":this.options.emptyTableText}}}),y=s.LayoutView.extend({"className":"csui-table-row","attributes":function(){return{"role":"row"}},"tagName":"div","template":m,"events":{"focusin .csui-table-cell":"onFocusInTableCell","blur .csui-table-cell":"onFocusOutTableCell"},"templateHelpers":function(){return{"columns":this.options.columns,"hasWrappedColumns":this.options.wrappedColumns&&this.options.wrappedColumns.length>0}},"constructor":function(e){e||(e={}),s.LayoutView.prototype.constructor.call(this,e)},"initialize":function(){var i=this;this.options.columns&&e.each(this.options.columns,function(e){if(e.CellView){var t=e.name;i.addRegion(t,".csui-table-cell-"+t)}},this),this.options.wrappedColumns&&this.options.wrappedColumns.length>0&&i.addRegion("csui-column-wrapped",".csui-column-wrapped")},"onRender":function(){var i=this;if(this.options.columns&&e.each(this.options.columns,function(e,t){if(e.CellView){var s=e.name,n=new e.CellView({"tagName":"DIV","model":i.model,"context":i.options.context,"applyTo":i.options.applyTo,"column":e,"authUser":i.options.authUser,"hasEditPermissionAction":!!this.options.admin_permissions,"updateModelSilent":!0,"originatingView":i.options.originatingView});i[s].show(n),i.listenTo(n,"clicked:cell",function(e){i.trigger("clicked:cell",{"cellView":n,"rowIndex":i._index,"colIndex":t,"model":i.model})})}},this),this.options.wrappedColumns&&this.options.wrappedColumns.length>0){var t=new d({"context":this.options.context,"model":this.model,"columns":this.options.wrappedColumns});this["csui-column-wrapped"].show(t)}!n.isTouchBrowser()&&this.options.showInlineToolbar&&this.$el&&this._subscribeEventHandlers(),n.isTouchBrowser()&&this.options.showInlineToolbar&&this._showInlineRowActions()},"_showInlineRowActions":function(){var i=this.$el.find(".csui-row-inlinetoolbar").removeClass("binf-hidden"),t=[0,1];(null===this.model.get("permissions")||!this.options.hasEditPermission||t.indexOf(this.model.get("right_id_expand")&&this.model.get("right_id_expand").type)<0&&"custom"===this.model.get("type"))&&this.$el.find(".csui-row-inlinetoolbar").addClass("binf-hidden"),0!==i.length&&void 0===this.inlineRowToolbarView&&(this.inlineRowToolbarView=new u(e.extend({"context":this.options.context,"commands":o,"collection":this.options.toolbarItems.inlineToolbar,"toolItemsMask":this.options.toolbarItemsMasks.toolbars.inlineToolbar,"originatingView":this.options.originatingView,"model":this.model,"applyTo":this.options.applyTo,"status":{"model":this.model,"targetView":this,"connector":this.options.connector,"applyTo":this.options.applyTo,"admin_permissions":this.options.admin_permissions}},this.options.toolbarItems.inlineToolbar.options,{"maxItemsShown":1})),this.listenTo(this.inlineRowToolbarView,"before:execute:command",function(e){e&&e.status&&e.status.targetView&&e.status.targetView.$el&&e.status.targetView.$el.addClass("active-row"),this.trigger("before:execute:action",e)}),this.listenTo(this.inlineRowToolbarView,"after:execute:command",function(e){e&&e.status&&e.status.targetView&&e.status.targetView.$el&&e.status.targetView.$el.removeClass("active-row"),this.trigger("after:execute:action",e)}),this.options.originatingView&&(this.listenTo(this.options.originatingView,"block:view:actions",function(){this.trigger("before:execute:action")}),this.listenTo(this.options.originatingView,"unblock:view:actions",function(){this.trigger("after:execute:action")})),this.inlineRowToolbarView.render(),i.append(this.inlineRowToolbarView.$el),this.inlineRowToolbarView.triggerMethod("show"))},"_destroyInlineRowActionBar":function(){this.inlineRowToolbarView&&(this.inlineRowToolbarView.destroy(),this.inlineRowToolbarView=void 0,this.$el.find("active-row")&&this.$el.removeClass("active-row"))},"onBeforeRender":function(){!n.isTouchBrowser()&&this.options.showInlineToolbar&&this._unsubscribeEventHandlers()},"onBeforeDestroy":function(){this.options.showInlineToolbar&&(n.isTouchBrowser()?this._destroyInlineRowActionBar():this._unsubscribeEventHandlers())},"_subscribeEventHandlers":function(){this.$el&&this.$el.mousehover(this.showInlineActions.bind(this),this.hideInlineActions.bind(this),{"namespace":this.cid})},"_unsubscribeEventHandlers":function(){this._isRendered&&this.$el.mousehover("off",{"namespace":this.cid})},"showInlineActions":function(e){if([0,1].indexOf(this.model.get("right_id_expand")&&this.model.get("right_id_expand").type)<0&&"custom"===this.model.get("type"))this.$el.find(".csui-inlinetoolbar").addClass("binf-hidden");else{var i=this.$el.find(".csui-inlinetoolbar").removeClass("binf-hidden");if(i.length>0){var t=this,s={"sender":t,"target":i,"model":t.model};t.trigger("mouseenter:row",s)}}},"hideInlineActions":function(e){var i=this.$el.find(".csui-inlinetoolbar").addClass("binf-hidden");if(i.length>0){var t=this,s={"sender":t,"target":i,"model":t.model};t.trigger("mouseleave:row",s)}},"onFocusInTableCell":function(e){this.options.showInlineToolbar&&this._showInlineRowActions()},"onFocusOutTableCell":function(i){this.options.showInlineToolbar&&setTimeout(e.bind(function(){0!==this.$el.find(document.activeElement).length||n.isTouchBrowser()||this._destroyInlineRowActionBar()},this),50)}}),_=s.ItemView.extend({"className":"csui-table-header","attributes":function(){return{"role":"row"}},"tagName":"div","behaviors":{"TabableRegion":{"behaviorClass":p,"initialActivationWeight":100}},"events":{"keydown":"onKeyInView"},"template":f,"templateHelpers":function(){var i=this.options.userPermissionsModel&&this.options.userPermissionsModel.get("permissions"),t=e.contains(i,"edit_permissions");return{"columns":this.options.columns,"addTitle":v.addTitle,"isToolbar":this.options.admin_permissions||t}},"constructor":function(e){e||(e={}),s.ItemView.prototype.constructor.call(this,e)},"onRender":function(){this.focusIndex=0,this._columnCount=this.options.columns.length,this._toolbarHeaderColumnCount=0;var i=this.options.userPermissionsModel&&this.options.userPermissionsModel.get("permissions");if(this.options.admin_permissions||e.contains(i,"edit_permissions"))this._toolbarHeaderColumnCount=this._columnCount;else for(var t=0;t<this._columnCount;t++){var s=this.options.columns[t];s.isToolbar||this._toolbarHeaderColumnCount++,void 0!==s.attributes.containsInlineActions&&(s.attributes.containsInlineActions=!1)}},"currentlyFocusedElement":function(){return this.$el.find(".csui-table-header-cell").eq(this.focusIndex)},"onKeyInView":function(e){var i=!0;switch(e.keyCode){case 37:this.focusIndex>0&&this.focusIndex--;break;case 39:this.focusIndex<this._toolbarHeaderColumnCount-1&&this.focusIndex++;break;default:i=!1}i&&(e.preventDefault(),e.stopPropagation(),this.$el.find(".csui-table-header-cell").eq(this.focusIndex).focus())}}),C=s.CollectionView.extend({"className":"csui-table-body","attributes":function(){return{"role":"rowgroup"}},"childView":y,"childEvents":{"mouseenter:row":"onChildShowInlineActionBarWithDelay","mouseleave:row":"onChildActionBarShouldDestroy","clicked:cell":"onClickedCell"},"behaviors":{"TabableRegion":{"behaviorClass":p,"initialActivationWeight":100}},"events":{"keydown":"onKeyInView"},"childViewOptions":function(){return{"context":this.options.context,"columns":this.options.columns,"wrappedColumns":this.options.wrappedColumns,"showInlineToolbar":this.showInlineToolbar,"toolbarItems":this.options.toolbarItems,"toolbarItemsMasks":this.options.toolbarItemsMasks,"connector":this.options.collection.connector,"originatingView":this.options.originatingView,"applyTo":this.options.applyTo,"authUser":this.options.authUser,"hasEditPermission":this.hasEditPermissionUser(this.collection)||this.options.admin_permissions,"admin_permissions":this.options.admin_permissions}},"getEmptyView":function(){return this.options.emptyView?this.options.emptyView:w},"emptyViewOptions":function(){return this.options.emptyView?{"model":this.options.emptyViewModel}:this.options},"constructor":function(e){s.CollectionView.prototype.constructor.call(this,e),this.showInlineToolbar=this.options.toolbarItems&&this.options.toolbarItemsMasks,this.showInlineToolbar&&this.setInlineActionBarEvents()},"onRender":function(){if(this.nameColumnIndex=this.getNameColumnIndex(this.options.columns)||0,this.accFocusedCell=this.options.accFocusedCell||{"column":this.nameColumnIndex,"row":0},this.columnState=0,this._columnCount=this.options.columns.length,this._toolbarColumnCount=0,this.hasEditPermission=this.hasEditPermissionUser(this.collection)||this.options.admin_permissions,!this.hasEditPermission)for(var e=0;e<this._columnCount;e++){var i=this.options.columns[e];i.isToolbar&&this._toolbarColumnCount++}},"hasEditPermissionUser":function(i){var t=i.options&&i.options.authenticatedUserPermissions,s=t.get("permissions");return e.contains(s,"edit_permissions")},"setInlineActionBarEvents":function(){this.listenTo(this,"closeOther",this._destroyInlineActionBar),this.listenTo(this.collection,"reset",this._destroyInlineActionBar)},"_showInlineActionBar":function(t){this.inlineToolbarView?this._savedHoverEnterArgs=t:t&&(this._savedHoverEnterArgs=null,this.inlineToolbarView=new u(e.extend({"context":this.options.context,"commands":o,"collection":this.options.toolbarItems.inlineToolbar,"toolItemsMask":this.options.toolbarItemsMasks.toolbars.inlineToolbar,"originatingView":this.options.originatingView,"applyTo":this.options.applyTo,"model":t.model,"status":{"model":t.model,"targetView":t.sender,"connector":this.options.collection.connector,"filterId":this.options.memberFilter.get("id"),"applyTo":this.options.applyTo,"admin_permissions":this.options.admin_permissions},"customError":!0},this.options.toolbarItems.inlineToolbar.options)),this.listenTo(this.inlineToolbarView,"before:execute:command",function(e){this.lockedForOtherContols=!0,e&&e.status&&e.status.targetView&&e.status.targetView.$el&&e.status.targetView.$el.addClass("active-row"),this._destroyInlineActionBar()}),this.listenTo(this.inlineToolbarView,"after:execute:command",function(e){this.lockedForOtherContols=!1,e&&e.status&&e.status.targetView&&e.status.targetView.$el&&e.status.targetView.$el.removeClass("active-row"),this._toolbarActionTriggered(e)}),this.options.originatingView&&(this.listenTo(this.options.originatingView,"block:view:actions",function(){this.lockedForOtherContols=!0,this._destroyInlineActionBar()}),this.listenTo(this.options.originatingView,"unblock:view:actions",function(){this.lockedForOtherContols=!1})),this.inlineToolbarView.render(),this.listenTo(this.inlineToolbarView,"destroy",function(){this.inlineToolbarView=void 0,this._savedHoverEnterArgs&&this.onChildShowInlineActionBarWithDelay(this._savedHoverEnterArgs)},this),i(t.target).append(this.inlineToolbarView.$el),this.inlineToolbarView.triggerMethod("show"))},"onChildShowInlineActionBarWithDelay":function(e,i){this._showInlineActionbarTimeout&&clearTimeout(this._showInlineActionbarTimeout);var t=this;this._showInlineActionbarTimeout=setTimeout(function(){t._showInlineActionbarTimeout=void 0,t.lockedForOtherContols||t._showInlineActionBar.call(t,i)},200)},"onChildActionBarShouldDestroy":function(e,i){this._showInlineActionbarTimeout&&(clearTimeout(this._showInlineActionbarTimeout),this._showInlineActionbarTimeout=void 0),this.inlineToolbarView&&this.inlineToolbarView.destroy()},"onChildviewBeforeExecuteAction":function(){n.isTouchBrowser()&&this.children.each(function(e,i){e.inlineRowToolbarView&&e.inlineRowToolbarView.$el&&e.inlineRowToolbarView.$el.addClass("binf-disabled")})},"onChildviewAfterExecuteAction":function(){n.isTouchBrowser()&&this.children.each(function(e,i){e.inlineRowToolbarView&&e.inlineRowToolbarView.$el&&(e.inlineRowToolbarView.$el.removeClass("binf-disabled"),e.$el.find("active-row")&&e.$el.removeClass("active-row"))})},"_destroyInlineActionBar":function(){this.inlineToolbarView&&(this.inlineToolbarView.destroy(),this.inlineToolbarView=void 0)},"_toolbarActionTriggered":function(e){e&&e.commandSignature&&this.trigger("after:action:execute",e),this.currentlyFocusedElement().focus()},"currentlyFocusedElement":function(){if(this.collection.length>0&&null!=this.accFocusedCell.column){var e=this.children.findByIndex(this.accFocusedCell.row);return e&&e.$el.find(".csui-table-cell:nth-child("+(this.accFocusedCell.column+1)+")").children("DIV")}return i()},"onClickedCell":function(e,i){this.accFocusedCell.row=i.rowIndex,i.colIndex<this._columnCount-this._toolbarColumnCount?this.accFocusedCell.column=i.colIndex:this.accFocusedCell.column=this._columnCount-this._toolbarColumnCount-1,this._accSetFocusToCurrentlyFocusedElement()},"onKeyInView":function(e){var t,s,n,o=!0,l=this.currentlyFocusedElement();switch(e.keyCode){case 33:this.accFocusedCell.row=0;break;case 34:this.collection.length>0?this.accFocusedCell.row=this.collection.length-1:this.accFocusedCell.row=0;break;case 35:this.accFocusedCell.column=this._columnCount-this._toolbarColumnCount-1;break;case 36:this.accFocusedCell.column=0;break;case 37:if(this.accFocusedCell.column>0&&(t=this.accFocusedCell.column,this.accFocusedCell.column--,l=this.currentlyFocusedElement(),"true"===l.attr("data-csui-empty-cell")&&l.children().length<1)){var r=this._getNextFocusableElementIndex(37,--this.accFocusedCell.column);this.accFocusedCell.column=r>=0?r:t}break;case 38:if(this.$(".binf-dropdown-toggle").parent(".binf-dropdown").hasClass("binf-open")){s=this.$(".binf-dropdown-menu li").length-1,n=i(document.activeElement.parentElement).index(),s<=n&&(n-=1,this.$(this.$(".binf-dropdown-menu li a")[n]).focus().focus()),o=!1;break}this.accFocusedCell.row>0&&(t=this.accFocusedCell.column,this.accFocusedCell.row--,l=this.currentlyFocusedElement(),"true"===l.attr("data-csui-empty-cell")&&l.children().length<1&&(this.accFocusedCell.row=t));break;case 39:this.accFocusedCell.column<this._columnCount-this._toolbarColumnCount-1&&(t=this.accFocusedCell.column,this.accFocusedCell.column++,l=this.currentlyFocusedElement(),"true"===l.attr("data-csui-empty-cell")&&l.children().length<1&&(this.accFocusedCell.column=t));break;case 40:if(this.$(".binf-dropdown-toggle").parent(".binf-dropdown").hasClass("binf-open")){s=this.$(".binf-dropdown-menu li").length-1,n=i(document.activeElement.parentElement).index(),s>n&&(n+=1,this.$(this.$(".binf-dropdown-menu li a")[n]).focus().focus()),o=!1;break}this.accFocusedCell.row<this.collection.length-1&&(t=this.accFocusedCell.row,this.accFocusedCell.row++);break;default:o=!1}o&&(e.preventDefault(),e.stopPropagation(),this.trigger("closeOther"),this._accSetFocusToCurrentlyFocusedElement())},"_getNextFocusableElementIndex":function(e,i){var t=this.currentlyFocusedElement();switch(e){case 37:return this.accFocusedCell.column>=0&&"true"===t.attr("data-csui-empty-cell")?i:-1;default:return-1}},"_accSetFocusToCurrentlyFocusedElement":function(){var e=this.currentlyFocusedElement();e.length>0&&(e=i(e[0]),this.trigger("changed:focus",this),n.isVisibleInWindowViewport(e)&&e.focus())},"getNameColumnIndex":function(e){if(e)for(var i=0;i<e.length;i++){var t=e[i];if(t.isNaming)return i}}}),T=s.LayoutView.extend({"className":"csui-table-list","attributes":function(){return{"role":"table"}},"template":g,"regions":{"headerRegion":".csui-table-list-header","bodyRegion":".csui-table-list-body"},"behaviors":{"PerfectScrolling":{"behaviorClass":h,"contentParent":".csui-table-list-body","suppressScrollX":!0}},"constructor":function(t){t||(t={}),t.maxColumnsDisplayed||(t.maxColumnsDisplayed=10),t.tableColumns||(t.tableColumns=[]),s.LayoutView.prototype.constructor.call(this,t),this.context=t.context,this.collection=t.collection,this.listenTo(this.collection.delayedActions,"error",function(e,i,t){var s=new n.Error(i);c.showMessage("error",s.message)}),this.listenTo(this.collection,"sync",this._updateTable),this.listenTo(this.collection,"update",this.render),this.listenTo(this,"update:table",this._updateTable),this.onTableWinResize=e.bind(function(e){this._adjustColumnsAfterWindowResize(),this.trigger("resizetable",e)},this),i(window).bind("resize",this.onTableWinResize),i(window).bind("resize.tableview",this.onTableWinResize)},"onBeforeDestroy":function(){i(window).unbind("resize",this.onTableWinResize)},"_updateTable":function(e){if(this.tableBodyView&&this.tableBodyView.accFocusedCell){var i=this.tableBodyView.accFocusedCell.row,t=this.tableBodyView.accFocusedCell.column;e===this.collection?this.render():(this.tableBodyView.children.findByModel(e).render(),this.triggerMethod("dom:refresh")),this.tableBodyView.accFocusedCell.row=i,this.tableBodyView.accFocusedCell.column=t,this.tableBodyView.trigger("changed:focus",this.tableBodyView)}else this.render()},"onRender":function(){this.allColumns=this.getColumns(),this.displayedColumns=e.where(this.allColumns,{"columnWrapped":!1}),this.wrappedColumns=e.where(this.allColumns,{"columnWrapped":!0}),this.tableHeaderView=new _({"columns":this.displayedColumns,"context":this.context,"admin_permissions":this.options.admin_permissions,"userPermissionsModel":this.collection.options.authenticatedUserPermissions,"hasPermissionAction":!!this.options.hasPermissionAction}),this.headerRegion.show(this.tableHeaderView),this.tableBodyView=new C(e.defaults({"columns":this.displayedColumns,"wrappedColumns":this.wrappedColumns,"context":this.context,"collection":this.collection,"toolbarItems":this.options.toolbarItems,"toolbarItemsMasks":this.options.toolbarItemsMasks,"emptyView":this.options.emptyView,"authUser":this.options.authUser,"admin_permissions":!!this.options.admin_permissions,"emptyViewModel":this.options.emptyViewModel},this.options)),this.bodyRegion.show(this.tableBodyView);var i=this;this.$el.find(".csui-table-list-body").bind("scroll",function(e){i.trigger("scroll",e)}),this._rebuildingTable=!1},"onBeforeRender":function(){this._rebuildingTable=!0},"onDomRefresh":function(e){this.$el.is(":visible")&&(this._adjustColumnsAfterWindowResize(),this.trigger("resizetable",e))},"getColumns":function(){var i=[];if(this.options.tableColumns){var t=this.options.tableColumns.deepClone(),s=[];t.each(function(e){var i=e,t=e.get("key");e.attributes.column_key=t,s.push(i)},this),i=e.map(s,function(i){var t=r.getCellView(i),s=i.get("column_key"),n=t.columnClassName;n||(n="csui-table-cell-"+s);var o=["permanentColumn","noTitleInHeader","title","align","widthFactor","isNaming","containsInlineActions"];e.each(o,function(e){t[e]&&i.set(e,t[e],{"silent":!0})});var l={"CellView":t,"name":s,"noTitleInHeader":i.get("noTitleInHeader"),"isToolbar":i.get("isToolbar"),"title":i.get("title")||i.get("name")||i.get("column_name"),"className":n},a=i.get("align");return a&&(window.csui&&window.csui.rtl&&("left"===a&&(a="right")||"right"===a&&(a="left")),l.className+=" csui-align-"+a),i.attributes&&(l.attributes=l.attributes||{},e.extend(l.attributes,i.attributes)),l})}if(this.options.maxColumnsDisplayed||this.maxColumnsDisplayed){var n=0;e.each(i,function(e){e.attributes&&!0===e.attributes.permanentColumn&&(n++,e.columnWrapped=!1)},this),this.maxColumnsDisplayed=this.calculateMaxColumnsDisplayed(i),e.each(i,function(e){e.attributes&&!0===e.attributes.permanentColumn||(n++,e.columnWrapped=n>this.maxColumnsDisplayed)},this)}return i},"_adjustColumns":function(){if(this.displayedColumns&&this.$el.is(":visible")){var t,s=this.$el.width()-5,n=0,o=0,l=this.$el.find(".csui-table-header-cell");t=this.collection.length>0?this.$el.find(".csui-table-body>div").first().find(".csui-table-cell"):l;var r,a={},c=[],u=this.displayedColumns,d=0,h=0,p=0,m=0;t.each(function(e){if(e<u.length){var t=i(this),s=u[e];if(s.CellView&&s.CellView.hasFixedWidth)o+=t.outerWidth(),n++;else{var l=s.attributes&&s.attributes.widthFactor||1;l&&1!==l?(a[e]=l,d+=l):s.CellView&&s.CellView.flexibleWidth?(p+=t.outerWidth(),m++):(c.push(e),d+=1),l>h&&(h=l,r=e)}}});var f=s-o-p-4*u.length,g=u.length-n-m,b=g>0?f/g:0,v=0,w=d/g;e.each(a,function(e,i){var t=e/w,s=b*t;v+s>f&&(s=f-v)<0&&(s=0),s=Math.floor(s),a[i]=s,v+=s});var y;c.length>0?(b=(f-v)/c.length/w,b=Math.floor(b),y=f-v-b*c.length):(b=0,y=f-v),y=Math.floor(y);var _={},C=this;t.each(function(e){if(e<u.length){var t=i(this),s=u[e],n=s.CellView&&s.CellView.hasFixedWidth,o={"width":t.outerWidth()+"px"};if(!n){var c;c=a[e]&&a[e]>0?a[e]:b,e===r&&y&&(c+=y);var d=c+"px";s.CellView.flexibleWidth?i(l[e]).css(o):(o={"min-width":d,"max-width":d},i(l[e]).css(o));C.$el.find(".csui-table-cell:nth-child("+(e+1)+")").css(o)}_[s.className]=o}}),this.cachedColumnWidths=_}},"calculateMaxColumnsDisplayed":function(i){if(i&&0!==i.length){var t,s,n=0,o=0;if(this.$el.length>0&&this.$el[0].children.length>0){var l=this.$el.width();e.each(i,function(e){e.attributes&&!0===e.attributes.permanentColumn&&(t=e.attributes.widthFactor,s=t?120*t:120,o+=s,n++)},this);for(var r=0;r<i.length;r++){var a,c=i[r];if(c.attributes&&!c.attributes.permanentColumn){if(t=c.attributes.widthFactor,a=120,s=t?a*t:a,(o+=s)>l)break;n++}}n>this.options.maxColumnsDisplayed&&(n=this.options.maxColumnsDisplayed),n<1&&(n=1)}else n=this.options.maxColumnsDisplayed;return n}},"_adjustColumnsAfterWindowResize":function(){if(this.allColumns.length){if(this.maxColumnsDisplayed&&this.$el.is(":visible")){var i=this.calculateMaxColumnsDisplayed(this.allColumns);if(i!==this.maxColumnsDisplayed&&(this.maxColumnsDisplayed=i,!this._rebuildingTable))return setTimeout(e.bind(this.render,this))}this._adjustColumns()}}});return e.extend(T.prototype,l),T}),csui.define("csui/controls/tabletoolbar/impl/nls/localized.strings",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/tabletoolbar/impl/nls/root/localized.strings",{"ToolbarItemFilter":"Show filters","ToolbarItemFilterAria":"Show filter panel","ToolbarItemOpen":"Open","ToolbarItemDownload":"Download","ToolbarItemBrowse":"Browse","ToolbarItemCopy":"Copy","ToolbarItemEmailLink":"Email link","ToolbarItemPaste":"Paste","ToolbarItemMove":"Move","ToolbarItemShare":"Share","ToolbarItemNavigate":"Visit","ToolbarItemViewProperties":"Properties","ToolbarItemVersionHistory":"Version history","ToolbarItemDelete":"Delete","ToolbarItemReserve":"Reserve","ToolbarItemUnreserve":"Unreserve","ToolbarItemEdit":"Edit","ToolbarItemRename":"Rename","ToolbarItemRenameFavorite":"Rename Favorite","ToolbarItemOpenSavedQuery":"Open","ToolbarItemExecuteSavedQuery":"Execute","ToolbarItemInfo":"Properties","ToolbarItemTimeline":"Timeline","ToolbarItemToggleTableLayout":"Toggle layout","ToolbarItemSettings":"Settings","ToolbarItemAddFolder":"Folder","ToolbarItemAddDocument":"Document","ToolbarItemAdd":"Add","ToolbarItemAddItem":"Add Item","ToolbarItemAddVersion":"Add version","ToolbarItemAddCategories":"Add Categories","ToolbarItemMore":"More actions","ToolbarItemPrint":"Print","ToolbarItemOriginalEdit":"Edit original","ToolbarItemOriginalShare":"Share original","ToolbarItemOriginalReserve":"Reserve original","ToolbarItemOriginalUnreserve":"Unreserve original","ToolbarItemOriginalCopy":"Copy original","ToolbarItemOriginalMove":"Move original","ToolbarItemOriginalDownload":"Download original","ToolbarItemOriginalDelete":"Delete original","ToolbarItemCopyLink":"Copy link","ToolbarItemOriginalCopyLink":"Copy link original","ToolbarItemPermissions":"View permissions","ToolbarItemDeletePermission":"Remove from list","ToolbarItemEditPermission":"Edit permissions","ToolbarItemApplyPermission":"Apply permissions to sub-items","ToolbarItemChangeOwnerPermission":"Change owner",
"ToolbarItemRemoveCollectionItems":"Remove from collection","ToolbarItemInformation":"Properties","ToolbarGoToLocation":"Go to location","ToolbarCollect":"Collect","ToolbarItemZipAndDownload":"Download","MenuItemUploadFile":"Upload file","MenuItemAddNewFolder":"Add new Folder","MenuItemZipAndDownload":"Download","MenuItemCopy":"Copy","MenuItemMove":"Move","MenuItemEmailLink":"Email link","MenuItemShare":"Share","MenuItemReserve":"Reserve","MenuItemUnreserve":"Unreserve","MenuItemDelete":"Delete","MenuItemSendToDevice":"Send to device","MenuItemRename":"Rename","MenuItemTimeline":"Timeline","MenuItemInformation":"Properties","MenuItemCopyLink":"Copy link","ToolbarItemComment":"Comment","ToolbarItemShowDescription":"Show description","ToolbarItemConfiguration":"Configuration","ToolbarItemMaximizeWidgetView":"Maximize widget view","ToolbarItemRestoreWidgetViewSize":"Restore widget view size","AddUserOrGroups":"Add user or groups","AddOwnerOrGroup":"Add owner or owner group","RestorePublicAccess":"Restore public access","AddToolbarItemsTitle":"Add {0}","ToolbarItemThumbnail":"Grid view","ToolbarItemListView":"List view","ThumbnailTitle":"Grid view","ListViewTitle":"List view"}),csui.define("hbs!csui/controls/tabletoolbar/impl/tabletoolbar",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){return'<div class="csui-tabletoolbar tile-nav" aria-label="Table menubar" role="menu">\r\n  <div class="csui-filterToolbar" ></div>\r\n  <div class="csui-addToolbar" role="menuitem"></div>\r\n  <div class="csui-leftToolbar" ></div>\r\n  <div class="csui-otherToolbar" ></div>\r\n  <div class="csui-toolbar-caption" ></div>\r\n  <div class="csui-rightToolbar" ></div>\r\n</div>\r\n'}});return t.registerPartial("csui_controls_tabletoolbar_impl_tabletoolbar",s),s}),csui.define("css!csui/controls/tabletoolbar/impl/tabletoolbar",[],function(){}),csui.define("csui/controls/tabletoolbar/tabletoolbar.view",["module","require","csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/utils/log","csui/utils/base","csui/models/nodes","csui/controls/toolbar/toolitem.model","csui/controls/toolbar/toolitems.filtered.model","csui/controls/toolbar/toolbar.view","csui/controls/item.title/item.title.view","csui/controls/toolbar/delayed.toolbar.view","csui/utils/commandhelper","csui/utils/commands/add","i18n!csui/controls/tabletoolbar/impl/nls/localized.strings","csui/controls/table/inlineforms/inlineform.factory","hbs!csui/controls/tabletoolbar/impl/tabletoolbar","csui/controls/mixins/layoutview.events.propagation/layoutview.events.propagation.mixin","csui/controls/mixins/global.alert/global.alert.mixin","csui/behaviors/keyboard.navigation/tabable.region.behavior","csui/controls/toolbar/toolbar.state.behavior","csui/controls/toolbar/toolbar.command.controller","csui/utils/commands","csui-ext!csui/controls/tabletoolbar/tabletoolbar.view","csui/lib/jquery.when.all","css!csui/controls/tabletoolbar/impl/tabletoolbar"],function(e,i,t,s,n,o,l,r,a,c,u,d,h,p,m,f,g,b,v,w,y,_,C,T,x,k){"use strict";var S=o.LayoutView.extend({"template":v,"regions":{"filterToolbarRegion":".csui-filterToolbar","addToolbarRegion":".csui-addToolbar","leftToolbarRegion":".csui-leftToolbar","otherToolbarRegion":".csui-otherToolbar","toolbarCaptionRegion":".csui-toolbar-caption","rightToolbarRegion":".csui-rightToolbar"},"behaviors":{"TabableRegion":{"behaviorClass":_}},"toolbarItemSelector":"a."+_.accessibilityFocusableClass+",button."+_.accessibilityFocusableClass+",div."+_.accessibilityFocusableClass,"events":{"keydown":"onKeyInView"},"currentlyFocusedElement":function(){var e=this.$(this.toolbarItemSelector);return e.length?t(e[this.accNthToolbarItemFocused]):null},"constructor":function(e){e||(e={}),this.context=e.context,this.commandController=e.toolbarCommandController||new T({"commands":e.commands||x}),this.addableTypes=e.addableTypes,this.originatingView=e.originatingView||this,this.blockingParentView=e.blockingParentView,this.selectedNodes=new a,this.accNthToolbarItemFocused=0,this.toolbarNames=["filter","add","left","other","right"],o.LayoutView.prototype.constructor.apply(this,arguments),this.listenTo(this,"before:regions:reinitialize",this.initialize)},"initialize":function(e){this.container=e.container||this.collection&&this.collection.node;var i={"context":this.context,"nodes":this.selectedNodes,"container":e.removeContainer?void 0:this.container,"collection":this.collection,"originatingView":this.originatingView,"data":{"addableTypes":this.addableTypes}};s.each(this.toolbarNames,function(e){var t=e+"Toolbar",n=this.options.toolbarItems[t];if(n){var o=this.options.toolbarItemsMasks&&this.options.toolbarItemsMasks.toolbars[t],l=this.collection&&this.collection.delayedActions,r=new u(n,{"status":i,"commands":this.commandController.commands,"delayedActions":l,"mask":o});this.container&&this.listenTo(this.container.actions,"reset update",function(){r.refilter()});var a=d,c=new a(s.extend({"collection":r,"toolbarName":e,"toolbarCommandController":this.commandController,"toolbarItemsMask":o,"originatingView":this.originatingView,"blockingParentView":this.blockingParentView},n.options));this[e+"ToolbarView"]=c,c.closeDropdown&&c.listenTo(this,"changed:focus close:dropdown",c.closeDropdown),this.listenTo(c,"childview:toolitem:action",this._toolbarItemClicked).listenTo(c,"dom:refresh",function(){this.triggerMethod("refresh:tabindexes")}).listenTo(this.commandController,"after:execute:command",function(e){if(e&&e.cancelled){var i=this.$el.find("[data-csui-command="+e.commandSignature.toLowerCase()+"] a"),t=i.length?i.closest("ul.csui-more-dropdown-menu"):{};t.length?t.siblings("a.binf-dropdown-toggle").focus():i.focus()}}),c instanceof p&&this.listenTo(this.selectedNodes,"reset",function(){c.actionState.set("showMessage",!!this.selectedNodes.length)})}},this),this.options.toolbarItems.addToolbar&&this.addableTypes&&(this._updateAddToolbar(),this.listenTo(this.addableTypes,"reset",this._updateAddToolbar,this)),this.options.headermenuItems&&this.options.headermenuItems.headerMenuToolbar&&this.container&&(this.captionView=new h({"model":this.container,"toolItems":this.options.headermenuItems.headerMenuToolbar,"toolItemsMask":this.options.headermenuItemsMask,"context":this.context,"commands":this.commandController.commands,"originatingView":this.originatingView}),this.captionView.listenTo(this,"changed:focus",this.captionView.closeMenu)),this.propagateEventsToRegions(),this.prepareForGlobalAlert();var t=this;k&&k.forEach(function(e){e(t)})},"_moveTo":function(e){e.preventDefault(),e.stopPropagation(),this.trigger("changed:focus",this),this.currentlyFocusedElement().focus()},"onKeyInView":function(e){var i;if(!t(e.target).is(":input")||t(e.target).hasClass(_.accessibilityFocusableClass))switch(e.keyCode){case 9:this.trigger("close:dropdown");break;case 37:i=this.$(this.toolbarItemSelector),this.accNthToolbarItemFocused>0&&this.accNthToolbarItemFocused--,this._moveTo(e);break;case 39:i=this.$(this.toolbarItemSelector),this.accNthToolbarItemFocused<i.length-1&&this.accNthToolbarItemFocused++,this._moveTo(e);break;case 35:t(e.target).closest("ul").hasClass("binf-dropdown-menu")||(i=this.$(this.toolbarItemSelector),this.accNthToolbarItemFocused=i.length-1,this._moveTo(e));break;case 36:t(e.target).closest("ul").hasClass("binf-dropdown-menu")||(this.accNthToolbarItemFocused=0,this._moveTo(e))}},"_updateAddToolbar":function(){var e=[];this.addableTypes.each(function(i){var t,n=i.get("type"),o=f.isAddableTypeWithoutInlineForm(n);if(o||(t=b.getInlineFormView(n)),o||t){var l=new c({"signature":"Add","name":i.get("type_name"),"title":s.str.sformat(g.AddToolbarItemsTitle,i.get("type_name")),"type":n,"group":"add","commandData":{"type":n,"addableTypes":this.addableTypes}});e.push(l)}},this);var i=[],n=this;this.triggerMethod("before:updateAddToolbar",{"context":this.context,"container":this.container,"addableTypes":this.addableTypes,"toolbarItems":e,"async":function(){var e=t.Deferred();return i.push(e),function(){e.resolve()}}}),t.whenAll.apply(t,i).always(function(){n.options.creationToolItemsMask&&(e=n.options.creationToolItemsMask.maskItems(e)),n.options.toolbarItems.addToolbar.reset(e)})},"_toolbarItemClicked":function(e,i){var t={"context":this.context,"nodes":this.selectedNodes.clone(),"container":this.container,"collection":this.collection,"originatingView":this.originatingView,"toolItemView":e};this.commandController.toolitemClicked(i.toolItem,t)},"updateForSelectedChildren":function(e){this.selectedNodes.reset(e)},"onRender":function(){this.options.height&&this.$el.height(this.options.height),s.each(this.toolbarNames,function(e){var i=this[e+"ToolbarView"];i&&(i.collection.refilter(),this[e+"ToolbarRegion"].show(i))},this),this.captionView&&this.toolbarCaptionRegion.show(this.captionView)}});return s.extend(S.prototype,w),s.extend(S.prototype,y),S}),csui.define("hbs!csui/controls/table.configuration.toolbar/impl/configuration.toolbar.dropdown",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){var n;return'<div class="binf-dropdown">\r\n  <button id="'+this.escapeExpression((n=null!=(n=i.btnId||(null!=e?e.btnId:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"btnId","hash":{}}):n))+'" type="button" class="binf-dropdown-toggle csui-acc-focusable"\r\n          data-binf-toggle="dropdown" aria-haspopup="true" aria-expanded="false"\r\n          title="'+this.escapeExpression((n=null!=(n=i.configurationButtonTooltip||(null!=e?e.configurationButtonTooltip:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"configurationButtonTooltip","hash":{}}):n))+'" aria-label="'+this.escapeExpression((n=null!=(n=i.configurationButtonTooltip||(null!=e?e.configurationButtonTooltip:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"configurationButtonTooltip","hash":{}}):n))+'">\r\n    <span class="icon icon-toolbar-settings"></span>\r\n  </button>\r\n  <ul class="binf-dropdown-menu" role="menu"></ul>\r\n</div>\r\n'}});return t.registerPartial("csui_controls_table.configuration.toolbar_impl_configuration.toolbar.dropdown",s),s}),csui.define("csui/controls/table.configuration.toolbar/impl/nls/localized.strings",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/table.configuration.toolbar/impl/nls/root/localized.strings",{"configurationButtonTooltip":"Settings"}),csui.define("css!csui/controls/table.configuration.toolbar/impl/configuration.toolbar.dropdown",[],function(){}),csui.define("csui/controls/table.configuration.toolbar/configuration.toolbar.dropdown.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/utils/log","csui/controls/toolbar/toolitem.view","csui/models/nodes","csui/controls/toolbar/toolitems.filtered.model","csui/utils/commands","csui/controls/toolbar/toolbar.command.controller","csui/behaviors/dropdown.menu/dropdown.menu.behavior","csui/controls/tile/behaviors/perfect.scrolling.behavior","hbs!csui/controls/table.configuration.toolbar/impl/configuration.toolbar.dropdown","i18n!csui/controls/table.configuration.toolbar/impl/nls/localized.strings","css!csui/controls/table.configuration.toolbar/impl/configuration.toolbar.dropdown","csui/lib/binf/js/binf"],function(e,i,t,s,n,o,l,r,a,c,u,d,h,p){return s.CompositeView.extend({"className":"csui-configuration-view","template":h,"templateHelpers":function(){return{"btnId":i.uniqueId("configurationButton"),"configurationButtonTooltip":p.configurationButtonTooltip}},"childView":o,"childViewContainer":"ul.binf-dropdown-menu","childViewOptions":function(e){return{"renderTextOnly":!0,"role":"menuitem"}},"ui":{"dropdownDiv":".binf-dropdown","dropdownToggle":".binf-dropdown-toggle","dropdownMenu":".binf-dropdown-menu","loadingIconsDiv":".csui-loading-parent-wrapper"},"behaviors":{"DropdownMenuBehavior":{"behaviorClass":u},"PerfectScrolling":{"behaviorClass":d,"contentParent":".command-view-region"}},"constructor":function(e){e||(e={}),this.context=e.context,this.commands=e.commands||a,this.commandController=e.toolbarCommandController||new c({"commands":this.commands}),this.selectedNodes=e.status&&e.status.nodes||new l,this.container=e.container,this.status=e.status||{"context":this.context,"nodes":this.selectedNodes,"container":this.container},e.collection=new r(e.toolbarItems,{"status":this.status,"commands":this.commands,"mask":e.toolbarItemsMask}),s.CompositeView.prototype.constructor.apply(this,arguments),this.listenTo(this,"childview:toolitem:action",this._triggerMenuItemAction).listenTo(t,"closeToggleAction",this._closeToggle)},"enabled":function(){return!!this.options.context},"onRender":function(){this.collection.length<1?(this.$el.addClass("binf-hidden"),this.ui.dropdownToggle.attr("data-cstabindex","-1"),this.ui.dropdownToggle.removeClass("csui-acc-focusable")):(this.$el.find(".binf-dropdown").removeClass("binf-hidden"),this.$el.removeClass("binf-hidden"),this.ui.dropdownToggle.attr("data-cstabindex","0"),this.ui.dropdownToggle.addClass("csui-acc-focusable")),this.collection.length>0&&(this.ui.dropdownToggle.binf_dropdown(),this.ui.dropdownDiv.on("hide.binf.dropdown",i.bind(function(){this._showMenuItems()},this)))},"_closeToggle":function(){var e=this.$el.find(".binf-dropdown-toggle");e.parent().hasClass("binf-open")&&e.binf_dropdown("toggle",!1),this._showMenuItems()},"_triggerMenuItemAction":function(e,t){if(t&&t.toolItem&&!0===t.toolItem.get("menuWithMoreOptions"))this._toolitemClicked(e,t);else{this.$el.find(".binf-dropdown-toggle").binf_dropdown("toggle");var s=i.extend(this.status,{"originatingView":this.options.originatingView,"blockingParentView":this.options.blockingParentView,"configurationMenuView":this,"toolItemView":e});this.commandController.toolitemClicked(t.toolItem,s)}},"_toolitemClicked":function(e,t){var s=this,n=t.toolItem.get("signature"),o=this.commandController.commands.findWhere({"signature":n}),l=i.extend(this.status,{"originatingView":this.options.originatingView,"blockingParentView":this.options.blockingParentView,"configurationMenuView":this,"toolItemView":e}),r=i.extend({},l.data,t.toolItem.get("commandData"));l=i.defaults({"toolItem":t.toolItem,"data":r},l);var a={"status":l,"commandSignature":n,"command":o};this.commandController.trigger("before:execute:command",a);var c={"context":l.context};o.execute(l,c).done(function(e){e&&e.viewClass&&s._showCommandViewInDropdownMenu(e.viewClass,e.viewOptions||{}),s.commandController.trigger("after:execute:command",a)}).fail(function(e){void 0===e&&(e={"cancelled":!0,"commandSignature":n}),s.commandController.trigger("after:execute:command",e)})},"_showCommandViewInDropdownMenu":function(e,t){var s=new e(t);this.listenTo(s,"go:back",i.bind(function(){this._showMenuItemsWithAnimation()},this)),this.listenTo(s,"close:menu",i.bind(function(){this._showMenuItems(),this._closeToggle()},this)),this.listenTo(s,"dom:refresh",i.bind(function(){this.trigger("render"),this.trigger("update:scrollbar")},this)),this._ensureCommandViewRegion(),this.commandViewRegion.show(s),this._hideMenuItemsWithAnimation()},"_ensureCommandViewRegion":function(){if(!this.commandViewRegion){this.ui.dropdownMenu.append('<div class="command-view-region"></div>');var e=this.ui.dropdownMenu.find(".command-view-region");this.commandViewRegion=new s.Region({"el":e}),e.on("click",function(e){e.preventDefault(),e.stopPropagation()}),this.commandViewRegion.$el.hide()}},"_emptyCommandViewRegion":function(){this.commandViewRegion&&this.commandViewRegion.empty()},"_showMenuItems":function(){this.ui.dropdownMenu.find("> li").show(),this._emptyCommandViewRegion(),this.commandViewRegion&&this.commandViewRegion.$el.hide()},"_showMenuItemsWithAnimation":function(){var e=this,i=this.ui.dropdownMenu.find(".csui-icon-rightArrow");i.addClass("binf-hidden"),e.ui.dropdownMenu.css("overflow","hidden"),e.ui.dropdownMenu.animate({"width":e.dropdownMenuOriginalWidth,"height":e.dropdownMenuOriginalHeight},500),e.commandViewRegion.$el.css({"position":"absolute","top":e.ui.dropdownMenu.css("padding-top"),"background-color":e.ui.dropdownMenu.css("background-color"),"opacity":1}),e.ui.dropdownMenu.find("> li").show(),e.commandViewRegion.$el.hide("blind",{"direction":"right","complete":function(){e._emptyCommandViewRegion(),i.removeClass("binf-hidden"),e.commandViewRegion.$el.css({"position":"","top":"","background-color":"","opacity":""}),e.ui.dropdownMenu.css({"overflow":"","width":"","height":""})}},500)},"_hideMenuItemsWithAnimation":function(){var e=this,i=this.ui.dropdownMenu.find(".csui-icon-rightArrow");i.addClass("binf-hidden"),e.dropdownMenuOriginalWidth=e.ui.dropdownMenu.css("width"),e.dropdownMenuOriginalHeight=e.ui.dropdownMenu.css("height"),e.ui.dropdownMenu.css("overflow","hidden"),e.ui.dropdownMenu.animate({"width":e.commandViewRegion.$el.width(),"height":e.commandViewRegion.$el.height()},500),e.commandViewRegion.$el.css({"position":"absolute","top":e.ui.dropdownMenu.css("padding-top"),"background-color":e.ui.dropdownMenu.css("background-color"),"opacity":1}),e.commandViewRegion.$el.show("blind",{"direction":"right","complete":function(){e.ui.dropdownMenu.find("> li").hide(),i.removeClass("binf-hidden"),e.commandViewRegion.$el.css({"position":"","top":"","background-color":"","opacity":""}),e.ui.dropdownMenu.css({"width":"","height":""})}},500)}})}),csui.define("csui/controls/table/inlineforms/favorite/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/table/inlineforms/favorite/impl/nls/root/lang",{"CancelButtonLabel":"Cancel","NewNamePlaceholder":"Enter name"}),csui.define("hbs!csui/controls/table/inlineforms/favorite/impl/favorite",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"1":function(e,i,t,s){var n;return'    <button type="button" class="csui-btn-edit-cancel binf-btn"><span class="icon edit-cancel"\r\n                                                                 title="'+this.escapeExpression((n=null!=(n=i.EditCancelTooltip||(null!=e?e.EditCancelTooltip:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"EditCancelTooltip","hash":{}}):n))+'"></span>\r\n    </button>\r\n'},"3":function(e,i,t,s){var n;return'    <button type="button" class="csui-btn-metadata binf-btn"><span\r\n        class="icon icon-toolbar-metadata"></span></button>\r\n    <button type="button"\r\n            class="csui-btn-save csui-btn binf-btn" disabled>'+this.escapeExpression((n=null!=(n=i.SaveButtonLabel||(null!=e?e.SaveButtonLabel:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"SaveButtonLabel","hash":{}}):n))+'</button>\r\n    <button type="button" class="csui-btn-cancel csui-btn binf-btn">'+this.escapeExpression((n=null!=(n=i.CancelButtonLabel||(null!=e?e.CancelButtonLabel:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"CancelButtonLabel","hash":{}}):n))+"</button>\r\n"},"5":function(e,i,t,s){var n;return'  <div class="csui-inlineform-group csui-inlineform-group-error" role="alert">\r\n    <div class="binf-text-danger" title="'+this.escapeExpression((n=null!=(n=i.errorMessage||(null!=e?e.errorMessage:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"errorMessage","hash":{}}):n))+'><span class="csui-text-danger">'+this.escapeExpression((n=null!=(n=i.errorMessage||(null!=e?e.errorMessage:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"errorMessage","hash":{}}):n))+"</span></div>\r\n  </div>\r\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){var n,o;return'<form class="csui-inlineform-group csui-inlineform-group-favorite-name">\r\n  <input type="text" value="'+this.escapeExpression((o=null!=(o=i.name||(null!=e?e.name:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"name","hash":{}}):o))+'" placeholder="'+this.escapeExpression((o=null!=(o=i.namePlaceholder||(null!=e?e.namePlaceholder:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"namePlaceholder","hash":{}}):o))+'"\r\n         class="binf-form-control csui-inlineform-input-name">\r\n'+(null!=(n=i.if.call(e,null!=e?e.formModeIsEdit:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.program(3,s,0)}))?n:"")+"</form>\r\n"+(null!=(n=i.if.call(e,null!=e?e.haveErrorMessage:e,{"name":"if","hash":{},"fn":this.program(5,s,0),"inverse":this.noop}))?n:"")}});return t.registerPartial("csui_controls_table_inlineforms_favorite_impl_favorite",s),s}),csui.define("css!csui/controls/table/inlineforms/favorite/impl/favorite",[],function(){}),csui.define("csui/controls/table/inlineforms/favorite/favorite.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/marionette","i18n!csui/controls/table/inlineforms/favorite/impl/nls/lang","csui/controls/table/inlineforms/inlineform.registry","csui/controls/table/inlineforms/inlineform/impl/inlineform.view","hbs!csui/controls/table/inlineforms/favorite/impl/favorite","css!csui/controls/table/inlineforms/favorite/impl/favorite"],function(e,i,t,s,n,o,l){return o.extend({"className":function(){var e="csui-inlineform-favorite";return o.prototype.className&&(e+=" "+i.result(o.prototype,"className")),e},"template":l,"templateHelpers":function(){var e=this._templateHelpers(),t=!this.model.get("favorite_name");return i.extend(e,{"name":this.model.get("favorite_name"),"namePlaceholder":s.NewNamePlaceholder,"disableSavebtn":t})},"ui":{},"constructor":function e(t){this.options=t||{},this.ui=i.extend({},this.ui,o.prototype.ui),this.events=i.extend({},this.events,o.prototype.events),e.__super__.constructor.apply(this,arguments)},"_saveIfOk":function(){var e=this._getInputName(),i=this.model.get("favorite_name");e.length>0&&e===i?this.cancel():e.length>0&&this._save({"favorite_name":e})}},{"CSSubType":void 0})}),csui.define("csui/controls/table/inlineforms/permissions/user.picker/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/table/inlineforms/permissions/user.picker/impl/nls/root/lang",{"CancelButtonLabel":"Cancel","SaveButtonLabel":"Save","UserPickerPlaceHolder":"Enter name","InvalidUser":"Invalid user"}),csui.define("hbs!csui/controls/table/inlineforms/permissions/user.picker/impl/user.picker",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){return'<div id="csui-inline-permissions-user-picker" class="csui-inline-permissions-user-picker"></div>\r\n<div class="csui-user-picker-buttons csui-inlineform-group">\r\n  <button class="binf-btn csui-btn binf-btn-primary cs-save-button" tabindex="-1" disabled>'+this.escapeExpression(this.lambda(null!=e?e.SaveButtonLabel:e,e))+'</button>\r\n  <button class="binf-btn csui-btn binf-btn-default cs-cancel-button" tabindex="-1">'+this.escapeExpression(this.lambda(null!=e?e.CancelButtonLabel:e,e))+'</button>\r\n</div>\r\n<div class="csui-change-user-error"></div>'}});return t.registerPartial("csui_controls_table_inlineforms_permissions_user.picker_impl_user.picker",s),s}),csui.define("css!csui/controls/table/inlineforms/permissions/user.picker/impl/user.picker",[],function(){}),csui.define("csui/controls/table/inlineforms/permissions/user.picker/user.picker.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/marionette","csui/behaviors/keyboard.navigation/tabable.region.behavior","i18n!csui/controls/table/inlineforms/permissions/user.picker/impl/nls/lang","hbs!csui/controls/table/inlineforms/permissions/user.picker/impl/user.picker","css!csui/controls/table/inlineforms/permissions/user.picker/impl/user.picker"],function(e,i,t,s,n,o){return t.ItemView.extend({"className":"cs-inline-user-lookup","template":o,"behaviors":{"TabableRegion":{"behaviorClass":s,"initialActivationWeight":100}},"ui":{"cancelButton":".cs-cancel-button","saveButton":".cs-save-button","inputBox":".cs-search"},"events":{"click @ui.saveButton":"saveClicked","click @ui.cancelButton":"cancelClicked","focus @ui.inputBox":"inputBoxFocus","click":"handleClick"},"handleClick":function(e){e.preventDefault(),e.stopPropagation()},"templateHelpers":function(){return{"SaveButtonLabel":n.SaveButtonLabel,"CancelButtonLabel":n.CancelButtonLabel}},"initialize":function(e){this.options=e},"constructor":function(e){e||(e={}),e.data||(e.data={}),this.options=e,t.ItemView.prototype.constructor.call(this,e)},"inputBoxFocus":function(){this.focusIndex=0},"onShow":function(){var e=this;this.focusIndex=0,csui.require(["csui/controls/userpicker/userpicker.view"],function(s){e.pickerView=new s({"context":e.options.context,"limit":5,"memberFilter":e.options.memberFilter,"widgetoptions":e.options,"placeholder":n.UserPickerPlaceHolder,"prettyScrolling":!0,"scrollContainerHeight":"auto","model":e.options.userPickerModel,"id_input":i.uniqueId("csui-inline-permissions-user-picker-input"),"lightWeight":!1}),new t.Region({"el":e.$el.find("#csui-inline-permissions-user-picker")}).show(e.pickerView),e.pickerView.$el.find("input")&&e.pickerView.$el.find("input").focus(),e.listenTo(e.pickerView,"item:change",e.processItemChange),e.listenTo(e.pickerView,"item:clear",e.processItemChange),e.$el.bind("keydown",i.bind(e.onKeyInView,e)),e.$el.find("input").focus().attr("tabindex","-1")})},"processItemChange":function(){var e=arguments.length>0&&arguments[0].item;this.param=e,e?this.options.currentRow.find(".cs-save-button").removeAttr("disabled"):(this.options.currentRow.find(".cs-save-button").attr("disabled",!0),this.$el.find("input").focus())},"currentlyFocusedElement":function(){return this.$el.find("input")},"cancelClicked":function(e){e.preventDefault(),e.stopPropagation(),this.options.currentRow.removeClass("csui-changeowner-permission"),this.options.currentRow.find(".member-info").removeClass("binf-hidden"),this.trigger("change:completed")},"saveClicked":function(e){e.preventDefault(),e.stopPropagation(),this.$(".cs-search").val()===this.param.get("name_formatted")?this.trigger("member:selected:save",this.param):this.$(".csui-change-user-error").addClass("csui-change-user-error-display").html(n.InvalidUser)},"onKeyInView":function(e){var i=this,t=this.$el.find("[tabindex]").filter(function(e,t){return i.$(t).is(":visible")&&!i.$(t).is(":disabled")});t.length,t[this.focusIndex];switch(this.$(e.target).hasClass("cs-search")&&(this.focusIndex=0),e.keyCode){case 37:this.focusIndex>0&&(this.focusIndex--,t[this.focusIndex].focus(),e.preventDefault()),e.stopPropagation();break;case 9:e.shiftKey?(this.focusIndex--,this.focusIndex>=0&&this.focusIndex<=t.length-1&&t[this.focusIndex].focus(),e.preventDefault(),e.stopPropagation()):(this.focusIndex++,this.focusIndex<=t.length-1&&this.focusIndex>=0&&t[this.focusIndex].focus(),e.preventDefault(),e.stopPropagation());break;case 39:e.stopPropagation();break;case 38:case 40:e.preventDefault(),e.stopPropagation();break;case 32:e.stopPropagation();break;case 13:this.$(e.target).trigger("click"),e.preventDefault(),e.stopPropagation();break;default:e.stopPropagation()}}})}),csui.define("csui/controls/table/cells/celleditor/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/table/cells/celleditor/impl/nls/root/lang",{"NewNamePlaceholder":"Enter name"}),csui.define("hbs!csui/controls/table/cells/celleditor/impl/celleditor",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"1":function(e,i,t,s){return'    <span class="csui-undo edit-cancel inline-edit-icon"></span>\r\n'},"3":function(e,i,t,s){var n;return'    <button class="csui-undo csui-btn-cancel binf-btn">'+this.escapeExpression((n=null!=(n=i.CancelButtonLabel||(null!=e?e.CancelButtonLabel:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"CancelButtonLabel","hash":{}}):n))+"</button>\r\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){var n,o;return'<div class="csui-td-content-edit">\r\n  <input type="text" value="'+this.escapeExpression((o=null!=(o=i.formattedValue||(null!=e?e.formattedValue:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"formattedValue","hash":{}}):o))+'" placeholder="'+this.escapeExpression((o=null!=(o=i.inputPlaceholder||(null!=e?e.inputPlaceholder:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"inputPlaceholder","hash":{}}):o))+'" class="binf-form-control">\r\n'+(null!=(n=i.if.call(e,null!=e?e.useEditCancelIcon:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.program(3,s,0)}))?n:"")+"</div>\r\n"}});return t.registerPartial("csui_controls_table_cells_celleditor_impl_celleditor",s),s}),csui.define("css!csui/controls/table/cells/celleditor/impl/celleditor",[],function(){}),csui.define("csui/controls/table/cells/celleditor/celleditor.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/marionette","csui/utils/log","csui/utils/base","csui/controls/table/cells/templated/templated.view","i18n!csui/controls/table/cells/celleditor/impl/nls/lang","hbs!csui/controls/table/cells/celleditor/impl/celleditor","css!csui/controls/table/cells/celleditor/impl/celleditor"],function(e,i,t,s,n,o,l,r){return o.extend({"template":r,"ui":{"editCancel":".csui-td-content-edit .csui-undo","cancelButton":".csui-td-content-edit .csui-btn-cancel","inputField":".csui-td-content-edit > input"},"events":{"click @ui.editCancel":"iconUndoClicked","keyup @ui.inputField":"keyReleased","blur @ui.inputField":"leftInputField","click @ui.inputField":"inputFieldClicked"},"onRender":function(){this.ui.inputField.addClass("csui-input-full"),this.ui.inputField.select()},"endEdit":function(){this.editStarted=!1,this.saving=!1,delete this.model.csuiValueEdited;var i=this.$el.find(".csui-td-content-edit");i.length>0&&e(i[0]).remove(),this.model.unset("csuiErrorMessage"),this.trigger("closed",this)},"_cancelEdit":function(){this.leftInputFieldTimer&&clearTimeout(this.leftInputFieldTimer),this.trigger("cancelEdit",this),this.endEdit()},"_save":function(){if(this.editStarted){var e=this.ui.inputField,i=e.val();i=i.trim(),i.length>0?(this.saving=!0,this.trigger("cellEditorWantsSave",{"newName":i})):this._cancelEdit()}},"inputFieldClicked":function(e){e.preventDefault(),e.stopPropagation()},"iconUndoClicked":function(e){e.preventDefault(),e.stopPropagation(),this._cancelEdit()},"keyReleased":function(e){e.preventDefault(),e.stopPropagation(),this.leftInputFieldTimer&&clearTimeout(this.leftInputFieldTimer),27===e.keyCode?this._cancelEdit():13===e.keyCode&&this._save()},"leftInputField":function(e){if(!this.saving){var i=this;this.leftInputFieldTimer&&clearTimeout(this.leftInputFieldTimer),this.leftInputFieldTimer=setTimeout(function(){i.leftInputFieldTimer=void 0,i._save()},100)}},"renderValue":function(){var i;i=this.model.csuiValueEdited?{"value":this.model.csuiValueEdited,"formattedValue":this.model.csuiValueEdited}:this.getValueData(),i.useEditCancelIcon=void 0!==this.model.get("id"),i.CancelButtonLabel=l.CancelButtonLabel,i.inputPlaceholder=l.NewNamePlaceholder;var t=void 0!==this.model.get("csuiErrorMessage"),s=i?this.template(i):"",n=this.$el.find(".csui-td-content-edit");if(n.length>0)t&&e(n[0]).addClass("binf-has-error"),e(n[0]).replaceWith(s);else{var o=e(s);t&&o.addClass("binf-has-error"),o.appendTo(this.$el.find(".csui-td-container"))}this.editStarted=!0,this.saving=!1}})}),csui.define("hbs!csui/controls/table/cells/reservation/impl/reservation",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"1":function(e,i,t,s){var n;return null!=(n=i.if.call(e,null!=e?e.isReservedByOther:e,{"name":"if","hash":{},"fn":this.program(2,s,0),"inverse":this.program(4,s,0)}))?n:""},"2":function(e,i,t,s){var n;return'      <span title="'+this.escapeExpression((n=null!=(n=i.reservedTooltip||(null!=e?e.reservedTooltip:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"reservedTooltip","hash":{}}):n))+'" class="icon icon-shared_collaborate_other"></span>\r\n'},"4":function(e,i,t,s){var n;return'      <span title="'+this.escapeExpression((n=null!=(n=i.reservedTooltip||(null!=e?e.reservedTooltip:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{
"name":"reservedTooltip","hash":{}}):n))+'" class="icon icon-shared_collaborate_self"></span>\r\n'},"6":function(e,i,t,s){var n;return null!=(n=i.if.call(e,null!=e?e.reserved:e,{"name":"if","hash":{},"fn":this.program(7,s,0),"inverse":this.noop}))?n:""},"7":function(e,i,t,s){var n;return(null!=(n=i.if.call(e,null!=e?e.canUnreserve:e,{"name":"if","hash":{},"fn":this.program(8,s,0),"inverse":this.noop}))?n:"")+(null!=(n=i.if.call(e,null!=e?e.isReservedByOther:e,{"name":"if","hash":{},"fn":this.program(10,s,0),"inverse":this.program(12,s,0)}))?n:"")+(null!=(n=i.if.call(e,null!=e?e.canUnreserve:e,{"name":"if","hash":{},"fn":this.program(14,s,0),"inverse":this.noop}))?n:"")},"8":function(e,i,t,s){var n;return'    <button type="button" aria-label="'+this.escapeExpression((n=null!=(n=i.reservedAria||(null!=e?e.reservedAria:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"reservedAria","hash":{}}):n))+'" class="csui-unreserve-cellview">\r\n'},"10":function(e,i,t,s){var n;return'      <span title="'+this.escapeExpression((n=null!=(n=i.reservedTooltip||(null!=e?e.reservedTooltip:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"reservedTooltip","hash":{}}):n))+'" class="icon icon-reserved_other"></span>\r\n'},"12":function(e,i,t,s){var n;return'      <span title="'+this.escapeExpression((n=null!=(n=i.reservedTooltip||(null!=e?e.reservedTooltip:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"reservedTooltip","hash":{}}):n))+'" class="icon icon-reserved_self"></span>\r\n'},"14":function(e,i,t,s){return"    </button>\r\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){var n;return null!=(n=i.if.call(e,null!=e?e.reservedSharedCollaboration:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.program(6,s,0)}))?n:""}});return t.registerPartial("csui_controls_table_cells_reservation_impl_reservation",s),s}),csui.define("csui/controls/table/cells/reservation/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/table/cells/reservation/impl/nls/root/lang",{"reservedTooltipPrefix":"Reserved by {0}\r\n{1}","reservedAria":"Reserved by {0} at {1}, click to unreserve","reservedSharedCollaborationTooltipPrefix":"Shared for collaboration by {0}\r\n{1}","reservedSharedCollaborationAria":"Shared for collaboration by {0} at {1}"}),csui.define("css!csui/controls/table/cells/reservation/impl/reservation",[],function(){}),csui.define("csui/controls/table/cells/reservation/reservation.view",["csui/lib/jquery","csui/lib/underscore","csui/utils/base","csui/utils/log","csui/utils/contexts/factories/user","csui/models/nodes","csui/models/nodechildren","csui/controls/table/cells/templated/templated.view","csui/utils/commands","csui/utils/commands/unreserve","csui/utils/commandhelper","csui/controls/table/cells/cell.registry","hbs!csui/controls/table/cells/reservation/impl/reservation","i18n!csui/controls/table/cells/reservation/impl/nls/lang","css!csui/controls/table/cells/reservation/impl/reservation"],function(e,i,t,s,n,o,l,r,a,c,u,d,h,p){"use strict";return r.extend({"template":h,"triggers":{"click .csui-unreserve-cellview":"remove:reservation"},"events":{"keydown":"onKeyInView"},"getValueData":function(){var e=this.model.get("reserved_user_id");e&&"object"==typeof e&&(e=e.id);var s,n=this.model.get("reserved")&&e,o=this.model.get("reserved_shared_collaboration"),l=!1;if(n){var r=this.model.get("reserved_user_id_expand")||this.model.get("reserved_user_id");s=t.formatMemberName(r),l=this.userId!==e}var a,c,u=t.formatExactDate(this.model.get("reserved_date"));t.formatMemberName(s);return o?(a=p.reservedSharedCollaborationTooltipPrefix,c=p.reservedSharedCollaborationAria):n&&(a=p.reservedTooltipPrefix,c=p.reservedAria),a&&(a=i.str.sformat(a,s,u),c=i.str.sformat(c,s,u)),{"reservedTooltip":a,"reservedAria":c,"canUnreserve":this.canUnreserve,"reserved":n,"isReservedByOther":l,"reservedSharedCollaboration":o}},"initialize":function(){var e=this.options.context.getModel(n);this.userId=e.get("id"),this.unreserveCommand=new c,this.commandStatus={"nodes":new o([this.model]),"context":this.options.context},this._checkEnabledAction();var i=this.model.collection.delayedActions;i&&this.listenTo(i,"sync",this._checkEnabledAction)},"_checkEnabledAction":function(){this.canUnreserve=this.unreserveCommand.enabled(this.commandStatus),this.isDestroyed||this.render()},"onRemoveReservation":function(e){var i;this.canUnreserve&&(i=this.unreserveCommand.execute(this.commandStatus),u.handleExecutionResults(i,{"command":this.unreserveCommand,"suppressSuccessMessage":this.commandStatus.suppressSuccessMessage,"suppressFailMessage":this.commandStatus.suppressFailMessage}))},"onKeyInView":function(e){32!==e.keyCode&&13!==e.keyCode||this.onRemoveReservation()}},{"hasFixedWidth":!0,"columnClassName":"csui-table-cell-reservation","getModelExpand":function(e){return{"properties":["reserved_user_id"]}}})}),csui.define("csui/controls/table/cells/node.state/impl/node.state.icons",["csui/controls/table/cells/node.state/impl/reservation/reservation.view"],function(e){"use strict";return[{"sequence":50,"iconView":e}]}),csui.define("hbs!csui/controls/table/rows/description/impl/description",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"1":function(e,i,t,s){var n;return'  <span class="description '+this.escapeExpression((n=null!=(n=i.truncate_fade_class||(null!=e?e.truncate_fade_class:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"truncate_fade_class","hash":{}}):n))+'"\r\n        title="'+this.escapeExpression((n=null!=(n=i.complete_description||(null!=e?e.complete_description:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"complete_description","hash":{}}):n))+'">'+this.escapeExpression((n=null!=(n=i.current_description||(null!=e?e.current_description:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"current_description","hash":{}}):n))+"</span>\r\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){var n,o;return(null!=(n=i.if.call(e,null!=e?e.current_description:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?n:"")+'<div class="description-caret-div">\r\n  <span class="description-readmore icon-expandArrowDown" role="button" aria-expanded="false" title="'+this.escapeExpression((o=null!=(o=i.showmore_tooltip||(null!=e?e.showmore_tooltip:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"showmore_tooltip","hash":{}}):o))+'"\r\n        aria-label="'+this.escapeExpression((o=null!=(o=i.showmore_aria||(null!=e?e.showmore_aria:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"showmore_aria","hash":{}}):o))+'" tabindex="0"></span>\r\n  <span class="description-showless icon-expandArrowUp" role="button" aria-expanded="true" title="'+this.escapeExpression((o=null!=(o=i.showless_tooltip||(null!=e?e.showless_tooltip:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"showless_tooltip","hash":{}}):o))+'"\r\n        aria-label="'+this.escapeExpression((o=null!=(o=i.showless_aria||(null!=e?e.showless_aria:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"showless_aria","hash":{}}):o))+'" tabindex="0"></span>\r\n</div>\r\n'}});return t.registerPartial("csui_controls_table_rows_description_impl_description",s),s}),csui.define("csui/controls/table/rows/description/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/table/rows/description/impl/nls/root/lang",{"showmore":"Show more","showmoreAria":"Show more description","showless":"Show less","showlessAria":"Show less description"}),csui.define("css!csui/controls/table/rows/description/impl/description",[],function(){}),csui.define("csui/controls/table/rows/description/description.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/utils/base","hbs!csui/controls/table/rows/description/impl/description","i18n!csui/controls/table/rows/description/impl/nls/lang","css!csui/controls/table/rows/description/impl/description"],function(e,i,t,s,n,o){return t.ItemView.extend({"className":function(){return this._collapsedHeightIsOneLine?"cs-description csui-description-short-lines-1":"cs-description"},"template":n,"templateHelpers":function(){var e=this.model.get("instructions")||this.model.get("description")||"";return{"complete_description":e,"current_description":e,"more_description":this.has_more_desc&&!this.hideShowLess,"showmore_tooltip":o.showmore,"showmore_aria":o.showmoreAria,"showless_tooltip":o.showless,"showless_aria":o.showlessAria}},"ui":{"description":".description","readMore":".description-readmore","showLess":".description-showless","caret_div":".description-caret-div"},"events":{"keydown @ui.readMore":"readMoreClicked","keydown @ui.showLess":"showLessClicked","click @ui.readMore":"readMoreClicked","click @ui.showLess":"showLessClicked"},"constructor":function(e){this._preinitializeFlags(e),t.ItemView.prototype.constructor.apply(this,arguments),this.listenTo(this,"dom:refresh",this._truncateIfNecessary).listenTo(this.options.tableView,"dom:refresh",this.triggerMethod.bind(this,"dom:refresh")).listenTo(this,"row:toggle",function(e){e?(this.expandedMode=!0,this.ui.caret_div.addClass("binf-hidden"),this.$el.removeClass("csui-description-collapsed")):(this.expandedMode=!1,this.ui.caret_div.removeClass("binf-hidden"),this._updateDescriptionAndCaret())})},"currentlyFocusedElement":function(){return this.has_more_desc&&!this.expandedMode?this.shortDescMode?this.ui.readMore:this.ui.showLess:i()},"_preinitializeFlags":function(e){this.shortDescMode=!0,this.hideShowLess=!1,this.has_more_desc=!1,this._collapsedHeightIsOneLine=e&&e.collapsedHeightIsOneLine},"_updateDescriptionAndCaret":function(){this._enableCaretState(),this.shortDescMode&&this.has_more_desc?this.$el.addClass("csui-description-collapsed"):this.$el.removeClass("csui-description-collapsed")},"_truncateIfNecessary":function(){if(!this.expandedMode){var e=this.ui.description.height();if(e){var i=parseFloat(this.ui.description.css("line-height"));this._collapsedHeightIsOneLine||(i*=2),e>i&&(this.has_more_desc=!0),this._updateDescriptionAndCaret()}}},"readMoreClicked":function(e){!e||13!==e.keyCode&&32!==e.keyCode&&"click"!==e.type||(e.preventDefault(),e.stopPropagation(),this.shortDescMode=!1,this._updateDescriptionAndCaret(),this.options.tableView&&this.options.tableView.trigger("update:scrollbar"),this.ui.showLess.focus())},"showLessClicked":function(e){!e||13!==e.keyCode&&32!==e.keyCode&&"click"!==e.type||(e.preventDefault(),e.stopPropagation(),this.shortDescMode=!0,this._updateDescriptionAndCaret(),this.options.tableView&&this.options.tableView.trigger("update:scrollbar"),this.ui.readMore.focus())},"_enableCaretState":function(){this.has_more_desc?(this.ui.readMore.toggleClass("caret-hide",!this.shortDescMode),this.ui.showLess.toggleClass("caret-hide",!!this.shortDescMode)):(this.ui.readMore.addClass("caret-hide"),this.ui.showLess.addClass("caret-hide"))}})}),csui.define("hbs!csui/controls/thumbnail/impl/metadata/thumbnail.metadata",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"1":function(e,i,t,s){var n;return'  <span class="csui-thumbnail-metadata-label" title="'+this.escapeExpression((n=null!=(n=i.label||(null!=e?e.label:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"label","hash":{}}):n))+'">'+this.escapeExpression((n=null!=(n=i.label||(null!=e?e.label:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"label","hash":{}}):n))+'</span>\r\n  <span class="csui-thumbnail-metadata-spacer"></span>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){var n,o;return(null!=(n=i.if.call(e,null!=e?e.displayHeader:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?n:"")+'<span class="csui-thumbnail-metadata-val">'+this.escapeExpression((o=null!=(o=i.value||(null!=e?e.value:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"value","hash":{}}):o))+"</span>"}});return t.registerPartial("csui_controls_thumbnail_impl_metadata_thumbnail.metadata",s),s}),csui.define("csui/controls/thumbnail/impl/metadata/thumbnail.metadata.view",["csui/lib/underscore","csui/lib/marionette","csui/utils/types/date","hbs!csui/controls/thumbnail/impl/metadata/thumbnail.metadata"],function(e,i,t,s){"use strict";var n=i.ItemView.extend({"className":"csui-thumbnail-item-details binf-col-lg-12","template":s,"templateHelpers":function(){this.$el.attr("role","listitem");var e=this.getValueData();return{"displayHeader":this.model.get("noTitleHeader"),"label":this.model.get("key"),"value":e}},"getValueData":function(){var e=this.options.thumbnailItemModel,i=this.model.get("key"),s=this.model.get("column_type"),n=e.get(i);if("date"===s){n=(!1!==this.model.get("include_time")?t.formatExactDateTime:t.formatExactDate)(n)}return n}});return i.CollectionView.extend({"className":"csui-thumbnail-metadata","childView":n,"childViewOptions":function(){return{"rowId":this.options.rowId,"thumbnailItemModel":this.model}},"filter":function(e,i,t){return"size"===e.get("key")?this.model.get(e.get("key"))&&""!==this.model.get(e.get("key")+"_formatted"):this.model.get(e.get("key"))&&""!==this.model.get(e.get("key"))},"onRender":function(){this.collection;this.bindUIElements()}})}),csui.define("csui/controls/thumbnail/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/thumbnail/impl/nls/root/lang",{"addTitle":"Add","searchIconTooltip":"Search by {0}","selectAll":"Select all","selectAllTitle":"Select all items","noResults":"No results found","dragAndDropMessage":"Drag and drop files here to add new content","items":"Items","formatForNone":"{0} items","formatForOne":"{0} item","formatForTwo":"{0} items","formatForFive":"{0} items","asc_name":"Name (A-Z)","desc_name":"Name (Z-A)","asc_modify_date":"Modified (new-old)","desc_modify_date":"Modified (old-new)","asc_size":"Size (small-large)","desc_size":"Size (large-small)","name":"Name","modified":"Modified","size":"Size","selectItem":"Select {0}","selectItemAria":"Select {0}. When selected an action bar of options can be reached per shift-tab"}),csui.define("hbs!csui/controls/thumbnail/impl/sort/impl/sort.menu",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"1":function(e,i,t,s){var n;return'      <li role="presentation"><a role="menuitem" href="#" class="csui-sort-option"\r\n                                 data-binf-toggle="tab">                                \r\n'+(null!=(n=i.if.call(e,null!=e?e.selected:e,{"name":"if","hash":{},"fn":this.program(2,s,0),"inverse":this.program(4,s,0)}))?n:"")+'        <span class="cs-label" title="'+this.escapeExpression(this.lambda(null!=e?e.value:e,e))+'" id="'+this.escapeExpression(this.lambda(null!=e?e.key:e,e))+'">'+this.escapeExpression(this.lambda(null!=e?e.value:e,e))+" </span></a></li>\r\n"},"2":function(e,i,t,s){return'          <span class="cs-icon icon-listview-checkmark"></span>\r\n'},"4":function(e,i,t,s){return'          <span class="cs-icon "></span>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){var n,o;return'<div class="csui-search-sort-options">\r\n  <button id="'+this.escapeExpression((o=null!=(o=i.id||(null!=e?e.id:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"id","hash":{}}):o))+'" type="button" class="binf-btn binf-btn-default binf-dropdown-toggle"\r\n          data-binf-toggle="dropdown" aria-haspopup="true" aria-expanded="false">\r\n    <span class="cs-label">'+this.escapeExpression((o=null!=(o=i.selectedValue||(null!=e?e.selectedValue:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"selectedValue","hash":{}}):o))+'</span>\r\n    <span class="csui-button-icon icon-caret-down"></span>\r\n  </button>\r\n  <span id="search-sort-btn" class="csui-sort-arrow  '+this.escapeExpression((o=null!=(o=i.selectedArrow||(null!=e?e.selectedArrow:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"selectedArrow","hash":{}}):o))+'"></span>\r\n  <ul class="binf-dropdown-menu" role="menu">\r\n'+(null!=(n=i.each.call(e,null!=e?e.sortListArray:e,{"name":"each","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?n:"")+"  </ul>\r\n</div>"}});return t.registerPartial("csui_controls_thumbnail_impl_sort_impl_sort.menu",s),s}),csui.define("csui/controls/thumbnail/impl/sort/sort.view",["module","require","csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/utils/log","i18n!csui/controls/thumbnail/impl/nls/lang","hbs!csui/controls/thumbnail/impl/sort/impl/sort.menu","csui/controls/tile/behaviors/perfect.scrolling.behavior","csui/behaviors/keyboard.navigation/tabable.region.behavior","csui/lib/binf/js/binf"],function(e,i,t,s,n,o,l,r,a,c,u){return o.ItemView.extend({"className":"cs-sort-links","template":a,"constants":{"NAME_ASC":"asc_name","NAME_DESC":"desc_name","MODIFIED_ASC":"asc_modify_date","MODIFIED_DESC":"desc_modify_date","SIZE_ASC":"asc_size","SIZE_DESC":"desc_size"},"templateHelpers":function(){var e=this,i=[];s.each(this.constants,function(e,t){i.push({"key":e,"value":r[e],"selected":!1})});s.any(i,function(i){return i.value===e.actualValue?i.selected=!0:i.selected=!1},e);return{"id":s.uniqueId("sortButton"),"selectedValue":e.selectedValue,"selectedArrow":e.selectedArrow,"sortListArray":i}},"ui":{"sortOrderBtn":"#search-sort-btn"},"events":{"click .binf-dropdown-menu > li > a":"onSortOptionClick"},"constructor":function(e){o.ItemView.prototype.constructor.call(this,e);var i=e.collection.sorting.sort[0].value,t=i||this.constants.NAME_ASC,s=this.OverlapDisplayText(t);this.selectedValue=s,this.actualValue=r[i]||r[this.constants.NAME_ASC],this.selectedArrow=this.options.collection.orderstate||"icon-sortArrowDown",this.config=this.options.config||{}},"onSortOptionClick":function(e){e.preventDefault(),e.stopPropagation(),this.$el.find(".csui-search-sort-options li>a").removeClass("binf-active"),this.$el.find(".csui-search-sort-options li>a>span").removeClass("icon-listview-checkmark"),this.$(e.currentTarget).addClass("binf-active"),this.resetSelection(e.currentTarget.children[1].id)},"resetSelection":function(e){switch(e){case this.constants.NAME_ASC:this.collection.setOrder("name asc"),this.selectedValue=r[e],this.actualValue=r.name,this.selectedArrow="icon-sortArrowDown",this.options.collection.state=this.constants.NAME_ASC,this.options.collection.sorting.sort[0].value=this.constants.NAME_ASC,this.options.collection.orderstate=this.selectedArrow;break;case this.constants.NAME_DESC:this.collection.setOrder("name desc"),this.selectedValue=r[e],this.actualValue=r.name,this.selectedArrow="icon-sortArrowUp",this.options.collection.state=this.constants.NAME_DESC,this.options.collection.sorting.sort[0].value=this.constants.NAME_DESC,this.options.collection.orderstate=this.selectedArrow;break;case this.constants.MODIFIED_ASC:this.collection.setOrder("modify_date asc"),this.selectedValue=r[e],this.actualValue=r.modified,this.selectedArrow="icon-sortArrowDown",this.options.collection.state=this.constants.MODIFIED_ASC,this.options.collection.sorting.sort[0].value=this.constants.MODIFIED_ASC,this.options.collection.orderstate=this.selectedArrow;break;case this.constants.MODIFIED_DESC:this.collection.setOrder("modify_date desc"),this.selectedValue=r[e],this.actualValue=r.modified,this.selectedArrow="icon-sortArrowUp",this.options.collection.state=this.constants.MODIFIED_DESC,this.options.collection.sorting.sort[0].value=this.constants.MODIFIED_DESC,this.options.collection.orderstate=this.selectedArrow;break;case this.constants.SIZE_ASC:this.collection.setOrder("size asc"),this.selectedValue=r[e],this.actualValue=r.size,this.selectedArrow="icon-sortArrowDown",this.options.collection.state=this.constants.SIZE_ASC,this.options.collection.sorting.sort[0].value=this.constants.SIZE_ASC,this.options.collection.orderstate=this.selectedArrow;break;case this.constants.SIZE_DESC:this.collection.setOrder("size desc"),this.selectedValue=r[e],this.actualValue=r.size,this.selectedArrow="icon-sortArrowUp",this.options.collection.state=this.constants.SIZE_DESC,this.options.collection.sorting.sort[0].value=this.constants.SIZE_DESC,this.options.collection.orderstate=this.selectedArrow}var i=this;this.options.collection.fetch({"silent":!0}).then(function(){i.trigger("render:sortmenu",e),i.$el.find(".binf-dropdown-toggle >span").innerText=r[e],i.$el.find(".csui-sort-option.binf-active >span.cs-icon").addClass("icon-listview-checkmark");var t=i.OverlapDisplayText(e);i.$el.find(".binf-dropdown-toggle >span.cs-label").html(t),i.$el.find(".csui-sort-arrow").removeClass("icon-sortArrowDown"),i.$el.find(".csui-sort-arrow").removeClass("icon-sortArrowUp"),i.$el.find(".csui-sort-arrow").addClass(i.selectedArrow),i.$el.find(".csui-search-sort-options").removeClass("binf-open")},i)},"OverlapDisplayText":function(e){var i="";switch(e){case this.constants.NAME_ASC:case this.constants.NAME_DESC:i=r.name;break;case this.constants.MODIFIED_ASC:case this.constants.MODIFIED_DESC:i=r.modified;break;case this.constants.SIZE_ASC:case this.constants.SIZE_DESC:i=r.size;break;default:i=r.name}return i},"onRender":function(){var e=this;e.$el.find(".csui-search-sort-options li>a span.cs-label").each(function(){t(this).text().trim()===e.selectedValue&&t(this).siblings().addClass("icon-listview-checkmark")},e)}})}),csui.define("csui/controls/thumbnail/content/content.registry",["csui/lib/underscore"],function(e){function i(){this._contentKeys={},this._dataTypes={}}return e.extend(i.prototype,{"getContentView":function(e){if("type"!==e.get("column_type_identifier")){var i=e.get("key"),t=i&&this._contentKeys[i];if(t)return t}var s=e.get("type");return s&&this._dataTypes[s.toString()]},"registerByKey":function(i,t){if(!e.isString(i)||!i)throw new Error("Key must be a non-empty string");this._registerContentView(this._contentKeys,i,t)},"registerByDataType":function(i,t){if(!e.isNumber(i)||!i)throw new Error("Data type must be a non-zero number");this._registerContentView(this._dataTypes,i.toString(),t)},"_registerContentView":function(e,i,t){if("function"!=typeof t)throw new Error("Column handler must be a function object");e[i]=t}}),new i}),csui.define("csui/controls/thumbnail/content/favorite/impl/nls/localized.strings",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/thumbnail/content/favorite/impl/nls/root/localized.strings",{"ColumnTitle":"Favorite"}),csui.define("hbs!csui/controls/thumbnail/content/favorite/impl/favorite",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){return'<span class="csui-thumbnail-favorite"></span>'}});return t.registerPartial("csui_controls_thumbnail_content_favorite_impl_favorite",s),s}),csui.define("css!csui/controls/thumbnail/content/favorite/impl/favorite",[],function(){}),csui.define("csui/controls/thumbnail/content/favorite/favorite.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/widgets/favorites/favorite.star.view","csui/controls/thumbnail/content/content.registry","i18n!csui/controls/thumbnail/content/favorite/impl/nls/localized.strings","hbs!csui/controls/thumbnail/content/favorite/impl/favorite","css!csui/controls/thumbnail/content/favorite/impl/favorite"],function(e,i,t,s,n,o,l,r){"use strict";var a=s.LayoutView.extend({"template":r,"className":"csui-thumbnail-favorite-container","regions":{"favRegion":".csui-thumbnail-favorite"},"constructor":function(e){e||(e={}),s.LayoutView.prototype.constructor.call(this,e)},"onRender":function(){this.favStarView||(this.favStarView=new n(i.extend({"checkVisible":!0,"popoverAtBodyElement":!0,"focusable":!0},this.options)),this.favRegion.show(this.favStarView)),this.listenTo(this.favStarView,"show:add:favorite:form",function(){this.triggerMethod("show:add:favorite:form")}),this.listenTo(this.favStarView,"close:add:favorite:form",function(){this.triggerMethod("close:add:favorite:form")}),this.favStarView.render(),this.$el.append(this.favStarView.el),this.listenTo(this.options.originatingView.thumbnail,"scroll",function(){this.favStarView&&this.favStarView.closePopover()})}});return o.registerByKey("favorite",a),a}),csui.define("csui/controls/thumbnail/content/node.state/node.state.icons",["csui/lib/underscore","csui/lib/backbone","csui-ext!csui/controls/table/cells/node.state/node.state.icons","csui-ext!csui/controls/thumbnail/content/node.state/node.state.icons"],function(e,i,t,s){"use strict";var n=i.Model.extend({"defaults":{"sequence":100,"iconView":null,"iconViewOptions":null},"constructor":function(e,t){i.Model.prototype.constructor.apply(this,arguments)}}),o=i.Collection.extend({"model":n,"comparator":"sequence","constructor":function(e,t){i.Collection.prototype.constructor.apply(this,arguments)}}),l=new o;return s&&(s=e.flatten(s,!0),l.add(s)),l}),csui.define("hbs!csui/controls/thumbnail/content/node.state/impl/node.state",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){return'<div class="csui-thumbnail-nodestate"></div>'}});return t.registerPartial("csui_controls_thumbnail_content_node.state_impl_node.state",s),s}),csui.define("csui/controls/thumbnail/content/node.state/impl/nls/localized.strings",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/thumbnail/content/node.state/impl/nls/root/localized.strings",{"stateListAria":"List of states","someStateIconsAria":"State available","noStateIconsAria":"No state","bool_value_true":"true","bool_value_false":"false","reservedTooltip":"Reserved by {0}\r\n{1}","reservedAria":"Reserved by {0} at {1}, click to unreserve","reservedSharedCollaborationTooltip":"Shared for collaboration by {0}\r\n{1}","reservedSharedCollaborationAria":"Shared for collaboration by {0} at {1}","reserved_attribute_title":"Reserved","reserved_attribute_name":"reserved","reserved_shared_collaboration_attribute_title":"Shared for collaboration","reserved_shared_collaboration_attribute_name":"reserved_shared_collaboration","nodeStateTitle_thumbnail":"Open info panel to see status icons"}),csui.define("csui/controls/thumbnail/content/node.state/node.state.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/controls/thumbnail/content/content.registry","csui/controls/thumbnail/content/node.state/node.state.icons","csui/models/mixins/v2.fields/v2.fields.mixin","hbs!csui/controls/thumbnail/content/node.state/impl/node.state","i18n!csui/controls/thumbnail/content/node.state/impl/nls/localized.strings"],function(e,i,t,s,n,o,l,r,a){"use strict";var c=s.CollectionView.extend({"tagName":"ul","attributes":{"aria-label":a.stateListAria},"getChildView":function(e){return e.get("iconView")},"childViewOptions":function(e){return i.extend({"context":this.options.context,"model":this.options.node,"originatingView":this.options.originatingView,"targetView":this.options.targetView},e.get("iconViewOptions"))}}),u=s.LayoutView.extend({"template":r,"className":"csui-thumbnail-nodestate-container","regions":{"nodeStateRegion":".csui-thumbnail-nodestate"},"constructor":function(e){e||(e={}),this.options=e,s.LayoutView.prototype.constructor.call(this,e)},"onRender":function(){var e=this._getEnabledNodeStateIcons(),i=e.length?a.someStateIconsAria:a.noStateIconsAria,t=this.options.displayTitle?a.nodeStateTitle_thumbnail:"";if(this.el.setAttribute("aria-label",i),this.el.setAttribute("title",t),e.length){var s=new c({"context":this.options.context,"node":this.model,"originatingView":this.options.originatingView,"targetView":this.options.targetView,"collection":e});this.nodeStateRegion.show(s),this.options.displayTitle&&s.$el.find("button").attr("tabindex","-1")}},"_getEnabledNodeStateIcons":function(){var e;return e=Object.getPrototypeOf(o),new e.constructor(o.filter(function(e){var i=e.get("iconView");return i&&(!i.enabled||i.enabled({"context":this.options.context,"node":this.model}))},this))}});return n.registerByKey("reserved",u),u}),csui.define("csui/controls/thumbnail/content/name/impl/nls/localized.strings",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/thumbnail/content/name/impl/nls/root/localized.strings",{"ColumnTitle":"Name","nameAria":"{0}","nameNoOpenAria":"{0}. Can not be opened."}),csui.define("hbs!csui/controls/thumbnail/content/name/impl/name",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"1":function(e,i,t,s){var n;return null!=(n=i.if.call(e,null!=e?e.defaultAction:e,{"name":"if","hash":{},"fn":this.program(2,s,0),"inverse":this.program(7,s,0)}))?n:""},"2":function(e,i,t,s){var n;return null!=(n=i.if.call(e,null!=e?e.inactive:e,{"name":"if","hash":{},"fn":this.program(3,s,0),"inverse":this.program(5,s,0)}))?n:""},"3":function(e,i,t,s){return'      <div class="csui-thumbnail-overview-icon csui-thumbnail-no-default-action"></div>\r\n'},"5":function(e,i,t,s){var n;return'      <a href="'+this.escapeExpression((n=null!=(n=i.defaultActionUrl||(null!=e?e.defaultActionUrl:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"defaultActionUrl","hash":{}}):n))+'" class="csui-thumbnail-overview-icon csui-thumbnail-default-action" tabindex="0"/>\r\n'},"7":function(e,i,t,s){return'    <div class="csui-thumbnail-overview-icon csui-thumbnail-no-default-action"></div>\r\n'},"9":function(e,i,t,s){var n;return null!=(n=i.if.call(e,null!=e?e.inactive:e,{"name":"if","hash":{},"fn":this.program(10,s,0),"inverse":this.program(12,s,0)}))?n:""},"10":function(e,i,t,s){var n;return'    <div class="csui-thumbnail-name csui-thumbnail-name-'+this.escapeExpression((n=null!=(n=i.cid||(null!=e?e.cid:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"cid","hash":{}}):n))+'">\r\n      <span class="csui-thumbnail-name-justify-div">\r\n        <span class="csui-thumbnail-name-value csui-thumbnail-no-default-action"\r\n           title="'+this.escapeExpression((n=null!=(n=i.name||(null!=e?e.name:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"name","hash":{}}):n))+'" aria-label="'+this.escapeExpression((n=null!=(n=i.nameNoOpenAria||(null!=e?e.nameNoOpenAria:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"nameNoOpenAria","hash":{}}):n))+'">'+this.escapeExpression((n=null!=(n=i.name||(null!=e?e.name:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"name","hash":{}}):n))+"</span>\r\n      </span>\r\n    </div>\r\n"},"12":function(e,i,t,s){var n;return'    <div class="csui-thumbnail-name csui-thumbnail-name-'+this.escapeExpression((n=null!=(n=i.cid||(null!=e?e.cid:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"cid","hash":{}}):n))+'">\r\n      <a href="'+this.escapeExpression((n=null!=(n=i.defaultActionUrl||(null!=e?e.defaultActionUrl:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"defaultActionUrl","hash":{}}):n))+'"\r\n         class="csui-thumbnail-name-value csui-thumbnail-default-action csui-thumbnail-name-justify-div"\r\n         title="'+this.escapeExpression((n=null!=(n=i.name||(null!=e?e.name:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"name","hash":{}}):n))+'" aria-label="'+this.escapeExpression((n=null!=(n=i.nameAria||(null!=e?e.nameAria:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"nameAria","hash":{}}):n))+'">\r\n        <span class="csui-thumbnail-name-link-text">'+this.escapeExpression((n=null!=(n=i.name||(null!=e?e.name:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"name","hash":{}}):n))+"</span>\r\n      </a>\r\n    </div>\r\n"},"14":function(e,i,t,s){var n;return'  <div class="csui-thumbnail-name csui-thumbnail-name-'+this.escapeExpression((n=null!=(n=i.cid||(null!=e?e.cid:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"cid","hash":{}}):n))+'">\r\n    <span class="csui-thumbnail-name-justify-div">\r\n      <span class="csui-thumbnail-name-value csui-thumbnail-no-default-action"\r\n         title="'+this.escapeExpression((n=null!=(n=i.name||(null!=e?e.name:e))?n:i.helperMissing,
"function"==typeof n?n.call(e,{"name":"name","hash":{}}):n))+'" aria-label="'+this.escapeExpression((n=null!=(n=i.nameNoOpenAria||(null!=e?e.nameNoOpenAria:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"nameNoOpenAria","hash":{}}):n))+'">'+this.escapeExpression((n=null!=(n=i.name||(null!=e?e.name:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"name","hash":{}}):n))+"</span>\r\n    </span>\r\n  </div>\r\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){var n;return(null!=(n=i.if.call(e,null!=e?e.displayIcon:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?n:"")+(null!=(n=i.if.call(e,null!=e?e.defaultAction:e,{"name":"if","hash":{},"fn":this.program(9,s,0),"inverse":this.program(14,s,0)}))?n:"")}});return t.registerPartial("csui_controls_thumbnail_content_name_impl_name",s),s}),csui.define("css!csui/controls/thumbnail/content/name/impl/name",[],function(){}),csui.define("csui/controls/thumbnail/content/name/name.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/controls/node-type.icon/node-type.icon.view","csui/utils/node.links/node.links","csui/controls/thumbnail/content/content.registry","i18n!csui/controls/thumbnail/content/name/impl/nls/localized.strings","hbs!csui/controls/thumbnail/content/name/impl/name","css!csui/controls/thumbnail/content/name/impl/name"],function(e,i,t,s,n,o,l,r,a){"use strict";var c=s.ItemView.extend({"template":a,"className":"csui-thumbnail-name-container","templateHelpers":function(){var e=this.options.column,t=this.model,s=t.get(e.name),n=o.getUrl(t);return{"cid":this.model.cid,"defaultAction":e.defaultAction,"defaultActionUrl":n,"contextualMenu":e.contextualMenu,"name":s,"nameAria":i.str.sformat(r.nameAria,s),"nameNoOpenAria":i.str.sformat(r.nameNoOpenAria,s),"inactive":t.get("inactive"),"displayIcon":this.options.displayIcon}},"events":{"keydown":"onKeyInView"},"constructor":function(e){e||(e={}),this.options=e,s.ItemView.prototype.constructor.apply(this,arguments),this.options.displayIcon&&this.listenTo(this,"render",this._createNodeTypeIcon).listenTo(this,"before:render",this._destroyNodeTypeIcon).listenTo(this,"before:destroy",this._destroyNodeTypeIcon)},"onKeyInView":function(e){32!==e.keyCode&&13!==e.keyCode||this.model.inlineFormView||this.trigger("execute:defaultAction",e)},"_createNodeTypeIcon":function(){var e=new n({"node":this.model});this.typeIconRegion=new s.Region({"el":this.$(".csui-thumbnail-overview-icon")}),this.typeIconRegion.show(e)},"_destroyNodeTypeIcon":function(){this.typeIconRegion&&(this.typeIconRegion.empty(),this.typeIconRegion=null)},"onRender":function(){var e=this;this.$el.find(".csui-thumbnail-default-action").on("click."+this.cid,function(i){e.model.inlineFormView||e.trigger("execute:defaultAction",i)})}});return l.registerByKey("name",c),c}),csui.define("hbs!csui/controls/thumbnail/content/member/impl/member",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){var n;return'<div class="csui-thumbnail-user csui-thumbnail-user-'+this.escapeExpression((n=null!=(n=i.cid||(null!=e?e.cid:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"cid","hash":{}}):n))+'">\r\n  <div class="csui-thumbnail-label csui-thumbnail-user-content-label" aria-label="'+this.escapeExpression((n=null!=(n=i.label||(null!=e?e.label:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"label","hash":{}}):n))+'">\r\n    <span>'+this.escapeExpression((n=null!=(n=i.label||(null!=e?e.label:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"label","hash":{}}):n))+'</span>\r\n  </div>\r\n  <div class="csui-thumbnail-value csui-thumbnail-user-content-justify-div">\r\n    <p class="csui-thumbnail-item-content-value" title="'+this.escapeExpression((n=null!=(n=i.value||(null!=e?e.value:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"value","hash":{}}):n))+'"\r\n       aria-label="'+this.escapeExpression((n=null!=(n=i.userNoOpenAria||(null!=e?e.userNoOpenAria:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"userNoOpenAria","hash":{}}):n))+'">'+this.escapeExpression((n=null!=(n=i.value||(null!=e?e.value:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"value","hash":{}}):n))+"</p>\r\n  </div>\r\n</div>"}});return t.registerPartial("csui_controls_thumbnail_content_member_impl_member",s),s}),csui.define("csui/controls/thumbnail/content/member/member.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/utils/base","csui/controls/thumbnail/content/content.registry","hbs!csui/controls/thumbnail/content/member/impl/member"],function(e,i,t,s,n,o,l){"use strict";var r=s.ItemView.extend({"template":l,"className":"csui-thumbnail-user-container","templateHelpers":function(){var e,t=this.options.column.name,s=this.model.get(t+"_expand")||this.model.get(t)||"",o=this.options.contentModel.get("name");return e=i.isObject(s)?n.formatMemberName(s):this.model.get(t+"_formatted")||s.toString(),{"label":o,"value":e}},"constructor":function(e){e||(e={}),this.options=e,s.ItemView.prototype.constructor.apply(this,arguments)}});return o.registerByDataType(14,r),o.registerByDataType(19,r),o.registerByKey("owner_id",r),r}),csui.define("csui/controls/thumbnail/content/size/impl/nls/localized.strings",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/thumbnail/content/size/impl/nls/root/localized.strings",{"sizeLabel":"Size","ColumnTitle":"Size","formatForNone":"{0} items","formatForOne":"{0} item","formatForTwo":"{0} items","formatForFive":"{0} items","sizeUnavailable":"Size unavailable for {0}"}),csui.define("hbs!csui/controls/thumbnail/content/size/impl/size",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"1":function(e,i,t,s){var n;return'    <div class="csui-thumbnail-label csui-thumbnail-size-label" aria-label="'+this.escapeExpression((n=null!=(n=i.label||(null!=e?e.label:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"label","hash":{}}):n))+'">\r\n      <span>'+this.escapeExpression((n=null!=(n=i.label||(null!=e?e.label:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"label","hash":{}}):n))+"</span>\r\n    </div>\r\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){var n,o;return'<div class="csui-thumbnail-size csui-thumbnail-size-'+this.escapeExpression((o=null!=(o=i.cid||(null!=e?e.cid:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"cid","hash":{}}):o))+'">\r\n'+(null!=(n=i.if.call(e,null!=e?e.displayLabel:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?n:"")+'  <div class="csui-thumbnail-value csui-thumbnail-size-justify-div">\r\n    <p class="csui-thumbnail-size-value" title="'+this.escapeExpression((o=null!=(o=i.value||(null!=e?e.value:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"value","hash":{}}):o))+'"\r\n       aria-label="'+this.escapeExpression((o=null!=(o=i.value||(null!=e?e.value:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"value","hash":{}}):o))+'">'+this.escapeExpression((o=null!=(o=i.formattedValue||(null!=e?e.formattedValue:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"formattedValue","hash":{}}):o))+"</p>\r\n  </div>\r\n</div>"}});return t.registerPartial("csui_controls_thumbnail_content_size_impl_size",s),s}),csui.define("css!csui/controls/thumbnail/content/size/impl/size",[],function(){}),csui.define("csui/controls/thumbnail/content/size/size.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/utils/base","csui/controls/thumbnail/content/content.registry","i18n!csui/controls/thumbnail/content/size/impl/nls/localized.strings","hbs!csui/controls/thumbnail/content/size/impl/size","css!csui/controls/thumbnail/content/size/impl/size"],function(e,i,t,s,n,o,l,r){"use strict";var a=s.ItemView.extend({"template":r,"className":"csui-thumbnail-size-container","templateHelpers":function(){var e,i=this.model,t=this.options.column,s=t.name,o=i.get(s),r=i.get("type");return null==o&&(o=e=i.get(s+"_formatted")),i.get("container")?o=e=899!==r&&411!==r?i.get(s+"_formatted"):"":144===r||749===r||736===r||30309===r?(e=n.formatFriendlyFileSize(o),o=n.formatExactFileSize(o)):o=e=i.get(s+"_formatted"),{"value":o,"formattedValue":e,"displayLabel":this.options.displayLabel,"label":this.options.displayLabel?l.sizeLabel:"","cid":this.model.cid}},"constructor":function(e){e||(e={}),s.ItemView.prototype.constructor.apply(this,arguments)}});return o.registerByKey("size",a),a}),csui.define("hbs!csui/controls/thumbnail/content/select/impl/select",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"1":function(e,i,t,s){var n,o;return'  <div class="csui-focusable-table-column-header">\r\n    <div class="csui-selected-checkbox csui-checkbox-primary">\r\n      <input type="checkbox" class="selectAction" title="'+this.escapeExpression((o=null!=(o=i.selectItemName||(null!=e?e.selectItemName:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"selectItemName","hash":{}}):o))+'"\r\n             '+(null!=(n=i.if.call(e,null!=e?e.checked:e,{"name":"if","hash":{},"fn":this.program(2,s,0),"inverse":this.noop}))?n:"")+' >\r\n      <div class="csui-selectlabel"></div>\r\n    </div>\r\n  </div>\r\n'},"2":function(e,i,t,s){return"checked"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){var n;return null!=(n=i.if.call(e,null!=e?e.selectable:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?n:""}});return t.registerPartial("csui_controls_thumbnail_content_select_impl_select",s),s}),csui.define("css!csui/controls/thumbnail/content/select/impl/select",[],function(){}),csui.define("csui/controls/thumbnail/content/select/select.view",["csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/controls/thumbnail/content/content.registry","i18n!csui/controls/thumbnail/impl/nls/lang","hbs!csui/controls/thumbnail/content/select/impl/select","css!csui/controls/thumbnail/content/select/impl/select"],function(e,i,t,s,n,o){"use strict";var l=t.ItemView.extend({"template":o,"templateHelpers":function(){return{"selectable":!1!==this.model.get("selectable"),"checked":!0===this.model.get(l.isSelectedModelAttributeName),"selectItemName":e.str.sformat(n.selectItem,this.model.get("name")),"selectItemAria":e.str.sformat(n.selectItemAria,this.model.get("name"))}},"events":{"keydown":"onKeyInView"},"constructor":function(e){t.ItemView.prototype.constructor.apply(this,arguments),this.rowIndex=e.rowIndex,this.listenTo(this.model,"change:"+l.isSelectedModelAttributeName,this.render),this.listenTo(this,"before:render",this._detachClickHandler).listenTo(this,"before:destroy",this._detachClickHandler)},"onKeyInView":function(e){32!==e.keyCode&&13!==e.keyCode||this._toggleCheckbox(e)},"_attachClickHandler":function(){var e=this,t=this.$el.find('input[type="checkbox"]');this.$el.find(".csui-selectlabel").on("click."+this.cid,function(i){i.preventDefault(),i.stopPropagation(),e.options.thumbnailView&&e.options.thumbnailView._isSelectCheckBoxBlocked||(t.prop("checked",!t.prop("checked")).change(),e.triggerMethod("clicked:checkbox",i))}),t.on("change."+this.cid,function(s){i.trigger("closeToggleAction");var n=t.prop("checked");e.triggerMethod("clicked:checkbox",{"view":e,"checked":n})})},"_detachClickHandler":function(){var e=this.$el.find('input[type="checkbox"]'),i=this.$el.find(".csui-selectlabel");e.off("change."+this.cid),i.off("click."+this.cid),this.$el.off("click."+this.cid)},"_toggleCheckbox":function(e){var i=this.$el.find('input[type="checkbox"]');return i.prop("checked",!i.prop("checked")).change(),this.$el.attr("aria-checked",i.prop("checked")),e.preventDefault(),e.stopPropagation(),i.prop("checked")},"onRender":function(){this._ensureViewIsIntact(),this.triggerMethod("before:render",this),this.$el.attr("aria-label",n.selectItemAria),this.$el.attr("role","checkbox");var e=this.$el.find('input[type="checkbox"]'),i=e.prop("checked");return this.$el.attr("aria-checked",i),this._attachClickHandler(),this}},{"columnClassName":"csui-table-cell-_select","isSelectedModelAttributeName":"csuiIsSelected"});return s.registerByKey("_select",l),l}),csui.define("csui/controls/thumbnail/content/date/impl/nls/localized.strings",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/thumbnail/content/date/impl/nls/root/localized.strings",{"ColumnTitle":"Date","dateLabel":"Modified date"}),csui.define("hbs!csui/controls/thumbnail/content/date/impl/date",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"1":function(e,i,t,s){var n;return'    <div class="csui-thumbnail-label csui-thumbnail-date-label" aria-label="'+this.escapeExpression((n=null!=(n=i.label||(null!=e?e.label:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"label","hash":{}}):n))+'">\r\n      <span>'+this.escapeExpression((n=null!=(n=i.label||(null!=e?e.label:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"label","hash":{}}):n))+"</span>\r\n    </div>\r\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){var n,o;return'<div class="csui-thumbnail-date csui-thumbnail-date-'+this.escapeExpression((o=null!=(o=i.cid||(null!=e?e.cid:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"cid","hash":{}}):o))+'">\r\n'+(null!=(n=i.if.call(e,null!=e?e.displayLabel:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?n:"")+'  <div class="csui-thumbnail-value csui-thumbnail-date-justify-div">\r\n    <p class="csui-thumbnail-date-value" title="'+this.escapeExpression((o=null!=(o=i.value||(null!=e?e.value:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"value","hash":{}}):o))+'"\r\n       aria-label="'+this.escapeExpression((o=null!=(o=i.value||(null!=e?e.value:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"value","hash":{}}):o))+'">'+this.escapeExpression((o=null!=(o=i.value||(null!=e?e.value:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"value","hash":{}}):o))+"</p>\r\n  </div>\r\n</div>"}});return t.registerPartial("csui_controls_thumbnail_content_date_impl_date",s),s}),csui.define("css!csui/controls/thumbnail/content/date/impl/date",[],function(){}),csui.define("csui/controls/thumbnail/content/date/date.view",["module","csui/lib/underscore","csui/lib/marionette","csui/utils/types/date","csui/controls/thumbnail/content/content.registry","i18n!csui/controls/thumbnail/content/date/impl/nls/localized.strings","hbs!csui/controls/thumbnail/content/date/impl/date","css!csui/controls/thumbnail/content/date/impl/date"],function(e,i,t,s,n,o,l){"use strict";var r=i.extend({"multiValueSeparator":", "},e.config()),a=t.ItemView.extend({"template":l,"className":"csui-thumbnail-date-container","templateHelpers":function(){var e=this.options.column,i=this.model.get(e.name),t=!1!==e.include_time,n=t?s.formatExactDateTime:s.formatExactDate,l=this.getSingleOrMultipleValueData(i,n,n);return this.options.displayLabel&&(l.label=this.options.contentModel.get("name")?this.options.contentModel.get("name"):o.dateLabel),l.displayLabel=this.options.displayLabel,l.cid=this.model.cid,l},"getSingleOrMultipleValueData":function(e,i,t){var s,n;return Array.isArray(e)?(s=this.concatenateTextValues(e,i),n=this.concatenateTextValues(e,t)):(s=i(e),n=t(e)),{"value":s,"formattedValue":n}},"concatenateTextValues":function(e,i){return i=this._validateFormater(i),e.map(i).join(r.multiValueSeparator)},"_validateFormater":function(e){return e||function(e){return e}},"constructor":function(e){e||(e={}),t.ItemView.prototype.constructor.apply(this,arguments)}});return n.registerByDataType(-7,a),a}),csui.define("hbs!csui/controls/thumbnail/content/thumbnail.icon/impl/thumbnail.icon",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"1":function(e,i,t,s){var n;return'  <div\r\n      class="csui-thumbnail-content-icon csui-thumbnail-content-no-default-action thumbnail-'+this.escapeExpression((n=null!=(n=i.cid||(null!=e?e.cid:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"cid","hash":{}}):n))+'"\r\n      aria-label="'+this.escapeExpression((n=null!=(n=i.typeAndNameAria||(null!=e?e.typeAndNameAria:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"typeAndNameAria","hash":{}}):n))+'" tabindex="0"></div>\r\n'},"3":function(e,i,t,s){var n;return null!=(n=i.if.call(e,null!=e?e.inactive:e,{"name":"if","hash":{},"fn":this.program(4,s,0),"inverse":this.program(6,s,0)}))?n:""},"4":function(e,i,t,s){var n;return'    <div class="csui-thumbnail-content-icon csui-thumbnail-content-no-default-action inactive"\r\n         aria-label="'+this.escapeExpression((n=null!=(n=i.typeAndNameAria||(null!=e?e.typeAndNameAria:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"typeAndNameAria","hash":{}}):n))+'"></div>\r\n'},"6":function(e,i,t,s){var n;return null!=(n=i.if.call(e,null!=e?e.inCreateMode:e,{"name":"if","hash":{},"fn":this.program(7,s,0),"inverse":this.program(9,s,0)}))?n:""},"7":function(e,i,t,s){var n;return'      <div class="csui-thumbnail-content-icon csui-thumbnail-content-default-action"\r\n           aria-label="'+this.escapeExpression((n=null!=(n=i.typeAndNameAria||(null!=e?e.typeAndNameAria:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"typeAndNameAria","hash":{}}):n))+'" tabindex="0"></div>\r\n'},"9":function(e,i,t,s){var n;return'      <a class="csui-thumbnail-content-icon csui-thumbnail-content-default-action thumbnail-'+this.escapeExpression((n=null!=(n=i.cid||(null!=e?e.cid:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"cid","hash":{}}):n))+'"\r\n         href="'+this.escapeExpression((n=null!=(n=i.defaultActionUrl||(null!=e?e.defaultActionUrl:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"defaultActionUrl","hash":{}}):n))+'" aria-label="'+this.escapeExpression((n=null!=(n=i.typeAndNameAria||(null!=e?e.typeAndNameAria:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"typeAndNameAria","hash":{}}):n))+'"></a>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){var n;return null!=(n=i.if.call(e,null!=e?e.thumbnailAction:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.program(3,s,0)}))?n:""}});return t.registerPartial("csui_controls_thumbnail_content_thumbnail.icon_impl_thumbnail.icon",s),s}),csui.define("csui/controls/thumbnail/content/thumbnail.icon/impl/nls/localized.strings",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/thumbnail/content/thumbnail.icon/impl/nls/root/localized.strings",{"typeAndNameAria":"{0} {1}","downloadTitle":"Download","hideTitle":"Hide filmstrip","showTitle":"Show filmstrip","nextTitle":"Next","previousTitle":"Previous","videoNotSupportMsg":"Your browser does not support the video tag."}),csui.define("hbs!csui/controls/thumbnail/content/thumbnail.icon/util/gallery",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){var n,o;return'<div class="csui-current-total-items">'+this.escapeExpression((o=null!=(o=i.currentItem||(null!=e?e.currentItem:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"currentItem","hash":{}}):o))+" / "+this.escapeExpression((o=null!=(o=i.totalItems||(null!=e?e.totalItems:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"totalItems","hash":{}}):o))+'</div>\r\n<div class="csui-active-item-name">\r\n  <span class="item-name">'+this.escapeExpression((o=null!=(o=i.currentItemName||(null!=e?e.currentItemName:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"currentItemName","hash":{}}):o))+'</span>\r\n  <span title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.lang:e)?n.downloadTitle:n,e))+'" class="icon icon-download-white csui-download-gallery"\r\n        tabindex="0"></span>\r\n</div>\r\n<div class="csui-carousel-container">\r\n  <div class="csui-preview-carousal-container">\r\n    <div id="binf-carousel" class="binf-carousel binf-slide" data-binf-ride="carousel">\r\n      <div class="csui-preview-carousal"></div>\r\n      <a class="binf-left binf-carousel-control" href="#binf-carousel" role="binf_button"\r\n         data-binf-slide="binf-prev" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.lang:e)?n.previousTitle:n,e))+'" tabindex="0">\r\n        <span class="icon-previous-gallery" aria-hidden="true"></span>\r\n      </a>\r\n      <a class="binf-right binf-carousel-control" href="#binf-carousel" role="binf_button"\r\n         data-binf-slide="binf-next" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.lang:e)?n.nextTitle:n,e))+'" tabindex="0">\r\n        <span class="icon-next-gallery" aria-hidden="true"></span>\r\n      </a>\r\n    </div>\r\n  </div>\r\n  <div class="csui-carousel-film-strip">\r\n    <div class="binf-carousel binf-slide binf-filmstrip-container" data-interval="false"></div>\r\n    <a class="binf-left binf-carousel-control csui-thumb-toggle-control" href="javascript:void(0);"\r\n       role="binf_button">\r\n    <span class="binf-glyphicon binf-glyphicon-menu-down" aria-hidden="true"\r\n          title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.lang:e)?n.hideTitle:n,e))+'"></span>\r\n    </a>\r\n  </div>\r\n</div>'}});return t.registerPartial("csui_controls_thumbnail_content_thumbnail.icon_util_gallery",s),s}),csui.define("hbs!csui/controls/thumbnail/content/thumbnail.icon/util/gallery.item",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"1":function(e,i,t,s){var n;return null!=(n=i.if.call(e,null!=e?e.activeItem:e,{"name":"if","hash":{},"fn":this.program(2,s,0),"inverse":this.program(16,s,0)}))?n:""},"2":function(e,i,t,s){var n;return null!=(n=i.if.call(e,null!=e?e.isVideo:e,{"name":"if","hash":{},"fn":this.program(3,s,0),"inverse":this.program(8,s,0)}))?n:""},"3":function(e,i,t,s){var n,o;return'      <div class="binf-item binf-active binf-item-'+this.escapeExpression((o=null!=(o=i.id||(null!=e?e.id:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"id","hash":{}}):o))+'">\r\n'+(null!=(n=i.if.call(e,null!=e?e.originalAvailable:e,{"name":"if","hash":{},"fn":this.program(4,s,0),"inverse":this.program(6,s,0)}))?n:"")+"      </div>\r\n"},"4":function(e,i,t,s){return'          <div class="csui-video">\r\n            <video preload="none" poster="" controls="controls">\r\n              <source src="'+this.escapeExpression(this.lambda(null!=e?e.contentURL:e,e))+"\" type='"+this.escapeExpression(this.lambda(null!=e?e.videoType:e,e))+"'>\r\n              </source>\r\n              "+this.escapeExpression(this.lambda(null!=e?e.videoNotSupportMsg:e,e))+"\r\n            </video>\r\n          </div>\r\n"},"6":function(e,i,t,s){return'          <div class="csui-video">\r\n            <video preload="none" poster="" controls="controls">\r\n              <source src="'+this.escapeExpression(this.lambda(null!=e?e.contentURL:e,e))+"\" type='"+this.escapeExpression(this.lambda(null!=e?e.videoType:e,e))+"'>\r\n              </source>\r\n              "+this.escapeExpression(this.lambda(null!=e?e.videoNotSupportMsg:e,e))+'\r\n            </video>\r\n            <div class="csui-img-loader">\r\n              <div class="csui-img-loader-inner"></div>\r\n            </div>\r\n          </div>\r\n'},"8":function(e,i,t,s){var n,o;return'      <div class="binf-item binf-active binf-item-'+this.escapeExpression((o=null!=(o=i.id||(null!=e?e.id:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"id","hash":{}}):o))+'">\r\n'+(null!=(n=i.if.call(e,null!=e?e.originalAvailable:e,{"name":"if","hash":{},"fn":this.program(9,s,0),"inverse":this.program(11,s,0)}))?n:"")+"      </div>\r\n"},"9":function(e,i,t,s){return'          <div class="csui-img-box csui-gallery-original-icon">\r\n            <img src="'+this.escapeExpression(this.lambda(null!=e?e.contentURL:e,e))+'" tabindex="0">\r\n          </div>\r\n'},"11":function(e,i,t,s){var n;return null!=(n=i.if.call(e,null!=e?e.thumbnailAvailable:e,{"name":"if","hash":{},"fn":this.program(12,s,0),"inverse":this.program(14,s,0)}))?n:""},"12":function(e,i,t,s){return'            <div class="csui-img-box csui-gallery-thumbnail-icon">\r\n              <div>\r\n                <img src="'+this.escapeExpression(this.lambda(null!=e?e.contentURL:e,e))+'" tabindex="0">\r\n                <div class="csui-img-loader">\r\n                  <div class="csui-img-loader-inner"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div class="csui-img-box csui-gallery-original-icon binf-hidden">\r\n              <img src="'+this.escapeExpression(this.lambda(null!=e?e.contentURL:e,e))+'" tabindex="0">\r\n            </div>\r\n'},"14":function(e,i,t,s){return'            <div class="csui-img-box csui-gallery-original-icon binf-hidden">\r\n              <img src="'+this.escapeExpression(this.lambda(null!=e?e.contentURL:e,e))+'" tabindex="0">\r\n            </div>\r\n            <div class="outer-border">\r\n              <div class="loader"></div>\r\n            </div>\r\n'},"16":function(e,i,t,s){var n;return null!=(n=i.if.call(e,null!=e?e.isVideo:e,{"name":"if","hash":{},"fn":this.program(17,s,0),"inverse":this.program(19,s,0)}))?n:""},"17":function(e,i,t,s){var n,o;return'      <div class="binf-item binf-item-'+this.escapeExpression((o=null!=(o=i.id||(null!=e?e.id:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"id","hash":{}}):o))+'">\r\n'+(null!=(n=i.if.call(e,null!=e?e.originalAvailable:e,{"name":"if","hash":{},"fn":this.program(4,s,0),"inverse":this.program(6,s,0)}))?n:"")+"      </div>\r\n"},"19":function(e,i,t,s){var n,o;return'      <div class="binf-item binf-item-'+this.escapeExpression((o=null!=(o=i.id||(null!=e?e.id:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"id","hash":{}}):o))+'">\r\n'+(null!=(n=i.if.call(e,null!=e?e.originalAvailable:e,{"name":"if","hash":{},"fn":this.program(9,s,0),"inverse":this.program(11,s,0)}))?n:"")+"      </div>\r\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){var n;return null!=(n=i.each.call(e,null!=e?e.data:e,{"name":"each","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?n:""}});return t.registerPartial("csui_controls_thumbnail_content_thumbnail.icon_util_gallery.item",s),s}),csui.define("hbs!csui/controls/thumbnail/content/thumbnail.icon/util/filmstrip.item",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"1":function(e,i,t,s){var n;return null!=(n=i.if.call(e,null!=e?e.activeItem:e,{"name":"if","hash":{},"fn":this.program(2,s,0),"inverse":this.program(12,s,0)}))?n:""},"2":function(e,i,t,s){var n,o;return'    <div class="binf-item binf-filmstrip-item-'+this.escapeExpression((o=null!=(o=i.id||(null!=e?e.id:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"id","hash":{}}):o))+' binf-active" title="'+this.escapeExpression((o=null!=(o=i.name||(null!=e?e.name:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"name","hash":{}}):o))+'" tabindex="0">\r\n      <div class="binf-thumb" data-binf-target="#binf-carousel" data-binf-slide-to= '+this.escapeExpression((o=null!=(o=i.index||(null!=e?e.index:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"index","hash":{}}):o))+'>\r\n        <div class="binf-thumb-caption">'+this.escapeExpression((o=null!=(o=i.name||(null!=e?e.name:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"name","hash":{}}):o))+'</div>\r\n        <div class="binf-thumb-img-container">\r\n          <div class="binf-thumb-img '+(null!=(n=i.if.call(e,null!=e?e.isVideo:e,{"name":"if","hash":{},"fn":this.program(3,s,0),"inverse":this.noop}))?n:"")+'">\r\n'+(null!=(n=i.if.call(e,null!=e?e.isVideo:e,{"name":"if","hash":{},"fn":this.program(5,s,0),"inverse":this.program(7,s,0)}))?n:"")+"          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n"},"3":function(e,i,t,s){return"binf-video-container "},"5":function(e,i,t,s){return'              <div class="binf-play-arrow-container"><span\r\n                  class="binf-play-arrow"></span></div>\r\n'},"7":function(e,i,t,s){var n;return"              <div>\r\n                <img "+(null!=(n=i.unless.call(e,null!=e?e.thumbnailURL:e,{"name":"unless","hash":{},"fn":this.program(8,s,0),"inverse":this.noop}))?n:"")+' src="'+this.escapeExpression(this.lambda(null!=e?e.thumbnailURL:e,e))+'"></img>\r\n'+(null!=(n=i.unless.call(e,null!=e?e.thumbnailURL:e,{"name":"unless","hash":{},"fn":this.program(10,s,0),"inverse":this.noop}))?n:"")+"              </div>\r\n"},"8":function(e,i,t,s){return' class="binf-hidden"'},"10":function(e,i,t,s){return'                <span class="csui-icon mime_image"></span>\r\n'},"12":function(e,i,t,s){var n,o;return'    <div class="binf-item binf-filmstrip-item-'+this.escapeExpression((o=null!=(o=i.id||(null!=e?e.id:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"id","hash":{}}):o))+'" title="'+this.escapeExpression((o=null!=(o=i.name||(null!=e?e.name:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"name","hash":{}}):o))+'" tabindex="0">\r\n      <div class="binf-thumb" data-binf-target="#binf-carousel" data-binf-slide-to= '+this.escapeExpression((o=null!=(o=i.index||(null!=e?e.index:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"index","hash":{}}):o))+'>\r\n        <div class="binf-thumb-caption">'+this.escapeExpression((o=null!=(o=i.name||(null!=e?e.name:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"name","hash":{}}):o))+'</div>\r\n        <div class="binf-thumb-img-container">\r\n          <div class="binf-thumb-img '+(null!=(n=i.if.call(e,null!=e?e.isVideo:e,{"name":"if","hash":{},"fn":this.program(3,s,0),"inverse":this.noop}))?n:"")+'">\r\n'+(null!=(n=i.if.call(e,null!=e?e.isVideo:e,{"name":"if","hash":{},"fn":this.program(5,s,0),"inverse":this.program(7,s,0)}))?n:"")+"          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){var n;return null!=(n=i.each.call(e,null!=e?e.data:e,{"name":"each","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?n:""}});return t.registerPartial("csui_controls_thumbnail_content_thumbnail.icon_util_filmstrip.item",s),s});csui.define("css!csui/controls/thumbnail/content/thumbnail.icon/util/gallary",[],function(){}),csui.define("csui/controls/thumbnail/content/thumbnail.icon/util/gallery.view",["csui/lib/underscore","csui/lib/jquery","i18n","csui/utils/base","hbs!csui/controls/thumbnail/content/thumbnail.icon/util/gallery","hbs!csui/controls/thumbnail/content/thumbnail.icon/util/gallery.item","hbs!csui/controls/thumbnail/content/thumbnail.icon/util/filmstrip.item","css!csui/controls/thumbnail/content/thumbnail.icon/util/gallary","csui/lib/jquery.touchSwipe"],function(e,i,t,s,n,o,l){"use strict";function r(t,s,r){d=t,f=t.length,g=t[s],b=g.name,h=i("<div />",{"class":"binf-gallery-container","html":n({"totalItems":t.length,"currentItem":g.index+1,"currentItemName":b,"lang":r})}),p=i("<div />",{"class":"binf-carousel-inner","html":o({"data":t})}),m=i("<div />",{"class":"csui-carousel-film-strip-inner","html":l({"data":t})}),h.find(".csui-carousel-film-strip .binf-carousel").html(m),h.find(".csui-preview-carousal").html(p),e.each(t,function(e,i){var t=h.find(".binf-item-"+e.model.cid).find(".csui-gallery-original-icon");e.model.flipRight&&t.find("img").css({"-webkit-transform":"scaleX(-1)","-moz-transform":"scaleX(-1)","-o-transform":"scaleX(-1)","transform":"scaleX(-1)","filter":"FlipH","-ms-filter":"FlipH"}),t.find("img").css({"-webkit-transform":"rotate("+e.model.transformDegrees+"deg)","-moz-transform":"rotate("+e.model.transformDegrees+"deg)","-ms-transform":"rotate("+e.model.transformDegrees+"deg)","-o-transform":"rotate("+e.model.transformDegrees+"deg)","transform":"rotate("+e.model.transformDegrees+"deg)"})},this),d.length<2&&(h.find("#binf-carousel").children(".binf-left").hide(),
h.find("#binf-carousel").children(".binf-right").hide()),w=74;var v=w*d.length;return i(window).width()<v&&(h.find(".csui-carousel-film-strip-inner").css("width",v+"px"),h.find(".csui-carousel-film-strip-inner").addClass("csui-film-strip-adjust")),h.find("#binf-carousel").on("slid.binf.carousel",c),h.find(".csui-thumb-toggle-control").on("click",{"lang":r},u),h.find(".csui-download-gallery").on("click",a),h.find("#binf-carousel").swipe({"swipe":function(e,t,s,n,o,l){"left"==t&&i(this).binf_carousel("next"),"right"==t&&i(this).binf_carousel("prev")},"allowPageScroll":"vertical"}),m.find(".binf-item").on("keyup",function(e){32!==e.keyCode&&13!==e.keyCode||i(e.currentTarget)&&i(e.currentTarget).find(".binf-thumb").trigger("click")}),h}function a(e){g.downloadItem(e)}function c(e,t){var s;s="click"===e.type||"keyup"===e.type?t:e.relatedTarget,w=i(h.find(".csui-carousel-film-strip-inner .binf-thumb-img")[0]).width()+10,v=h.find(".csui-carousel-film-strip-inner").find(".binf-item").removeClass("binf-active");var n=i(v[i(s).index()]);n.addClass("binf-active"),g&&g.index>=0&&(g=d[i(s).index()],d[g.index].model&&d[g.index].model.contentURL&&!d[g.index].model.addedOriginalImage&&(i(s).addClass("csui-item-original"),d[g.index].addedOriginalImage=!0,i(s).find("img").length>0&&i(s).find("img").attr("src",d[g.index].model.contentURL),i(s).find("video").length>0&&(i(s).find("video").attr("src",d[g.index].model.contentURL),i(s).find(".outer-border").addClass("binf-hidden"))),b=g.name,h.find(".csui-current-total-items").html(g.index+1+" / "+f),h.find(".csui-active-item-name .item-name").html(b),g.updateScroll(n))}function u(e){h.find(".csui-carousel-film-strip .binf-carousel").slideToggle(),h.find(".binf-glyphicon-menu-down").toggleClass("binf-glyphicon-menu-up"),h.find(".binf-glyphicon-menu-up").length>0?h.find(".binf-glyphicon-menu-up").attr("title",e.data.lang.showTitle):h.find(".binf-glyphicon-menu-down").attr("title",e.data.lang.hideTitle)}var d,h,p,m,f,g,b,v,w;return{"createGalleryContainer":r,"updateSlide":c,"thumbToggle":u,"downloadItem":a}}),csui.define("css!csui/controls/thumbnail/content/thumbnail.icon/impl/thumbnail.icon",[],function(){}),csui.define("csui/controls/thumbnail/content/thumbnail.icon/thumbnail.icon.view",["module","csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/utils/base","csui/controls/node-type.icon/node-type.icon.view","csui/utils/node.links/node.links","hbs!csui/controls/thumbnail/content/thumbnail.icon/impl/thumbnail.icon","i18n!csui/controls/thumbnail/content/thumbnail.icon/impl/nls/localized.strings","csui/controls/thumbnail/content/content.registry","csui/controls/dialog/dialog.view","csui/controls/thumbnail/content/thumbnail.icon/util/gallery.view","csui/utils/commands/impl/thumbnail/thumbnail.object","csui/models/nodes","csui/utils/url","csui/utils/taskqueue","csui/utils/commands/download","csui/controls/tile/behaviors/perfect.scrolling.behavior","csui/lib/exif","css!csui/controls/thumbnail/content/thumbnail.icon/impl/thumbnail.icon"],function(e,i,t,s,n,o,l,r,a,c,u,d,h,p,m,f,g,b,v,w){"use strict";var y=e.config();i.defaults(y,{"parallelism":3});var _=!1,C=n.ItemView.extend({"ui":{"thumbnailIcon":".csui-thumbnail-content-icon","iconcloseGallery":".icon-close-gallery"},"events":{"keydown":"onKeyInView","keydown click @ui.iconcloseGallery":"handleShiftKey","click @ui.thumbnailIcon":"showThumbCarousel","keyup @ui.thumbnailIcon":"showGalleryView"},"template":a,"templateHelpers":function(){var e=this.model,t=this.model.get("mime_type")&&this.model.get("mime_type").match(/^image|video\/*[-.\w\s]*$/g)||144===this.model.get("type"),s=r.getUrl(this.model),n=i.str.sformat(c.typeAndNameAria,e.get("type_name"),e.get("name"));return{"thumbnailAction":t,"cid":this.model&&this.model.cid||this.options.model.cid,"defaultActionUrl":s,"typeAndNameAria":n,"inactive":e.get("inactive"),"inCreateMode":!this.model.get("id")}},"constructor":function(e){n.ItemView.prototype.constructor.apply(this,arguments),this.listenTo(this,"render",this._createNodeTypeIcon).listenTo(this,"before:render",this._destroyNodeTypeIcon).listenTo(this,"before:destroy",this._destroyNodeTypeIcon).listenTo(this.model,"update:thumbnail",this.updateThumbnailImage).listenTo(this.model,"update:default:thumbnail",this.updateDefaultThumbnailImage)},"showGalleryView":function(e){13!==e.keyCode&&32!==e.keyCode||this.showThumbCarousel(e)},"showThumbCarousel":function(e){var t=this,s=!1;if((s=o.isSafari()||o.isMSBrowser()||o.isAppleMobile()?this.model.get("mime_type")&&(this.model.get("mime_type").match(/^image\/*[-.\w\s]*$/g)||this.model.get("mime_type").match(/^video\/(mp4|mov)$/g)):this.model.get("mime_type")&&(this.model.get("mime_type").match(/^image\/*[-.\w\s]*$/g)||this.model.get("mime_type").match(/^video\/(mp4|webm|ogg|mov)$/g)))&&s.length>0){this.options.originatingView.blockingView.enable();var n=i.filter(t.model.collection.models,function(e){return o.isSafari()||o.isMSBrowser()||o.isAppleMobile()?e.get("mime_type")&&(e.get("mime_type").match(/^image\/*[-.\w\s]*$/g)||e.get("mime_type").match(/^video\/(mp4|mov)$/g)):e.get("mime_type")&&(e.get("mime_type").match(/^image\/*[-.\w\s]*$/g)||e.get("mime_type").match(/^video\/(mp4|webm|ogg|mov)$/g))},this);this.fetchGalleryImageURL(n);var l=[],r=0;t.thumbNailCollection=n,i.each(n,function(e,i){var s={"name":e.get("name"),"contentURL":e.contentURL?e.contentURL:e.thumbnail?e.thumbnail.url:"","thumbnailURL":e.thumbnail&&e.thumbnail.url?e.thumbnail.url:e.contentURL?e.contentURL:"","id":e.cid,"index":i,"activeItem":e.get("id")===t.model.get("id"),"downloadItem":t.downloadItem.bind(null,e),"updateScroll":t.updateScroll.bind(null,t),"isVideo":e.get("mime_type").match(/^video\/*[-.\w\s]*$/g),"videoType":e.get("mime_type"),"model":e,"videoNotSupportMsg":c.videoNotSupportMsg,"originalAvailable":!!e.contentURL,"thumbnailAvailable":!(!e.thumbnail||!e.thumbnail.url)};e.get("id")===t.model.get("id")&&(r=i),l.push(s)},t);var a=h.createGalleryContainer(l,r,c),u=new T({"el":a[0]}),p=new d({"title":"","headerView":"","view":u,"className":"csui-thumbcarousel-dialog","userClassName":"","largeSize":!0});if(v.usePerfectScrollbar()&&a.find(".binf-filmstrip-container").addClass("csui-no-scrolling"),_)return t.options.originatingView.blockingView.disable(),!1;p.show(),_=!0,p.headerView.$el.find(".cs-icon-cross").removeClass("cs-icon-cross").addClass("icon-close-gallery"),p.headerView.$el.bind("keydown click",i.bind(this.handleShiftKey,this)),t.options.originatingView.blockingView.disable(),t.galleryView=u;var m=a.find(".csui-preview-carousal .binf-active");setTimeout(function(){h.updateSlide(e,m)},200)}else!this.model.get("inactive")&&this.model.get("id")&&this.trigger("execute:defaultAction",e)},"handleShiftKey":function(e){e.shiftKey;if(e.shiftKey&&9==e.keyCode){var i=this.thumbNailCollection[this.thumbNailCollection.length-1].cid;setTimeout(function(){t(".binf-filmstrip-item-"+i).focus()},200)}_=!1},"downloadItem":function(e,i){(new b).execute({"nodes":new m([e])})},"updateScroll":function(e,i){e.galleryView.updateScrollbar(i)},"fetchOriginalThumbNails":function(e){var i=this,s=e,n=t.Deferred();return i._fetchThumbNailObject(s).done(function(e){n.resolve(e)}).fail(function(e){n.reject(e)}),n.promise()},"_fetchThumbNailObject":function(e){var i=t.Deferred(),s=new p({"node":e});return s.load(),this.listenTo(s,"load",function(t){e.thumbnail={},e.thumbnail.url=t.url,e.attributes.thumbnailPreviewAvailable=!0,e.trigger("update:thumbnail",e),i.resolve(e)}).listenTo(s,"error",function(t){e.thumbnail={},e.thumbnail.url=void 0,e.attributes.thumbnailPreviewAvailable=!1,e.trigger("update:default:thumbnail",e),i.reject(e)}),i.promise()},"updateThumbnailImage":function(e){if(e&&e.thumbnail){var i=this.$el.find(".csui-thumbnail-content-icon.thumbnail-"+e.cid);if(i.find(".csui-icon-group").css("background-image","url("+e.thumbnail.url+")"),i.addClass("thumbnailPreview"),t(".binf-filmstrip-item-"+e.cid).length>0){var s=t(".binf-filmstrip-item-"+e.cid).find("img");s.length>0&&s.attr("src",e.thumbnail.url)}}},"updateDefaultThumbnailImage":function(e){if(e&&e.thumbnail&&e.thumbnail.url){var i=this.$el.find(".csui-thumbnail-content-icon.thumbnail-"+e.cid);i.find(".csui-icon-group").css("background-image","url("+e.thumbnail.url+")"),i.find(".csui-icon").addClass("binf-hidden")}},"fetchGalleryImageURL":function(e){var s=this,n=new g({"parallelism":y.parallelism}),o=i.map(e,function(e){var i=t.Deferred();return e.contentURL||n.pending.add({"worker":function(){return s._fetchImageOpenURL(e).done(function(e){i.resolve(e)}).fail(function(e){i.reject(e)}),i.promise()}}),i.promise(o)});return t.whenAll.apply(t,o)},"_fetchImageOpenURL":function(e){var s=this,n=t.Deferred(),o=f.combine(e.connector.connection.url,"/nodes",e.get("id"),"/content?action=open&suppress_response_codes"),l={"url":o,"dataType":"binary"};if(144===e.get("type")){var r=0,a=!1;e.connector.makeAjaxCall(l).always(i.bind(function(i,t,o){if(200===o.status){if(e.contentURL=URL.createObjectURL(i),e.addedOriginalImage=!0,e.get("mime_type").match(/^video\/!*[-.\w\s]*$/g)){var l=s.galleryView&&s.galleryView.$el.find(".binf-item-"+e.cid).find("video");l.length>0&&(l.attr("src",e.contentURL),s.galleryView.$el.find(".binf-item-"+e.cid).addClass("csui-item-original"),s.galleryView.$el.find(".binf-item-"+e.cid+" .csui-img-loader").addClass("binf-hidden"))}else{var c=s.galleryView&&s.galleryView.$el.find(".binf-item-"+e.cid),u=c.find(".csui-gallery-thumbnail-icon"),d=c.find(".csui-gallery-original-icon");w.getData(i,function(){var i=this,t=i&&i.exifdata&&i.exifdata.Orientation;r=7===t||8===t?-90:5===t||6===t?90:3===t||4===t?180:0,e.transformDegrees=r,2!==t&&4!==t&&5!==t&&7!==t||(a=!0,e.flipRight=!0),u.length>0?u.addClass("binf-hidden"):s.galleryView.$el.find(".binf-item-"+e.cid+" .outer-border").addClass("binf-hidden"),d.find("img").attr("src",e.contentURL),d.find("img").addClass("csui-item-original"),d.removeClass("binf-hidden"),a&&d.find("img").css({"-webkit-transform":"scaleX(-1)","-moz-transform":"scaleX(-1)","-o-transform":"scaleX(-1)","transform":"scaleX(-1)","filter":"FlipH","-ms-filter":"FlipH"}),d.find("img").css({"-webkit-transform":"rotate("+r+"deg)","-moz-transform":"rotate("+r+"deg)","-ms-transform":"rotate("+r+"deg)","-o-transform":"rotate("+r+"deg)","transform":"rotate("+r+"deg)"})});var h=s.galleryView&&s.galleryView.$el.find(".binf-filmstrip-item-"+e.cid);h.find("img").attr("src")||(h.find("img").attr("src",e.contentURL).removeClass("binf-hidden"),h.find(".mime_image").addClass("binf-hidden"))}n.resolve()}},this))}return n.promise()},"_createNodeTypeIcon":function(){var e=new l({"node":this.model});this.contentRegion=new n.Region({"el":this.$("> *")}),this.contentRegion.show(e),144!==this.model.get("type")||this.model.thumbnail&&this.model.thumbnail.url?144===this.model.get("type")&&this.model.thumbnail&&this.model.thumbnail.url?this.updateThumbnailImage(this.model):144===this.model.get("type")&&this.model.thumbnail&&!this.model.thumbnail.url&&this.updateDefaultThumbnailImage(this.model):this.fetchOriginalThumbNails(this.model)},"_destroyNodeTypeIcon":function(){this.contentRegion&&(this.contentRegion.empty(),this.contentRegion=null)},"onKeyInView":function(e){13!==e.keyCode&&32!==e.keyCode||this.$el.find("a.csui-thumbnail-content-default-action").click()}}),T=n.View.extend({"constructor":function(e){n.View.prototype.constructor.apply(this,arguments)},"behaviors":{"PerfectScrolling":{"behaviorClass":v,"contentParent":".binf-filmstrip-container","suppressScrollY":!0,"scrollXMarginOffset":2}},"updateScrollbar":function(e){this.trigger("update:scrollbar");var i,t=this.$(this.behaviors.PerfectScrolling.contentParent),s=this.$el.find(".binf-filmstrip-container").scrollLeft();e.offset().left+e.width()>=t.width()?i=e.offset().left-t.width()+s+e.width()+20:e.offset().left<=0&&(i=e.offset().left+s-5),this.$(this.behaviors.PerfectScrolling.contentParent).animate({"scrollLeft":i},"fast")}});return u.registerByKey("thumbnailIcon",C),C}),csui.define("csui/controls/thumbnail/content/overview/overview.content",["csui/lib/underscore","csui/lib/backbone","csui-ext!csui/controls/thumbnail/content/overview/overview.content"],function(e,i,t){var s=i.Model.extend({"idAttribute":"key","defaults":{"key":null,"sequence":0}}),n=i.Collection.extend({"model":s,"comparator":"sequence","getColumnKeys":function(){return this.pluck("key")},"deepClone":function(){return new n(this.map(function(e){return e.attributes}))}}),o=[{"key":"type","sequence":2,"defaultAction":!1},{"key":"name","sequence":4,"displayLabel":!0,"defaultAction":!1,"displayIcon":!0},{"key":"properties","title":"properties","sequence":7},{"key":"reserved","sequence":100,"title":"State"}],l=["type","name","properties","reserved","wnd_comments"];t&&e.each(t,function(i){e.each(i,function(e,i){o.push(e)})});var r=new n(o);return r.fixedOrRemovedOverviewContent=l,r}),csui.define("hbs!csui/controls/thumbnail/content/impl/content",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"1":function(e,i,t,s){var n;return'    <div class="csui-thumbnail-label csui-thumbnail-item-content-label" aria-label="'+this.escapeExpression((n=null!=(n=i.label||(null!=e?e.label:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"label","hash":{}}):n))+'">\r\n      <span>'+this.escapeExpression((n=null!=(n=i.label||(null!=e?e.label:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"label","hash":{}}):n))+"</span>\r\n    </div>\r\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){var n,o;return'<div class="csui-thumbnail-item-content csui-thumbnail-item-content-'+this.escapeExpression((o=null!=(o=i.cid||(null!=e?e.cid:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"cid","hash":{}}):o))+'">\r\n'+(null!=(n=i.if.call(e,null!=e?e.displayLabel:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?n:"")+'  <div class="csui-thumbnail-value csui-thumbnail-item-content-justify-div">\r\n    <p class="csui-thumbnail-item-content-value" title="'+this.escapeExpression((o=null!=(o=i.value||(null!=e?e.value:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"value","hash":{}}):o))+'"\r\n       aria-label="'+this.escapeExpression((o=null!=(o=i.value||(null!=e?e.value:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"value","hash":{}}):o))+'">'+this.escapeExpression((o=null!=(o=i.value||(null!=e?e.value:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"value","hash":{}}):o))+"</p>\r\n  </div>\r\n</div>"}});return t.registerPartial("csui_controls_thumbnail_content_impl_content",s),s}),csui.define("csui/controls/thumbnail/content/content.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","hbs!csui/controls/thumbnail/content/impl/content"],function(e,i,t,s,n){"use strict";return s.ItemView.extend({"template":n,"className":"csui-thumbnail-content-item","templateHelpers":function(){var e=this.options.contentModel,i=e.get("name"),t=e.get("key");return{"value":this.model.get(t),"displayLabel":this.options.displayLabel,"label":this.options.displayLabel?i:"","cid":this.model.cid}},"constructor":function(e){e||(e={}),s.ItemView.prototype.constructor.apply(this,arguments)}})}),csui.define("hbs!csui/controls/thumbnail/content/properties/impl/properties",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){var n;return'<div class="csui-thumbnail-properties">\r\n  <button type="button" class="csui-btn-metadata binf-btn" title="'+this.escapeExpression((n=null!=(n=i.propertiesTitle||(null!=e?e.propertiesTitle:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"propertiesTitle","hash":{}}):n))+'"><span\r\n    class="icon icon-toolbar-metadata"></span></button>\r\n</div>'}});return t.registerPartial("csui_controls_thumbnail_content_properties_impl_properties",s),s}),csui.define("csui/controls/thumbnail/content/properties/impl/nls/localized.strings",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/thumbnail/content/properties/impl/nls/root/localized.strings",{"propertiesTitle":"Properties"}),csui.define("csui/controls/thumbnail/content/properties/properties.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/marionette","csui/controls/thumbnail/content/content.registry","csui/utils/commands/properties","csui/models/nodes","hbs!csui/controls/thumbnail/content/properties/impl/properties","i18n!csui/controls/thumbnail/content/properties/impl/nls/localized.strings"],function(e,i,t,s,n,o,l,r){"use strict";var a=t.LayoutView.extend({"template":l,"templateHelpers":function(){return{"propertiesTitle":r.propertiesTitle}},"className":"csui-thumbnail-properties-container","regions":{"propertiesRegion":".csui-thumbnail-properties"},"events":{"click .csui-btn-metadata":"showMetadataForm"},"constructor":function(e){e||(e={}),t.LayoutView.prototype.constructor.call(this,e)},"showMetadataForm":function(t){var s=new o([this.model]),l={"nodes":s,"data":{},"container":this.options.collection.node,"context":this.options.context,"collection":this.options.collection,"showThumbnails":!0};l=i.extend(l,{"originatingView":this.options.originatingView}),(new n).execute(l,this.options).always(function(i){e("body").addClass("csui-apply-zero-zindex")}),e("body").removeClass("csui-apply-zero-zindex")},"cancel":function(e){e||(e={}),this.destroy()}});return s.registerByKey("properties",a),a}),csui.define("hbs!csui/controls/thumbnail/content/overview/impl/properties.overview",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"1":function(e,i,t,s){var n;return'  <div class="csui-thumbnail-properties csui-thumbnail-overview-'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.attributes:e)?n.key:n,e))+'"></div>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){var n;return'<div class="csui-thumbnail-properties csui-thumbnail-overview-name"></div>\r\n<div class="csui-thumbnail-metadata-container">\r\n'+(null!=(n=i.each.call(e,null!=e?e.columns:e,{"name":"each","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?n:"")+'</div>\r\n<div class="csui-thumbnail-properties-actions">\r\n  <div class="csui-thumbnail-properties csui-thumbnail-overview-properties"></div>\r\n  <div class="csui-thumbnail-properties csui-thumbnail-overview-reserved"></div>\r\n</div>'}});return t.registerPartial("csui_controls_thumbnail_content_overview_impl_properties.overview",s),s}),csui.define("csui/controls/thumbnail/content/overview/properties.overview",["module","csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/controls/thumbnail/content/overview/overview.content","csui/controls/thumbnail/content/content.view","csui/controls/thumbnail/content/name/name.view","csui/controls/thumbnail/content/properties/properties.view","csui/controls/thumbnail/content/node.state/node.state.view","csui/controls/tile/behaviors/perfect.scrolling.behavior","hbs!csui/controls/thumbnail/content/overview/impl/properties.overview"],function(e,i,t,s,n,o,l,r,a,c,u,d){"use strict";return n.LayoutView.extend({"className":"csui-overview-container","template":d,"templateHelpers":function(){return{"columns":this.columnModels}},"regions":{"nameRegion":".csui-thumbnail-overview-name","propertiesRegion":".csui-thumbnail-overview-properties","nodeStateRegion":".csui-thumbnail-overview-reserved"},"events":{"keydown":"onKeyInView"},"behaviors":{"PerfectScrolling":{"behaviorClass":u,"contentParent":".csui-thumbnail-metadata-container","suppressScrollX":!0,"scrollYMarginOffset":15}},"initialize":function(){this.propertiesCollection=this.getColumns();var e=this,t=[];this.propertiesCollection&&this.propertiesCollection.models&&i.each(this.propertiesCollection.models,function(i,s){var n=i.get("key");"size"===n?!!e.getSizeValue(n)&&t.push(i):!!e.model.get(n)&&t.push(i)}),this.columnModels=t},"constructor":function(e){e||(e={}),this.options=e,n.LayoutView.prototype.constructor.call(this,e);var t=this;this.columnModels&&i.each(this.columnModels,function(i,s){var n=i.get("key");e.ContentFactory.getContentView(i);t.addRegion(n,".csui-thumbnail-overview-"+n)},this)},"getSizeValue":function(e){var i=this.model.get(e+"_formatted");return i&&0!=i.split(" ")[0]?i:0},"getColumns":function(){var e,t=this;if(o&&o.models){this.fixedContent=o.fixedOrRemovedOverviewContent,e=o.deepClone(),e.remove(e.findWhere({"key":"properties"}));var s,n,l={};this.options.columns.each(function(o){var r=o.get("column_key"),a=(o.get("name"),o.get("definitions_order"));if(!0===o.get("isNaming")&&(n=r,o.unset("isNaming",{"silent":!0})),l[r]=o,o.get("type")&&a){var c=e.findWhere({"key":r});if(c){!0===c.get("isNaming")&&(s=c.get("key"));var u=c.get("sequence"),d=i.extend({"sequence":u},o.attributes);c.set(d)}else o.attributes.sequence=a,e.add(o.attributes)}t.fixedContent.indexOf(r)>=0&&e.remove(e.findWhere({"key":r}))},this)}return e},"currentlyFocusedElement":function(e){return this.$el.find(":focusable")[0]},"onKeyInView":function(e){if(e&&27===e.keyCode){e.preventDefault(),e.stopPropagation();this.$el.parents("body").find(".binf-popover").parent().click()}},"onRender":function(e){var t=this,s=new r({"model":t.model,"context":t.options.context,"column":{"name":"name","defaultAction":!1},"displayIcon":!0});this.nameRegion.show(s),this.columnModels&&i.each(this.columnModels,function(e,i){var s=this.options.ContentFactory.getContentView(e);if(s=s||l){var n=e.get("key"),o=e.get("displayIcon"),r=e.toJSON();r.name=r.key;var a=new s({"tagName":"DIV","contentModel":e,"model":t.model,"context":t.options.context,"column":r,"displayLabel":!0,"displayIcon":o});t[n].show(a),a.$el.find(".csui-thumbnail-value p").length>0&&""===a.$el.find(".csui-thumbnail-value p")[0].innerHTML&&a.$el.parent().addClass("binf-hidden"),t.listenTo(a,"clicked:content",function(e){t.trigger("clicked:content",{"contentView":a,"rowIndex":t._index,"colIndex":i,"model":t.model})})}},this);var n=new a({"model":t.model,"context":t.options.context,"column":{"name":"properties","defaultAction":!0},"displayIcon":!0,"selectedChildren":t.options.selectedChildren,"collection":t.options.collection,"originatingView":t.options.originatingView});this.propertiesRegion.show(n);var o=new c({"model":t.model,"context":t.options.context,"column":{"name":"reserved","defaultAction":!0},"displayTitle":!1,"selectedChildren":t.options.selectedChildren,"collection":t.options.collection,"originatingView":t.options.originatingView,"targetView":this});this.nodeStateRegion.show(o)}})}),csui.define("csui/controls/thumbnail/content/overview/impl/nls/localized.strings",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/thumbnail/content/overview/impl/nls/root/localized.strings",{"ColumnTitle":"Metadata","Modified":"Modified","Size":"Size"}),csui.define("hbs!csui/controls/thumbnail/content/overview/impl/overview",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"1":function(e,i,t,s){return'tabindex="0"\r\n        '},"3":function(e,i,t,s){return'tabindex="-1"'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){var n,o;return'<button type="button" class="csui-thumbnail-overview-icon" title="'+this.escapeExpression((o=null!=(o=i.overViewTitle||(null!=e?e.overViewTitle:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"overViewTitle","hash":{}}):o))+'"\r\n        aria-haspopup="dialog" aria-label="'+this.escapeExpression((o=null!=(o=i.overViewTitle||(null!=e?e.overViewTitle:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"overViewTitle","hash":{}}):o))+'" '+(null!=(n=i.if.call(e,null!=e?e.focusable:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.program(3,s,0)}))?n:"")+'>\r\n  <span class="icon icon-thumbnail-metadata-overview"></span>\r\n</button>'}});return t.registerPartial("csui_controls_thumbnail_content_overview_impl_overview",s),s}),csui.define("css!csui/controls/thumbnail/content/overview/impl/overview",[],function(){}),csui.define("csui/controls/thumbnail/content/overview/overview.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/controls/thumbnail/content/content.registry","csui/controls/thumbnail/content/content.factory","csui/controls/thumbnail/content/overview/properties.overview","csui/controls/mixins/keyboard.navigation/modal.keyboard.navigation.mixin","csui/utils/base","i18n","i18n!csui/controls/thumbnail/content/overview/impl/nls/localized.strings","hbs!csui/controls/thumbnail/content/overview/impl/overview","css!csui/controls/thumbnail/content/overview/impl/overview"],function(e,i,t,s,n,o,l,r,a,c,u,d){"use strict";var h=s.LayoutView.extend({"className":"csui-thumbnail-overview-container","template":d,"constructor":function(e){e||(e={}),s.LayoutView.prototype.constructor.call(this,e),i.defaults(e,{"formPopoverPlacement":"right"}),this.options=e},"templateHelpers":function(){return{"overViewTitle":u.ColumnTitle,"focusable":this.options.focusable||!0}},"events":{"keydown":"onKeyInView","click .csui-thumbnail-overview-icon":"_showPopover"},"onKeyInView":function(e){if(32===e.keyCode||13===e.keyCode){if(this.$el.find(".binf-popover").length>0)return void e.stopPropagation();e.preventDefault(),e.stopPropagation(),this._showPopover()}else 27===e.keyCode&&this.$el.find(".binf-popover").length>0&&(e.preventDefault(),e.stopPropagation(),this._closePopover())},"_capturePreviousFocusElement":function(){this._previousFocusElm=document.activeElement},"_restorePreviousFocusAfterClosingPopover":function(){if(this._previousFocusElm){var i=e(this._previousFocusElm);i.hasClass("csui-thumbnail-overview-icon")?this.$el.find("button.csui-thumbnail-overview-icon").focus():i.focus(),this._previousFocusElm=void 0}},"_showPopover":function(t){var s=this;if(!(this.$el.find(".binf-popover").length>0)){this._capturePreviousFocusElement();var n=this.options.formPopoverPlacement;c&&c.settings.rtl&&(this.rtl=!0),this.propertiesOverview=new l({"model":this.model,"context":this.options.context,"ContentFactory":this.options.ContentFactory,"originatingView":this.options.originatingView,"selectedChildren":this.options.selectedChildren,"collection":this.options.collection,"columns":this.options.columns}),this.propertiesOverview.render(),this.$popoverEl=this.$el.find(".csui-thumbnail-overview-icon"),this._previousTitle=this.$popoverEl.attr("title"),this.$popoverEl.attr("title","");var o,r=c&&c.settings.rtl,a=e(window).width()!==e(".csui-thumbnail-container").width();o=r&&a?e(window).width()-this.$popoverEl.offset().left-this.$popoverEl.width():e(".csui-thumbnail-container").width()-this.$popoverEl.offset().left-this.$popoverEl.width(),o<248&&(this.placementChanged=!0,n="right"===n?"left":"right"),this.$popoverEl.binf_popover({"content":i.bind(function(){return this.propertiesOverview.el},this),"html":!0,"placement":function(e,i){return n},"trigger":"manual"}),this.$popoverEl.binf_popover("show"),this.propertiesOverview.trigger("dom:refresh"),this.engageModalKeyboardFocusOnOpen(this.propertiesOverview.el),this.$popoverEl.on("shown.binf.popover",i.bind(function(i){e(document).on("click.popover",{"view":this},this._handleClickEvent),this.scrollEle=this.$el.closest(".csui-thumbnail-results"),this.scrollEle.on("scroll.popover",{"view":this},this._handleScrollEvent),s.onShowOverviewFlyout(i),s.triggerMethod("shown:overview:flyout"),this.propertiesOverview&&this.propertiesOverview.currentlyFocusedElement().focus()},this))}},"onShowOverviewFlyout":function(i){var t,n=this.$el,o=this.$el.parent().find(".binf-popover"),l=o.find(".binf-arrow"),r=parseInt(l.css("top")),u=(parseInt(l.css("height")),0===l.outerWidth()||l.outerWidth(),this.$el.closest(".csui-thumbnail-results")),d=u.closest(".ps-container").length>0?u.closest(".ps-container"):u.closest(".csui-normal-scrolling"),h=o.find(".csui-thumbnail-metadata-container"),p=o.find(".csui-thumbnail-overview-name"),m=o.find(".csui-thumbnail-properties-actions"),f=c&&c.settings.rtl,g=window.innerHeight<h.height()+p.height()+m.height()+100?h.height()-100:h.height();h.css({"height":g}),t=a.isIE11()?n.offset().top-parseInt(l.css("top"))+12:n.offset().top-(e("nav.csui-navbar").innerHeight()+e("#breadcrumb-wrap").innerHeight()+parseInt(l.css("top")))+9;var b=e(".cs-perspective-panel"),v=b.length>0?b[0].getBoundingClientRect().top:0;h.height()>window.innerHeight&&(t=0,g=window.innerHeight-(p.height()+m.height()),h.css({"height":g})),a.isIE11()&&t<v+e("#breadcrumb-wrap").innerHeight()&&(t=n.offset().top-(e("nav.csui-navbar").innerHeight()+e("#breadcrumb-wrap").innerHeight())+12,r=n.offset().top-t+12,l.css("top",r)),t<v&&!a.isIE11()&&(t=0,r=n.offset().top-(e("nav.csui-navbar").innerHeight()+e("#breadcrumb-wrap").innerHeight())+11,l.css("top",r)),o.css({"position":"fixed","top":t}),a.isTouchBrowser()&&d.css({"-webkit-overflow-scrolling":"auto"});var w,y=e(window).width()!==e(".csui-thumbnail-container").width();if(f&&y){var _=e(".csui-thumbnail-container").width()-e(window).width();w=this.placementChanged?_+n.offset().left-o.outerWidth():_+n.offset().left+n.width()}else w=this.placementChanged?n.offset().left-o.outerWidth():n.offset().left+n.width();o.css({"right":"auto","left":w}),this._adjustFlyOut();var C=e(window).height(),T=(o.offset().top,o.innerHeight()-parseInt(l.css("top"))),x=n.offset().top;C<x+T&&(a.isIE11()?(t=e("nav.csui-navbar").outerHeight()+v,r=n.offset().top-t+12,l.css("top",r),o.css({"top":t}),h.height(h.height()-e("nav.csui-navbar").outerHeight()),window.innerHeight<h.height()+p.height()+m.height()+100&&h.height(h.height()-150)):(h.height(h.height()-e("nav.csui-navbar").outerHeight()),window.innerHeight<h.height()+p.height()+m.height()+100&&h.height(h.height()-100))),s.triggerMethodOn(this,"dom:refresh",this),n.focus()},"_adjustFlyOut":function(){this.propertiesOverview.trigger("update:scrollbar");var i=this.$el.closest(".csui-thumbnail-results"),t=e(window).height(),s=e("nav.csui-navbar").innerHeight()/2;this.currentNavbarIndex=e("nav.csui-navbar").css("z-index"),this.currentBreadcrumbIndex=e("#breadcrumb-wrap").css("z-index"),this.$el.height()>t&&this.$el.height(t-s),e("body").addClass("csui-apply-zero-zindex");var n=i.closest(".ps-container").length>0?i.closest(".ps-container"):i.closest(".csui-normal-scrolling");return e(n).on("scroll",function(){e(this).data("binf.popover")&&(e(this).binf_popover("destroy"),e("body").removeClass("csui-apply-zero-zindex"))}),!1},"_closePopover":function(){this.disengageModalKeyboardFocusOnClose(),this.$popoverEl.binf_popover("destroy"),this.placementChanged=!1,this._previousTitle&&(this.$popoverEl.attr("title",this._previousTitle),this._previousTitle=void 0),e(document).off("click.popover",this._handleClickEvent),this.scrollEle.off("scroll.popover",this._handleScrollEvent),e("body").removeClass("csui-apply-zero-zindex"),this.triggerMethod("hide:overview:flyout"),this._restorePreviousFocusAfterClosingPopover(),a.isTouchBrowser()&&this.scrollEle.css("-webkit-overflow-scrolling","touch")},"_handleClickEvent":function(i){if(!e(i.target).closest(".binf-popover").length){var t=i.data.view;e(document).off("click.popover",this._handleClickEvent),t._closePopover()}},"_handleScrollEvent":function(i){var t=i.data.view;e(i.target).closest(".binf-popover").length||(t.scrollEle.off("scroll.popover",t._handleScrollEvent),t&&t._closePopover())}});return n.registerByKey("overview",h),r.mixin(h.prototype),h}),
csui.define("csui/controls/thumbnail/content/content.factory",["csui/lib/underscore","csui/controls/thumbnail/content/content.registry","csui/controls/thumbnail/content/favorite/favorite.view","csui/controls/thumbnail/content/node.state/node.state.view","csui/controls/thumbnail/content/name/name.view","csui/controls/thumbnail/content/member/member.view","csui/controls/thumbnail/content/size/size.view","csui/controls/thumbnail/content/select/select.view","csui/controls/thumbnail/content/date/date.view","csui/controls/thumbnail/content/thumbnail.icon/thumbnail.icon.view","csui/controls/thumbnail/content/overview/overview.view","csui/controls/thumbnail/content/properties/properties.view","csui-ext!csui/controls/thumbnail/content/content.factory"],function(e,i){function t(){}return e.extend(t.prototype,{"getContentView":function(e){return i.getContentView(e)}}),new t}),csui.define("csui/controls/thumbnail/thumbnail.content",["csui/lib/underscore","csui/lib/backbone","csui-ext!csui/controls/thumbnail/thumbnail.content"],function(e,i,t){var s=i.Model.extend({"idAttribute":"key","defaults":{"key":null,"sequence":0}}),n=i.Collection.extend({"model":s,"comparator":"sequence","getColumnKeys":function(){return this.pluck("key")},"deepClone":function(){return new n(this.map(function(e){return e.attributes}))}}),o=[{"key":"name","sequence":4,"defaultAction":!0},{"key":"reserved","sequence":5,"displayTitle":!0,"title":"State"},{"key":"wnd_comments","sequence":900},{"key":"favorite","sequence":910},{"key":"overview","sequence":920,"showoverview":!0}];return t&&e.each(t,function(i){e.each(i,function(e,i){e.push(e)})}),new n(o)}),csui.define("hbs!csui/controls/thumbnail/impl/thumbnail.header",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"1":function(e,i,t,s){var n;return'      <div class="csui-selected-checkbox csui-checkbox-primary csui-checkbox-selectAll">\r\n        <input class="csui-selectAll-input" type="checkbox" disabled="" title="'+this.escapeExpression((n=null!=(n=i.selectAllTitle||(null!=e?e.selectAllTitle:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"selectAllTitle","hash":{}}):n))+'"\r\n               tabindex="0">\r\n\r\n        <div class="csui-selectAll-header csui-selectlabel"></div>\r\n        <span>'+this.escapeExpression((n=null!=(n=i.selectAll||(null!=e?e.selectAll:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"selectAll","hash":{}}):n))+"</span>\r\n      </div>\r\n"},"3":function(e,i,t,s){var n;return'      <div class="csui-selected-checkbox csui-checkbox-primary csui-checkbox-selectAll">\r\n        <input class="csui-selectAll-input" type="checkbox" title="'+this.escapeExpression((n=null!=(n=i.selectAllTitle||(null!=e?e.selectAllTitle:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"selectAllTitle","hash":{}}):n))+'" tabindex="0">\r\n\r\n        <div class="csui-selectAll-header csui-selectlabel"></div>\r\n        <span>'+this.escapeExpression((n=null!=(n=i.selectAll||(null!=e?e.selectAll:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"selectAll","hash":{}}):n))+"</span>\r\n      </div>\r\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){var n,o;return'<div class="csui-thumbnail-header-data">\r\n  <div class="csui-thumbnail-select">\r\n'+(null!=(n=i.if.call(e,null!=e?e.isEmptyNode:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.program(3,s,0)}))?n:"")+'  </div>\r\n  <div class="csui-thumbnail-itemcount">'+this.escapeExpression((o=null!=(o=i.items||(null!=e?e.items:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"items","hash":{}}):o))+'</div>\r\n  <div class="csui-thumbnail-sort-search-container">\r\n    <div id="csui-sorting-container" class="csui-sorting-container"></div>\r\n    <div id="csui-thumbnail-column-search" class="csui-thumbnail-column-search"></div>\r\n  </div>\r\n</div>'}});return t.registerPartial("csui_controls_thumbnail_impl_thumbnail.header",s),s}),csui.define("hbs!csui/controls/thumbnail/impl/thumbnail.item",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"1":function(e,i,t,s){return" csui-checkbox "},"3":function(e,i,t,s){var n;return'    <div class="csui-thumbnail-content csui-thumbnail-'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.attributes:e)?n.key:n,e))+'"></div>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){var n;return'<div class="csui-thumbnail-item-container">\r\n<div class="csui-thumbnail-icon-container">\r\n  <div class="csui-thumbnail-select '+(null!=(n=i.if.call(e,null!=e?e.isChecked:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?n:"")+'"></div>\r\n  <div class="csui-thumbnail-actionbar"></div>\r\n  <div class="csui-thumbnail-thumbnailIcon"></div>\r\n</div>\r\n<div class="csui-thumbnail-content-container">\r\n'+(null!=(n=i.each.call(e,null!=e?e.columns:e,{"name":"each","hash":{},"fn":this.program(3,s,0),"inverse":this.noop}))?n:"")+"</div>\r\n</div>"}});return t.registerPartial("csui_controls_thumbnail_impl_thumbnail.item",s),s}),csui.define("hbs!csui/controls/thumbnail/impl/thumbnail",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){return'<div id="csui-thumbnail-header" class="csui-thumbnail-header"></div>\r\n<div id="csui-thumbnail-results" class="csui-thumbnail-results"></div>'}});return t.registerPartial("csui_controls_thumbnail_impl_thumbnail",s),s}),csui.define("hbs!csui/controls/thumbnail/impl/empty.thumbnail",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){var n;return"<p class='csui-no-result-message' title=\""+this.escapeExpression((n=null!=(n=i.noResults||(null!=e?e.noResults:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"noResults","hash":{}}):n))+'">\r\n  '+this.escapeExpression((n=null!=(n=i.noResults||(null!=e?e.noResults:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"noResults","hash":{}}):n))+"\r\n</p>\r\n"}});return t.registerPartial("csui_controls_thumbnail_impl_empty.thumbnail",s),s}),csui.define("css!csui/controls/thumbnail/thumbnail",[],function(){}),csui.define("csui/controls/thumbnail/thumbnail.view",["module","csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/utils/base","csui/utils/commands","csui/behaviors/default.action/default.action.behavior","csui/behaviors/default.action/impl/defaultaction","csui/controls/tile/behaviors/perfect.scrolling.behavior","csui/behaviors/keyboard.navigation/tabable.region.behavior","csui/controls/thumbnail/impl/metadata/thumbnail.metadata.view","csui/controls/thumbnail/impl/sort/sort.view","csui/controls/thumbnail/content/content.factory","csui/controls/thumbnail/thumbnail.content","csui/controls/thumbnail/content/thumbnail.icon/thumbnail.icon.view","csui/controls/thumbnail/content/select/select.view","csui/controls/table/cells/searchbox/searchbox.view","csui/controls/tableactionbar/tableactionbar.view","csui/controls/mixins/layoutview.events.propagation/layoutview.events.propagation.mixin","csui/controls/progressblocker/blocker","hbs!csui/controls/thumbnail/impl/thumbnail.header","hbs!csui/controls/thumbnail/impl/thumbnail.item","hbs!csui/controls/thumbnail/impl/thumbnail","hbs!csui/controls/thumbnail/impl/empty.thumbnail","i18n!csui/controls/thumbnail/impl/nls/lang","css!csui/controls/thumbnail/thumbnail","csui/lib/jquery.mousehover"],function(e,i,t,s,n,o,l,r,a,c,u,d,h,p,m,f,g,b,v,w,y,_,C,T,x,k){"use strict";var S=(i.extend({},e.config()),n.ItemView.extend({"className":"csui-thumbnail-empty","template":x,"templateHelpers":function(){return{"noResults":this.options.isFilterApplied||-1!==[298,899].indexOf(this._parent.collection.node.get("type"))?k.noResults:k.dragAndDropMessage}},"constructor":function(e){n.ItemView.prototype.constructor.apply(this,arguments)},"onRender":function(){this.options.$parentEl.addClass("csui-thumbnail-empty")},"onShow":function(){this.$el.addClass("icon-thumbnail-empty-page")},"onDestroy":function(){this.options.$parentEl.removeClass("csui-thumbnail-empty")}})),I=n.LayoutView.extend({"className":function(){var e="csui-thumbnail-item csui-thumbnail-item-"+this.model.cid;return this.model.inlineFormView&&(e+=" csui-thumbnail-item-form"),e},"template":C,"templateHelpers":function(){return{"columns":m.models,"isChecked":this.options.thumbnailView.collection.itemchecked}},"ui":{"itemContainer":".csui-thumbnail-item-container"},"events":{"click @ui.itemContainer":"onItemClick"},"regions":{"selectContentRegion":".csui-thumbnail-select","thumbnailIconRegion":".csui-thumbnail-thumbnailIcon"},"initialize":function(){var e=this;m&&m.models&&i.each(m.models,function(i,t){if(p.getContentView(i)){var s=i.get("key");e.addRegion(s,".csui-thumbnail-"+s)}},this),!o.isTouchBrowser()&&this.options.showInlineToolbar&&this._subscribeEventHandlers(),this.model.set("inactive",!this.options.thumbnailView.checkModelHasAction(this.model),{"silent":!0}),e.ContentFactory=p},"constructor":function(e){e||(e={}),n.LayoutView.prototype.constructor.call(this,e),this.listenTo(this.model,"sync",this.render)},"onItemClick":function(){this.options.thumbnailView.currentItemView=this},"_subscribeEventHandlers":function(){this.$el&&this.$el.mousehover(this.showInlineActions.bind(this),this.hideInlineActions.bind(this),{"namespace":this.cid})},"_unsubscribeEventHandlers":function(){this._isRendered&&this.$el.mousehover("off",{"namespace":this.cid})},"showInlineActions":function(e){if(0===this.$el.find(".csui-inlineform-group").length){var i=this.$el.find(".csui-thumbnail-actionbar");if(i.length>0&&!this.options.originatingView.lockedForOtherContols){var t=this,s={"sender":t,"target":i,"model":t.model};t.trigger("mouseenter:row",s)}}else this.$el.find(".csui-thumbnail-select").css({"display":"none"})},"hideInlineActions":function(e){var i=this.$el.find(".csui-thumbnail-actionbar");if(i.length>0){var t=this,s={"sender":t,"target":i,"model":t.model};t.trigger("mouseleave:row",s)}},"onRender":function(e){var t=this;t.model.isLocallyCreated&&!t.model.inlineFormView&&this.$el.find(".csui-thumbnail-content-container").addClass("csui-new-item"),this.selectContentView=new g({"tagName":"div","model":this.options.model,"thumbnailView":this.options.thumbnailView,"events":function(){return o.isFirefox()?i.extend({},g.prototype.events,{"keydown":t.onKeyInView}):g.prototype.events}}),this.selectContentRegion.show(this.selectContentView),this.options.model.get("csuiIsSelected")?(this.selectContentRegion.$el.addClass("csui-checkbox"),this.$el.addClass("csui-thumbnail-item-selected")):(0===this.options.thumbnailView.getSelectedChildren().length&&this.options.thumbnailView.resultsView.$el.find(".csui-checkbox")&&(this.selectContentRegion.$el.removeClass("csui-checkbox"),this.$el.removeClass("csui-thumbnail-item-selected")),this.options.thumbnailHeaderView.trigger("selectOrUnselect.mixed"),this.options.thumbnailView.showToolBarActions()),this.options.model.get(g.isSelectedModelAttributeName)&&this.$el.addClass("csui-thumbnail-item-selected"),this.getSelectedChildren().length>0&&t.model.isLocallyCreated&&!t.model.inlineFormView&&this.$el.find(".csui-new-item").parent().find(".csui-thumbnail-select").addClass("csui-checkbox"),t.listenTo(this.selectContentView,"clicked:checkbox",function(e){if(this.options.thumbnailView.activeInlineForm&&e.checked&&this.options.thumbnailView.cancelAnyExistingInlineForm(),t.showToolBarActions(e),e.checked)this.options.thumbnailView.resultsView.inlineToolbarView&&this.options.thumbnailView.resultsView.inlineToolbarView.destroy(),t._parent.$el.find(".csui-thumbnail-select").addClass("csui-checkbox"),t.$el.addClass("csui-thumbnail-item-selected"),t.model.set(g.isSelectedModelAttributeName,!0),t.model.attributes.isSelected=!0;else{t.$el.removeClass("csui-thumbnail-item-selected"),t.model.set(g.isSelectedModelAttributeName,!1),t.model.attributes.isSelected=!1;var s=0;i.each(t._parent.collection.models,function(e){e.attributes.csuiIsSelected&&s++}),(0===s||t.model.get("selectAllThumbnailsEnabled")&&0===s)&&(t._parent.$el.find(".csui-thumbnail-select").removeClass("csui-checkbox"),t.$el.removeClass("csui-thumbnail-item-selected"))}this.options.thumbnailHeaderView.trigger("selectOrUnselect.mixed")}),this.thumbnailIconView=new f({"model":this.options.model,"context":this.options.context,"column":{"defaultAction":!0},"originatingView":this.options.originatingView}),this.thumbnailIconRegion.show(this.thumbnailIconView),this.listenTo(this.thumbnailIconView,"execute:defaultAction",function(e){e.preventDefault(),e.stopPropagation(),t.options.thumbnailView.trigger("execute:defaultAction",t.model)}),m&&m.models&&i.each(m.models,function(e,i){this.options.model&&this.options.model.isReservedClicked||this.options.model.isUnreservedClicked?this.options.model.set("inactive",this.options.model.attributes.inactive,{"silent":!0}):this.options.model.set("inactive",!this.options.thumbnailView.checkModelHasAction(this.model),{"silent":!0});var s=p.getContentView(e);if(s){var n=e.get("key"),o=e.get("showoverview")?p:void 0,l=e.toJSON();l.name=l.key;var r=new s({"tagName":"DIV","model":t.model,"context":t.options.context,"column":l,"ContentFactory":o,"displayLabel":e.get("displayLabel"),"displayTitle":e.get("displayTitle"),"displayIcon":!0,"originatingView":t.options.originatingView,"selectedChildren":this.options.thumbnailView.options.selectedChildren,"collection":this.options.thumbnailView.options.collection,"columns":this.options.columns});t.model.collection=this.options.thumbnailView.options.collection,t[n].show(r),t.listenTo(r,"clicked:content",function(e){t.trigger("clicked:content",{"contentView":r,"rowIndex":t._index,"colIndex":i,"model":t.model})}),t.listenTo(r,"execute:defaultAction",function(e){e.preventDefault(),e.stopPropagation(),t.options.thumbnailView.trigger("execute:defaultAction",t.model)}),t.listenTo(r,"show:add:favorite:form",function(){t.hideInlineActions(),t.favoritePopoverOpened=!0,t.options.originatingView.lockedForOtherContols=!0}),t.listenTo(r,"close:add:favorite:form",function(){t.favoritePopoverOpened=!1,t.options.originatingView.lockedForOtherContols=!1}),t.listenTo(r,"shown:overview:flyout",function(){t.hideInlineActions(),t.overviewPopoverOpened=!0,t.options.originatingView.lockedForOtherContols=!0}),t.listenTo(r,"hide:overview:flyout",function(){t.overviewPopoverOpened=!1,t.options.originatingView.lockedForOtherContols=!1})}},this)},"showToolBarActions":function(e){var i=this;e.checked?(i.model.set(g.isSelectedModelAttributeName,!0,{"silent":!0}),i.model.attributes.isSelected=!0):(this._subscribeEventHandlers(),i.model.set(g.isSelectedModelAttributeName,!1,{"silent":!0}),i.model.attributes.isSelected=!1),this.options.thumbnailView.showToolBarActions()},"getSelectedChildren":function(){return this.model.collection.where({"csuiIsSelected":!0})}}),V=n.CollectionView.extend({"className":"csui-thumbnail-collection","childView":I,"childViewOptions":function(){return{"context":this.options.context,"showInlineToolbar":this.showInlineToolbar,"toolbarItems":this.options.inlineBar.options.collection,"toolbarItemsMasks":this.options.inlineBar.options.toolItemsMask,"originatingView":this.options.originatingView,"thumbnailView":this.options.thumbnailView,"thumbnailHeaderView":this.options.thumbnailHeaderView,"tableColumns":this.options.tableColumns,"columns":this.options.columns}},"childEvents":{"mouseenter:row":"onChildShowInlineActionBarWithDelay","mouseleave:row":"onChildActionBarShouldDestroy","render":"_onChildRender"},"emptyView":S,"emptyViewOptions":function(){return{"isFilterApplied":i.some(this.collection.filters,function(e){return e&&e.trim().length>0}),"$parentEl":this.$el,"model":this.emptyModel}},"behaviors":{"DefaultAction":{"behaviorClass":r}},"constructor":function(e){e||(e={}),this.context=e.context,n.CollectionView.prototype.constructor.apply(this,arguments),this.showInlineToolbar=this.options.inlineBar.options.collection&&this.options.inlineBar.options.toolItemsMask,this.showInlineToolbar&&this.setInlineActionBarEvents(),t(window).bind("resize",i.bind(this._adjustThumbnailWidth,this))},"setInlineActionBarEvents":function(){this.listenTo(this,"closeOther",this._destroyInlineActionBar),this.listenTo(this.collection,"reset",this._destroyInlineActionBar)},"_destroyInlineActionBar":function(){this.inlineToolbarView&&(this.inlineToolbarView.destroy(),this.inlineToolbarView=void 0)},"_onChildRender":function(e){e.options.thumbnailView&&e.options.thumbnailView.trigger("thumbnailRowRendered",{"sender":this,"target":e.el,"node":e.model})},"_showInlineActionBar":function(e){this.inlineToolbarView?this._savedHoverEnterArgs=e:e&&(this._savedHoverEnterArgs=null,this.inlineToolbarView=new v(i.extend({"context":this.options.context,"commands":l,"collection":this.options.inlineBar.options.collection,"toolItemsMask":this.options.inlineBar.options.toolItemsMask,"originatingView":this.options.originatingView,"model":e.model,"status":{"targetView":e.sender,"connector":this.options.collection.connector}},this.options.inlineBar.options)),this.listenTo(this.inlineToolbarView,"before:execute:command",function(e){this.lockedForOtherContols=!0,e&&e.status&&e.status.targetView&&e.status.targetView.$el&&e.status.targetView.$el.addClass("active-row"),this._destroyInlineActionBar()}),this.listenTo(this.inlineToolbarView,"after:execute:command",function(e){this.lockedForOtherContols=!1,e&&e.status&&e.status.targetView&&e.status.targetView.$el&&e.status.targetView.$el.removeClass("active-row")}),this.options.originatingView&&(this.listenTo(this.options.originatingView,"block:view:actions",function(){this.lockedForOtherContols=!0,this._destroyInlineActionBar()}),this.listenTo(this.options.originatingView,"unblock:view:actions",function(){this.lockedForOtherContols=!1})),this.inlineToolbarView.render(),this.listenTo(this.inlineToolbarView,"destroy",function(){this.inlineToolbarView=void 0,this._savedHoverEnterArgs&&this.onChildShowInlineActionBarWithDelay(this._savedHoverEnterArgs)},this),t(e.target).append(this.inlineToolbarView.$el),this.inlineToolbarView.triggerMethod("show"))},"onChildShowInlineActionBarWithDelay":function(e,i){this._showInlineActionbarTimeout&&clearTimeout(this._showInlineActionbarTimeout);var t=this;t.isSelected=t.collection.where({"csuiIsSelected":!0}).length>0,t._showInlineActionbarTimeout=setTimeout(function(){t._showInlineActionbarTimeout=void 0,t.lockedForOtherContols||t.isSelected||!t.isSelected&&t._showInlineActionBar.call(t,i)},200)},"onChildActionBarShouldDestroy":function(e,i){this._showInlineActionbarTimeout&&(clearTimeout(this._showInlineActionbarTimeout),this._showInlineActionbarTimeout=void 0),this.inlineToolbarView&&this.inlineToolbarView.destroy()},"showOrHideZeroRecordsMessage":function(){if(this.$el.find("div.csui-thumbnail-empty").remove(),0===this.collection.length){this.$el.addClass("csui-thumbnail-empty");var e,i="";this._showingEmptyView&&(e=this.collection.node.get("container")&&-1!==[298,899].indexOf(this.collection.node.get("type"))&&k.noResults,i=this.collection.filters&&this.collection.filters.name?k.noResults:k.dragAndDropMessage,i=e||i);var s=t("<div class='csui-thumbnail-empty  icon-thumbnail-empty-page'><p class='csui-no-result-message' title='"+i+"'>"+i+"</p></div>");this.$el.append(s),this.options.thumbnailHeaderView&&this.options.thumbnailView.collection.filters&&this.options.thumbnailHeaderView.searchBoxes.setFocus(),this._showingEmptyView&&this.options.thumbnailView.collection&&this.options.thumbnailView.collection.filters&&(this.options.thumbnailHeaderView.render(),this.options.thumbnailHeaderView.searchBoxes.setFocus())}else this.$el.removeClass("csui-thumbnail-empty"),this.$el.removeClass("icon-thumbnail-empty-page")},"onRender":function(){this.showOrHideZeroRecordsMessage(),this._adjustThumbnailWidth()},"onMetadataClose":function(){this._adjustThumbnailWidth()},"_adjustThumbnailWidth":function(){for(var e=this.$el.find(".csui-thumbnail-item"),i=t(".csui-table-facetview .csui-facet-panel").length>0?t(".csui-facet-table-container").width()-t(".csui-table-facetview").width():t(".cs-thumbnail-wrapper").width(),s=190/i*100,n=1;n<=e.length;n++){if(n*s>100){n-=1,s=100/n;break}}e.css({"maxWidth":"calc("+s+"% - 4px)","minWidth":"calc("+s+"% - 4px)"})}}),A=n.LayoutView.extend({"className":"csui-thumbnail-header","tagName":"div","regions":{"sortRegion":"#csui-sorting-container","searchRegion":"#csui-thumbnail-column-search"},"behaviors":{"TabableRegion":{"behaviorClass":u,"initialActivationWeight":100}},"ui":{"selectAll":".csui-selectAll-input","sortContainer":"#csui-sorting-container"},"events":{"keydown":"onKeyInView","click @ui.selectAll":"selectAllThumbnails","click @ui.sortContainer":"onSortClick"},"template":_,"templateHelpers":function(){return{"columns":this.options.thumbnailColumns,"addTitle":k.addTitle,"selectAll":k.selectAll,"selectAllTitle":k.selectAllTitle,"isEmptyNode":0===this.collection.models.length,"items":o.formatMessage(this.collection.length,k)}},"constructor":function(e){e||(e={}),n.LayoutView.prototype.constructor.call(this,e),this.columnsWithSearch=e.columnsWithSearch||[],this.listenTo(this,"selectOrUnselect.mixed",this.thumbnailItemClicked)},"onSortClick":function(){this.options.thumbnailView.currentItemView&&this.options.thumbnailView.currentItemView.overviewPopoverOpened?this.options.thumbnailView.currentItemView.overview.currentView._closePopover():this.options.thumbnailView.currentItemView&&this.options.thumbnailView.currentItemView.favoritePopoverOpened&&this.options.thumbnailView.currentItemView.favorite.currentView.favStarView.closePopover()},"sortmenurender":function(e){this.options.thumbnailView.resultsView.render(),this.sortRegion.$el.find("button.binf-dropdown-toggle").focus(),this._isRendered&&0===this.options.thumbnailView.getSelectedChildren().length&&this.options.thumbnailView.resultsView.$el.find(".csui-checkbox")&&this.options.thumbnailView.resultsView.$el.find(".csui-checkbox").removeClass("csui-checkbox")},"thumbnailItemClicked":function(){var e=this.collection.filter(function(e){return e.get(g.isSelectedModelAttributeName)}),i=e.length===this.collection.length;e.length>0&&!i?this.$el.find(".csui-selected-checkbox").addClass("csui-checkbox-atleastone"):this.$el.find(".csui-selected-checkbox").removeClass("csui-checkbox-atleastone"),this.$(".csui-selectAll-input").prop("checked",i)},"selectAllThumbnails":function(e){this.options.thumbnailView.activeInlineForm&&(this.options.thumbnailView.$el.find(".csui-thumbnail-item-form").removeClass("csui-thumbnail-item-form"),this.options.thumbnailView.activeInlineForm.model.trigger("sync"),this.options.thumbnailView.cancelAnyExistingInlineForm()),this.$el.find(".csui-checkbox-atleastone").removeClass("csui-checkbox-atleastone"),this.trigger("selectOrUnselect.all",e.target.checked),this.collection.where({"csuiIsSelected":!0}).length>0&&this.trigger("selectOrUnselect.mixed")},"onRender":function(e){var i=e||window.event,t=this.options.thumbnailView;this.focusIndex=0;var s=t.$el.find(".csui-thumbnail-item-selected").length;if(this.collection.where({"csuiIsSelected":!0}).length>0)this.trigger("selectOrUnselect.mixed");else if(s>0)t.$el.find(".csui-checkbox").removeClass(),this.trigger("selectOrUnselect.all",i.target&&i.target.checked);else if(0===s){var n=t.getSelectedChildren();t.options.selectedChildren&&t.options.selectedChildren.reset(n)}var o=new h({"collection":this.collection,"resultView":this});this.sortRegion.show(o),this.listenTo(o,"render:sortmenu",this.sortmenurender),this.ensureAllSearchBox(),this.currentlyFocusedElement()},"updateTotalCount":function(){var e=o.formatMessage(this.collection.length,k);this.$el.find(".csui-thumbnail-itemcount").html(e)},"currentlyFocusedElement":function(e){var i=this.$el.find("*[tabindex=-1]");i.length&&i.prop("tabindex",0)},"onKeyInView":function(e){if(32===e.keyCode||13===e.keyCode){if(t(e.target).hasClass("csui-selectAll-input")){if(e.preventDefault(),e.stopPropagation(),o.isFirefox()&&32===e.keyCode)return!1;t(e.target).click()}t(e.target).hasClass("csui-thumbnail-column-search")&&(e.preventDefault(),e.stopPropagation(),this.searchBoxes.showSearchInput(e))}},"ensureAllSearchBox":function(){var e=this,s=(this.options.thumbnailView,this.$el.find(".csui-thumbnail-column-search")),n=this.$el.find(".csui-sorting-container");if(0===t(this).find(".csui-thumbnail-column-search").length){var o=new b(e.collection.filters.name,{"column":"name","columnTitle":k.name});e.searchBoxes=o,o.on("change:filterValue",function(i){e.applyFilter(i)}),o.on("opened",function(){n.find(".csui-search-sort-options").removeClass("binf-open"),n.addClass("binf-hidden"),e.searchColumn="name"}),o.on("closed",function(){n.removeClass("binf-hidden"),e.collection.filters.name=void 0}),this.searchRegion.show(e.searchBoxes),"name"!==e.searchColumn||e.options.thumbnailView.activeInlineForm||o.setFocus(),s=t(this).find(".csui-table-column-search"),s&&s.attr("aria-label",i.str.sformat(k.searchIconTooltip,k.name))}},"applyFilter":function(e){var i={};i[e.column]=e.keywords,this.collection.fetching?this.filterValuePending=i:(this.collection.resetLimit(!1),this.collection.setFilter(i))}}),M=n.LayoutView.extend({"className":"csui-thumbnail-container","template":T,"regions":{"headerRegion":"#csui-thumbnail-header","resultsRegion":"#csui-thumbnail-results"},"behaviors":{"PerfectScrolling":{"behaviorClass":c,"contentParent":".csui-thumbnail-results","suppressScrollX":!0,"scrollYMarginOffset":15},"DefaultAction":{"behaviorClass":r}},"constructor":function(e){e||(e={}),this.options=e,e.actionItems&&e.commands?(this.defaultActionController=new a({"actionItems":e.actionItems,"commands":e.commands}),this.checkModelHasAction=this.defaultActionController.hasAction.bind(this.defaultActionController)):this.checkModelHasAction=function(){return!0},n.LayoutView.prototype.constructor.call(this,e),this.context=e.context,this.collection=e.collection;var i=this.collection.where({"csuiIsSelected":!0});this.collection.itemchecked=!1,i.length>0&&(this.collection.itemchecked=!0),this.options.blockingParentView?y.delegate(this,this.options.blockingParentView):y.imbue(this),this.listenTo(this.collection,"update",this._handleModelsUpdate),this.listenTo(this.collection,"change",this.updateRow),this.context&&this.listenTo(this.context,"request",this._handleContextRequest).listenTo(this.context,"sync error",this._handleContextFinish).listenTo(this.context,"sync",this._handleContextSync),this.collection.node&&this.listenTo(this.collection.node,"change:id",this._clearSearchBoxes),this.listenTo(this.collection,"request",this.blockActions).listenTo(this.collection,"sync",this.unblockActions).listenTo(this.collection,"destroy",this.unblockActions).listenTo(this.collection,"error",this.unblockActions),this._ViewCollection=s.Collection.extend({"model":this.collection.model}),this.selectedChildren=new this._ViewCollection;var t=this;this.el.addEventListener("scroll",function(){t.trigger("scroll")},!0),this.listenTo(this.collection,"reset",this._updateSelectedChildren),this.listenTo(this.collection,"remove",this._updateSelectedChildren),this.listenTo(this.collection,"new:page",this.resetScrollToTop),this.listenTo(this.collection,"reset",function(){this._isRendered&&(this.resetScrollToTop(),this.thumbnailHeaderView&&this.collection.filters&&this.collection.filters.name?this.thumbnailHeaderView.updateTotalCount():this.thumbnailHeaderView.render())})},"_updateSelectedChildren":function(){this._isRendered&&this.options.selectedChildren&&this.options.selectedChildren.enableNonPromotedCommands&&this.showToolBarActions()},"_handleContextRequest":function(){this._fetchingContext=!0,this._columnsReset=!1,this._collectionReset=!1},"_handleContextSync":function(){this._isRendered&&(this._columnsReset?this.rebuild():this._collectionReset&&this.render())},"_handleContextFinish":function(){this._fetchingContext=!1},"resetScrollToTop":function(){this._isRendered&&this.resultsRegion&&this.resultsRegion.$el.scrollTop(0)},"onDestroy":function(){this._originalScope&&this.options.collection.setResourceScope(this._originalScope)},"_handleModelsUpdate":function(e,t){if(this._isRendered){var s=t.changes.added,o=this;if(s.length>0){i.each(s,function(e){e.unset(g.isSelectedModelAttributeName)}),this.triggerMethod("before:render",this);var l=null;if(i.each(s,function(e){l=e}),l.inlineFormView){o.activeInlineForm&&o.activeInlineForm.destroy(),o.activeInlineForm=new l.inlineFormView({"model":l,"originatingView":o.options.originatingView,"context":o.context});var r=".csui-thumbnail-name-"+l.cid,a=this.$el.find(r);o.activeInlineForm.listenTo(o.activeInlineForm,"destroy",function(){o.lockedForOtherContols=!1,delete o.activeInlineForm});new n.Region({"el":a}).show(o.activeInlineForm)}this.resultsView.showOrHideZeroRecordsMessage(),this._adjustThumbnailWidth(),this.trigger("dom:refresh"),i.each(s,function(e){e.isLocallyCreated&&!e.inlineFormView&&o.$el.find(".csui-thumbnail-item-"+e.cid).find(".csui-thumbnail-content-container").addClass("csui-new-item")})}this.thumbnailHeaderView&&this.thumbnailHeaderView.render()}},"_maintainNodeState":function(e){var i=e,t=this;if(!e||!e.inlineFormView)return!1;t.activeInlineForm=new i.inlineFormView({"model":i,"originatingView":t.options.originatingView,"context":t.context}),t.$el.find(".csui-thumbnail-item-"+i.cid).addClass("csui-thumbnail-item-form");var s=".csui-thumbnail-name-"+i.cid,o=this.$el.find(s);new n.Region({"el":o}).show(t.activeInlineForm)},"updateRow":function(e){if(e.isLocallyCreated&&this.$el.find(".csui-thumbnail-item-form")&&this.$el.find(".csui-thumbnail-item-form").find(".csui-thumbnail-content-container").addClass("csui-new-item"),this.isSelected=this.collection.where({"csuiIsSelected":!0}).length>0,e.inlineFormView){this.options.originatingView.updateRowIndex=this.collection.indexOf(e);var i=this;i.activeInlineForm&&i.activeInlineForm.model!==e&&(this.$el.find(".csui-thumbnail-item-form").removeClass("csui-thumbnail-item-form"),this.$el.find(".csui-thumbnail-item-form").removeClass("csui-thumbnail-item-rename-form"),this.activeInlineForm.model.trigger("sync"),this.cancelAnyExistingInlineForm({"silent":!0})),i.activeInlineForm=new e.inlineFormView({"model":e,"originatingView":i.options.originatingView,"context":i.context}),this.$el.find(".csui-thumbnail-item-"+e.cid).addClass("csui-thumbnail-item-rename-form");var t=".csui-thumbnail-name-"+e.cid,s=this.$el.find(t);i.activeInlineForm.listenTo(i.activeInlineForm,"destroy",function(){i.lockedForOtherContols=!1,i.activeInlineForm.model.trigger("sync"),delete i.activeInlineForm}),this.$el.find(".csui-thumbnail-item-"+e.cid).removeClass("csui-thumbnail-item-apply-transition"),i.$el.find(".csui-thumbnail-item-"+i.activeInlineForm.model.cid).addClass("csui-thumbnail-item-form");new n.Region({"el":s}).show(i.activeInlineForm),i.$el.find(".csui-thumbnail-item-"+i.activeInlineForm.model.cid).removeClass("csui-thumbnail-item-rename-form"),i.$el.find(".csui-thumbnail-item-"+i.activeInlineForm.model.cid).find("div.csui-thumbnail-overview-icon").addClass("binf-hidden"),this.$el.find(".csui-thumbnail-item-form")&&this.$el.find(".csui-thumbnail-item-form").find(".csui-thumbnail-content-container .csui-inlineform-error").length>0&&this.$el.find(".csui-thumbnail-item-form").find(".csui-thumbnail-content-container.csui-new-item").addClass("csui-new-item-error"),i.activeInlineForm&&i.activeInlineForm.triggerMethod("dom:refresh",i.activeInlineForm)}else{this.$el.find(".csui-thumbnail-item-"+e.cid).removeClass("csui-thumbnail-item-form"),this.$el.find(".csui-thumbnail-item-"+e.cid).addClass("csui-thumbnail-item-apply-transition"),this.activeInlineForm&&this.activeInlineForm.model.cid===e.cid&&(this.activeInlineForm.model.trigger("sync"),this.cancelAnyExistingInlineForm({"silent":!0})),
this.collection&&this.collection.filters.name&&this.thumbnailHeaderView.searchBoxes.setFocus(),this.$el.find(".csui-thumbnail-content-container.csui-new-item.csui-new-item-error").length>0&&this.$el.find(".csui-thumbnail-content-container.csui-new-item.csui-new-item-error").removeClass("csui-new-item-error");var o=this;setTimeout(function(){o._updateSelectedChildren(e)},0)}},"onAfterShow":function(){this.thumbnailHeaderView.searchBoxes.setFocus()},"_adjustThumbnailWidth":function(){for(var e=this.$el.find(".csui-thumbnail-item"),i=t(".csui-table-facetview .csui-facet-panel").length>0?t(".csui-facet-table-container").width()-t(".csui-table-facetview").width():t(".cs-thumbnail-wrapper").width(),s=190/i*100,n=1;n<=e.length;n++){if(n*s>100){n-=1,s=100/n;break}}e.css({"maxWidth":"calc("+s+"% - 4px)","minWidth":"calc("+s+"% - 4px)"})},"cancelAnyExistingInlineForm":function(e){this.activeInlineForm&&this.activeInlineForm.cancel(e)},"startCreateNewModel":function(e,i){this.cancelAnyExistingInlineForm(),this.collection&&this.collection.node&&(e.set("parent_id",this.collection.node.get("id")),e.isLocallyCreated=!0,e.inlineFormView=i,this.collection.add(e,{"at":0}),this._adjustThumbnailWidth())},"_clearSearchBoxes":function(){this._isRendered&&i.each(this.searchBoxes,function(e){e.hideAndClear()})},"onRender":function(){this.thumbnailHeaderView=new A({"columns":this.displayedColumns,"context":this.context,"columnsWithSearch":this.options.columnsWithSearch,"filterBy":this.options.filterBy,"collection":this.options.collection,"thumbnailView":this}),this.headerRegion.show(this.thumbnailHeaderView);var e=this;this.listenTo(this.thumbnailHeaderView,"selectOrUnselect.all",function(t){t?(e.collection.models.length>0&&i.each(e.collection.models,function(e){e.set(g.isSelectedModelAttributeName,!0),e.attributes.selectAllThumbnailsEnabled=!0,e.attributes.isSelected=!0}),e.$el.find(".csui-thumbnail-results .csui-thumbnail-select").addClass("csui-checkbox"),e.$el.find(".csui-thumbnail-results .csui-thumbnail-item").addClass("csui-thumbnail-item-selected")):e.collection.models.length>0&&(i.each(e.collection.models,function(e){e.set(g.isSelectedModelAttributeName,!1),e.attributes.selectAllThumbnailsEnabled=!1,e.attributes.isSelected=!1}),e.$el.find(".csui-thumbnail-select").removeClass("csui-checkbox"),e.$el.find(".csui-thumbnail-results .csui-thumbnail-item").removeClass("csui-thumbnail-item-selected")),e.showToolBarActions()}),e.listenTo(e,"thumbnailRowRendered",function(i){e.trigger("thumbnailItemRendered",{"sender":e,"target":i.target,"node":i.node})}),this.resultsView=new V({"context":this.options.context,"collection":this.options.collection,"thumbnailView":this,"originatingView":this.options.originatingView,"inlineBar":this.options.inlineBar,"thumbnailHeaderView":this.thumbnailHeaderView,"tableColumns":this.options.tableColumns,"columns":this.options.columns}),this.showToolBarActions(),this.resultsRegion.show(this.resultsView)},"showToolBarActions":function(e){var i=this.getSelectedChildren();this.options.selectedChildren.reset(i)},"getSelectedChildren":function(){var e=[];return this.options.collection.each(function(i){i.get("csuiIsSelected")&&e.push(i)}),e}});return i.extend(M.prototype,w),M}),csui.define("hbs!csui/controls/thumbnail/content/node.state/impl/reservation/reservation",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"1":function(e,i,t,s){return"other"},"3":function(e,i,t,s){return"self"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){var n,o;return'<button type="button" aria-label="'+this.escapeExpression((o=null!=(o=i.reservedAria||(null!=e?e.reservedAria:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"reservedAria","hash":{}}):o))+'">\r\n<span class="icon '+this.escapeExpression((o=null!=(o=i.iconPrefix||(null!=e?e.iconPrefix:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"iconPrefix","hash":{}}):o))+"_"+(null!=(n=i.if.call(e,null!=e?e.isReservedByOther:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.program(3,s,0)}))?n:"")+'"\r\n        title="'+this.escapeExpression((o=null!=(o=i.reservedTooltip||(null!=e?e.reservedTooltip:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"reservedTooltip","hash":{}}):o))+'"></span>\r\n</button>\r\n\r\n'}});return t.registerPartial("csui_controls_thumbnail_content_node.state_impl_reservation_reservation",s),s}),csui.define("css!csui/controls/thumbnail/content/node.state/impl/reservation/reservation",[],function(){}),csui.define("csui/controls/thumbnail/content/node.state/impl/reservation/reservation.view",["csui/lib/underscore","csui/lib/marionette","csui/utils/base","csui/utils/contexts/factories/user","csui/models/nodes","csui/utils/commands","csui/utils/commandhelper","hbs!csui/controls/thumbnail/content/node.state/impl/reservation/reservation","i18n!csui/controls/thumbnail/content/node.state/impl/nls/localized.strings","css!csui/controls/thumbnail/content/node.state/impl/reservation/reservation"],function(e,i,t,s,n,o,l,r,a){"use strict";return i.ItemView.extend({"tagName":"li","className":"csui-node-state-reservation","template":r,"triggers":{"click button":"remove:reservation"},"constructor":function(){i.ItemView.prototype.constructor.apply(this,arguments);var e=this.options.context.getModel(s);this.userId=e.get("id"),this.unreserveCommand=o.get("UnreserveDoc"),this.revokeShareCommand=o.get("RevokeShare"),this.commandStatus={"nodes":new n([this.model]),"context":this.options.context};var t=this.model.actions;t&&this.listenTo(t,"update",function(){this._isDestroyed||this.options.targetView||(this.render(),this.$el.find("button").attr("tabindex","-1"))})},"templateHelpers":function(){var i,s,n,o=this._getReservedStatus(),l=o.isReserved,r=o.isSharedCollaboration,c=o.reservedBy;if(l){var u=t.formatExactDate(this.model.get("reserved_date")),d=t.formatMemberName(c);r?(i=a.reservedSharedCollaborationTooltip,s=a.reservedSharedCollaborationAria):(i=a.reservedTooltip,s=a.reservedAria),i=e.str.sformat(i,d,u),s=e.str.sformat(s,d,u),n=r?"icon-shared_collaborate":"icon-reserved"}return this._reservedStatus={"isReserved":l,"isSharedCollaboration":r,"isReservedByOther":c&&this.userId!==c.id,"canUnreserve":o.canUnreserve,"reservedTooltip":i,"reservedAria":s,"iconPrefix":n},this._reservedStatus},"onRemoveReservation":function(e){if(!this.model.get("FromThumbnailStateIconView")&&this._reservedStatus.canUnreserve){var i=this._reservedStatus.isSharedCollaboration?this.revokeShareCommand:this.unreserveCommand,t=i.execute(this.commandStatus);l.handleExecutionResults(t,{"command":i,"suppressSuccessMessage":this.commandStatus.suppressSuccessMessage,"suppressFailMessage":this.commandStatus.suppressFailMessage})}},"_getReservedStatus":function(){var e=this.model.get("reserved"),i=this.model.get("reserved_shared_collaboration"),t=i?this.revokeShareCommand:this.unreserveCommand,s=this.model.get("reserved_user_id_expand");return s||(s=this.model.get("reserved_user_id"))&&"number"==typeof s&&(s={"id":s}),{"isReserved":e&&void 0!==s||i,"isSharedCollaboration":i,"reservedBy":s,"canUnreserve":t.enabled(this.commandStatus)}},"getAttributes":function(){var e,i,t=this.templateHelpers();return t.isSharedCollaboration?(e=a.reserved_shared_collaboration_attribute_title,i=a.reserved_shared_collaboration_attribute_name):(e=a.reserved_attribute_title,i=a.reserved_attribute_name),[{"label":e,"value":t.isReserved,"name":i,"tooltip":t.reservedTooltip,"aria":t.reservedAria}]}},{"enabled":function(e){var i=e.node,t=i.get("reserved"),s=i.get("reserved_shared_collaboration"),n=i.get("reserved_user_id");return t&&n||s},"getModelExpand":function(e){return{"properties":["reserved_user_id"]}}})}),csui.define("csui/controls/thumbnail/content/node.state/impl/node.state.icons",["csui/controls/thumbnail/content/node.state/impl/reservation/reservation.view"],function(e){"use strict";return[{"sequence":5,"iconView":e}]}),csui.define("csui/controls/zipanddownload/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/zipanddownload/impl/nls/root/lang",{"itemCount":"{0} item","itemsCount":"{0} items","moreThan100":"100+","preflightDialogTitle":"Download details","itemsExcludedMessage":"Items with the following types will be excluded from the Zip file:","downloadDialogTitle":"Download Zip file","zipFileName":"Zip file name","skippedItemsLabel":"The following {0} items cannot be downloaded","skippedItemLabel":"The following {0} item cannot be downloaded","labelType":"Type","labelName":"Name","labelLocation":"Location","labelMessage":"Message"}),csui.define("hbs!csui/controls/zipanddownload/impl/dialog.header/impl/dialog.header",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"1":function(e,i,t,s){var n;return'<div class="cs-header-control csui-zipanddownload-details">\r\n  <span class="csui-items">'+this.escapeExpression((n=null!=(n=i.itemsCount||(null!=e?e.itemsCount:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"itemsCount","hash":{}}):n))+' </span>\r\n  <span class="csui-size">'+this.escapeExpression((n=null!=(n=i.size||(null!=e?e.size:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"size","hash":{}}):n))+"</span>\r\n</div>\r\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){var n,o;return'<div class="tile-title">\r\n  <h2 class="tile-title binf-modal-title csui-heading">'+this.escapeExpression((o=null!=(o=i.title||(null!=e?e.title:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"title","hash":{}}):o))+"</h2>\r\n</div>\r\n"+(null!=(n=i.if.call(e,null!=e?e.itemCountExists:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?n:"")}});return t.registerPartial("csui_controls_zipanddownload_impl_dialog.header_impl_dialog.header",s),s}),csui.define("css!csui/controls/zipanddownload/impl/dialog.header/impl/dialog.header",[],function(){}),csui.define("csui/controls/zipanddownload/impl/dialog.header/dialog.header.view",["csui/lib/underscore","csui/controls/dialog/impl/header.view","csui/utils/base","i18n!csui/controls/zipanddownload/impl/nls/lang","hbs!csui/controls/zipanddownload/impl/dialog.header/impl/dialog.header","css!csui/controls/zipanddownload/impl/dialog.header/impl/dialog.header"],function(e,i,t,s,n){return i.extend({"template":n,"templateHelpers":function(){return{"title":this.options.title,"itemCountExists":this.options.hasOwnProperty("itemsCount")&&this.options.itemsCount>0,"itemsCount":this.options.hasOwnProperty("itemsCount")?e.str.sformat(1===this.options.itemsCount?s.itemCount:s.itemsCount,this.options.itemsCount):"","size":this.options.size?t.formatFriendlyFileSize(1024*this.options.size):""}},"constructor":function(e){i.prototype.constructor.call(this,e)}})}),csui.define("hbs!csui/controls/zipanddownload/impl/preflight.dialog/impl/preflight.dialog",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"1":function(e,i,t,s){return'          <div class="csui-preflight-table-row">\r\n            <div class="csui-preflight-cell csui-type">\r\n              <span class="'+this.escapeExpression(this.lambda(null!=e?e.mimeIcon:e,e))+'"></span>\r\n            </div>\r\n            <div class="csui-preflight-cell csui-name">'+this.escapeExpression(this.lambda(null!=e?e.typeName:e,e))+"</div>\r\n          </div>\r\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){var n,o;return'<div class="binf-modal-dialog '+this.escapeExpression((o=null!=(o=i.binfDialogSizeClassName||(null!=e?e.binfDialogSizeClassName:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"binfDialogSizeClassName","hash":{}}):o))+'" role="dialog" aria-modal="true" aria-hidden="false">\r\n  <div class="binf-modal-content">\r\n    <div class="tile-header binf-modal-header"></div>\r\n    <div class="binf-modal-body">\r\n      <div class="csui-preflight-table csui-preflight-table-body">\r\n        <div>'+this.escapeExpression((o=null!=(o=i.itemsExcludedMessage||(null!=e?e.itemsExcludedMessage:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"itemsExcludedMessage","hash":{}}):o))+"</div>\r\n        <div>"+this.escapeExpression((o=null!=(o=i.skippedTypes||(null!=e?e.skippedTypes:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"skippedTypes","hash":{}}):o))+'</div>\r\n      </div>\r\n    </div>\r\n    <div class="binf-hidden">\r\n      <div class="csui-preflight-table csui-preflight-table-header">\r\n        <div class="csui-preflight-cell csui-type">Type</div>\r\n        <div class="csui-preflight-cell csui-name">Name</div>\r\n      </div>\r\n      <div class="csui-preflight-table csui-preflight-table-body">\r\n'+(null!=(n=i.each.call(e,null!=e?e.skippedTypes:e,{"name":"each","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?n:"")+'      </div>\r\n    </div>\r\n  </div>\r\n  <div class="binf-modal-footer binf-hidden"></div>\r\n</div>'}});return t.registerPartial("csui_controls_zipanddownload_impl_preflight.dialog_impl_preflight.dialog",s),s}),csui.define("css!csui/controls/zipanddownload/impl/preflight.dialog/impl/preflight.dialog",[],function(){}),csui.define("csui/controls/zipanddownload/impl/preflight.dialog/preflight.dialog.view",["csui/controls/dialog/dialog.view","csui/controls/tile/behaviors/perfect.scrolling.behavior","csui/controls/zipanddownload/impl/dialog.header/dialog.header.view","i18n!csui/controls/zipanddownload/impl/nls/lang","hbs!csui/controls/zipanddownload/impl/preflight.dialog/impl/preflight.dialog","css!csui/controls/zipanddownload/impl/preflight.dialog/impl/preflight.dialog"],function(e,i,t,s,n){return e.extend({"className":"csui-zipanddownload-dialog csui-zipanddownload-preflight-dialog csui-preflight-check","template":n,"templateHelpers":function(){var e={};return this.options.model.get("results")&&this.options.model.get("results").data&&this.options.model.get("results").data.jobs&&(e=this.options.model.get("results").data.jobs),{"itemsExcludedMessage":s.itemsExcludedMessage,"skipped":e.total_skipped,"skippedTypes":e.skipped_types.map(function(e){return e.name}).join(", ")}},"behaviors":{"PerfectScrolling":{"behaviorClass":i,"contentParent":".csui-preflight-table-body","suppressScrollX":!0,"scrollYMarginOffset":15}},"constructor":function(i){e.prototype.constructor.call(this,i)},"_renderHeader":function(){this.getRegion("header").show(new t({"title":s.preflightDialogTitle}))}})}),csui.define("hbs!csui/controls/zipanddownload/impl/download.dialog/impl/download.dialog",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"1":function(e,i,t,s){var n,o;return'        <div class="csui-unprocessed-item-list">\r\n          <div class="csui-info">\r\n            <span class="notification_warning_orange"></span>\r\n            <span class="notification_message">'+this.escapeExpression((o=null!=(o=i.skippedItemsLabel||(null!=e?e.skippedItemsLabel:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"skippedItemsLabel","hash":{}}):o))+'</span>\r\n          </div>\r\n          <div class="csui-skipped-container">\r\n            <div class="csui-skipped-item-table csui-download-table-header">\r\n              <div class="csui-skipped-item-cell csui-type">'+this.escapeExpression((o=null!=(o=i.labelType||(null!=e?e.labelType:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"labelType","hash":{}}):o))+'</div>\r\n              <div class="csui-skipped-item-cell csui-name">'+this.escapeExpression((o=null!=(o=i.labelName||(null!=e?e.labelName:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"labelName","hash":{}}):o))+'</div>\r\n              <div class="csui-skipped-item-cell csui-location">'+this.escapeExpression((o=null!=(o=i.labelLocation||(null!=e?e.labelLocation:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"labelLocation","hash":{}}):o))+'</div>\r\n              <div class="csui-skipped-item-cell csui-message">'+this.escapeExpression((o=null!=(o=i.labelMessage||(null!=e?e.labelMessage:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"labelMessage","hash":{}}):o))+'</div>\r\n            </div>\r\n            <div class="csui-skipped-item-table csui-download-table-body">\r\n'+(null!=(n=i.each.call(e,null!=e?e.skippedTypes:e,{"name":"each","hash":{},"fn":this.program(2,s,0),"inverse":this.noop}))?n:"")+"            </div>\r\n          </div>\r\n        </div>\r\n"},"2":function(e,i,t,s){return'                <div class="csui-download-table-row">\r\n                  <div class="csui-skipped-item-cell csui-type">\r\n                    <span title="'+this.escapeExpression(this.lambda(null!=e?e.subtype_name:e,e))+'" class="'+this.escapeExpression(this.lambda(null!=e?e.mimeIcon:e,e))+'"></span>\r\n                  </div>\r\n                  <div class="csui-skipped-item-cell csui-name">\r\n                    <span title="'+this.escapeExpression(this.lambda(null!=e?e.name:e,e))+'">'+this.escapeExpression(this.lambda(null!=e?e.name:e,e))+'</span>\r\n                  </div>\r\n                  <div class="csui-skipped-item-cell csui-location">\r\n                    <span class="csui-location-name"\r\n                          title="'+this.escapeExpression(this.lambda(null!=e?e.path:e,e))+'">'+this.escapeExpression(this.lambda(null!=e?e.parentLocation:e,e))+'</span>\r\n                  </div>\r\n                  <div class="csui-skipped-item-cell csui-message">\r\n                    <span title="'+this.escapeExpression(this.lambda(null!=e?e.details:e,e))+'">'+this.escapeExpression(this.lambda(null!=e?e.details:e,e))+"</span>\r\n                  </div>\r\n                </div>\r\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){var n,o;return'<div class="binf-modal-dialog '+this.escapeExpression((o=null!=(o=i.binfDialogSizeClassName||(null!=e?e.binfDialogSizeClassName:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"binfDialogSizeClassName","hash":{}}):o))+'" role="dialog" aria-modal="true"\r\n     aria-hidden="false">\r\n  <div class="binf-modal-content">\r\n    <div class="tile-header binf-modal-header"></div>\r\n    <div class="binf-modal-body">\r\n      <div class="csui-zipanddownload">\r\n        <div class="csui-zipanddownload-filename">\r\n          <label>'+this.escapeExpression((o=null!=(o=i.zipFileName||(null!=e?e.zipFileName:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"zipFileName","hash":{}}):o))+'</label>\r\n          <input type="text" class="csui-archive-name" name="download-name" value="'+this.escapeExpression((o=null!=(o=i.fileName||(null!=e?e.fileName:e))?o:i.helperMissing,"function"==typeof o?o.call(e,{"name":"fileName","hash":{}}):o))+'">\r\n        </div>\r\n        <div class="csui-archive-name-error-container">\r\n          <span class="csui-archive-name-error"></span>\r\n        </div>\r\n      </div>\r\n'+(null!=(n=i.if.call(e,null!=e?e.skippedTypes:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?n:"")+'    </div>\r\n  </div>\r\n  <div class="binf-modal-footer binf-hidden"></div>\r\n</div>'}});return t.registerPartial("csui_controls_zipanddownload_impl_download.dialog_impl_download.dialog",s),s}),csui.define("css!csui/controls/zipanddownload/impl/download.dialog/impl/download.dialog",[],function(){}),csui.define("csui/controls/zipanddownload/impl/download.dialog/download.dialog.view",["csui/lib/jquery","csui/lib/backbone","csui/lib/underscore","csui/controls/dialog/dialog.view","csui/utils/base","csui/utils/nodesprites","csui/controls/tile/behaviors/perfect.scrolling.behavior","csui/controls/zipanddownload/impl/dialog.header/dialog.header.view","i18n!csui/controls/zipanddownload/impl/nls/lang","csui/models/node/node.model","hbs!csui/controls/zipanddownload/impl/download.dialog/impl/download.dialog","css!csui/controls/zipanddownload/impl/download.dialog/impl/download.dialog"],function(e,i,t,s,n,o,l,r,a,c,u){return s.extend({"className":"csui-zipanddownload-dialog csui-download-dialog","template":u,"templateHelpers":function(){var e=this.options.model,i=this.options.model.get("unprocessed_items_list")&&this.options.model.get("unprocessed_items_list").length;return this.options.model.get("unprocessed_items_list")&&this.options.model.get("unprocessed_items_list").map(function(e){e.mimeIcon=o.findClassByNode(new c({"id":e.id,"container":e.container,"mime_type":e.mimetype,"type":e.subtype}))}),{"skipped":e.get("total_skipped"),"skippedTypes":e.get("unprocessed_items_list"),"supported":e.get("total_supported"),"size":n.formatFriendlyFileSize(e.get("total_supported_size")),"fileName":this.options.model.get("name"),"zipFileName":a.zipFileName,"labelType":a.labelType,"labelName":a.labelName,"labelLocation":a.labelLocation,"labelMessage":a.labelMessage,"skippedItemsLabel":t.str.sformat(1===i?a.skippedItemLabel:a.skippedItemsLabel,i)}},"ui":t.extend({"fileName":"input[name=download-name]","errorEl":".csui-archive-name-error"},s.prototype.ui),"events":t.extend({"keypress @ui.fileName":"downloadArchive","focusin @ui.fileName":"onFocusInFileName"},s.prototype.events),"behaviors":{"PerfectScrolling":{"behaviorClass":l,"contentParent":".csui-download-table-body","suppressScrollX":!0,"scrollYMarginOffset":15}},"constructor":function(e){e||(e={}),s.prototype.constructor.call(this,e)},"onShown":function(){this.triggerMethod&&(this.triggerMethod("dom:refresh"),this.triggerMethod("after:show")),this.header.currentView&&this.header.currentView.triggerMethod&&(this.header.currentView.triggerMethod("dom:refresh"),this.header.currentView.triggerMethod("after:show")),this.footerView&&this.footerView.triggerMethod&&(this.footerView.triggerMethod("dom:refresh"),this.footerView.triggerMethod("after:show")),this.ui.fileName.focus()},"_renderHeader":function(){var e=this.options.model;this.getRegion("header").show(new r({"title":a.downloadDialogTitle,"itemsCount":e.get("total"),"size":e.get("total_size")}))},"downloadArchive":function(e){if("keypress"===e.type&&13===e.keyCode&&this.options&&this.options.buttons&&this.options.buttons.length>0){var i=t.find(this.options.buttons,function(e){return"zipDownload"===e.id});i.disabled||i.click()}},"onFocusInFileName":function(i){var t=e(i.target)[0],s=t.value,n=s?s.length:0;s.lastIndexOf(".")>0&&s.lastIndexOf(".")<s.length-1&&(n=s.lastIndexOf(".")),t.selectionEnd=n}})}),csui.define("csui/dialogs/multilingual.text.picker/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/dialogs/multilingual.text.picker/impl/nls/root/lang",{"formHeading":"This field can be translated for each defined metadata language","dialogTitle":"Multilingual Values","btnDone":"Done","btnCancel":"Cancel"}),csui.define("csui/dialogs/multilingual.text.picker/languages",[],function(){return{"en":{"LanguageName":"English","LanguageNameLocal":"English"},"en-US":{"LanguageName":"English ( United States )","LanguageNameLocal":"English ( United States )"},"ar":{"LanguageName":"Arabic","LanguageNameLocal":"\u0627\u0644\u0639\u0631\u0628\u064a\u0629"},"ca-ES":{"LanguageName":"Catalan","LanguageNameLocal":"Catal\xe0"},"zh-CN":{"LanguageName":"Simplified Chinese","LanguageNameLocal":"\u4e2d\u6587"},"zh-TW":{"LanguageName":"Traditional Chinese","LanguageNameLocal":"\u4e2d\u6587"},"nl":{"LanguageName":"Dutch","LanguageNameLocal":"Nederlands"},"fi-FI":{"LanguageName":"Finnish","LanguageNameLocal":"Suomi"},"fr":{"LanguageName":"French","LanguageNameLocal":"Fran\xe7ais"},"de":{"LanguageName":"German","LanguageNameLocal":"Deutsch"},"it":{"LanguageName":"Italian","LanguageNameLocal":"Italiano"},"ja":{"LanguageName":"Japanese","LanguageNameLocal":"\u65e5\u672c\u8a9e"},"kk-KZ":{"LanguageName":"Kazakh","LanguageNameLocal":"\u049a\u0430\u0437\u0430\u049b"},"ko-KR":{"LanguageName":"Korean","LanguageNameLocal":"\ud55c\uad6d\uc5b4"},"pt":{"LanguageName":"Portuguese","LanguageNameLocal":"Portugu\xeas"},"ru-RU":{"LanguageName":"Russian","LanguageNameLocal":"\u0420\u0443\u0441\u0441\u043a\u0438\u0439"},"es":{"LanguageName":"Spanish","LanguageNameLocal":"Espa\xf1ol"},"sv":{"LanguageName":"Swedish","LanguageNameLocal":"Svenska"},"uk-UA":{"LanguageName":"Ukrainian","LanguageNameLocal":"\u0423\u043a\u0440\u0430\u0457\u043d\u0441\u044c\u043a\u0430"}}}),csui.define("hbs!csui/dialogs/multilingual.text.picker/impl/multilingual.form",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"1":function(e,i,t,s,n,o){return'    <div class="binf-row">\r\n      <label class="binf-control-label alpaca-control-label binf-col-sm-4"\r\n             for="input-'+this.escapeExpression(this.lambda(null!=e?e.LanguageCode:e,e))+'"\r\n             title="'+this.escapeExpression(this.lambda(null!=e?e.LanguageNameLocal:e,e))+'">'+this.escapeExpression(this.lambda(null!=e?e.LanguageNameLocal:e,e))+'</label>\r\n      <div class="binf-col-sm-8 "><input id="input-'+this.escapeExpression(this.lambda(null!=e?e.LanguageCode:e,e))+'"\r\n                                         value="'+this.escapeExpression(i.lookup.call(e,null!=o[1]?o[1].data:o[1],null!=e?e.LanguageCode:e,{"name":"lookup","hash":{}}))+'"></div>\r\n    </div>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s,n,o){var l,r;return'<div class="cs-header">\r\n  '+this.escapeExpression((r=null!=(r=i.formHeading||(null!=e?e.formHeading:e))?r:i.helperMissing,"function"==typeof r?r.call(e,{"name":"formHeading","hash":{}}):r))+'\r\n</div>\r\n<div class="cs-ml-form-container">\r\n'+(null!=(l=i.each.call(e,null!=e?e.languages:e,{"name":"each","hash":{},"fn":this.program(1,s,0,n,o),"inverse":this.noop}))?l:"")+"</div>"},"useDepths":!0});return t.registerPartial("csui_dialogs_multilingual.text.picker_impl_multilingual.form",s),s}),csui.define("css!csui/dialogs/multilingual.text.picker/impl/multilingual.form",[],function(){}),csui.define("csui/dialogs/multilingual.text.picker/impl/multilingual.form.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/controls/form/impl/fields/csformfield.view","csui/utils/contexts/factories/connector","csui/dialogs/multilingual.text.picker/languages","i18n!csui/dialogs/multilingual.text.picker/impl/nls/lang","hbs!csui/dialogs/multilingual.text.picker/impl/multilingual.form","css!csui/dialogs/multilingual.text.picker/impl/multilingual.form","csui/lib/binf/js/binf","csui/lib/handlebars.helpers.xif"],function(e,i,t,s,n,o,l,r,a){var c=csui.require.s.contexts._.config.config.i18n,u=c.locale||"en-US",d=c&&c.loadableLocales;return d||(d[u]=!0),s.LayoutView.extend({"template":a,"className":"cs-multilingual-form","templateHelpers":function(){return{"formHeading":r.formHeading,"languages":this.languages,"data":this.data}},"constructor":function(i){s.LayoutView.apply(this,arguments),this._prepareLanguages(),this.data=e.extend({},i.data||{})},"_prepareLanguages":function(){this.languages=e.map(d,function(i,t){return e.defaults({},l[t],{"LanguageCode":t,"LanguageName":t,"LanguageNameLocal":t})})},"getData":function(){var i=this,t=this.data;return e.each(this.languages,function(e){t[e.LanguageCode]=i.$el.find("#input-"+e.LanguageCode).val()}),t}})}),csui.define("csui/dialogs/multilingual.text.picker/multilingual.text.picker",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/controls/dialog/dialog.view","i18n!csui/dialogs/multilingual.text.picker/impl/nls/lang","csui/dialogs/multilingual.text.picker/impl/multilingual.form.view","csui/utils/log","csui/lib/binf/js/binf","csui/lib/handlebars.helpers.xif"],function(e,i,t,s,n,o,l,r){function a(i){i||(i={}),this.options=e.defaults(i,c)}var c={"dialogTitle":o.dialogTitle};return e.extend(a.prototype,{"show":function(){return this._showDialog(),this._deferred=i.Deferred(),this._deferred.promise()},"_showDialog":function(){this._view=this._createMultilingualForm(),this._dialog=this._createDialog(),this._dialog.show()},"_createMultilingualForm":function(){return new l(this.options)},"_createDialog":function(){var i=this.options,t=new n({"title":i.dialogTitle,"view":this._view,"midSize":!0,"className":"cs-multilingual-picker","attributes":{"aria-label":i.dialogTitle},"buttons":[{"id":"done","label":o.btnDone,"default":!0,"disabled":!1,"click":e.bind(this._onClickDoneButton,this,status)},{"id":"cancel","label":o.btnCancel,"close":!0,"click":e.bind(this.onClickCancelButton,this)}]});return t.listenTo(t,"hide",e.bind(this._onHideDialog,this)),t},"_onClickDoneButton":function(){this._result=this._view.getData(),this._dialog.destroy()},"onClickCancelButton":function(){},"_onHideDialog":function(){this._deferred&&(this._result?this._deferred.resolve(this._view.getData()):"pending"===this._deferred.state()&&this._deferred.reject({"cancelled":!0}))}}),a}),csui.define("csui/dialogs/node.picker/start.locations/location.base.factory",["csui/lib/underscore","csui/lib/backbone"],function(e,i){"use strict";function t(e){this.options=e||{}}return e.extend(t.prototype,{"updateLocationModel":function(e){},"getLocationParameters":function(){return{"container":null,"collection":null,"locationName":""}}}),t.extend=i.View.extend,t}),csui.define("csui/dialogs/node.picker/start.locations/node.base.factory",["csui/lib/jquery","csui/lib/underscore","csui/dialogs/node.picker/start.locations/location.base.factory","csui/models/node/node.model","csui/models/nodechildren","csui/utils/commands"],function(e,i,t,s,n,o){"use strict";return t.extend({"constructor":function(e){t.prototype.constructor.apply(this,arguments),this.container=new s(this.options.node,{"connector":this.options.connector})},"updateLocationModel":function(i){var t=this,s=e.Deferred();return this.container.fetch().then(function(){i.set({"name":t.container.get("name")||t.options.defaultName,"icon":t.options.icon,"invalid":!1,"selectable":t.options.selectable}),s.resolve()},function(){i.set({"invalid":!0}),i.collection.remove(i),s.reject()}),s.promise()},"getLocationParameters":function(){var e=new n(void 0,{"node":this.container,"autoreset":!0,"expand":["node"],"orderBy":"name asc","commands":o.getAllSignatures()});return this.container.set("unselectable",this.options.unselectable),{"container":this.container,"collection":e}}})}),csui.define("csui/dialogs/node.picker/start.locations/current.location/current.location.factory",["csui/lib/underscore","csui/lib/jquery","csui/dialogs/node.picker/start.locations/location.base.factory","csui/models/nodechildren","csui/utils/commands","i18n!csui/dialogs/node.picker/start.locations/impl/nls/lang"],function(e,i,t,s,n,o){"use strict";return t.extend({"updateLocationModel":function(e){var t=this.options.container;return e.set({"name":o.labelCurrentLocation,"icon":"location","invalid":!(t&&t.isFetchable())}),i.Deferred().resolve().promise()},"getLocationParameters":function(){var e=this.options.container,i=new s(void 0,{"node":this.options.container,"autoreset":!0,"expand":["node"],"orderBy":"name asc","commands":n.getAllSignatures()});return e.set("unselectable",!1),{"container":e,"collection":i,"locationName":o.labelCurrentLocation}}})}),csui.define("csui/dialogs/node.picker/start.locations/enterprise.volume/enterprise.volume.factory",["csui/lib/underscore","csui/dialogs/node.picker/start.locations/node.base.factory","i18n!csui/dialogs/node.picker/start.locations/impl/nls/lang"],function(e,i,t){"use strict";return i.extend({"constructor":function(s){s=e.defaults({"node":{"id":"volume","type":141},"icon":"enterprise","unselectable":!1,"defaultName":t.labelEnterpriseVolume},s),i.prototype.constructor.call(this,s)}})}),csui.define("csui/dialogs/node.picker/start.locations/favorites/impl/favorite.collection",["csui/lib/underscore","csui/lib/backbone","csui/utils/url","csui/models/node/node.model","csui/models/mixins/connectable/connectable.mixin","csui/models/mixins/fetchable/fetchable.mixin","csui/models/browsable/client-side.mixin","csui/models/browsable/v2.response.mixin"],function(e,i,t,s,n,o,l,r){"use strict";var a=i.Collection.extend({"model":s,"constructor":function(e,t){i.Collection.prototype.constructor.apply(this,arguments),
this.makeConnectable(t).makeFetchable(t).makeClientSideBrowsable(t).makeBrowsableV2Response(t)},"url":function(){var e="";if(this.orderBy){var i=this.orderBy.split(",")[0].split(" ");e=(i[1]||"asc")+"_"+i[0]}var s=this.connector.connection.url.replace("/v1","/v2"),n=t.combineQueryString({"fields":["properties","versions.element(0)"],"expand":"properties{original_id}","orderBy":e,"actions":""});return t.appendQuery(t.combine(s,"members/favorites"),n)},"parse":function(e,i){return this.parseBrowsedState(e,i),this.parseBrowsedItems(e,i)}});return l.mixin(a.prototype),r.mixin(a.prototype),n.mixin(a.prototype),o.mixin(a.prototype),a}),csui.define("csui/dialogs/node.picker/start.locations/favorites/favorites.factory",["csui/lib/underscore","csui/lib/jquery","csui/dialogs/node.picker/start.locations/location.base.factory","i18n!csui/dialogs/node.picker/start.locations/impl/nls/lang","csui/dialogs/node.picker/start.locations/favorites/impl/favorite.collection"],function(e,i,t,s,n){"use strict";return t.extend({"updateLocationModel":function(e){return e.set({"name":s.labelFavorites,"icon":"favorites"}),i.Deferred().resolve().promise()},"getLocationParameters":function(){return{"container":null,"collection":new n(void 0,{"connector":this.options.connector,"autoreset":!0,"expand":["node"]}),"locationName":s.labelFavorites}}})}),csui.define("csui/dialogs/node.picker/start.locations/personal.volume/personal.volume.factory",["csui/lib/underscore","csui/dialogs/node.picker/start.locations/node.base.factory","i18n!csui/dialogs/node.picker/start.locations/impl/nls/lang"],function(e,i,t){"use strict";return i.extend({"constructor":function(s){s=e.defaults({"node":{"id":"volume","type":142},"icon":"csui-icon-personal-volume","unselectable":!1,"defaultName":t.labelPersonalVolume},s),i.prototype.constructor.call(this,s)}})}),csui.define("csui/dialogs/node.picker/start.locations/category.volume/category.volume.factory",["csui/lib/underscore","csui/dialogs/node.picker/start.locations/node.base.factory","i18n!csui/dialogs/node.picker/start.locations/impl/nls/lang"],function(e,i,t){"use strict";return i.extend({"constructor":function(s){s=e.defaults({"node":{"id":"volume","type":133},"unselectable":!0,"icon":"csui-icon-category-volume","defaultName":t.labelCategoryVolume},s),i.prototype.constructor.call(this,s)}})}),csui.define("csui/dialogs/node.picker/start.locations/perspective.assets.volume/perspective.assets.volume.factory",["csui/lib/underscore","csui/dialogs/node.picker/start.locations/node.base.factory","i18n!csui/dialogs/node.picker/start.locations/impl/nls/lang"],function(e,i,t){"use strict";return i.extend({"constructor":function(s){s=e.defaults({"node":{"id":"volume","type":954},"unselectable":!0,"icon":"csui-icon-perspective-assets-volume","defaultName":t.labelPerspectiveAssetsVolume},s),i.prototype.constructor.call(this,s)}})}),csui.define("csui/dialogs/node.picker/start.locations/recent.containers/impl/recent.containers.collection",["module","csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/utils/url","csui/models/node/node.model","csui/models/mixins/connectable/connectable.mixin","csui/models/mixins/fetchable/fetchable.mixin","csui/models/browsable/client-side.mixin","csui/models/browsable/v2.response.mixin"],function(e,i,t,s,n,o,l,r,a,c){"use strict";var u=s.Collection.extend({"model":o,"constructor":function(e,t){i.defaults(t,{"orderBy":""}),s.Collection.prototype.constructor.call(this,e,t),this.makeConnectable(t).makeFetchable(t).makeClientSideBrowsable(t).makeBrowsableV2Response(t)},"url":function(){var e="";if(this.orderBy){var i=this.orderBy.split(",")[0].split(" ");e=(i[1]||"asc")+"_"+i[0]}var t=this.connector.connection.url.replace("/v1","/v2"),s=n.combineQueryString({"fields":["properties","versions.element(0)"],"expand":"properties{original_id}","orderBy":e,"actions":""});return n.appendQuery(n.combine(t,"members/targets"),s)},"parse":function(e,i){return this.parseBrowsedState(e,i),this.parseBrowsedItems(e,i),e.results.reverse(),e.results}});return a.mixin(u.prototype),c.mixin(u.prototype),l.mixin(u.prototype),r.mixin(u.prototype),u}),csui.define("csui/dialogs/node.picker/start.locations/recent.containers/recent.containers.factory",["csui/lib/underscore","csui/lib/jquery","csui/dialogs/node.picker/start.locations/location.base.factory","i18n!csui/dialogs/node.picker/start.locations/impl/nls/lang","csui/dialogs/node.picker/start.locations/recent.containers/impl/recent.containers.collection"],function(e,i,t,s,n){"use strict";return t.extend({"updateLocationModel":function(e){return e.set({"name":s.labelRecentContainers,"icon":"recent"}),i.Deferred().resolve().promise()},"getLocationParameters":function(){return{"container":null,"collection":new n(void 0,{"connector":this.options.connector,"autoreset":!0,"expand":["node"]}),"locationName":s.labelRecentContainers}}})}),csui.define("csui/dialogs/node.picker/start.locations/search.location/impl/search.collection",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/utils/url","csui/models/node/node.model","csui/models/mixins/connectable/connectable.mixin","csui/models/mixins/fetchable/fetchable.mixin","csui/models/browsable/browsable.mixin","csui/models/browsable/v1.request.mixin","csui/models/browsable/v2.response.mixin","csui/utils/deepClone/deepClone"],function(e,i,t,s,n,o,l,r,a,c){"use strict";var u=t.Collection.extend({"model":n,"constructor":function(e,i){this.options=i||(i={}),t.Collection.prototype.constructor.call(this,e,i),this.makeConnectable(i).makeFetchable(i).makeBrowsable(i).makeBrowsableV1Request(i).makeBrowsableV2Response(i)},"clone":function(){return new this.constructor(this.models,{"connector":this.connector,"skip":this.skipCount,"top":this.topCount,"filter":e.deepClone(this.filters),"orderBy":e.clone(this.orderBy)})}});return r.mixin(u.prototype),a.mixin(u.prototype),c.mixin(u.prototype),o.mixin(u.prototype),l.mixin(u.prototype),e.extend(u.prototype,{"isFetchable":function(){return!0},"cacheId":"","url":function(){var e=this.connector.connection.url.replace("/v1","/v2"),i=this.options.query.toJSON();return i.where="OTName:"+i.where,this.orderBy="OTName",i=s.combineQueryString(this.getBrowsableUrlQuery(),{"actions":"open","expand":"properties{parent_id}"},i),s.combine(e,"search?"+i)},"parse":function(e,i){return this.parseBrowsedState(e.collection,i),e.results.sorting=e.collection.sorting,this.cacheId=e.collection&&e.collection.searching&&e.collection.searching.cache_id?e.collection.searching.cache_id:"",this.parseBrowsedItems(e,i)}}),u}),csui.define("csui/dialogs/node.picker/start.locations/search.location/search.location.factory",["csui/lib/underscore","csui/lib/jquery","csui/dialogs/node.picker/start.locations/location.base.factory","csui/dialogs/node.picker/start.locations/search.location/impl/search.collection","csui/utils/commands","i18n!csui/dialogs/node.picker/start.locations/impl/nls/lang"],function(e,i,t,s,n,o){"use strict";return t.extend({"updateLocationModel":function(e){this.options.container;return e.set({"hide":!0,"invalid":!1}),i.Deferred().resolve().promise()},"getLocationParameters":function(e){var i=this.options.container,t=new s(void 0,e);return i&&i.set("unselectable",!1),{"container":i,"collection":t}}})}),csui.define("csui/dialogs/node.picker/start.locations/default.location/default.location.factory",["csui/lib/underscore","csui/lib/jquery","csui/dialogs/node.picker/start.locations/location.base.factory","csui/models/nodechildren","csui/utils/commands","i18n!csui/dialogs/node.picker/start.locations/impl/nls/lang"],function(e,i,t,s,n,o){"use strict";return t.extend({"updateLocationModel":function(e){this.options.container;return e.set({"hide":!0,"invalid":!1}),i.Deferred().resolve().promise()},"getLocationParameters":function(){var e=this.options.container,i=new s(void 0,{"node":this.options.container,"autoreset":!0,"expand":["node"],"orderBy":"name asc","commands":n.getAllSignatures()});return e.set("unselectable",!1),{"container":e,"collection":i,"locationName":o.labelCurrentLocation}}})}),csui.define("csui/dialogs/members.picker/start.locations/location.base.factory",["csui/lib/underscore","csui/lib/backbone"],function(e,i){"use strict";function t(e){this.options=e||{}}return e.extend(t.prototype,{"updateLocationModel":function(e){},"getLocationParameters":function(){return{"container":null,"collection":null,"locationName":""}}}),t.extend=i.View.extend,t}),csui.define("csui/dialogs/members.picker/start.locations/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/dialogs/members.picker/start.locations/impl/nls/root/lang",{"labelNoSelection":"Go to...","labelAllMembersAndGroups":"All members and groups","labelRecentGroups":"Recent groups","labelGroupWhereIamMember":"Groups where I am member","labelAllGroups":"All Groups"}),csui.define("csui/dialogs/members.picker/start.locations/current.group/current.group.factory",["csui/lib/underscore","csui/lib/jquery","csui/dialogs/node.picker/start.locations/location.base.factory","csui/models/member/membercollection","i18n!csui/dialogs/members.picker/start.locations/impl/nls/lang"],function(e,i,t,s,n){"use strict";return t.extend({"updateLocationModel":function(e){this.options.container;return e.set({"hide":!0,"invalid":!1}),i.Deferred().resolve().promise()},"getLocationParameters":function(){var e=this.options.container,i=new s(void 0,{"connector":this.options.connector,"groupId":e.groupId,"member":e});return e.set("unselectable",!1),{"container":this.options.container,"collection":i,"locationName":n.labelCurrentLocation}}})}),csui.define("csui/dialogs/members.picker/start.locations/all.members/all.members.factory",["csui/lib/underscore","csui/lib/jquery","csui/dialogs/node.picker/start.locations/location.base.factory","csui/models/member/membercollection","i18n!csui/dialogs/members.picker/start.locations/impl/nls/lang"],function(e,i,t,s,n){"use strict";return t.extend({"updateLocationModel":function(e){var t=this.options.container;return e.set({"name":n.labelAllMembersAndGroups,"icon":"member","invalid":!(t&&t.isFetchable())}),i.Deferred().resolve().promise()},"getLocationParameters":function(){var e=(this.options.container,new s(void 0,{"connector":this.options.connector}));return{"container":this.options.container,"collection":e,"locationName":n.labelCurrentLocation}}})}),csui.define("csui/dialogs/members.picker/start.locations/member.groups/member.groups.factory",["csui/lib/underscore","csui/lib/jquery","csui/dialogs/node.picker/start.locations/location.base.factory","csui/models/member/membercollection","i18n!csui/dialogs/members.picker/start.locations/impl/nls/lang"],function(e,i,t,s,n){"use strict";return t.extend({"updateLocationModel":function(e){var t=this.options.container;return e.set({"name":n.labelGroupWhereIamMember,"icon":"location","invalid":!(t&&t.isFetchable())}),i.Deferred().resolve().promise()},"getLocationParameters":function(){var e=this.options.container,i=new s(void 0,{"connector":this.options.connector,"type":"GroupsOfCurrentUser"});return e.set("unselectable",!1),{"container":this.options.container,"collection":i,"locationName":n.labelCurrentLocation}}})}),csui.define("csui/dialogs/members.picker/start.locations/recent.groups/impl/recent.groups.collection",["module","csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/utils/url","csui/models/member/member.model","csui/models/mixins/connectable/connectable.mixin","csui/models/mixins/fetchable/fetchable.mixin","csui/models/browsable/client-side.mixin","csui/models/browsable/v2.response.mixin"],function(e,i,t,s,n,o,l,r,a,c){"use strict";var u=s.Collection.extend({"model":o,"constructor":function(e,i){s.Collection.prototype.constructor.call(this,e,i),this.makeConnectable(i).makeFetchable(i).makeClientSideBrowsable(i).makeBrowsableV2Response(i)},"url":function(){var e=this.connector.connection.url.replace("/v1","/v2");return n.appendQuery(n.combine(e,"members/targets"))},"parse":function(e,i){return this.parseBrowsedState(e,i),this.parseBrowsedItems(e,i),e.results.reverse(),e.results}});return a.mixin(u.prototype),c.mixin(u.prototype),l.mixin(u.prototype),r.mixin(u.prototype),u}),csui.define("csui/dialogs/members.picker/start.locations/recent.groups/recent.groups.factory",["csui/lib/underscore","csui/lib/jquery","csui/dialogs/node.picker/start.locations/location.base.factory","csui/dialogs/members.picker/start.locations/recent.groups/impl/recent.groups.collection","csui/utils/commands","i18n!csui/dialogs/members.picker/start.locations/impl/nls/lang"],function(e,i,t,s,n,o){"use strict";return t.extend({"updateLocationModel":function(e){var t=this.options.container;return e.set({"name":o.labelRecentGroups,"icon":"recent","invalid":!(t&&t.isFetchable())}),i.Deferred().resolve().promise()},"getLocationParameters":function(){var e=this.options.container,i=new s(void 0,{"connector":this.options.connector});return e.set("unselectable",!1),{"container":this.options.container,"collection":i,"locationName":o.labelCurrentLocation}}})}),csui.define("csui/dialogs/members.picker/start.locations/all.groups/all.groups.factory",["csui/lib/underscore","csui/lib/jquery","csui/dialogs/node.picker/start.locations/location.base.factory","csui/models/member/membercollection","i18n!csui/dialogs/members.picker/start.locations/impl/nls/lang"],function(e,i,t,s,n){"use strict";return t.extend({"updateLocationModel":function(e){var t=this.options.container;return e.set({"name":n.labelAllGroups,"icon":"group","invalid":!(t&&t.isFetchable())}),i.Deferred().resolve().promise()},"getLocationParameters":function(){var e=(this.options.container,new s(void 0,{"connector":this.options.connector,"type":1}));return{"container":this.options.container,"collection":e,"locationName":n.labelCurrentLocation}}})}),csui.define("csui/dialogs/members.picker/start.locations/acl.groups/impl/acl.groups.collection",["module","csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/utils/url","csui/models/member/member.model","csui/models/mixins/connectable/connectable.mixin","csui/models/mixins/fetchable/fetchable.mixin","csui/models/browsable/client-side.mixin","csui/models/browsable/v2.response.mixin"],function(e,i,t,s,n,o,l,r,a,c){"use strict";var u=s.Collection.extend({"model":o,"constructor":function(e,i){this.options=i||{},s.Collection.prototype.constructor.call(this,e,i),this.makeConnectable(i).makeFetchable(i).makeClientSideBrowsable(i).makeBrowsableV2Response(i)},"url":function(){var e,i=n.combine(this.connector.connection.url,"nodes",this.options.nodeId);return i=i.replace("/v1","/v2"),e=n.combineQueryString({"fields":["permissions{right_id, permissions, type}"],"expand":"permissions{right_id}"},e),e&&(i+="?"+e),i},"parse":function(e,i){return this.filterGroups(e),e.aclGroups},"filterGroups":function(e){var t=e.results.data&&e.results.data.permissions,s=[];return i.each(t,function(e){if(e.right_id_expand&&1===e.right_id_expand.type){var i={};i=e.right_id_expand,i.data={},i.data.properties=e.right_id_expand,s.push(i)}}),e.aclGroups=s,e}});return a.mixin(u.prototype),c.mixin(u.prototype),l.mixin(u.prototype),r.mixin(u.prototype),u}),csui.define("csui/dialogs/members.picker/start.locations/acl.groups/acl.groups.factory",["csui/lib/underscore","csui/lib/jquery","csui/dialogs/node.picker/start.locations/location.base.factory","csui/dialogs/members.picker/start.locations/acl.groups/impl/acl.groups.collection","csui/utils/commands","i18n!csui/dialogs/members.picker/start.locations/impl/nls/lang"],function(e,i,t,s,n,o){"use strict";return t.extend({"updateLocationModel":function(e){this.options.container;return e.set({"hide":!0,"invalid":!1}),i.Deferred().resolve().promise()},"getLocationParameters":function(){var e=this.options.container,i=new s(void 0,{"connector":this.options.connector,"nodeId":this.options.nodeId});return e.set("unselectable",!1),{"container":this.options.container,"collection":i,"locationName":o.labelCurrentLocation}}})}),csui.define("csui/widgets/nodestable/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/widgets/nodestable/impl/nls/root/lang",{"columnTitleLocation":"Location","dragAndDropMessage":"Drag and drop files here to add new content.","filterExpandAria":"Show filter panel","filterCollapseAria":"Hide filter panel","filterExpandTooltip":"Show filters","filterCollapseTooltip":"Hide filters"}),csui.define("csui/utils/toolitem.masks/children.toolitems.mask",["csui/controls/toolbar/toolitems.mask","csui-ext!csui/utils/toolitem.masks/children.toolitems.mask"],function(e,i){"use strict";return i||(i=[]),e.extend({"constructor":function(i){e.prototype.constructor.apply(this),this.context=i.context,this.node=i.node,this._updateMask(),this.listenTo(this.node,"change:id",this._updateMask)},"_updateMask":function(){var e=this.restoreMask({"silent":!0});i.forEach(function(i){(i=i({"context":this.context,"node":this.node}))&&(e=this.extendMask(i,{"silent":!0})||e)},this),e&&this.trigger("update",this)}})}),csui.define("csui/utils/toolitem.masks/creation.toolitems.mask",["module","csui/controls/toolbar/toolitems.mask","csui/utils/toolitem.masks/global.toolitems.mask","csui-ext!csui/utils/toolitem.masks/creation.toolitems.mask"],function(e,i,t,s){"use strict";return s||(s=[]),i.extend({"constructor":function(s){var n=e.config(),o=new t;i.prototype.constructor.call(this,o,{"normalize":!1}),Object.keys(n).forEach(function(e){"extensions"!=e&&this.extendMask(n[e])},this),this.storeMask(),this.context=s.context,this.node=s.node,this._updateMask(),this.listenTo(this.node,"change:id",this._updateMask)},"_updateMask":function(){var e=this.restoreMask({"silent":!0});s.forEach(function(i){(i=i({"context":this.context,"node":this.node}))&&(e=this.extendMask(i,{"silent":!0})||e)},this),e&&this.trigger("update",this)},"_normalizeRule":function(e){return"object"!=typeof e&&(e="string"==typeof e?{"signature":e}:{"type":e}),e.commandData||(e={"commandData":e}),null!=e.type&&(e.commandData.type=e.type,delete e.type),e.signature||(e.signature="Add"),e}})}),csui.define("csui/controls/tabletoolbar/nls/localized.strings",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/tabletoolbar/nls/root/localized.strings",{"ToolbarItemReserve":"Reserve","ToolbarItemUnreserve":"Unreserve","ToolbarItemOriginalReserve":"Reserve original","ToolbarItemOriginalUnreserve":"Unreserve original","ToolbarItemAdvancedPermission":"Advanced permissions","MenuItemReserve":"Reserve","MenuItemUnreserve":"Unreserve","ToolbarItemThumbnail":"Grid view","ToolbarItemListView":"List view","ThumbnailTitle":"Grid view","ListViewTitle":"List view"}),csui.define("csui/widgets/nodestable/toolbaritems",["csui/lib/underscore","i18n!csui/controls/tabletoolbar/nls/localized.strings","i18n!csui/controls/tabletoolbar/impl/nls/localized.strings","csui/controls/toolbar/toolitems.factory","csui/controls/toolbar/toolitem.model","csui/widgets/favorites/favorite.star.view","csui-ext!csui/widgets/nodestable/toolbaritems"],function(e,i,t,s,n,o,l){"use strict";var r={"filterToolbar":new s({"filter":[{"signature":"Filter","name":t.ToolbarItemFilter,"icon":"icon icon-toolbarFilter","toolItemAria":t.ToolbarItemFilterAria,"toolItemAriaExpand":!1}]},{"maxItemsShown":2,"dropDownIcon":"icon icon-toolbar-more","dropDownText":t.ToolbarItemMore,"addTrailingDivider":!1}),"addToolbar":new s({"add":[]},{"maxItemsShown":0,"dropDownIcon":"icon icon-toolbarAdd","dropDownText":t.ToolbarItemAddItem,"addTrailingDivider":!1}),"leftToolbar":new s({"main":[{"signature":"CollectionCanCollect","name":t.ToolbarItemAddItem,"icon":"icon icon-toolbarAdd"}]},{"maxItemsShown":2,"dropDownIcon":"icon icon-toolbar-more","dropDownText":t.ToolbarItemMore,"addTrailingDivider":!1}),"tableHeaderToolbar":new s({"info":[{"signature":"Properties","name":t.ToolbarItemInfo,"icon":"icon icon-toolbar-metadata"}],"share":[{"signature":"CopyLink","name":t.ToolbarItemCopyLink},{"signature":"Share","name":t.ToolbarItemShare,"flyout":"share","group":"share"},{"signature":"EmailLink","name":t.ToolbarItemEmailLink,"flyout":"share","promoted":!0,"group":"share"}],"edit":[{"signature":"Edit","name":t.ToolbarItemEdit,"flyout":"edit","promoted":!0},{"signature":"EditActiveX","name":"EditActiveX","flyout":"edit"},{"signature":"EditOfficeOnline","name":"EditOfficeOnline","flyout":"edit"},{"signature":"EditWebDAV","name":"EditWebDAV","flyout":"edit"}],"main":[{"signature":"InlineEdit","name":t.ToolbarItemRename,"onlyInTouchBrowser":!0},{"signature":"permissions","name":t.ToolbarItemPermissions},{"signature":"Download","name":t.ToolbarItemDownload},{"signature":"ReserveDoc","name":i.ToolbarItemReserve},{"signature":"UnreserveDoc","name":i.ToolbarItemUnreserve},{"signature":"ZipAndDownload","name":t.MenuItemZipAndDownload},{"signature":"Copy","name":t.ToolbarItemCopy},{"signature":"Move","name":t.ToolbarItemMove},{"signature":"AddVersion","name":t.ToolbarItemAddVersion},{"signature":"Collect","name":t.ToolbarCollect},{"signature":"Delete","name":t.ToolbarItemDelete},{"signature":"RemoveCollectedItems","name":t.ToolbarItemRemoveCollectionItems}],"shortcut":[{"signature":"OriginalCopyLink","name":t.ToolbarItemOriginalCopyLink},{"signature":"OriginalEdit","name":t.ToolbarItemOriginalEdit},{"signature":"OriginalEmailLink","name":t.ToolbarItemOriginalShare},{"signature":"OriginalReserveDoc","name":i.ToolbarItemOriginalReserve},{"signature":"OriginalUnreserveDoc","name":i.ToolbarItemOriginalUnreserve},{"signature":"OriginalCopy","name":t.ToolbarItemOriginalCopy},{"signature":"OriginalMove","name":t.ToolbarItemOriginalMove},{"signature":"OriginalAddVersion","name":t.ToolbarItemAddVersion},{"signature":"OriginalDownload","name":t.ToolbarItemOriginalDownload},{"signature":"OriginalDelete","name":t.ToolbarItemOriginalDelete}]},{"maxItemsShown":15,"dropDownIcon":"icon icon-toolbar-more","dropDownText":t.ToolbarItemMore,"addGroupSeparators":!1,"lazyActions":!0}),"captionMenuToolbar":new s({"other":[{"signature":"Properties","name":t.MenuItemInformation},{"signature":"CopyLink","name":t.MenuItemCopyLink},{"signature":"EmailLink","name":t.MenuItemShare},{"signature":"permissions","name":t.ToolbarItemPermissions},{"signature":"Rename","name":t.MenuItemRename},{"signature":"Copy","name":t.MenuItemCopy},{"signature":"Move","name":t.MenuItemMove},{"signature":"Delete","name":t.MenuItemDelete},{"signature":"Collect","name":t.ToolbarCollect}]},{"maxItemsShown":0,"dropDownIcon":"icon icon-expandArrowDown"}),"inlineActionbar":new s({"info":[{"signature":"Properties","name":t.ToolbarItemInfo,"icon":"icon icon-toolbar-metadata"}],"share":[{"signature":"CopyLink","name":t.ToolbarItemCopyLink,"icon":"icon icon-toolbar-copylink"}],"edit":[{"signature":"Edit","name":t.ToolbarItemEdit,"icon":"icon icon-toolbar-edit"}],"other":[{"signature":"InlineEdit","name":t.ToolbarItemRename,"icon":"icon icon-toolbar-rename"},{"signature":"permissions","name":t.ToolbarItemPermissions,"icon":"icon icon-toolbar-permissions"},{"signature":"Download","name":t.ToolbarItemDownload,"icon":"icon icon-toolbar-download"},{"signature":"ReserveDoc","name":i.ToolbarItemReserve,"icon":"icon icon-toolbar-reserve"},{"signature":"ZipAndDownload","name":t.MenuItemZipAndDownload,"icon":"icon icon-toolbar-download"},{"signature":"UnreserveDoc","name":i.ToolbarItemUnreserve,"icon":"icon icon-toolbar-unreserve"},{"signature":"Copy","name":t.ToolbarItemCopy,"icon":"icon icon-toolbar-copy"},{"signature":"Move","name":t.ToolbarItemMove,"icon":"icon icon-toolbar-move"},{"signature":"AddVersion","name":t.ToolbarItemAddVersion,"icon":"icon icon-toolbar-add-version"},{"signature":"Delete","name":t.ToolbarItemDelete,"icon":"icon icon-toolbar-delete"},{"signature":"Collect","name":t.ToolbarCollect,"icon":"icon-toolbar-collect binf-glyphicon binf-glyphicon-shopping-cart"},{"signature":"RemoveCollectedItems","name":t.ToolbarItemRemoveCollectionItems,"icon":"icon icon-toolbar-remove-collection-items"}]},{"maxItemsShown":5,"dropDownText":t.ToolbarItemMore,"dropDownIcon":"icon icon-toolbar-more","addGroupSeparators":!1}),"rightToolbar":new s({"main":[{"signature":"Thumbnail","name":t.ToolbarItemThumbnail,"icon":"icon icon-switch_thumbnails24","commandData":{"useContainer":!0},"title":t.ThumbnailTitle},{"signature":"ToggleDescription","name":t.ToolbarItemShowDescription,"icon":"icon icon-description-toggle","commandData":{"useContainer":!0}},{"signature":"Comment","name":t.ToolbarItemComment,"icon":"icon icon-socialComment","className":"esoc-socialactions-comment","customView":!0,"commandData":{"useContainer":!0}},{"signature":"Favorite2","enabled":!0,"viewClass":o,"customView":!0,"commandData":{"useContainer":!0,"viewOptions":{"focusable":!1}}},{"signature":"RestoreWidgetViewSize","name":t.ToolbarItemRestoreWidgetViewSize,"icon":"icon icon-tileCollapse","commandData":{"useContainer":!0}},{"signature":"MaximizeWidgetView","name":t.ToolbarItemMaximizeWidgetView,"icon":"icon icon-tileExpand","commandData":{"useContainer":!0}}]},{"hAlign":"right","maxItemsShown":5,"dropDownIcon":"icon icon-toolbar-more","dropDownText":t.ToolbarItemMore,"addTrailingDivider":!1})};return l&&e.each(l,function(i){e.each(i,function(i,t){var s=r[t];if(s||"otherToolbar"!==t||(s=r.tableHeaderToolbar),!s)throw new Error("Invalid target toolbar: "+t);e.each(i,function(e){e=new n(e),s.addItem(e)})})}),r}),csui.define("csui/widgets/nodestable/toolbaritems.masks",["module","csui/lib/underscore","csui/controls/toolbar/toolitems.mask","csui/utils/toolitem.masks/global.toolitems.mask"],function(e,i,t,s){"use strict";function n(){var n=e.config(),l=new s;this.toolbars=i.reduce(o,function(e,s){var o=new t(l,{"normalize":!1});return i.each(n,function(e,i){(e=e[s])&&o.extendMask(e)}),o.storeMask(),e[s]=o,e},{})}var o=["filterToolbar","leftToolbar","tableHeaderToolbar","inlineActionbar","rightToolbar"];return n.toolbars=o,n}),csui.define("csui/widgets/nodestable/headermenuitems",["csui/lib/underscore","i18n!csui/controls/tabletoolbar/impl/nls/localized.strings","csui/controls/toolbar/toolitems.factory","csui/controls/toolbar/toolitem.model","csui-ext!csui/widgets/nodestable/headermenuitems"],function(e,i,t,s,n){var o={"headerMenuToolbar":new t({"other":[{"signature":"Properties","name":i.MenuItemInformation},{"signature":"CopyLink","name":i.MenuItemCopyLink},{"signature":"EmailLink","name":i.MenuItemShare},{"signature":"permissions","name":i.ToolbarItemPermissions},{"signature":"ZipAndDownload","name":i.ToolbarItemZipAndDownload},{"signature":"Rename","name":i.MenuItemRename},{"signature":"Copy","name":i.MenuItemCopy},{"signature":"Move","name":i.MenuItemMove},{"signature":"Collect","name":i.ToolbarCollect},{"signature":"Delete","name":i.MenuItemDelete}]},{"maxItemsShown":0,"dropDownIcon":"icon icon-expandArrowDown"})};return n&&e.each(n,function(i){e.each(i,function(i,t){var n=o[t];if(!n)throw new Error("Invalid target toolbar: "+t);e.each(i,function(e){e=new s(e),n.addItem(e)})})}),o}),csui.define("csui/widgets/nodestable/headermenuitems.mask",["module","csui/lib/underscore","csui/controls/toolbar/toolitems.mask","csui/utils/toolitem.masks/global.toolitems.mask"],function(e,i,t,s){"use strict";return t.extend({"constructor":function(){var n=e.config(),o=new s;t.prototype.constructor.call(this,o,{"normalize":!1}),i.each(n,function(e,i){this.extendMask(e)},this),this.storeMask()}})}),csui.define("hbs!csui/widgets/nodestable/impl/nodestable",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){return'<div class="csui-alternating-toolbars">\r\n  <div class="csui-table-tabletoolbar"></div>\r\n  <div class="csui-table-rowselection-toolbar"></div>\r\n</div>\r\n<div class="csui-facet-table-container">\r\n  <div class="csui-table-facetview csui-facetview-hidden csui-facetview-visibility"></div>\r\n  \x3c!--outer div is needed in order to float table contents right to accommodate  facets--\x3e\r\n  <div class="csui-outertablecontainer">\r\n    \x3c!--inner div is needed in order to have tableview sized to remaining height of container--\x3e\r\n    <div class="csui-innertablecontainer">\r\n      <div class="csui-table-facetbarview"></div>\r\n      <div class="csui-table-tableview"></div>\r\n      <div class="cs-thumbnail-wrapper"></div>\r\n      <div class="csui-table-paginationview"></div>\r\n    </div>\r\n  </div>\r\n</div>\r\n'}});return t.registerPartial("csui_widgets_nodestable_impl_nodestable",s),s}),csui.define("css!csui/widgets/nodestable/impl/nodestable",[],function(){}),csui.define("csui/widgets/nodestable/nodestable.view",["module","csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/utils/log","csui/utils/base","csui/models/utils/v1tov2","csui/utils/contexts/factories/connector","csui/utils/contexts/factories/columns","csui/utils/contexts/factories/children","csui/utils/contexts/factories/columns2","csui/utils/contexts/factories/children2","csui/utils/contexts/factories/node","csui/models/node/node.addable.type.factory","csui/models/node/node.facet.factory","csui/models/node/node.model","csui/models/nodes","csui/controls/progressblocker/blocker","csui/controls/tabletoolbar/tabletoolbar.view","csui/controls/table/inlineforms/inlineform.factory","csui/controls/facet.panel/facet.panel.view","csui/controls/facet.bar/facet.bar.view","csui/controls/table/table.view","csui/controls/table/table.columns","csui/controls/table/rows/description/description.view","i18n!csui/widgets/nodestable/impl/nls/lang","i18n!csui/utils/commands/nls/localized.strings","i18n!csui/controls/table/impl/nls/lang","csui/controls/pagination/nodespagination.view","csui/behaviors/default.action/default.action.behavior","csui/utils/toolitem.masks/children.toolitems.mask","csui/utils/toolitem.masks/creation.toolitems.mask","csui/widgets/nodestable/toolbaritems","csui/widgets/nodestable/toolbaritems.masks","csui/widgets/nodestable/headermenuitems","csui/widgets/nodestable/headermenuitems.mask","csui/utils/commands","csui/controls/table.rowselection.toolbar/table.rowselection.toolbar.view","csui/controls/tableactionbar/tableactionbar.view","csui/controls/toolbar/toolbar.command.controller","csui/controls/draganddrop/draganddrop.view","csui/controls/mixins/layoutview.events.propagation/layoutview.events.propagation.mixin","csui/controls/globalmessage/globalmessage","csui/controls/thumbnail/thumbnail.view","csui/controls/thumbnail/thumbnail.content","csui/utils/dragndrop.supported.subtypes","hbs!csui/widgets/nodestable/impl/nodestable","csui/lib/jquery.redraw","css!csui/widgets/nodestable/impl/nodestable"],function(e,i,t,s,n,o,l,r,a,c,u,d,h,p,m,f,g,b,v,w,y,_,C,T,x,k,S,I,V,A,M,E,D,F,P,R,B,N,L,O,$,H,z,U,j,q,G,W){"use strict";var K=/\baccessibleTable\b(?:=([^&]*)?)?/i.exec(location.search);K=K&&"false"!==K[1];var J=e.config();t.defaults(J,{"defaultPageSize":30,"defaultPageSizes":[30,50,100],"showInlineActionBarOnHover":!K,"forceInlineActionBarOnClick":!1,"inlineActionBarStyle":"csui-table-actionbar-bubble","clearFilterOnChange":!0,"resetOrderOnChange":!1,"resetLimitOnChange":!0,"fixedFilterOnChange":!1,"useV2RestApi":!1});var X=n.LayoutView.extend({"className":function(){var e="csui-nodestable";return K&&(e+=" csui-no-animation"),e},"template":W,"ui":{"facetTableContainer":".csui-facet-table-container","outerTableContainer":".csui-outertablecontainer","innerTableContainer":".csui-innertablecontainer","tableView":".csui-table-tableview","thumbnail":".csui-thumbnail-wrapper","toolbarContainer":".csui-alternating-toolbars","facetView":".csui-table-facetview","paginationView":".csui-table-paginationview"},"regions":{"facetBarRegion":".csui-table-facetbarview","tableToolbarRegion":".csui-table-tabletoolbar","tableRowSelectionToolbarRegion":".csui-table-rowselection-toolbar","facetRegion":".csui-table-facetview","tableRegion":".csui-table-tableview","thumbnailRegion":".cs-thumbnail-wrapper","paginationRegion":".csui-table-paginationview"},"behaviors":{"DefaultAction":{"behaviorClass":M}},
"constructor":function(e){e||(e={}),t.defaults(e,{"data":{},"pageSize":J.defaultPageSize,"ddItemsList":J.defaultPageSizes,"toolbarItems":F,"headermenuItems":R,"clearFilterOnChange":J.clearFilterOnChange,"resetOrderOnChange":J.resetOrderOnChange,"resetLimitOnChange":J.resetLimitOnChange,"fixedFilterOnChange":J.fixedFilterOnChange,"showDescriptions":!1,"isDragNDropSuppoertedWidget":!0});var s=e.data.pageSize||e.pageSize,o=e.data.pageSizes||e.ddItemsList;t.contains(o,s)||(o.push(s),e.data.pageSizes=o.sort()),this.context=e.context,this.tableColumns=x.deepClone(),this.commands=e.commands||N,this.commandController=new $({"commands":this.commands}),this.listenTo(this.commandController,"before:execute:command",this._beforeExecuteCommand),this.listenTo(this.commandController,"after:execute:command",this._toolbarActionTriggered),e.connector||(e.connector=this.context.getObject(a)),this.connector=e.connector,e.toolbarItemsMasks||(e.toolbarItemsMasks=new P),e.headermenuItemsMask||(e.headermenuItemsMask=new B),v.imbue({"parent":this,"focus":!0}),n.LayoutView.prototype.constructor.call(this,e),this.onWinRefresh=t.bind(this.windowRefresh,this),i(window).bind("resize.app",this.onWinRefresh),this.propagateEventsToRegions(),this.listenTo(this,"before:regions:reinitialize",this.initialize.bind(this,this.options)).listenTo(this,"dom:refresh",this._refreshTableToolbar).listenTo(this,"enable:blocking",this._rememberFocusInTable).listenTo(this,"disable:blocking",this._restoreFocusInTable),this.isDragNDropSuppoertedWidget=e.isDragNDropSuppoertedWidget||!0},"initialize":function(e){function i(){t.each(this.options.toolbarItemsMasks.toolbars,function(e,i){e.restoreAndResetMask(this.options.childrenToolItemsMask)},this)}var s=this.defaultActionController.commands,n=this.defaultActionController.actionItems;this.options.container?this.container=this.options.container:this.options.data.containerId&&(this.container=this.context.getModel(p,{"node":{"attributes":{"id":this.options.data.containerId}}})),this.collection||(this.collection=this.context.getCollection(u,{"options":{"commands":this.defaultActionController.commands,"defaultActionCommands":n.getAllCommandSignatures(s),"delayRestCommands":!0,"node":this.container},"attributes":this.options.data.containerId?{"id":this.options.data.containerId}:void 0})),this.options.data.containerId&&!this.collection.node.get("id")&&this.collection.node.set("id",this.options.data.containerId),this.container||(this.container=e.container||this.collection.node),this.collection.delayedActions&&this.listenTo(this.collection.delayedActions,"error",function(e,i,t){var s=new l.Error(i);U.showMessage("error",s.message)}),this.columns=e.columns||this.context.getCollection(c,{"options":{"node":this.container},"attributes":this.options.data.containerId?{"id":this.options.data.containerId}:void 0}),this.addableTypes=e.addableTypes||this.context.getCollection(m,{"options":{"node":this.container},"attributes":this.options.data.containerId?{"id":this.options.data.containerId}:void 0}),this.facetFilters=e.facetFilters||this.context.getCollection(f,{"options":{"node":this.container},"attributes":this.options.data.containerId?{"id":this.options.data.containerId}:void 0,"detached":!0}),this.listenToOnce(this.context,"request",function(){this.facetFilters.fetch()}),this.container&&(this.options.childrenToolItemsMask||(this.options.childrenToolItemsMask=new E({"context":this.context,"node":this.container})),i.call(this),this.listenTo(this.options.childrenToolItemsMask,"update",i),this.options.creationToolItemsMask||(this.options.creationToolItemsMask=new D({"context":this.context,"node":this.container})),this.listenTo(this.container,"change:id",function(){var e={"container":this.container};this.commands.get("Filter").enabled(e)?this.facetFilters.clearFilter()||this.facetFilters.fetch():this.showFilter&&this._completeFilterCommand(),this._showOrHideLocationColumn(!1)}),this._showOrHideLocationColumn()),this._setFacetBarView(),this._setToolBar(),this.setTableView({"enableDragNDrop":!0}),this.setTableRowSelectionToolbar({"toolItemFactory":this.options.toolbarItems.tableHeaderToolbar,"toolbarItemsMask":this.options.toolbarItemsMasks.toolbars.tableHeaderToolbar,"showCondensedHeaderToggle":!0}),this._setTableRowSelectionToolbarEventListeners(),this.setPagination(),this.setDragNDrop(),this._updateZeroRecordsMessage()},"_setThumbnailView":function(){var e=new j({"originatingView":this,"context":this.context,"collection":this.collection,"columns":this.columns,"thumbnailColumns":this.tableView.columns,"columnsWithSearch":["name"],"orderBy":this.collection.orderBy,"filterBy":this.options.filterBy,"selectedChildren":new b,"actionItems":this.defaultActionController.actionItems,"commands":this.defaultActionController.commands,"tableColumns":q,"inlineBar":this.tableView.options.inlineBar,"blockingParentView":this,"displayedColumns":this.tableView.displayedColumns});return this.thumbnail=e,this.listenTo(this.thumbnail,"execute:defaultAction",function(e){var i={"node":e};if(this.trigger("before:defaultAction",i),!i.cancel){var t=this;this.defaultActionController.executeAction(e,{"context":this.options.context,"originatingView":this}).done(function(){t.trigger("executed:defaultAction",i)})}}),this.thumbnail.listenTo(this.thumbnail,"thumbnailItemRendered",t.bind(function(e){if(!e.target.isEventSet&&e.node.get("id")){var t=this.setDragNDrop(e);this._assignDragArea(t,i(e.target)),e.target.isEventSet=!0}},this)),!0},"setThumbnailRowSelectionToolbar":function(e){this._thumbnailRowSelectionToolbarView=new L({"toolItemFactory":e.toolItemFactory,"toolbarItemsMask":e.toolbarItemsMask,"toolbarCommandController":this.commandController,"showCondensedHeaderToggle":e.showCondensedHeaderToggle,"commands":this.defaultActionController.commands,"selectedChildren":this.thumbnail.options.selectedChildren,"container":this.collection.node,"context":this.context,"originatingView":this,"collection":this.collection});var i=this._thumbnailRowSelectionToolbarView;this.listenTo(i,"toggle:condensed:header",function(){if(this.tableToolbarRegion.$el.hasClass("csui-table-rowselection-toolbar-visible")){this.ui.toolbarContainer&&this.ui.toolbarContainer.toggleClass("csui-show-header");var e=this.ui.toolbarContainer&&this.ui.toolbarContainer.hasClass("csui-show-header");e&&this.tableToolbarRegion.$el.removeClass("binf-hidden"),i.trigger("toolbar:activity",!0,e)}})},"enableThumbnailView":function(){var e=(this.tableView,this);i.Deferred(),this.container,this.context,this.originatingView;this.dragNDrop&&(this.dragNDrop.stopListeningDragEvent(".csui-innertablecontainer",this),this.dragNDrop.stopListeningDragEvent(".csui-alternating-toolbars",this)),this.thumbnailViewState?(this.tableView.selectedChildren&&this.tableView.selectedChildren.models.length>0&&(this.tableView.selectedChildren.models=[]),this._onSelectionUpdateCssClasses(this.tableView.selectedChildren.length,!0),this._setThumbnailView(),this._setThumbnailRowSelectionToolbarEventListeners()):(this._onSelectionUpdateCssClasses(this.thumbnail.options.selectedChildren.length,!0),this._setTableRowSelectionToolbarEventListeners()),1!==this.tableView.options.inlineBar.options.maxItemsShown&&(this.collection.defaultInlineMaxItemsShown=this&&this.tableView.options.inlineBar.options.maxItemsShown),this.thumbnailViewState?(this.tableView.options.inlineBar.options.maxItemsShown=1,this.$el.find("table.dataTable").addClass("csui-thumbnail-view"),this.thumbnailView=!0):(this.thumbnailView=!1,this.tableView.options.inlineBar.options.maxItemsShown=this.collection.defaultInlineMaxItemsShown,this.$el.find("table.dataTable").removeClass("csui-thumbnail-view"));var t,s=this.$el.find(".csui-table-tableview");if(t=i(this.thumbnailRegion.el)[0],t=i(t),s.is(":visible")){var o=this.collection.orderBy;this.tableView.destroy(),this.res=o.split(" "),"asc"===this.res[1]?this.collection.orderstate="icon-sortArrowDown":"desc"===this.res[1]&&(this.collection.orderstate="icon-sortArrowUp"),this.setThumbnailRowSelectionToolbar({"toolItemFactory":this.options.toolbarItems.tableHeaderToolbar,"toolbarItemsMask":this.options.toolbarItemsMasks.toolbars.tableHeaderToolbar,"showCondensedHeaderToggle":!0}),this.thumbnailRegion.show(this.thumbnail),this.setDragNDrop(),this.csuiDropMessage&&(this.csuiDropMessage.remove(),this.csuiDropMessage=void 0),this._assignDragArea(this.dragNDrop,".csui-innertablecontainer"),this._assignDragArea(this.dragNDrop,".csui-alternating-toolbars"),this.tableToolbarView.rightToolbarView&&this.tableToolbarView.rightToolbarView.collection.refilter();if(!this.thumbnail._maintainNodeState(this.collection.at(0))){var l=this.updateRowIndex;this.thumbnail._maintainNodeState(this.collection.at(l))}n.triggerMethodOn(this.thumbnail,"before:show"),this.collection&&this.collection.models&&this.collection.models.length>=0&&(0===t.length?(t=i(i(this.thumbnailRegion.el)[0]),n.triggerMethodOn(this.thumbnail,"before:show"),t.append(this.thumbnail.el),s.hide("blind",{"direction":"left","complete":function(){t.show("blind",{"direction":"right","complete":function(){n.triggerMethodOn(this.thumbnail,"show")}},100)}},100)):(s.hide("blind",{"direction":"left","complete":function(){t.show("blind",{"direction":"right","complete":function(){e.thumbnail.trigger("dom:refresh")}},100)}},100),e.thumbnail.onAfterShow()))}else{var r=this.collection.state,a=this.collection.orderBy;this.thumbnail.destroy(),this.res=a.split(" "),"asc"===this.res[1]?this.collection.orderstate="icon-sortArrowUp":"desc"===this.res[1]&&(this.collection.orderstate="icon-sortArrowDown"),this.setTableView({"enableDragNDrop":!0}),this.collection.state=r,this.collection.sorting&&this.collection.sorting.sort.length>0&&this.collection.sorting.sort[0].value&&(this.collection.sorting.sort[0].value=r),this.setTableRowSelectionToolbar({"toolItemFactory":this.options.toolbarItems.tableHeaderToolbar,"toolbarItemsMask":this.options.toolbarItemsMasks.toolbars.tableHeaderToolbar,"showCondensedHeaderToggle":!0}),!this.thumbnailViewState&&this.tableToolbarView.filterToolbarView&&(this.tableToolbarView.filterToolbarView.collection.status.thumbnailViewState=this.tableView.thumbnailView),this.tableToolbarView.rightToolbarView&&this.tableToolbarView.rightToolbarView.collection.refilter(),this.tableView.collection&&0===this.tableView.collection.length&&(this.tableView._showEmptyViewText=!0),this._updateZeroRecordsMessage(),this.tableRegion.show(this.tableView),this.setDragNDrop(),this.csuiDropMessage&&(this.csuiDropMessage.remove(),this.csuiDropMessage=void 0),this._assignDragArea(this.dragNDrop,".csui-innertablecontainer"),this._assignDragArea(this.dragNDrop,".csui-alternating-toolbars"),t.hide("blind",{"direction":"right","complete":function(){s.show("blind",{"direction":"left","complete":function(){e.tableView.triggerMethod("dom:refresh")}},100)}})}},"onDestroy":function(){i(window).unbind("resize.app",this.onWinRefresh),this.dragNDrop&&this.dragNDrop.destroy()},"windowRefresh":function(){this._isRendered&&this.isDisplayed&&this.facetView&&this.facetView.triggerMethod("dom:refresh")},"_refreshTableToolbar":function(){this.tableToolbarView&&this.tableToolbarView.rightToolbarView&&this.tableToolbarView.rightToolbarView.collection.refilter()},"onRender":function(){this.facetBarView&&this.facetBarRegion.show(this.facetBarView),this.tableToolbarRegion.show(this.tableToolbarView),this.tableRowSelectionToolbarRegion&&(!this.thumbnailView&&this._tableRowSelectionToolbarView?this.tableRowSelectionToolbarRegion.show(this._tableRowSelectionToolbarView):this._thumbnailRowSelectionToolbarView&&this.tableRowSelectionToolbarRegion.show(this._thumbnailRowSelectionToolbarView),this.tableRowSelectionToolbarRegion.$el.find("ul").attr("aria-label",V.selectedItemActionBarAria)),this.facetView&&this.facetRegion.show(this.facetView),this.tableRegion.show(this.tableView),this.paginationRegion.show(this.paginationView),this._assignDragArea(this.dragNDrop,".csui-innertablecontainer"),this._assignDragArea(this.dragNDrop,".csui-alternating-toolbars"),this.listenTo(this,"csui.description.toggled",function(e){this.tableView.showDetailRowDescriptions(e.showDescriptions),this.tableView.trigger("update:scrollbar")}),this.addFilterCommandAria()},"onShow":function(){t.each(this.regionManager._regions,function(e){e.currentView&&e.currentView.triggerMethod("show")})},"onAfterShow":function(){t.each(this.regionManager._regions,function(e){e.currentView&&e.currentView.triggerMethod("after:show")})},"getSelectedNodes":function(){return new b(this.tableView.getSelectedChildren())},"setActionBarEvents":function(){o.warn("The method 'setActionBarEvents' has been deprecated and will be removed.")&&console.warn(o.last)},"_updateToolItems":function(){o.warn("The method '_updateToolItems' has been deprecated and will be removed.")&&console.warn(o.last)},"setDragNDrop":function(e){function t(e){return-1!==i.inArray(e.get("type"),G)}var s=e&&e.node,n=function(e){return(!e||!e.get("type")||144!==e.get("type")||!l.isSafari()&&!l.isIE11())&&(e&&e.get("id")&&t(e))}(s),o=this.options.context,r=n?e.target:this,a=n?s:this.container,c=n?r:".csui-innertablecontainer";return r.dragNDrop=new H({"container":a,"collection":this.collection,"addableTypes":this.addableTypes,"context":o,"highlightedTarget":c,"originatingView":this,"isSupportedRowView":n}),this.listenTo(r.dragNDrop,"drag:over",this._addDragDropBorder),this.listenTo(r.dragNDrop,"drag:leave",this._removeDragDropBorder),this.container&&(this.listenTo(this.container,"change:id",this._updateZeroRecordsMessage),this.listenTo(this.addableTypes,"reset",this._updateZeroRecordsMessage)),r.dragNDrop},"_updateZeroRecordsMessage":function(){this.tableView.setCustomLabels({"zeroRecords":!!this.canDragAndDrop()&&S.dragAndDropMessage})},"canDragAndDrop":function(){var e=(!this.container||899!==this.container.get("type"))&&this.dragNDrop&&this.dragNDrop.canAdd();return this.tableView.options.canDragAndDrop=e,e},"_assignDragArea":function(e,i){e&&e.setDragParentView(this,i)},"_addDragDropBorder":function(e,t){var s=t&&t.disabled?"addClass":"removeClass",n=".csui-innertablecontainer";n=t&&t.highlightedTarget?t.highlightedTarget:n,i(n).addClass("drag-over")[s]("csui-disabled")},"_removeDragDropBorder":function(e){e&&e.highlightedTarget?i(e.highlightedTarget).removeClass("drag-over"):i(".csui-innertablecontainer").removeClass("drag-over")},"setTableView":function(e){e||(e={});var s=t.extend({"context":this.options.context,"connector":this.connector,"collection":this.collection,"columns":this.columns,"tableColumns":this.tableColumns,"descriptionRowView":k,"descriptionRowViewOptions":{"firstColumnIndex":2,"lastColumnIndex":2,"showDescriptions":!K&&this.options.showDescriptions,"collapsedHeightIsOneLine":!0},"pageSize":this.options.data.pageSize||this.options.pageSize,"originatingView":this,"columnsWithSearch":["name"],"orderBy":this.collection.orderBy,"filterBy":this.options.filterBy,"actionItems":this.defaultActionController.actionItems,"commands":this.defaultActionController.commands,"blockingParentView":this,"parentView":this,"inlineBar":{"viewClass":O,"options":t.extend({"collection":this.options.toolbarItems.inlineActionbar,"toolItemsMask":this.options.toolbarItemsMasks.toolbars.inlineActionbar,"delayedActions":this.collection.delayedActions,"container":this.container,"containerCollection":this.collection},this.options.toolbarItems.inlineActionbar.options,{"inlineBarStyle":J.inlineActionBarStyle,"forceInlineBarOnClick":J.forceInlineActionBarOnClick,"showInlineBarOnHover":J.showInlineActionBarOnHover})}},e);this.tableView=new T(s),this._ensureRequestingMetadata(),this.listenTo(this.tableView,"render",function(){this.tableView.$el.append(i("<div>")[0])}),this.enableDragNDrop=!!e.enableDragNDrop,this.listenTo(this.tableView.collection,"sync",t.bind(function(){void 0!==this.showFilter&&this.addFilterCommandAria()},this)),this._setTableViewEvents()},"_ensureRequestingMetadata":function(){function e(){i.setFields("columns"),i.includeResources("metadata")}var i=this.container;i&&i.makeFieldsV2&&(e(),this.listenTo(this.tableView,"columnDefinitionsBuilt",e))},"_setTableViewEvents":function(){return this.listenTo(this.tableView,"tableRowSelected",function(){this.tableView.cancelAnyExistingInlineForm.call(this.tableView)}),this.container&&this.listenTo(this.container,"change:id",function(){this.options.fixedFilterOnChange?(this.collection.clearFilter(!1),this.collection.setFilter(this.options.fixedFilterOnChange,!1)):this.options.clearFilterOnChange&&this.collection.clearFilter(!1),this.options.resetOrderOnChange&&this.collection.resetOrder(!1),this.options.resetLimitOnChange&&this.collection.resetLimit(!1)}),this.listenTo(this.tableView.selectedChildren,"reset",function(){this.tableToolbarView&&(this.tableToolbarView.filterToolbarView.collection.status.thumbnailViewState=this.tableView.thumbnailView,this.tableRowSelectionToolbarRegion.show(this._tableRowSelectionToolbarView),this._onSelectionUpdateCssClasses(this.tableView.selectedChildren.length))}),this.listenTo(this.tableView,"execute:defaultAction",function(e){var i={"node":e};if(this.trigger("before:defaultAction",i),!i.cancel){var t=this;this.defaultActionController.executeAction(e,{"context":this.options.context,"originatingView":this}).done(function(){t.trigger("executed:defaultAction",i)})}}),this.enableDragNDrop&&this.listenTo(this.tableView,"tableRowRendered",function(e){var t=this.setDragNDrop(e);this._assignDragArea(t,i(e.target)),this._assignDragArea(t,e.expandedRows)}),!0},"_setToolBar":function(){return this.tableToolbarView=new w({"context":this.options.context,"toolbarItems":this.options.toolbarItems,"toolbarItemsMasks":this.options.toolbarItemsMasks,"headermenuItems":this.options.headermenuItems,"headermenuItemsMask":this.options.headermenuItemsMask,"creationToolItemsMask":this.options.creationToolItemsMask,"container":this.container,"collection":this.collection,"originatingView":this,"blockingParentView":this,"addableTypes":this.addableTypes,"toolbarCommandController":this.commandController}),!0},"setTableRowSelectionToolbar":function(e){this._tableRowSelectionToolbarView=new L({"toolItemFactory":e.toolItemFactory,"toolbarItemsMask":e.toolbarItemsMask,"toolbarCommandController":this.commandController,"showCondensedHeaderToggle":e.showCondensedHeaderToggle,"commands":this.defaultActionController.commands,"selectedChildren":this.tableView.selectedChildren,"container":this.collection.node,"context":this.context,"originatingView":this,"collection":this.collection});var i=this._tableRowSelectionToolbarView;this.listenTo(i,"toggle:condensed:header",function(){if(this.tableToolbarRegion.$el.hasClass("csui-table-rowselection-toolbar-visible")){this.ui.toolbarContainer&&this.ui.toolbarContainer.toggleClass("csui-show-header");var e=this.ui.toolbarContainer&&this.ui.toolbarContainer.hasClass("csui-show-header");e&&this.tableToolbarRegion.$el.removeClass("binf-hidden"),i.trigger("toolbar:activity",!0,e)}})},"_triggerToolbarActivityEvent":function(e,i){(this.thumbnailView?this._thumbnailRowSelectionToolbarView:this._tableRowSelectionToolbarView).trigger("toolbar:activity",e,i)},"_onSelectionUpdateCssClasses":function(e,i){function t(e,i){!0!==i&&n._triggerToolbarActivityEvent(n._tableRowSelectionToolbarVisible,e),n._tableRowSelectionToolbarVisible?e||n.tableToolbarRegion.$el.addClass("binf-hidden"):n.tableRowSelectionToolbarRegion.$el.addClass("binf-hidden")}var s,n=this,o=this.tableRowSelectionToolbarRegion.$el;K?e>0?this._tableRowSelectionToolbarVisible||(this._tableRowSelectionToolbarVisible=!0,this.tableToolbarRegion.$el.addClass("csui-table-rowselection-toolbar-visible"),o.removeClass("binf-hidden"),o.addClass("csui-table-rowselection-toolbar-visible"),s=this.ui.toolbarContainer&&this.ui.toolbarContainer.hasClass("csui-show-header"),t(s)):this._tableRowSelectionToolbarVisible&&(this._tableRowSelectionToolbarVisible=!1,this.ui.toolbarContainer&&this.ui.toolbarContainer.removeClass("csui-show-header"),this.tableToolbarRegion.$el.removeClass("binf-hidden"),this.tableToolbarRegion.currentView.trigger(this.tableToolbarRegion.currentView,"dom:refresh"),this.tableToolbarRegion.$el.removeClass("csui-table-rowselection-toolbar-visible"),o.removeClass("csui-table-rowselection-toolbar-visible"),t(!1,i)):e>0?this._tableRowSelectionToolbarVisible||(this._tableRowSelectionToolbarVisible=!0,s=this.ui.toolbarContainer&&this.ui.toolbarContainer.hasClass("csui-show-header"),o.removeClass("binf-hidden").redraw().one("transitionend",function(){t(s)}.bind(this)).addClass("csui-table-rowselection-toolbar-visible"),this.tableToolbarRegion.$el.addClass("csui-table-rowselection-toolbar-visible")):this._tableRowSelectionToolbarVisible&&(this._tableRowSelectionToolbarVisible=!1,this.ui.toolbarContainer&&this.ui.toolbarContainer.removeClass("csui-show-header"),this.tableToolbarRegion.$el.removeClass("binf-hidden").redraw(),this.tableToolbarRegion.currentView.trigger(this.tableToolbarRegion.currentView,"dom:refresh"),o.one("transitionend",function(){t(!1,i)}.bind(this)).removeClass("csui-table-rowselection-toolbar-visible"),this.tableToolbarRegion.$el.removeClass("csui-table-rowselection-toolbar-visible"))},"_setTableRowSelectionToolbarEventListeners":function(){this.listenTo(this.tableView.selectedChildren,"reset",function(){this.tableToolbarView.filterToolbarView.collection.status.thumbnailViewState=this.thumbnailView,this.tableRowSelectionToolbarRegion.show(this._tableRowSelectionToolbarView),this._onSelectionUpdateCssClasses(this.tableView.selectedChildren.length)})},"_setCommonRowSelectionToolbarEventListeners":function(e){this.listenTo(e,"reset",function(){this.tableToolbarView.filterToolbarView.collection.status.thumbnailViewState=this.thumbnailView,this.tableRowSelectionToolbarRegion.show(this._tableRowSelectionToolbarView),this._onSelectionUpdateCssClasses(e.length)})},"_setThumbnailRowSelectionToolbarEventListeners":function(){this.listenTo(this.thumbnail.options.selectedChildren,"reset",function(){this.tableToolbarView.filterToolbarView.collection.status.thumbnailViewState=this.thumbnailView,this.tableRowSelectionToolbarRegion.show(this._thumbnailRowSelectionToolbarView),this._onSelectionUpdateCssClasses(this.thumbnail.options.selectedChildren.length)})},"setPagination":function(){return this.paginationView=new A({"collection":this.collection,"pageSize":this.options.data.pageSize||this.options.pageSize,"defaultDDList":this.options.data.pageSizes||this.options.ddItemsList}),!0},"_handleFacetBarVisible":function(){this.facetBarView.$el.find(".csui-facet-list-bar .csui-facet-item:last a").focus()},"_handleFacetBarHidden":function(){},"_showOrHideLocationColumn":function(e){var i=this.container&&this.container.get("type");e=!!e||!!i&&(899===i||298===i);var t={"properties":["parent_id"]};this.useV2RestApi||(t=r.expandsV2toV1(t)),e?this.tableColumns.get("parent_id")||(this.tableColumns.add([{"key":"parent_id","title":S.columnTitleLocation,"sequence":800,"permanentColumn":!1}]),this.collection.setExpand(t)):(this.tableColumns.remove("parent_id"),this.collection.resetExpand(t))},"_ensureFacetPanelViewDisplayed":function(){void 0===this.facetView&&(this._setFacetPanelView(),this.facetRegion.show(this.facetView))},"_setFacetPanelView":function(){this.facetView=new _({"collection":this.facetFilters,"blockingLocal":!0}),this.listenTo(this.facetView,"remove:filter",this._removeFacetFilter).listenTo(this.facetView,"remove:all",this._removeAll).listenTo(this.facetView,"apply:filter",this._addToFacetFilter).listenTo(this.facetView,"apply:all",this._setFacetFilter)},"_removeFacetPanelView":function(){this.thumbnailViewState&&this.thumbnail._adjustThumbnailWidth(),this.facetRegion.empty(),this.facetView=void 0},"_setFacetBarView":function(){this.facetBarView=new C({"collection":this.facetFilters,"context":this.options.context,"showSaveFilter":!0}),this.listenTo(this.facetBarView,"remove:filter",this._removeFacetFilter).listenTo(this.facetBarView,"remove:all",this._removeAll).listenTo(this.facetBarView,"facet:bar:visible",this._handleFacetBarVisible).listenTo(this.facetBarView,"facet:bar:hidden",this._handleFacetBarHidden)},"_addToFacetFilter":function(e){this.facetFilters.addFilter(e);var i=this.facetFilters.getFilterQueryValue();this._showOrHideLocationColumn(!0),this.collection.resetLimit(!1),this.collection.setFilter({"facet":i})},"_setFacetFilter":function(e){this.facetFilters.setFilter(e);var i=this.facetFilters.getFilterQueryValue();this._showOrHideLocationColumn(!0),this.collection.resetLimit(!1),this.collection.setFilter({"facet":i})},"_removeFacetFilter":function(e){this.facetFilters.removeFilter(e);var i=this.facetFilters.getFilterQueryValue(),t=0!==i.length;this.collection.resetLimit(!1),this.collection.setFilter({"facet":i}),this._showOrHideLocationColumn(t)},"_removeAll":function(){this.facetFilters.clearFilter(),this.collection.resetLimit(!1),this.collection.setFilter({"facet":[]}),this._showOrHideLocationColumn(!1)},"_beforeExecuteCommand":function(e){e&&"Thumbnail"!==e.commandSignature&&!this.thumbnailViewState?this.tableView.cancelAnyExistingInlineForm.call(this.tableView):e&&"Thumbnail"!==e.commandSignature&&this.thumbnailViewState&&this.thumbnail.cancelAnyExistingInlineForm.call(this.thumbnail),"Delete"===e.commandSignature&&(this.deletingNodes=!0,this.tableView.setDeletingNodesState(!0))},"_toolbarActionTriggered":function(e){if(e&&!e.cancelled){if(e.status.forwardToTable){var i=y.getInlineFormView(e.addableType);i&&(e.newNodes[0].error||(this.thumbnailView?this.thumbnail.startCreateNewModel(e.newNodes[0],i):this.tableView.startCreateNewModel(e.newNodes[0],i)))}switch(e.command&&e.command.allowCollectionRefetch&&"Delete"!==e.commandSignature&&this.collection.fetch(),e.commandSignature){case"Delete":this.deletingNodes=!1,this.tableView.setDeletingNodesState(!1),this.collection.fetch();break;case"Filter":this._completeFilterCommand();break;case"MaximizeWidgetView":case"RestoreWidgetViewSize":this.tableToolbarView.rightToolbarView.collection.refilter();break;case"Thumbnail":this.thumbnailViewState=!this.thumbnailViewState||!this.thumbnailViewState,this.enableThumbnailView()}}},"_transitionEnd":t.once(function(){var e,i={"transition":"transitionend","WebkitTransition":"webkitTransitionEnd","MozTransition":"transitionend","OTransition":"oTransitionEnd otransitionend"},t=document.createElement("div");for(e in i)if(void 0!==t.style[e])return i[e]}),"_completeFilterCommand":function(){var e=this;this.showFilter=!this.showFilter,this.showFilter?(this._ensureFacetPanelViewDisplayed(),this.ui.facetView.removeClass("csui-facetview-visibility"),K?(this.ui.facetView.removeClass("csui-facetview-hidden"),this.triggerMethod("dom:refresh")):this.ui.facetView.one(this._transitionEnd(),function(){e.triggerMethod("dom:refresh"),e.thumbnailViewState&&e.thumbnail._adjustThumbnailWidth()}).removeClass("csui-facetview-hidden")):K?(this.ui.facetView.addClass("csui-facetview-hidden"),this.triggerMethod("dom:refresh"),this.ui.facetView.hasClass("csui-facetview-hidden")&&this.ui.facetView.addClass("csui-facetview-visibility"),this._removeFacetPanelView()):this.ui.facetView.one(this._transitionEnd(),function(){e.triggerMethod("dom:refresh"),e.ui.facetView.hasClass("csui-facetview-hidden")&&e.ui.facetView.addClass("csui-facetview-visibility"),e._removeFacetPanelView()}).addClass("csui-facetview-hidden"),this.addFilterCommandAria()},"addFilterCommandAria":function(){if(this.tableToolbarView&&this.tableToolbarView.filterToolbarView){var e=this.tableToolbarView.filterToolbarView.$el.find(".csui-toolitem");e.removeAttr("aria-expanded"),this.ui.facetView.hasClass("csui-facetview-hidden")?(e.attr("aria-label",S.filterExpandAria),e.attr("title",S.filterExpandTooltip),e.find("span.icon").removeClass("icon-toolbarFilterCollapse")):(e.attr("aria-label",S.filterCollapseAria),e.attr("title",S.filterCollapseTooltip),e.find("span.icon").addClass("icon-toolbarFilterCollapse"))}},"_rememberFocusInTable":function(){this.tableView.el.contains(document.activeElement)&&(this._tableFocused=!0)},"_restoreFocusInTable":function(){this._tableFocused&&this.tableView.currentlyFocusedElement()&&this.tableView.currentlyFocusedElement().focus()}},{"useV2RestApi":J.useV2RestApi});return t.extend(X.prototype,z),X.prototype._eventsToPropagateToRegions.push("global.alert.inprogress","global.alert.completed"),X.useV2RestApi&&(u=h,c=d),X}),csui.define("hbs!csui/integration/folderbrowser/impl/folderbrowser",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){return'\r\n<div id="csui-folderbrowser-core">\r\n\r\n  <div class="csui-fb-breadcrumbs"></div>\r\n  <div class="csui-fb-nodestable "></div>\r\n</div>'}});return t.registerPartial("csui_integration_folderbrowser_impl_folderbrowser",s),s}),csui.define("css!csui/integration/folderbrowser/impl/folderbrowser",[],function(){}),csui.define("csui/integration/folderbrowser/impl/folderbrowser.view",["module","require","csui/lib/jquery","csui/lib/underscore","csui/lib/marionette","csui/utils/log","csui/utils/contexts/page/page.context","csui/utils/contexts/factories/connector","csui/utils/contexts/factories/node","csui/utils/contexts/factories/next.node","csui/utils/contexts/factories/user","csui/utils/contexts/factories/children","csui/utils/contexts/factories/children2","csui/models/node/node.model","csui/utils/connector","csui/utils/base","csui/utils/contexts/factories/ancestors","csui/controls/breadcrumbs/breadcrumbs.view","csui/widgets/nodestable/nodestable.view","csui/behaviors/default.action/default.action.behavior","csui/controls/table/table.columns","csui/controls/globalmessage/globalmessage","csui/controls/mixins/layoutview.events.propagation/layoutview.events.propagation.mixin","csui/behaviors/default.action/impl/defaultaction","csui/dialogs/modal.alert/modal.alert","hbs!csui/integration/folderbrowser/impl/folderbrowser","csui/controls/iconpreload/icon.preload.view","css!csui/integration/folderbrowser/impl/folderbrowser"],function(e,i,t,s,n,o,l,r,a,c,u,d,h,p,m,f,g,b,v,w,y,_,C,T,x,k,S){"use strict";function I(e){return e.get&&e.get("id")||e.id||e}v.useV2RestApi&&(d=h);var V=n.LayoutView.extend({"className":"binf-widgets csui-folderbrowser","template":k,"regions":{"breadcrumbRegion":"#csui-folderbrowser-core div.csui-fb-breadcrumbs","nodeTableRegion":"#csui-folderbrowser-core div.csui-fb-nodestable"},"behaviors":{"DefaultAction":{"behaviorClass":w}},"constructor":function(e){e||(e={}),this.setDefaultOptions(e);var i=e.connection,t=e.connector,o=e.context||new l({"factories":{"connector":t||i&&{"connection":i}||void 0}});t||(t=o.getObject(r)),this.context=o,this.connector=t,null==e.context&&s.extend(e,{"context":this.context}),n.LayoutView.prototype.constructor.call(this,e),this.container=this._initializeContainer(o,e),this.collection=this._initializeChildCollection(o,e),this.nodesTable=this._initializeNodesTable(o,e),this.tableView=this.nodesTable.tableView,this.breadcrumbs=this._initializeBreadCrumb(this.options),this._nextNode=o.getModel(c),this.listenTo(this._nextNode,"change:id",function(){this.enterContainer(this._nextNode.attributes)}),o.getModel(u),this.prevNodeId=this.container.get("id"),null!=this.prevNodeId&&(this.contextPromise=this.container.isFetchableDirectly()?o.fetch():this.container.fetch({"silent":!0}).fail(s.bind(this.handleFetchError,this)).then(function(){return o.fetch()})),this.listenTo(o,"error",this.handleFetchError),this.propagateEventsToRegions()},"setDefaultOptions":function(e){s.defaults(e,{"breadcrumb":!0,"facetPanel":!0,"columnsFromDefinitionsOrder":!1})},"onDestroy":function(){this.nodesTable.destroy(),this.breadcrumbs&&this.breadcrumbs.destroy()},"onRender":function(){this.nodeTableRegion.show(this.nodesTable),null!=this.breadcrumbs&&(this.$el.addClass("csui-with-breadcrumb"),this.breadcrumbRegion.show(this.breadcrumbs)),S.ensureOnThePage(),
_.setMessageRegionView(this,{"classes":"csui-globalMessenger"})},"updateOptions":function(e){e&&(this.breadcrumbs&&this._updateBreadcrumbs(e),e.start&&e.start.id&&this.enterContainer(e.start.id))},"enterContainer":function(e,i){var t={"id":I(e)};return t.id!=this.prevNodeId&&(this.trigger("openingContainer",t),t.cancel?null!=i&&(i.cancel=!0):this.fetchNode(t)),this},"fetchNode":function(e){var i=this.container;return this.prevNodeId=e.id,i.set(e),this.context.fetch(),!0},"_initializeContainer":function(e,i){var t=e.getObject(a);return i.start||(i.start={"type":141}),i.start.id?p.usesIntegerId&&"string"==typeof i.start.id?t.set({"id":parseInt(i.start.id,10)}):t.set({"id":i.start.id}):i.start.type&&t.set({"id":"volume","type":i.start.type}),this._setContainerEvents(t),t},"_setContainerEvents":function(e){return this.listenTo(e,"change:id",function(e,i){this.enterContainer(e.get("id"),i)}),!0},"_initializeChildCollection":function(e,i){var t=e.getCollection(d,{"options":{"commands":this.defaultActionController.commands,"defaultActionCommands":this.defaultActionController.actionItems.getAllCommandSignatures(this.defaultActionController.commands),"delayRestCommands":!0}});return t.setLimit(0,i.pageSize,!1),t.setFilter(i.filter,!1),this.listenTo(t,"sync",function(){this._containerOpened(this.container)}),t},"_initializeNodesTable":function(e,i){var t=new v({"context":e,"pageSize":i.pageSize,"ddItemsList":i.pageSizes,"tableColumns":i.tableColumns,"clearFilterOnChange":i.clearFilterOnChange,"resetOrderOnChange":i.resetOrderOnChange,"resetLimitOnChange":i.resetLimitOnChange,"fixedFilterOnChange":i.fixedFilterOnChange});return this.listenTo(t,"executed:defaultAction",function(e){"Browse"===e.signature&&this._containerOpened(e.node)}),this.listenTo(t.tableView,"tableBodyRendered",function(e){this.trigger("tableBodyRendered",{"sender":this,"target":e.target})}),this.listenTo(t,"before:defaultAction",function(e){this._beforeDefaultAction(e)}),t},"_beforeDefaultAction":function(e){var i={"sender":this,"node":e.node};return this.trigger("executingDefaultAction",i),e.cancel=i.cancel,!0},"_containerOpened":function(e){return this.trigger("containerOpened",{"sender":this,"node":e}),!0},"updateBreadcrumb":function(e){var i=I(e);this.breadcrumbs.updateStopId(i)},"_initializeBreadCrumb":function(e){var i=null;return this.options.breadcrumb&&(s.isObject(this.options.breadcrumb)||(this.options.breadcrumb={}),i=new b({"context":e.context,"collection":e.context.getCollection(g),"stop":e.breadcrumb.stop}),e.breadcrumb.isBreadcrumbsEmpty=!0,this._setBreadcrumbEvents(i)),i},"_setBreadcrumbEvents":function(e){return this.listenTo(e,"before:defaultAction",this._beforeDefaultAction),!0},"handleFetchError":function(e){var i=new f.Error(e);this.tableView.cancelFetch(),this.tableView.renderError(),x.showError(i.message)}});return s.extend(V.prototype,C),V}),csui.define("csui/integration/folderbrowser/folderbrowser.widget",["csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/integration/folderbrowser/impl/folderbrowser.view"],function(e,i,t,s){"use strict";function n(i){this.options=i||(i={}),this.folderView=new s(i),this.listenTo(this.folderView,"containerOpened",function(e){this.trigger("containerOpened",{"sender":this,"node":e.node.toJSON()})}),this.listenTo(this.folderView,"executingDefaultAction",function(e){var i={"sender":this,"node":e.node.toJSON()};this.trigger("executingDefaultAction",i),e.cancel=i.cancel}),this.listenTo(this.folderView,"tableBodyRendered",function(e){this.trigger("tableBodyRendered",{"sender":this,"target":e.target})});var t=this.folderView.nodesTable.getSelectedNodes(),n=t.clone();this.listenTo(t,"reset",function(){var i,s;t.length>n.length?(i="childSelected",s=t.reject(function(e){return n.findWhere({"id":e.get("id")})})):(i="childUnselected",s=n.reject(function(e){return t.findWhere({"id":e.get("id")})})),s.length&&this.trigger(i,{"sender":this,"nodes":e.invoke(s,"toJSON")}),n=t.clone()})}function o(i){var s=this.folderView.contextPromise,n=this;return i||(i={}),e.extend(i,this.options),this.region=new t.Region({"el":i.placeholder}),s?s.done(function(){n.region&&n.region.show(n.folderView)}):n.region.show(n.folderView),this}function l(){return this.region&&(this.folderView.destroy(),this.region.destroy(),this.region=null),this}var r=i.Events.listenTo;return e.extend(n.prototype,i.Events,{"constructor":n,"show":o,"display":o,"destroy":l,"close":l,"enterContainer":function(e,i){return i&&i.stop&&this.folderView.updateBreadcrumb(i.stop),this.folderView.enterContainer(e),this},"getContainer":function(){return this.folderView.container.toJSON()},"getSelectedChildren":function(){return this.folderView.nodesTable.selectedNodes.toJSON()},"listenTo":function(e,i,t){return"string"==typeof e?r.call(this,this,e,i):r.call(this,e,i,t)}}),n.version="1.0",n}),csui.define("csui/integration/target.picker/target.picker",["csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/dialogs/node.picker/node.picker","csui/utils/contexts/page/page.context"],function(e,i,t,s,n){"use strict";function o(i){this.options=e.defaults({},i,l)}var l={"start":{},"selectRows":"single","filter":{},"selectable":{},"ui":{}};return e.extend(o.prototype,i.Events,{"show":function(i){i=e.defaults({},i,this.options);var t=i.connector||{"connection":i.connection},o=new n({"factories":{"connector":t}}),l=e.isEmpty(i.start)?void 0:i.start.id?i.start:{"id":"volume","type":i.start.type},r=e.isEmpty(i.selectable.type)?i.filter.type:i.selectable.type,a=new s({"context":o,"initialContainer":l,"selectMultiple":"multiple"===i.selectRows,"selectableTypes":r,"globalSearch":!0,"dialogTitle":i.ui.TargetPickerDialogTitle}),c=a.show(),u=this;return c.done(function(t){var s=t.nodes[0],n=e.invoke(t.nodes,"toJSON");u.trigger("childSelected",{"sender":u,"nodes":e.invoke(t.nodes,"toJSON"),"ancestors":[]}),i.done&&i.done({"sender":u,"node":s&&s.toJSON(),"ancestors":[],"nodes":n})}).fail(function(){i.done&&i.done({"sender":u,"nodes":[]})}),this}}),o.defaults={"containers":{"selectable":{"type":s.defaults.containers.selectableTypes},"ui":{"TargetPickerDialogTitle":s.defaults.containers.dialogTitle}},"documents":{"selectable":{"type":s.defaults.documents.selectableTypes},"ui":{"TargetPickerDialogTitle":s.defaults.documents.dialogTitle}},"categories":{"start":s.defaults.categories.initialContainer,"selectable":{"type":s.defaults.categories.selectableTypes},"ui":{"TargetPickerDialogTitle":s.defaults.categories.dialogTitle}}},o}),csui.define("csui/integration/v1.widgets.wrapper",["csui/lib/underscore","csui/utils/connector","csui/integration/folderbrowser/folderbrowser.widget","csui/integration/target.picker/target.picker"],function(e,i,t,s){var n=window.csui;return e.extend(n,{"version":"2.0","util":{"Connector":i},"widget":{"FolderBrowserWidget":t,"TargetPickerDialogWidget":s},"Connector":i,"FolderBrowserWidget":t}),n}),csui.define("csui/integration/permission.header/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/integration/permission.header/impl/nls/root/lang",{"lblSecurityClearance":"Security clearance","lblSupplementalMarkings":"Supplemental markings"}),csui.define("hbs!csui/integration/permission.header/impl/permission.header",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){var n;return'<div class="csui-permissions-rightbar-view">\r\n  <div class="csui-secuirity-clearance"><label>'+this.escapeExpression((n=null!=(n=i.lblSecurityClearance||(null!=e?e.lblSecurityClearance:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"lblSecurityClearance","hash":{}}):n))+'</label><span>Secret</span\r\n  ></div>\r\n  <div class="csui-supplimental-markings"><label>'+this.escapeExpression((n=null!=(n=i.lblSupplementalMarkings||(null!=e?e.lblSupplementalMarkings:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"lblSupplementalMarkings","hash":{}}):n))+"</label><span\r\n  >Contractor; For official use only\r\n  </span\r\n></div>\r\n</div>"}});return t.registerPartial("csui_integration_permission.header_impl_permission.header",s),s}),csui.define("css!csui/integration/permission.header/impl/permission.header",[],function(){}),csui.define("csui/integration/permission.header/permission.header.view",["module","require","csui/lib/jquery","csui/lib/underscore","csui/lib/marionette","i18n!csui/integration/permission.header/impl/nls/lang","hbs!csui/integration/permission.header/impl/permission.header","css!csui/integration/permission.header/impl/permission.header"],function(e,i,t,s,n,o,l){"use strict";return n.ItemView.extend({"template":l,"templateHelpers":function(){return{"lblSecurityClearance":o.lblSecurityClearance,"lblSupplementalMarkings":o.lblSupplementalMarkings}},"constructor":function(e){e||(e={}),n.ItemView.prototype.constructor.call(this,e)}})}),csui.define("css!csui/integration/permission/table/cells/impl/security.permission.cell",[],function(){}),csui.define("csui/integration/permission/table/cells/security.permission.cell",["csui/controls/table/cells/cell/cell.view","csui/controls/table/cells/cell.registry","css!csui/integration/permission/table/cells/impl/security.permission.cell"],function(e,i){"use strict";var t=e.extend({"renderValue":function(){var e=this.getValueText();"true"===e?this.$el.append('<span class="csui-icon icon-true icon-checkmark-green"></span>'):"false"===e?this.$el.append('<span class="csui-icon icon-false circle_delete"></span>'):this.$el.text(e)}},{"hasFixedWidth":!0});return i.registerByColumnKey("security_clearance",t),i.registerByColumnKey("supplemental_markings",t),t}),csui.define("csui/integration/permission/table/permission.table.columns",["csui/lib/underscore"],function(e){return[{"key":"security_clearance","sequence":31,"permanentColumn":!0},{"key":"supplemental_markings","sequence":32,"permanentColumn":!0}]}),csui.define("csui/integration/folderbrowser/impl/nls/folderbrowser.manifest",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/integration/folderbrowser/impl/nls/root/folderbrowser.manifest",{"BackButtonToolItem":"Go Back","PageWidgetToolItem":"Open Full Page Container"}),csui.define("css!csui/integration/folderbrowser/impl/icons",[],function(){}),csui.define("csui/integration/folderbrowser/impl/nodestable.toolitems",["csui/lib/underscore","csui/utils/base","csui/controls/toolbar/toolitems.factory","i18n!csui/integration/folderbrowser/impl/nls/folderbrowser.manifest","css!csui/integration/folderbrowser/impl/icons"],function(e,i,t,s){return{"leftToolbar":[{"signature":"Back","name":s.BackButtonToolItem,"icon":"icon arrow_back csui-icon-go-previous-node csui-no-hover-effect"}],"rightToolbar":[{"signature":"Page","name":s.PageWidgetToolItem,"icon":"icon csui-icon-open-full-page","group":"main","options":{"hAlign":"right"}}]}}),csui.define("csui/widgets/search.results/impl/search.results.factory",["csui/utils/contexts/factories/search.results.factory"],function(e){return e.extend({"constructor":function(i,t){e.prototype.constructor.apply(this,arguments),console.warn('warning: "csui/widgets/search.results/impl/search.results.factory" has been deprecated. Use "csui/utils/contexts/factories/search.results.factory')}})}),csui.define("json!csui/utils/contexts/perspective/impl/perspectives/metadata.json",{"type":"grid","options":{"rows":[{"columns":[{"sizes":{"md":12},"heights":{"xs":"full"},"widget":{"type":"csui/widgets/metadata","options":{}}}]}]}}),csui.define("json!csui/utils/contexts/perspective/impl/perspectives/metadata.navigation.json",{"type":"grid","options":{"rows":[{"columns":[{"sizes":{"md":12},"heights":{"xs":"full"},"widget":{"type":"csui/widgets/metadata.navigation","options":{}}}]}]}}),csui.define("json!csui/utils/contexts/perspective/impl/perspectives/document.overview.json",{"type":"grid","options":{"rows":[{"columns":[{"sizes":{"md":12},"heights":{"xs":"full"},"widget":{"type":"csui/widgets/document.overview","options":{}}}]}]}}),csui.define("csui/utils/testutils/async.test.utils",["module","csui/lib/underscore","csui/lib/jquery"],function(e,i,t){function s(e,s,n){var o,l,r=t.Deferred(),a=window.jasmine?window.jasmine.DEFAULT_TIMEOUT_INTERVAL:6e4,c={},u=0;return a-=a/10,"number"==typeof n?c.interval=n:"boolean"==typeof n?c.removal=n:c=n,n=i.extend({"interval":50,"removal":!1,"length":0},c),e&&s?(o=t(e).find(s),(n.removal?o.length===n.length:o.length>n.length)?r.resolve(o):l=setInterval(function(){u+=n.interval,o=t(e).find(s),((n.removal?o.length===n.length:o.length>n.length)||u>=a)&&(clearInterval(l),r.resolve(o))},n.interval)):(console.warn("parent or child selector missing"),r.reject()),r.promise()}return{"asyncElement":s}}),csui.define("csui/widgets/favorites/toolbaritems",["csui/lib/underscore","i18n!csui/controls/tabletoolbar/nls/localized.strings","i18n!csui/controls/tabletoolbar/impl/nls/localized.strings","csui/controls/toolbar/toolitems.factory","csui/controls/toolbar/toolitem.model","csui-ext!csui/widgets/favorites/toolbaritems"],function(e,i,t,s,n,o){"use strict";var l={"tableHeaderToolbar":new s({"info":[{"signature":"Properties","name":t.ToolbarItemInfo,"icon":"icon icon-toolbar-metadata"}],"share":[{"signature":"CopyLink","name":t.ToolbarItemCopyLink},{"signature":"Share","name":t.ToolbarItemShare,"flyout":"share","group":"share"},{"signature":"EmailLink","name":t.ToolbarItemEmailLink,"flyout":"share","promoted":!0,"group":"share"}],"edit":[{"signature":"Edit","name":t.ToolbarItemEdit,"flyout":"edit","promoted":!0},{"signature":"EditActiveX","name":"EditActiveX","flyout":"edit"},{"signature":"EditOfficeOnline","name":"EditOfficeOnline","flyout":"edit"},{"signature":"EditWebDAV","name":"EditWebDAV","flyout":"edit"}],"main":[{"signature":"FavoriteRename","name":t.ToolbarItemRename,"onlyInTouchBrowser":!0},{"signature":"permissions","name":t.ToolbarItemPermissions},{"signature":"Download","name":t.ToolbarItemDownload},{"signature":"ZipAndDownload","name":t.MenuItemZipAndDownload},{"signature":"ReserveDoc","name":i.ToolbarItemReserve},{"signature":"UnreserveDoc","name":i.ToolbarItemUnreserve},{"signature":"Copy","name":t.ToolbarItemCopy},{"signature":"Move","name":t.ToolbarItemMove},{"signature":"AddVersion","name":t.ToolbarItemAddVersion},{"signature":"Collect","name":t.ToolbarCollect}],"shortcut":[{"signature":"OriginalCopyLink","name":t.ToolbarItemOriginalCopyLink},{"signature":"OriginalEdit","name":t.ToolbarItemOriginalEdit},{"signature":"OriginalEmailLink","name":t.ToolbarItemOriginalShare},{"signature":"OriginalReserveDoc","name":i.ToolbarItemOriginalReserve},{"signature":"OriginalUnreserveDoc","name":i.ToolbarItemOriginalUnreserve},{"signature":"OriginalCopy","name":t.ToolbarItemOriginalCopy},{"signature":"OriginalMove","name":t.ToolbarItemOriginalMove},{"signature":"OriginalAddVersion","name":t.ToolbarItemAddVersion},{"signature":"OriginalDownload","name":t.ToolbarItemOriginalDownload}]},{"maxItemsShown":15,"dropDownText":t.ToolbarItemMore,"dropDownIcon":"icon icon-toolbar-more","addGroupSeparators":!1,"lazyActions":!0}),"inlineActionbar":new s({"info":[{"signature":"Properties","name":t.ToolbarItemInfo,"icon":"icon icon-toolbar-metadata"}],"share":[{"signature":"CopyLink","name":t.ToolbarItemCopyLink,"icon":"icon icon-toolbar-copylink"}],"edit":[{"signature":"Edit","name":t.ToolbarItemEdit,"icon":"icon icon-toolbar-edit"}],"other":[{"signature":"permissions","name":t.ToolbarItemPermissions,"icon":"icon icon-toolbar-permissions"},{"signature":"FavoriteRename","name":t.ToolbarItemRenameFavorite,"icon":"icon icon-toolbar-rename"},{"signature":"Download","name":t.ToolbarItemDownload,"icon":"icon icon-toolbar-download"},{"signature":"ZipAndDownload","name":t.MenuItemZipAndDownload,"icon":"icon icon-toolbar-download"},{"signature":"ReserveDoc","name":i.ToolbarItemReserve,"icon":"icon icon-toolbar-reserve"},{"signature":"UnreserveDoc","name":i.ToolbarItemUnreserve,"icon":"icon icon-toolbar-unreserve"},{"signature":"Copy","name":t.ToolbarItemCopy,"icon":"icon icon-toolbar-copy"},{"signature":"Move","name":t.ToolbarItemMove,"icon":"icon icon-toolbar-move"},{"signature":"AddVersion","name":t.ToolbarItemAddVersion,"icon":"icon icon-toolbar-add-version"},{"signature":"Collect","name":t.ToolbarCollect,"icon":"icon-toolbar-collect binf-glyphicon binf-glyphicon-shopping-cart"}]},{"maxItemsShown":5,"dropDownText":t.ToolbarItemMore,"dropDownIcon":"icon icon-toolbar-more","addGroupSeparators":!1}),"dropdownMenuListInProperties":new s({"main":[{"signature":"Properties","name":t.ToolbarItemInformation},{"signature":"CopyLink","name":t.ToolbarItemCopyLink},{"signature":"Edit","name":t.ToolbarItemEdit},{"signature":"EmailLink","name":t.ToolbarItemShare},{"signature":"Download","name":t.ToolbarItemDownload},{"signature":"ReserveDoc","name":i.ToolbarItemReserve},{"signature":"UnreserveDoc","name":i.ToolbarItemUnreserve},{"signature":"Copy","name":t.ToolbarItemCopy},{"signature":"Move","name":t.ToolbarItemMove},{"signature":"AddVersion","name":t.ToolbarItemAddVersion},{"signature":"Collect","name":t.ToolbarCollect},{"signature":"permissions","name":t.ToolbarItemPermissions}],"shortcut":[{"signature":"OriginalCopyLink","name":t.ToolbarItemOriginalCopyLink},{"signature":"OriginalEdit","name":t.ToolbarItemOriginalEdit},{"signature":"OriginalEmailLink","name":t.ToolbarItemOriginalShare},{"signature":"OriginalReserveDoc","name":i.ToolbarItemOriginalReserve},{"signature":"OriginalUnreserveDoc","name":i.ToolbarItemOriginalUnreserve},{"signature":"OriginalCopy","name":t.ToolbarItemOriginalCopy},{"signature":"OriginalMove","name":t.ToolbarItemOriginalMove},{"signature":"OriginalAddVersion","name":t.ToolbarItemAddVersion},{"signature":"OriginalDownload","name":t.ToolbarItemOriginalDownload}]},{"maxItemsShown":0,"dropDownIcon":"icon icon-expandArrowDown"})};return o&&e.each(o,function(i){e.each(i,function(i,t){var s=l[t];if(s||"otherToolbar"!==t||(s=l.tableHeaderToolbar),!s)throw new Error("Invalid target toolbar: "+t);e.each(i,function(e){e=new n(e),s.addItem(e)})})}),l}),csui.define("csui/widgets/favorites/toolbaritems.masks",["module","csui/lib/underscore","csui/controls/toolbar/toolitems.mask","csui/utils/toolitem.masks/global.toolitems.mask"],function(e,i,t,s){"use strict";function n(){var n=e.config(),l=new s;this.toolbars=i.reduce(o,function(e,s){var o=new t(l,{"normalize":!1});return i.each(n,function(e,i){(e=e[s])&&o.extendMask(e)}),o.storeMask(),e[s]=o,e},{})}var o=["tableHeaderToolbar","inlineActionbar"];return n.toolbars=o,n}),csui.define("csui/widgets/recentlyaccessed/toolbaritems",["csui/lib/underscore","i18n!csui/controls/tabletoolbar/nls/localized.strings","i18n!csui/controls/tabletoolbar/impl/nls/localized.strings","csui/controls/toolbar/toolitems.factory","csui/controls/toolbar/toolitem.model","csui-ext!csui/widgets/recentlyaccessed/toolbaritems"],function(e,i,t,s,n,o){"use strict";var l={"filterToolbar":new s({"filter":[{"signature":"Filter","name":t.ToolbarItemFilter,"icon":"icon icon-toolbarFilter"}]},{"addTrailingDivider":!1}),"tableHeaderToolbar":new s({"info":[{"signature":"Properties","name":t.ToolbarItemInfo,"icon":"icon icon-toolbar-metadata"}],"share":[{"signature":"CopyLink","name":t.ToolbarItemCopyLink}],"edit":[{"signature":"Edit","name":t.ToolbarItemEdit,"flyout":"edit","promoted":!0},{"signature":"EditActiveX","name":"EditActiveX","flyout":"edit"},{"signature":"EditOfficeOnline","name":"EditOfficeOnline","flyout":"edit"},{"signature":"EditWebDAV","name":"EditWebDAV","flyout":"edit"}],"main":[{"signature":"permissions","name":t.ToolbarItemPermissions},{"signature":"Download","name":t.ToolbarItemDownload},{"signature":"ZipAndDownload","name":t.MenuItemZipAndDownload},{"signature":"ReserveDoc","name":i.ToolbarItemReserve},{"signature":"UnreserveDoc","name":i.ToolbarItemUnreserve},{"signature":"Copy","name":t.ToolbarItemCopy},{"signature":"Move","name":t.ToolbarItemMove},{"signature":"AddVersion","name":t.ToolbarItemAddVersion},{"signature":"Collect","name":t.ToolbarCollect}],"shortcut":[{"signature":"OriginalCopyLink","name":t.ToolbarItemOriginalCopyLink},{"signature":"OriginalEdit","name":t.ToolbarItemOriginalEdit},{"signature":"OriginalEmailLink","name":t.ToolbarItemOriginalShare},{"signature":"OriginalReserveDoc","name":i.ToolbarItemOriginalReserve},{"signature":"OriginalUnreserveDoc","name":i.ToolbarItemOriginalUnreserve},{"signature":"OriginalCopy","name":t.ToolbarItemOriginalCopy},{"signature":"OriginalMove","name":t.ToolbarItemOriginalMove},{"signature":"OriginalAddVersion","name":t.ToolbarItemAddVersion},{"signature":"OriginalDownload","name":t.ToolbarItemOriginalDownload}]},{"maxItemsShown":5,"dropDownIcon":"icon icon-toolbar-more","addGroupSeparators":!1}),"inlineActionbar":new s({"info":[{"signature":"Properties","name":t.ToolbarItemInfo,"icon":"icon icon-toolbar-metadata"}],"share":[{"signature":"CopyLink","name":t.ToolbarItemCopyLink,"icon":"icon icon-toolbar-copylink"},{"signature":"Share","name":t.ToolbarItemShare,"flyout":"share","group":"share"},{"signature":"EmailLink","name":t.ToolbarItemEmailLink,"flyout":"share","promoted":!0,"group":"share"}],"edit":[{"signature":"Edit","name":t.ToolbarItemEdit,"icon":"icon icon-toolbar-edit"}],"other":[{"signature":"permissions","name":t.ToolbarItemPermissions,"icon":"icon icon-toolbar-permissions"},{"signature":"Download","name":t.ToolbarItemDownload,"icon":"icon icon-toolbar-download"},{"signature":"ZipAndDownload","name":t.MenuItemZipAndDownload,"icon":"icon icon-toolbar-download"},{"signature":"ReserveDoc","name":i.ToolbarItemReserve,"icon":"icon icon-toolbar-reserve"},{"signature":"UnreserveDoc","name":i.ToolbarItemUnreserve,"icon":"icon icon-toolbar-unreserve"},{"signature":"Copy","name":t.ToolbarItemCopy,"icon":"icon icon-toolbar-copy"},{"signature":"Move","name":t.ToolbarItemMove,"icon":"icon icon-toolbar-move"},{"signature":"AddVersion","name":t.ToolbarItemAddVersion,"icon":"icon icon-toolbar-add-version"},{"signature":"Collect","name":t.ToolbarCollect,"icon":"icon-toolbar-collect binf-glyphicon binf-glyphicon-shopping-cart"}]},{"maxItemsShown":5,"dropDownText":t.ToolbarItemMore,"dropDownIcon":"icon icon-toolbar-more","addGroupSeparators":!1}),"dropdownMenuListInProperties":new s({"main":[{"signature":"Properties","name":t.ToolbarItemInformation},{"signature":"CopyLink","name":t.ToolbarItemCopyLink},{"signature":"Edit","name":t.ToolbarItemEdit},{"signature":"EmailLink","name":t.ToolbarItemShare},{"signature":"Download","name":t.ToolbarItemDownload},{"signature":"ReserveDoc","name":i.ToolbarItemReserve},{"signature":"UnreserveDoc","name":i.ToolbarItemUnreserve},{"signature":"Copy","name":t.ToolbarItemCopy},{"signature":"Move","name":t.ToolbarItemMove},{"signature":"AddVersion","name":t.ToolbarItemAddVersion},{"signature":"Collect","name":t.ToolbarCollect}],"shortcut":[{"signature":"OriginalCopyLink","name":t.ToolbarItemOriginalCopyLink},{"signature":"OriginalEdit","name":t.ToolbarItemOriginalEdit},{"signature":"OriginalEmailLink","name":t.ToolbarItemOriginalShare},{"signature":"OriginalReserveDoc","name":i.ToolbarItemOriginalReserve},{"signature":"OriginalUnreserveDoc","name":i.ToolbarItemOriginalUnreserve},{"signature":"OriginalCopy","name":t.ToolbarItemOriginalCopy},{"signature":"OriginalMove","name":t.ToolbarItemOriginalMove},{"signature":"OriginalAddVersion","name":t.ToolbarItemAddVersion},{"signature":"OriginalDownload","name":t.ToolbarItemOriginalDownload}]},{"maxItemsShown":0,"dropDownIcon":"icon icon-expandArrowDown"})};return o&&e.each(o,function(i){e.each(i,function(i,t){var s=l[t];if(s||"otherToolbar"!==t||(s=l.tableHeaderToolbar),!s)throw new Error("Invalid target toolbar: "+t);e.each(i,function(e){e=new n(e),s.addItem(e)})})}),l}),csui.define("csui/widgets/recentlyaccessed/toolbaritems.masks",["module","csui/lib/underscore","csui/controls/toolbar/toolitems.mask","csui/utils/toolitem.masks/global.toolitems.mask"],function(e,i,t,s){"use strict";function n(){var n=e.config(),l=new s;this.toolbars=i.reduce(o,function(e,s){var o=new t(l,{"normalize":!1});return i.each(n,function(e,i){(e=e[s])&&o.extendMask(e)}),o.storeMask(),e[s]=o,e},{})}var o=["tableHeaderToolbar","inlineActionbar"];return n.toolbars=o,n}),csui.define("csui/widgets/favorites/tileview.toolbaritems",["csui/lib/underscore","i18n!csui/controls/tabletoolbar/impl/nls/localized.strings","csui/controls/toolbar/toolitems.factory","csui/controls/toolbar/toolitem.model","csui-ext!csui/widgets/recentlyaccessed/tileview.toolbaritems"],function(e,i,t,s,n){"use strict";var o={"inlineActionbar":new t({"info":[{"signature":"Properties","name":i.ToolbarItemInfo,"commandData":{"dialogView":!0}}],"share":[{"signature":"CopyLink","name":i.ToolbarItemCopyLink}],"edit":[{"signature":"Edit","name":i.ToolbarItemEdit}],"other":[{"signature":"Download","name":i.ToolbarItemDownload},{"signature":"goToLocation","name":i.ToolbarGoToLocation}]},{"maxItemsShown":1,"dropDownText":i.ToolbarItemMore,"dropDownIcon":"icon icon-toolbar-more"})};return n&&function(i){e.each(i,function(i){e.each(i,function(i,t){var n=o[t];if(!n)throw new Error("Invalid target toolbar: "+t);e.each(i,function(e){e=new s(e),n.addItem(e)})})})}(n),o}),csui.define("csui/widgets/recentlyaccessed/tileview.toolbaritems",["csui/lib/underscore","i18n!csui/controls/tabletoolbar/impl/nls/localized.strings","csui/controls/toolbar/toolitems.factory","csui/controls/toolbar/toolitem.model","csui-ext!csui/widgets/recentlyaccessed/tileview.toolbaritems"],function(e,i,t,s,n){"use strict";var o={"inlineActionbar":new t({"info":[{"signature":"Properties","name":i.ToolbarItemInfo,"commandData":{"dialogView":!0}}],"share":[{"signature":"CopyLink","name":i.ToolbarItemCopyLink}],"edit":[{"signature":"Edit","name":i.ToolbarItemEdit}],"other":[{"signature":"Download","name":i.ToolbarItemDownload},{"signature":"goToLocation","name":i.ToolbarGoToLocation}]},{"maxItemsShown":1,"dropDownText":i.ToolbarItemMore,"dropDownIcon":"icon icon-toolbar-more"})};return n&&function(i){e.each(i,function(i){e.each(i,function(i,t){var n=o[t];if(!n)throw new Error("Invalid target toolbar: "+t);e.each(i,function(e){e=new s(e),n.addItem(e)})})})}(n),o}),csui.define("hbs!csui/widgets/favorites/impl/favorites2.groups.header",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){var n;return'<button title="'+this.escapeExpression((n=null!=(n=i.groupAddButtonTitle||(null!=e?e.groupAddButtonTitle:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"groupAddButtonTitle","hash":{}}):n))+'" aria-label="'+this.escapeExpression((n=null!=(n=i.groupAddButtonTitle||(null!=e?e.groupAddButtonTitle:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"groupAddButtonTitle","hash":{}}):n))+'" class="binf-btn csui-groups-header-plus">\r\n  <span class="icon icon-toolbarAdd"></span>\r\n</button><span class="csui-groups-header-text">'+this.escapeExpression((n=null!=(n=i.text||(null!=e?e.text:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"text","hash":{}}):n))+'</span>\r\n<button\r\n    class="binf-btn csui-groups-header-edit-mode csui-groups-header-edit-on">'+this.escapeExpression((n=null!=(n=i.startEditMode||(null!=e?e.startEditMode:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"startEditMode","hash":{}}):n))+'</button>\r\n<button\r\n    class="binf-btn csui-groups-header-edit-mode csui-groups-header-edit-off">'+this.escapeExpression((n=null!=(n=i.endEditMode||(null!=e?e.endEditMode:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"endEditMode","hash":{}}):n))+"</button>\r\n"}});return t.registerPartial("csui_widgets_favorites_impl_favorites2.groups.header",s),s}),csui.define("css!csui/widgets/favorites/impl/favorites2.groups.header.view",[],function(){}),csui.define("csui/widgets/favorites/impl/favorites2.groups.header.view",["module","csui/lib/marionette","i18n!csui/widgets/favorites/impl/nls/lang","hbs!csui/widgets/favorites/impl/favorites2.groups.header","css!csui/widgets/favorites/impl/favorites2.groups.header.view"],function(e,i,t,s){"use strict";return i.ItemView.extend({"className":"csui-favorite-groups-header","template":s,"initialize":function(e){this._useEditMode=e&&e.useEditMode,this._isGroupsEditing=!1},"ui":{"addButton":".csui-groups-header-plus","editModeOn":".csui-groups-header-edit-on","editModeOff":".csui-groups-header-edit-off"},"events":{"click @ui.addButton":"_addItem","click @ui.editModeOn":"_switchEditModeOn","click @ui.editModeOff":"_switchEditModeOff"},"templateHelpers":function(){return{"groupAddButtonTitle":t.groupAddButtonTitle,"text":t.groupAdd,"startEditMode":t.startEditMode,"endEditMode":t.endEditMode,"hasEditModeSwitch":this._useEditMode}},"_addItem":function(e){e.preventDefault(),e.stopPropagation(),this.triggerMethod("add:item")},"_switchEditModeOn":function(e){e.preventDefault(),e.stopPropagation(),this.triggerMethod("toggleEditMode:on")},"_switchEditModeOff":function(e){e.preventDefault(),e.stopPropagation(),this.triggerMethod("toggleEditMode:off")},"isAddEnabled":function(e){return void 0!==e&&(this._isAddEnabled=e,e?this.ui.addButton.removeClass("binf-disabled"):this.ui.addButton.addClass("binf-disabled")),!!this._isAddEnabled}})}),csui.define("hbs!csui/widgets/favorites/impl/favorites2.group",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"1":function(e,i,t,s){var n;return'  <input type="text" value="'+this.escapeExpression((n=null!=(n=i.name||(null!=e?e.name:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"name","hash":{}}):n))+'" placeholder="'+this.escapeExpression((n=null!=(n=i.namePlaceholder||(null!=e?e.namePlaceholder:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"namePlaceholder","hash":{}}):n))+'"\r\n         class="binf-flex-row binf-form-control csui-favorite-group-input-name">\r\n  <button type="button" class="binf-flex csui-btn-edit-cancel binf-btn">\r\n    <span class="icon edit-cancel" title="'+this.escapeExpression((n=null!=(n=i.EditCancelTooltip||(null!=e?e.EditCancelTooltip:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"EditCancelTooltip","hash":{}}):n))+'" aria-label="'+this.escapeExpression((n=null!=(n=i.EditCancelAria||(null!=e?e.EditCancelAria:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"EditCancelAria","hash":{}}):n))+'"></span>\r\n  </button>\r\n'},"3":function(e,i,t,s){var n;return'  <div class="csui-favorite-group-selection-marker"></div>\r\n  <div class="csui-favorite-group-draggable-handle">\r\n    <span class=" icon icon-draggable-handle"></span>\r\n  </div>\r\n  <a role="button" href="#" class="binf-flex-row csui-favorite-group-name-link" aria-label="'+this.escapeExpression((n=null!=(n=i.groupNameAria||(null!=e?e.groupNameAria:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"groupNameAria","hash":{}}):n))+'" title="'+this.escapeExpression((n=null!=(n=i.name||(null!=e?e.name:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"name","hash":{}}):n))+'"\r\n     tabindex="'+this.escapeExpression((n=null!=(n=i.tabindex||(null!=e?e.tabindex:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"tabindex","hash":{}}):n))+'">\r\n    <span class="csui-favorite-group-name">'+this.escapeExpression((n=null!=(n=i.name||(null!=e?e.name:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"name","hash":{}}):n))+'</span>\r\n  </a>\r\n  <button type="button" class="binf-btn csui-btn-action csui-btn-edit-start"\r\n          aria-label="'+this.escapeExpression((n=null!=(n=i.EditStartAria||(null!=e?e.EditStartAria:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"EditStartAria","hash":{}}):n))+'" tabindex="'+this.escapeExpression((n=null!=(n=i.tabindex||(null!=e?e.tabindex:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"tabindex","hash":{}}):n))+'">\r\n    <span class="icon icon-edit" title="'+this.escapeExpression((n=null!=(n=i.EditStartTooltip||(null!=e?e.EditStartTooltip:e))?n:i.helperMissing,
"function"==typeof n?n.call(e,{"name":"EditStartTooltip","hash":{}}):n))+'"></span>\r\n  </button>\r\n  <button type="button" class="binf-btn csui-btn-action csui-btn-delete"\r\n          aria-label="'+this.escapeExpression((n=null!=(n=i.DeleteAria||(null!=e?e.DeleteAria:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"DeleteAria","hash":{}}):n))+'" tabindex="'+this.escapeExpression((n=null!=(n=i.tabindex||(null!=e?e.tabindex:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"tabindex","hash":{}}):n))+'">\r\n    <span class="icon icon-circle-close" title="'+this.escapeExpression((n=null!=(n=i.DeleteTooltip||(null!=e?e.DeleteTooltip:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"DeleteTooltip","hash":{}}):n))+'"></span>\r\n  </button><span class="csui-favorite-group-arrow-overlay"></span>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){var n;return null!=(n=i.if.call(e,null!=e?e.isRename:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.program(3,s,0)}))?n:""}});return t.registerPartial("csui_widgets_favorites_impl_favorites2.group",s),s}),csui.define("css!csui/widgets/favorites/impl/favorites2.groups.view",[],function(){}),csui.define("csui/widgets/favorites/impl/favorites2.group.view",["module","csui/lib/jquery","csui/lib/underscore","csui/lib/marionette","csui/lib/hammer","csui/utils/log","csui/utils/base","csui/dialogs/modal.alert/modal.alert","hbs!csui/widgets/favorites/impl/favorites2.group","i18n!csui/widgets/favorites/impl/nls/lang","css!csui/widgets/favorites/impl/favorites2.groups.view"],function(e,i,t,s,n,o,l,r,a,c){"use strict";return s.ItemView.extend({"className":"csui-favorite-group","template":a,"tagName":"li","initialize":function(e){this.parent=e.parent,this.groupsView=e.groupsView,this._dragData=e.dragData,this._useEditMode=e.useEditMode,this._dragAndDropEnabled=e.dragAndDropEnabled},"ui":{"groupNameButton":".csui-favorite-group-name-link","nameInput":".csui-favorite-group-input-name","cancelButton":".csui-btn-edit-cancel","startEditButton":".csui-btn-edit-start","deleteButton":".csui-btn-delete"},"templateHelpers":function(){var e=this.model.get("name");return{"tabindex":this.model.get("isTabable")&&!this._isReadonly()?"0":"-1","isRename":this.model.get("isRename"),"name":e,"groupNameAria":e==c.fav_ungrouped?c.fav_ungroupedAria:t.str.sformat(c.favoritesGroupAria,e),"namePlaceholder":c.addFavoriteNamePlaceHolder,"EditCancelTooltip":c.addFavoriteCancelButtonLabel,"EditCancelAria":c.addFavoriteCancelButtonAria,"EditStartTooltip":c.editGroupButtonLabel,"EditStartAria":c.editGroupButtonAria,"DeleteTooltip":c.deleteGroupButtonLabel,"DeleteAria":c.deleteGroupButtonAria}},"modelEvents":{"change":"render"},"onRender":function(){var e=this.className;this.model.get("isSelected")&&(e+=" binf-active");var i=this.model.get("isSingleGroupEditing"),t=this.model.get("isRename");t&&(e+=" csui-favorite-group-rename");var s=this._isReadonly();s&&(e+=" csui-favorite-group-readonly"),this.dragStarted&&(e+=" csui-dragstarted");var n=!(s||t||i||this._useEditMode||this.dragStarted||!this._dragAndDropEnabled);this.$el.attr("draggable",n),this.$el.find("a.csui-favorite-group-name-link").attr("draggable",n),this.$el.attr("class",e),!this._useEditMode||s||t||this._assignTouchControl(),this.model.isNew()&&this.model.get("isRename")&&this._startEditing()},"onDomRefresh":function(){if(this.model.isNew()||this.model.get("isRename"))this.ui.nameInput.focus();else if(this._hasFocus&&this.isRendered){var e=this;setTimeout(function(){e.isRendered&&e._setFocus()},100)}},"onDestroy":function(){this.hammer&&this.hammer.destroy()},"_startDragOperation":function(){this._dragData.clear();var e=this.model.get("tab_id");return-1!==e&&(this._dragData.set("groupId",e),this.dragStarted=!0,!0)},"_stopDragOperation":function(){this.dragStarted=!1,this._dragData.clear(),this._removeDragline(),this._removeDragStarted()},"_moveItemsToThisGroup":function(){var e,t=this.model.get("tab_id");if(void 0!==t){if(!this.model.get("isGroupsEditing")&&this._dragData.get("favorites")&&this._dragData.get("favorites").length&&void 0!==this._dragData.get("groupId"))return e={"idSources":this._dragData.get("favorites"),"tabIdSource":this._dragData.get("groupId"),"tabIdDestination":t},this.trigger("dropped:favorite",e),e.savePromise;if(void 0!==this._dragData.get("groupId"))return e={"tabIdSource":this._dragData.get("groupId"),"tabIdDestination":t,"dropAfter":this._dropAfter},this.trigger("group:dropped",e),e.savePromise;var s=i.Deferred();return s.reject(),s.promise()}},"_selectThisGroup":function(){var e={"groupModel":this.model};this.triggerMethod("before:group:selected",e),e.cancel||this.triggerMethod("group:selected",e)},"_isReadonly":function(){return-1===this.model.get("tab_id")||this.model.get("isReadonly")},"events":{"click @ui.cancelButton":function(e){e.preventDefault(),e.stopPropagation(),this._cancelEdit()},"click @ui.startEditButton":function(e){e.preventDefault(),e.stopPropagation(),this._startEditing()},"click @ui.deleteButton":function(e){e.preventDefault(),e.stopPropagation();var i=this;r.confirmQuestion(c.deleteGroupConfirmatonText,c.deleteGroupConfirmatonTitle,{"buttons":r.OkCancel}).fail(function(){i._setFocus()}).done(function(e){i.triggerMethod("group:delete",{"model":i.model})})},"focus @ui.groupNameButton":function(e){this._hasFocus=!0,this.trigger("group:focused")},"focus @ui.startEditButton":function(e){this._hasStartEditButtonFocus=!0},"focusout @ui.startEditButton":function(e){this._hasStartEditButtonFocus=!1},"focus @ui.deleteButton":function(e){this._hasDeleteButtonFocus=!0},"focusout @ui.deleteButton":function(e){this._hasDeleteButtonFocus=!1},"keydown @ui.nameInput":function(e){switch(e.keyCode){case 13:e.preventDefault(),e.stopPropagation(),this._save();break;case 27:e.preventDefault(),e.stopPropagation(),this._cancelEdit()}},"keydown":function(e){var i=this.model.get("tab_id"),t=this.model.get("isRename"),s=l.isMacintosh();switch(e.keyCode){case 88:(s&&e.metaKey&&!e.ctrlKey||!s&&!e.metaKey&&e.ctrlKey)&&(e.preventDefault(),e.stopPropagation(),this._dragData.unset("favorites"),-1===i?this._dragData.unset("favorites"):this._dragData.set({"groupId":i}));break;case 86:if(s&&e.metaKey&&!e.ctrlKey||!s&&!e.metaKey&&e.ctrlKey){e.preventDefault(),e.stopPropagation();if(i===this._dragData.get("groupId"))return;this._dropAfter=!1;var n=this;this._moveItemsToThisGroup().then(function(){n._selectThisGroup()})}break;case 37:this._hasFocus&&!t&&(this._hasStartEditButtonFocus?(e.preventDefault(),e.stopPropagation(),this.ui.groupNameButton.focus()):this._hasDeleteButtonFocus&&(e.preventDefault(),e.stopPropagation(),this.ui.startEditButton.focus()));break;case 39:this._hasFocus&&!t&&(this._hasStartEditButtonFocus?(e.preventDefault(),e.stopPropagation(),this.ui.deleteButton.focus()):this._hasDeleteButtonFocus||(e.preventDefault(),e.stopPropagation(),this.ui.startEditButton.focus()))}},"click":function(e){if(!e.ctrlKey){if(e.preventDefault(),this.model.isNew()||this.model.get("isRename")||this.model.get("isGroupsEditing"))return;this._selectThisGroup()}},"dragstart":function(e){this._startDragOperation()&&e.originalEvent.dataTransfer.setData("text","")},"dragover":function(e){if(!this.dragStarted){var i=this.model.get("tab_id");if(void 0!==i)if(this._dragData.get("favorites")&&0!==this._dragData.get("favorites").length){if(this._dragData.get("favorites")&&this._dragData.get("favorites").length){if(this._dragData.get("groupId")===i)return;this.$el.addClass("csui-dragover"),e.preventDefault()}}else{var t=this.$el.height(),s=this.model.get("tab_id"),n=e.offsetY>t/2;this._moveNotPossible(this.model.collection,this._dragData.get("groupId"),s,n)?(this._removeDragline(),this._dropAfter=void 0,e.preventDefault()):n?-1===s?(this._removeDragline(),this._dropAfter=void 0):(void 0!==this._dropAfter&&!1!==this._dropAfter||(this._removeDragline(),this.$el.after('<div class="csui-favorite-group csui-dragline">'),this._dropAfter=!0),e.preventDefault()):(void 0!==this._dropAfter&&!0!==this._dropAfter||(this._removeDragline(),this.$el.before('<div class="csui-favorite-group csui-dragline">'),this._dropAfter=!1),e.preventDefault())}}},"drop":function(e){this.$el.removeClass("csui-dragover"),e.preventDefault(),this._moveItemsToThisGroup(),this._removeDragline()},"dragleave":function(e){this._removeDragline(),this.$el.removeClass("csui-dragover")},"dragend":function(e){e.preventDefault(),this._stopDragOperation()}},"_cancelEdit":function(){this.model.isNew()?this.triggerMethod("group:delete",{"model":this.model}):(this.model.set("isRename",!1),this.trigger("group:finished:editing"))},"_moveNotPossible":function(e,i,t,s){var n={"idSource":i,"idDestination":t,"moveAfterDestination":s};return this.trigger("group:before:dropped",n),n.cancel},"_setFocus":function(){this.ui.groupNameButton.length>0&&this.ui.groupNameButton.focus()},"_assignTouchControl":function(){this.hammer&&this.hammer.destroy();var e=this.model.get("isGroupsEditing");if(this.$el.length>0&&!e){this.hammer=new n.Manager(this.$el[0]);var i=new n.Press({"time":500});this.hammer.add([i]),this.hammer.on("press",t.bind(this._onPress,this))}},"_onPress":function(){this._startEditing()},"_startEditing":function(){this.model.set("isRename",!0),this.trigger("group:editing",{"model":this.model})},"_save":function(){var e=this.ui.nameInput.val();e&&(this.model.set("name",e),this.triggerMethod("group:changed",{"model":this.model}))},"_removeDragline":function(){this.parent.$el.find(".csui-favorite-group.csui-dragline").remove(),delete this._dropAfter},"_removeDragStarted":function(){this.parent.$el.find(".csui-dragstarted").removeClass("csui-dragstarted")}})}),csui.define("css!csui/widgets/favorites/impl/favorites2.groups.rows.view",[],function(){}),csui.define("csui/widgets/favorites/impl/favorites2.groups.rows.view",["module","csui/lib/jquery","csui/lib/marionette","csui/widgets/favorites/impl/favorites2.group.view","css!csui/widgets/favorites/impl/favorites2.groups.rows.view"],function(e,i,t,s){"use strict";return t.CollectionView.extend({"className":"csui-favorite-groups-rows","tagName":"ul","childView":s,"childViewOptions":function(){return{"parent":this,"groupsView":this.options.parent,"groupsViewStateModel":this.options.groupsViewStateModel,"dragData":this.options.dragData,"useEditMode":this._useEditMode,"dragAndDropEnabled":this.options.dragAndDropEnabled}},"initialize":function(e){this._useEditMode=e&&e.useEditMode},"events":{"focusout":function(e){e.relatedTarget&&0==i.contains(this.el,e.relatedTarget)&&this.trigger("groups:focusout")}}})}),csui.define("hbs!csui/widgets/favorites/impl/favorites2.groups.footer",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"1":function(e,i,t,s){return'    <p class="csui-groups-footer-text">'+this.escapeExpression(this.lambda(e,e))+"</p>\r\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){var n;return'<div class="csui-groups-footer-wrapper binf-hidden">\r\n'+(null!=(n=i.each.call(e,null!=e?e.texts:e,{"name":"each","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?n:"")+"</div>"}});return t.registerPartial("csui_widgets_favorites_impl_favorites2.groups.footer",s),s}),csui.define("css!csui/widgets/favorites/impl/favorites2.groups.footer.view",[],function(){}),csui.define("csui/widgets/favorites/impl/favorites2.groups.footer.view",["module","csui/lib/marionette","csui/utils/contexts/factories/favorite2groups","i18n!csui/widgets/favorites/impl/nls/lang","hbs!csui/widgets/favorites/impl/favorites2.groups.footer","css!csui/widgets/favorites/impl/favorites2.groups.footer.view"],function(e,i,t,s,n){"use strict";return i.ItemView.extend({"className":"csui-favorite-groups-footer","template":n,"initialize":function(){this.groups=this.options.groups||this.context.getCollection(t,{"detached":!0,"permanent":!0}),this.listenTo(this.groups,"reset",this._groupsChanged),this.listenTo(this.groups,"update",this._groupsChanged)},"templateHelpers":function(){return{"texts":[s.groupHint1,s.groupHint2]}},"_groupsChanged":function(){this.groups.length>1?this.$el.find(".csui-groups-footer-wrapper").addClass("binf-hidden"):this.$el.find(".csui-groups-footer-wrapper").removeClass("binf-hidden")}})}),csui.define("hbs!csui/widgets/favorites/impl/favorites2.groups",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){return'<div class="csui-favorite-groups-header-region"></div>\r\n<div class="csui-favorite-groups-rows-region binf-flex-column"></div>\r\n<div class="csui-favorite-groups-footer-region"></div>'}});return t.registerPartial("csui_widgets_favorites_impl_favorites2.groups",s),s}),csui.define("csui/widgets/favorites/impl/favorites2.groups.view",["module","csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/utils/log","csui/utils/base","csui/controls/tile/behaviors/perfect.scrolling.behavior","csui/controls/globalmessage/globalmessage","csui/utils/contexts/factories/favorite2groups","csui/models/favorite2group","csui/widgets/favorites/impl/favorites2.groups.header.view","csui/widgets/favorites/impl/favorites2.groups.rows.view","csui/widgets/favorites/impl/favorites2.groups.footer.view","csui/controls/progressblocker/blocker","i18n!csui/widgets/favorites/impl/nls/lang","hbs!csui/widgets/favorites/impl/favorites2.groups","css!csui/widgets/favorites/impl/favorites2.groups.view"],function(e,i,t,s,n,o,l,r,a,c,u,d,h,p,m,f,g){"use strict";return n.LayoutView.extend({"className":"csui-favorite-groups","template":g,"ui":{},"regions":{"headerRegion":".csui-favorite-groups-header-region","rowsRegion":".csui-favorite-groups-rows-region","footerRegion":".csui-favorite-groups-footer-region"},"behaviors":{"PerfectScrolling":{"behaviorClass":r,"contentParent":".csui-favorite-groups-rows","suppressScrollX":!0}},"constructor":function i(s){s||(s={});e.config();t.defaults(s,{}),i.__super__.constructor.call(this,s),this.options.blockingParentView?m.delegate(this,this.options.blockingParentView):m.imbue(this)},"initialize":function(){var e=this;this.collection=this.options.collection||this.context.getCollection(c,{"detached":!0,"permanent":!0}),this._useEditMode=l.isTouchBrowser(),this._isSingleGroupEditing=!1,this._isGroupsEditing=!1,this._dragData=this.options.dragData,this.options.collection&&(this.collection.fetched=!1),this.listenTo(this.collection,"reset",function(){this.collection.each(function(e,i){i>0?e.set("isTabable",!1):e.set("isTabable",!0)})}),this.headerView=new d({"useEditMode":this._useEditMode}),this.rowsView=new h({"dragData":this._dragData,"parent":this,"collection":this.collection,"sort":!0,"useEditMode":this._useEditMode,"dragAndDropEnabled":this.options.dragAndDropEnabled}),this.footerView=new p({"groups":this.collection}),this.listenTo(this.rowsView,"childview:group:focused",function(e){this._setFocusAtView(e)}),this.listenTo(this.rowsView,"groups:focusout",function(){this.$el.find(".csui-favorite-group.csui-in-focus").removeClass("csui-in-focus"),this.$el.removeClass("csui-favorite-groups-has-group-in-focus"),this.rowsView.children.each(function(e){delete e._hasFocus})}),this.listenTo(this.rowsView,"childview:before:group:selected",function(e,i){this._isSingleGroupEditing?i.cancel=!0:this.triggerMethod("before:group:selected",e)}),this.listenTo(this.rowsView,"childview:group:selected",function(e,i){this._modelOfNewlySelectedGroup(e)&&(this.triggerMethod("group:selected",e),this.selectGroup(e),this._tryReSetFocus())}),this.listenTo(this.rowsView,"childview:group:before:dropped",function(e,i){this._checkMoveNotPossible(i.idSource,i.idDestination,i.moveAfterDestination)&&(i.cancel=!0)}),this.listenTo(this.rowsView,"childview:group:dropped",function(e,i){this.triggerMethod("group:dropped",i)}),this.listenTo(this.rowsView,"childview:dropped:favorite",function(e,i){this.triggerMethod("dropped:favorite",i)}),this.listenTo(this.rowsView,"childview:group:editing",function(e,i){this._setSingleGroupEditingMode(e)}),this.listenTo(this.rowsView,"childview:group:changed",function(e,i){var t=i.model;this._saveGroup(t),this._setSingleGroupEditingMode(!1),this._setGroupsEditingMode(!1),this._tryReSetFocus()}),this.listenTo(this.rowsView,"childview:group:delete",function(i,t){var s=t.model;s.isNew()?(s.destroy(),e._setSingleGroupEditingMode(!1),e._setGroupsEditingMode(!1),e.triggerMethod("group:deleted",s)):s.destroy({"wait":!0}).then(function(){e._setSingleGroupEditingMode(!1),e._setGroupsEditingMode(!1),e.triggerMethod("group:deleted",s)}),this._tryReSetFocus()}),this.listenTo(this.rowsView,"childview:group:finished:editing",function(){this._setSingleGroupEditingMode(!1)}),this.listenTo(this.headerView,"add:item",function(e){if(!this._isSingleGroupEditing){this._isSingleGroupEditing=!0,this.headerView.isAddEnabled(!1);var i=new u({"name":"","order":1,"isRename":!0},{"connector":this.collection.connector});this.collection.add(i,{"at":0})}}),this.listenTo(this.headerView,"toggleEditMode:on",function(){this._setGroupsEditingMode(!0)}),this.listenTo(this.headerView,"toggleEditMode:off",function(){this._editingView?(this._editingView._save(),this._setSingleGroupEditingMode(!1)):this._setGroupsEditingMode(!1)})},"events":{"keydown":function(e){var i;switch(e.keyCode){case 38:if(e.preventDefault(),e.stopPropagation(),!this._isSingleGroupEditing&&void 0!==this._focusedModelIndex&&this._focusedModelIndex>0){i=this.collection.at(this._focusedModelIndex);var t=this.collection.at(this._focusedModelIndex-1),s=this.rowsView.children.findByModel(t);this._setFocusAtView(s),i.set("isTabable",!1),t.set("isTabable",!0)}break;case 40:if(e.preventDefault(),e.stopPropagation(),!this._isSingleGroupEditing&&void 0!==this._focusedModelIndex&&this._focusedModelIndex<this.collection.length-1){i=this.collection.at(this._focusedModelIndex);var n=this.collection.at(this._focusedModelIndex+1),o=this.rowsView.children.findByModel(n);this._setFocusAtView(o),i.set("isTabable",!1),n.set("isTabable",!0)}}}},"onRender":function(){this._updateGroupsCssClasses(),this.headerRegion.show(this.headerView),this.rowsRegion.show(this.rowsView),this.$el.find(".csui-favorite-groups-rows-region").attr("role","navigation").attr("aria-label",f.favoriteGroupsNavAria),this.footerRegion.show(this.footerView)},"onBeforeDestroy":function(){this._isSingleGroupEditing&&this._editingView.model.isNew()&&this._editingView.model.destroy()},"_setFocusAtView":function(e){this.rowsView.children.each(function(i){i.cid!==e.cid&&(delete i._hasFocus,i.$el.removeClass("csui-in-focus"))}),e._hasFocus=!0,e.$el.addClass("csui-in-focus"),this.$el.addClass("csui-favorite-groups-has-group-in-focus"),this._focusedModelIndex=this.collection.indexOf(e.model)},"_setFocusedByIndex":function(e){var i=this.rowsView.collection.at(e),t=this.rowsView.children.findByModel(i);this._setFocusAtView(t)},"_tryReSetFocus":function(){if(!this._isSingleGroupEditing&&void 0!==this._focusedModelIndex){var e=this.collection.at(this._focusedModelIndex);if(e){var i=this.rowsView.children.findByModel(e);i&&i._setFocus()}}},"_setGroupsEditingMode":function(e){var i=this._isGroupsEditing=e;this._updateGroupsCssClasses(),this.collection.each(function(e){e.set("isGroupsEditing",i)}),this.triggerMethod("group:any:editing",{"on":e})},"_setSingleGroupEditingMode":function(e){var i;e?(this._isSingleGroupEditing=!0,this._editingView=e,this.headerView.isAddEnabled(!1),i={"on":!0,"groupModel":e.model}):(this._editingView=void 0,this._isSingleGroupEditing=!1,this.headerView.isAddEnabled(!0),i={"on":!1});var t=this._isSingleGroupEditing;this._updateGroupsCssClasses(),this.collection.each(function(e){e.set("isSingleGroupEditing",t)}),this.triggerMethod("group:any:editing",i)},"_updateGroupsCssClasses":function(){this._useEditMode&&this.$el.addClass("csui-favorite-groups-has-groups-editing"),this._isSingleGroupEditing||this._isGroupsEditing?(this.$el.removeClass("csui-favorite-groups-editing-none"),this.$el.addClass("csui-favorite-groups-editing-any")):(this.$el.addClass("csui-favorite-groups-editing-none"),this.$el.removeClass("csui-favorite-groups-editing-any")),this._isSingleGroupEditing&&!this._isGroupsEditing?this.$el.addClass("csui-favorite-single-group-editing"):this.$el.removeClass("csui-favorite-single-group-editing"),!this._isSingleGroupEditing&&this._isGroupsEditing?this.$el.addClass("csui-favorite-groups-editing"):this.$el.removeClass("csui-favorite-groups-editing")},"_checkMoveNotPossible":function(e,i,t){var s=this.collection.get(e),n=this.collection.get(i),o=this.collection.indexOf(s),l=this.collection.indexOf(n);return o<l&&(l-=1),t&&(l+=1),o===l},"_modelOfNewlySelectedGroup":function(e){var i;return e instanceof s.Model?i=e:e instanceof s.View&&(i=e.model),!i||this.selectedGroup&&i.get("tab_id")==this.selectedGroup.get("tab_id")?void 0:i},"selectGroup":function(e){var i=this._modelOfNewlySelectedGroup(e);i&&(this.selectedGroup&&this.selectedGroup.set("isSelected",!1),i.set("isSelected",!0),this.selectedGroup=i)},"_endEditing":function(e){e.isNew()||e.set({"isRename":!1}),this._setSingleGroupEditingMode(!1)},"_saveGroup":function(e){var t=this;e.save({},{"wait":!0}).then(function(){t._endEditing(e)}).fail(function(t){e.trigger("error",e);var s;if(t&&t.responseJSON&&t.responseJSON.error)s=t.responseJSON.error;else{var n=l.MessageHelper.toHtml();l.MessageHelper.reset(),s=i(n).text()}o.error("Saving failed. ",s)&&console.error(o.last),a.showMessage("error",f.errorFavoriteGroupSaveFailed+" "+s)})}})}),csui.define("csui/widgets/favorites/impl/favorites2.table.columns",["csui/lib/underscore","csui/lib/backbone","i18n!csui/widgets/favorites/impl/nls/lang"],function(e,i,t){"use strict";var s=i.Model.extend({"idAttribute":"key","defaults":{"key":null,"sequence":0}}),n=i.Collection.extend({"model":s,"comparator":"sequence","getColumnKeys":function(){return this.pluck("key")},"deepClone":function(){return new n(this.map(function(e){return e.attributes}))},"resetCollection":function(t,n){if(t){var o=0,l=e.map(t,function(t){var n=t instanceof i.Model?t.toJSON():t;return o+=10,new s(e.defaults(n,{"key":n.column_key,"sequence":o}))});this.reset(l,n)}}});return new n([{"key":"type","sequence":10,"permanentColumn":!0},{"key":"favorite_name","title":t.favoriteColumnNameTitle,"cellViewClassname":"csui/controls/table/cells/name.view","sequence":20,"permanentColumn":!0,"isNaming":!0},{"key":"reserved","sequence":30,"noTitleInHeader":!0},{"key":"parent_id","sequence":40},{"key":"favorite","sequence":910,"noTitleInHeader":!0,"permanentColumn":!0}])}),csui.define("hbs!csui/widgets/favorites/impl/favorites2.table",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){return'<div class="csui-rowselection-toolbar"></div>\r\n<div class="csui-favorite-masterdetail-view">\r\n  <div class="csui-favorite-groups-view"></div>\r\n  <div class="csui-table-view"></div>\r\n</div>'}});return t.registerPartial("csui_widgets_favorites_impl_favorites2.table",s),s}),csui.define("css!csui/widgets/favorites/impl/favorites2.table.view",[],function(){}),csui.define("csui/widgets/favorites/impl/favorites2.table.view",["module","csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/utils/log","csui/utils/base","csui/utils/contexts/factories/connector","csui/utils/contexts/factories/favorite2groups","csui/models/favorite2columns","csui/utils/contexts/factories/favorites2","csui/models/favorites2","csui/widgets/favorites/toolbaritems","csui/widgets/favorites/toolbaritems.masks","csui/controls/progressblocker/blocker","csui/widgets/favorites/impl/favorites2.groups.view","csui/controls/table/table.view","csui/utils/commands","csui/controls/toolbar/toolbar.view","csui/controls/toolbar/delayed.toolbar.view","csui/controls/tableactionbar/tableactionbar.view","csui/controls/toolbar/toolbar.command.controller","csui/controls/mixins/layoutview.events.propagation/layoutview.events.propagation.mixin","csui/behaviors/default.action/default.action.behavior","csui/controls/tile/behaviors/infinite.scrolling.behavior","csui/controls/tile/behaviors/perfect.scrolling.behavior","csui/behaviors/keyboard.navigation/tabable.region.behavior","csui/controls/globalmessage/globalmessage","csui/widgets/favorites/impl/favorites2.table.columns","hbs!csui/widgets/favorites/impl/favorites2.table","i18n!csui/widgets/favorites/impl/nls/lang","csui/behaviors/table.rowselection.toolbar/table.rowselection.toolbar.behavior","csui/lib/perfect-scrollbar","css!csui/widgets/favorites/impl/favorites2.table.view"],function(e,i,t,s,n,o,l,r,a,c,u,d,h,p,m,f,g,b,v,w,y,_,C,T,x,k,S,I,V,A,M,E){"use strict";var D=e.config();t.defaults(D,{"defaultPageSize":30,"showGroupsRegion":!0,"dragAndDropEnabled":!0});var F=g.extend({"constructor":function e(i){e.__super__.constructor.apply(this,arguments)},"behaviors":{"PerfectScrolling":{"behaviorClass":k,"contentParent":"tbody","suppressScrollX":!0},"InfiniteScrolling":{"behaviorClass":x,"contentParent":"tbody","content":"tbody>tr:visible"},"TabableRegion":{"behaviorClass":S}}}),P=n.LayoutView.extend({"className":"csui-fav2-table","template":A,"ui":{"tableView":".csui-table-view"},"regions":{"toolbarRegion":".csui-rowselection-toolbar","groupsRegion":".csui-favorite-groups-view","tableRegion":".csui-table-view"},"behaviors":{"DefaultAction":{"behaviorClass":T},"TableRowSelectionToolbar":{"behaviorClass":E}},"constructor":function e(i){i||(i={}),t.defaults(i,{"pageSize":D.defaultPageSize,"showGroupsRegion":D.showGroupsRegion,"clearFilterOnChange":D.clearFilterOnChange,"resetOrderOnChange":D.resetOrderOnChange,"resetLimitOnChange":D.resetLimitOnChange,"fixedFilterOnChange":D.fixedFilterOnChange,"dragAndDropEnabled":D.dragAndDropEnabled},{"showInlineActionBarOnHover":!0,"forceInlineActionBarOnClick":!1,"inlineActionBarStyle":"csui-table-actionbar-bubble","clearFilterOnChange":!0,"resetOrderOnChange":!1,"resetLimitOnChange":!0,"fixedFilterOnChange":!1,"toolbarItems":h}),i.toolbarItemsMasks||(i.toolbarItemsMasks=new p),this.context=i.context,this.connector=this.context.getObject(r),this.commands=i.commands||b,this.commandController=new _({"commands":this.commands,"nameAttribute":"favorite_name"}),this.favoritesTableOptions={"isFavoritesTable":!0},this.tableColumns=this.options.tableColumns||V.deepClone(),m.imbue(this),e.__super__.constructor.call(this,i),this.propagateEventsToRegions()},"initialize":function(){this.collection=new d(void 0,{"connector":this.connector,"autoreset":!1,"skip":0,"top":this.options.pageSize});var e=this.defaultActionController.actionItems.getAllCommandSignatures(b);this.collection.setResourceScope(u.getDefaultResourceScope()),this.collection.setDefaultActionCommands(e),this.collection.setEnabledDelayRestCommands(!0),this.groups=this.options.groups||this.context.getCollection(a,{"detached":!0,"permanent":!0}),this.groups.favorites.setResourceScope(u.getDefaultsOnlyResourceScope()),this.groups.favorites.setEnabledDelayRestCommands(!1),this.columns=this.collection.columns||new c(void 0,{"connector":this.connector}),this._dragData=new s.Model,this._allowDragging=!0,this.collection.delayedActions&&this.listenTo(this.collection.delayedActions,"error",function(e,i,t){var s=new l.Error(i);I.showMessage("error",s.message)}),this.listenTo(this.groups,"request",this.blockActions),this.listenTo(this.groups,"sync error destroy",this.unblockActions),this.listenTo(this.groups,"reset",this._trySelectGroup),this.listenTo(this.groups,"bulk:update",function(){this._saveAllFavorites()}),this.setGroupsView(),this.setTableView(),this.tableView.listenTo(this.groups,"sync error destroy",this.tableView.enableEmptyViewText)},"_setSelectedGroup":function(e){this.selectedGroup=e,this.favoritesTableOptions.selectedGroup=e},"_trySelectGroup":function(){var e;e=void 0!==this.selectedGroup?this.groups.get(this.selectedGroup):this.groups.find(function(e){return e.favorites&&e.favorites.length>0||-1===e.get("tab_id")}),e?(0===this.columns.length&&this.columns.reset(e.favorites.columns.models,{"silent":!0}),this._setTableColumns(e.favorites.columns,{"silent":!0}),this.collection.populate(e.favorites.models,{"parse":!1}),this._setSelectedGroup(e),this.groupsView.selectGroup(e)):(delete this.selectedGroup,delete this.favoritesTableOptions.selectedGroup,this.collection.populate([]))},"_setTableColumns":function(e,i){if(!this.options.tableColumns&&e&&e.models){var s=this,n=["permanentColumn","noTitleInHeader","title","align","widthFactor","isNaming"],o=t.map(e.models,function(e){var i=e.toJSON(),o=e.get("column_key")||e.get("key"),l=s.tableColumns.findWhere({"key":o});return l&&t.each(n,function(e){var t=l.get(e);void 0!==t&&void 0===i[e]&&(i[e]=t)}),i});this.tableColumns.resetCollection(o,i)}},"_saveAllFavorites":function(){var e=this,t=i.Deferred();return this.blockActions(),this._dragData.clear(),this.groups.saveAll().then(function(){o.debug("Complete set of favorite information saved")&&console.log(o.last),e._updateTabIdsInSelectedGroup(),t.resolve()}).fail(function(i){i&&(o.error("failed to save complete set of favorite information: "+i.statusText)&&console.log(o.last),I.showMessage("error",M.errorFavoritesSaveFailed+" "+i.statusText),e.groups.fetch({"reload":!0}),t.reject())}).always(function(){e.unblockActions()}),t.promise()},"_updateTabIdsInSelectedGroup":function(){var e=this.collection;if(this.selectedGroup){var i=this.selectedGroup,t=i.get("tab_id");e.each(function(s,n){i.favorites.at(n);e.remove(s,{"silent":!0}),s.set("favorite_tab_id",t,{"silent":!0}),e.add(s,{"at":n,"silent":!0})})}},"_moveModel":function(e,i,t,s){var n=e.get(i),o=e.get(t),l=e.indexOf(n),r=e.indexOf(o);return l<r&&(r-=1),s&&(r+=1),l!=r&&(e.remove(n),e.add(n,{"at":r}),!0)},"_moveAndSaveFavorites":function(e,i,s){var n=this.groups.get(this.selectedGroup);return this.blockActions(),t.each(e,function(e){this.collection.get(e)&&(this._moveModel(this.collection,e,i,s),this._moveModel(n.favorites,e,i,s))},this),this.unblockActions(),this._saveAllFavorites()},"setGroupsView":function(){this.groupsView=new f({"connector":this.connector,"collection":this.groups,"dragData":this._dragData,"blockingParentView":this,"dragAndDropEnabled":this.options.dragAndDropEnabled}),this.listenTo(this.groupsView,"group:selected",function(e){this.collection.populate(e.model.favorites.models,{"parse":!1}),this._setSelectedGroup(e.model)}),this.listenTo(this.groupsView,"group:any:editing",function(e){this._allowDragging=!e.on,this._updateDraggable()}),this.listenTo(this.groupsView,"group:deleted",function(e){if(this.selectedGroup){var i=e.get("tab_id");this.selectedGroup.get("tab_id")===i&&(delete this.selectedGroup,this._trySelectGroup())}}),this.listenTo(this.groupsView,"group:dropped",function(e){var i=this,t=this.groups,s=e.tabIdSource,n=e.tabIdDestination;if(this._moveModel(t,s,n,e.dropAfter)){var o=this.groups.get(s),l=this.groups.indexOf(o);e.savePromise=this._saveAllFavorites().then(function(){i.groupsView._setFocusedByIndex(l),i.groupsView._tryReSetFocus()})}}),this.listenTo(this.groupsView,"dropped:favorite",function(e){var i=e.idSources;if(t.isArray(i)&&0!==i.length){var s=this.groups,n=this.collection,o=e.tabIdDestination,l=s.get(e.tabIdSource),r=this.selectedGroup.get("tab_id");t.each(i,function(i){var t=l.favorites.get(i);l.favorites.remove(t),s.get(o).favorites.add(t),r===e.tabIdSource?(t=n.get(i),n.remove(t),t.set("csuiIsSelected",!1)):r===o&&n.add(t)}),e.savePromise=this._saveAllFavorites()}})},"_removeDragline":function(){this.tableView.$el.find(".csui-dragline").remove(),this.tableView.$el.find("tr.csui-no-border").removeClass("csui-no-border"),delete this._dropAfter},"_updateDraggable":function(){if(this._allowDragging){if(!1===l.isAppleMobile()&&this.options.dragAndDropEnabled){var e=this.tableView.getSelectedChildren().length;if(e>0){var i=this.tableView.$el.find("tr[draggable=true]");i.attr("draggable",!1),
i=this.tableView.$el.find("tr.binf-active"),i.attr("draggable",!0)}else this.tableView.$el.find("tr:not(.csui-table-row-shows-inlineform)").attr("draggable",!0)}}else{this.tableView.$el.find("tr[draggable=true]").attr("draggable",!1)}},"_handleKeydown":function(e,i){var s,n=l.isMacintosh();switch(e.keyCode){case 88:if(n&&e.metaKey&&!e.ctrlKey||!n&&!e.metaKey&&e.ctrlKey){e.preventDefault(),e.stopPropagation();var o=this.selectedGroup.get("tab_id");s=[],this._dragData.set({"groupId":o,"favorites":s});var r=this.tableView.getSelectedChildren();if(r.length>0)t.each(r,function(e){s.push(e.get("id"))});else{var a=this.tableView.getFocusedChild();a&&s.push(a.get("id"))}this.tableView.trigger("closeOther"),this.tableView.cancelAnyExistingInlineForm.call(this.tableView)}break;case 86:if(n&&e.metaKey&&!e.ctrlKey||!n&&!e.metaKey&&e.ctrlKey){if(e.preventDefault(),e.stopPropagation(),!(s=this._dragData.get("favorites"))||0===s.length)return;var c=i,u=c.get("id");if(t.contains(s,u))return;try{this._moveAndSaveFavorites(this._dragData.get("favorites"),u,!1)}catch(e){}}}},"setTableView":function(){this.tableView=new F({"context":this.options.context,"connector":this.connector,"collection":this.collection,"columns":this.columns,"tableColumns":this.tableColumns,"pageSize":this.options.pageSize,"originatingView":this,"columnsWithSearch":["favorite_name"],"orderBy":this.options.orderBy,"filterBy":this.options.filterBy,"nameEdit":!1,"favoritesTableOptions":this.favoritesTableOptions,"actionItems":this.defaultActionController.actionItems,"commands":this.defaultActionController.commands,"blockingParentView":this,"tableTexts":{"zeroRecords":M.emptyGroupText},"inlineBar":{"viewClass":y,"options":t.extend({"collection":this.options.toolbarItems.inlineActionbar,"toolItemsMask":this.options.toolbarItemsMasks.toolbars.inlineActionbar,"delayedActions":this.collection.delayedActions,"container":this.collection.node,"containerCollection":this.collection,"commandExecutionOptions":{"nameAttribute":"favorite_name"}},this.options.toolbarItems.inlineActionbar.options,{"inlineBarStyle":this.options.inlineActionBarStyle,"forceInlineBarOnClick":this.options.forceInlineActionBarOnClick,"showInlineBarOnHover":this.options.showInlineActionBarOnHover})}});var e=this;this.listenTo(this.tableView,"tableRowRendered",function(t){var s=i(t.target);s.on("focusin",function(i){e._tableRowWithFocus=t}),s.on("focusout",function(i){delete e._tableRowWithFocus}),s.on("keydown",function(i){e._handleKeydown.call(e,i,t.node)})}),this.listenTo(this.tableView,"tableRowRendered",function(s){var n=i(s.target);n.find("a").attr("draggable",!1),!1===l.isAppleMobile()&&this.options.dragAndDropEnabled&&!1===n.hasClass("csui-table-row-shows-inlineform")&&n.attr("draggable",!0),n.on("dragstart",function(s){var n=e.selectedGroup.get("tab_id"),o=[];e._dragData.set({"groupId":n,"favorites":o,"sourceIndex":s.currentTarget._DT_RowIndex});var l=e.tableView.getSelectedChildren();if(l.length>0)t.each(l,function(e){o.push(e.get("id"))});else{var r=e.collection.at(e._dragData.get("sourceIndex"));o.push(r.get("id")),i(s.currentTarget).removeClass("csui-state-hover")}s.originalEvent.dataTransfer.setData("text",""),e.tableView.trigger("closeOther"),e.tableView.cancelAnyExistingInlineForm.call(e.tableView)}),n.on("dragover",function(t){if(e._dragData.get("favorites")&&0!==e._dragData.get("favorites").length){var s=e._dragData.get("sourceIndex"),n=t.currentTarget._DT_RowIndex;if(void 0!==s&&s!==n){t.preventDefault();var o=i('<tr class="csui-dragline">'),l=i(t.currentTarget).height();t.offsetY>l/2?void 0!==e._dropAfter&&!1!==e._dropAfter||(e._removeDragline.call(e),i(t.currentTarget).after(o),e._dropAfter=!0):void 0!==e._dropAfter&&!0!==e._dropAfter||(e._removeDragline.call(e),i(t.currentTarget).before(o),0===n&&o.before('<tr class="csui-dragline csu-dragline-spacer">'),e._dropAfter=!1),o.next().addClass("csui-no-border")}}}),n.on("drop",function(t){var n=e._dragData.get("sourceIndex"),o=t.currentTarget._DT_RowIndex,l=s.node,r=l.get("id");if(void 0!==n&&n!==o){t.preventDefault();try{if(e._dragData.get("favorites")&&e._dragData.get("groupId")){var a=i(t.currentTarget).height(),c=t.offsetY>a/2;e._moveAndSaveFavorites(e._dragData.get("favorites"),r,c)}}catch(e){}e._removeDragline()}}),n.on("dragleave",function(i){e._removeDragline()}),n.on("dragend",function(i){i.preventDefault(),e._removeDragline(),e._dragData.clear()})}),this.listenTo(this.tableView,"tableRowSelected",this._updateDraggable),this.listenTo(this.tableView,"tableRowUnselected",this._updateDraggable),this.listenTo(this,"render",function(){this.groupsRegion.show(this.groupsView),this.tableRegion.show(this.tableView),this.groups.ensureFetched({"reload":!0}),!1===this.options.showGroupsRegion&&this.groupsRegion.$el.hide(),delete this._tableRowWithFocus}),this.listenTo(this.tableView,"execute:defaultAction",function(e){var i={"node":e};if(this.trigger("before:defaultAction",i),!i.cancel){var t=this;this.defaultActionController.executeAction(e,{"context":this.options.context,"originatingView":this}).done(function(){t.trigger("executed:defaultAction",i)})}})},"_addFavoriteAttribute":function(e){return e.each(function(e){e.set("favorite",!0)},this),!0}});return t.extend(P.prototype,C),P}),csui.define("hbs!csui/widgets/myassignments/impl/myassignmentstable",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){return'<div class="csui-myassignmentstable">\r\n  <div id="tableviewMA"></div>\r\n  <div id="paginationviewMA"></div>\r\n</div>\r\n'}});return t.registerPartial("csui_widgets_myassignments_impl_myassignmentstable",s),s}),csui.define("css!csui/widgets/myassignments/impl/myassignmentstable",[],function(){}),csui.define("csui/widgets/myassignments/impl/myassignmentstable.view",["module","csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/utils/log","csui/utils/contexts/factories/myassignmentscolumns","csui/utils/contexts/factories/myassignments","csui/controls/table/rows/description/description.view","csui/controls/mixins/layoutview.events.propagation/layoutview.events.propagation.mixin","csui/widgets/myassignments/myassignments.columns","csui/widgets/nodestable/nodestable.view","hbs!csui/widgets/myassignments/impl/myassignmentstable","i18n!csui/widgets/myassignments/impl/nls/lang","css!csui/widgets/myassignments/impl/myassignmentstable"],function(e,i,t,s,n,o,l,r,a,c,u,d,h,p){"use strict";var m=/\baccessibleTable\b(?:=([^&]*)?)?/i.exec(location.search);m=m&&"false"!==m[1];var f=d.extend({"template":h,"className":"","regions":{"tableRegion":"#tableviewMA","paginationRegion":"#paginationviewMA"},"constructor":function(e){d.prototype.constructor.apply(this,arguments),this.propagateEventsToRegions()},"initialize":function(){this.collection=this.options.collection||this.context.getCollection(r),this.columns=this.collection.columns||this.context.getCollection(l),t.defaults(this.options,{"orderBy":"date_due asc","tableColumns":u}),this.setTableView({"nameEdit":!1,"descriptionRowView":a,"descriptionRowViewOptions":{"firstColumnIndex":1,"lastColumnIndex":2,"showDescriptions":!m,"collapsedHeightIsOneLine":!1},"selectRows":"none","selectColumn":!1,"haveDetailsRowExpandCollapseColumn":!1,"tableColumns":this.options.tableColumns,"tableTexts":{"zeroRecords":p.emptyListText},"inlineBar":{"options":{}}}),this.setPagination(),this.options.collection&&(this.collection.fetched=!1)},"onDestroy":function(){this.options.collection&&this.collection.setResourceScope(this._originalScope),d.prototype.onDestroy.call(this)},"onRender":function(){this.options.collection&&!this.collection.fetched&&(this._originalScope=this.collection.getResourceScope(),this.collection.setResourceScope(r.getDefaultResourceScope()),this.collection.setExpand("assignments",["from_user_id","location_id","workflow_id","workflow_subworkflow_id","workflow_subworkflow_task_id"]),this.collection.fetch({"reload":!0})),this.tableRegion.show(this.tableView),this.paginationRegion.show(this.paginationView)}});return t.extend(f.prototype,c),f}),csui.define("hbs!csui/widgets/recentlyaccessed/impl/recentlyaccessedtable",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){return'<div class="csui-recentlyaccessedtable">\r\n  <div class="csui-rowselection-toolbar"></div>\r\n  <div id="tableviewRA"></div>\r\n  <div id="paginationviewRA"></div>\r\n</div>\r\n'}});return t.registerPartial("csui_widgets_recentlyaccessed_impl_recentlyaccessedtable",s),s}),csui.define("css!csui/widgets/recentlyaccessed/impl/recentlyaccessedtable",[],function(){}),csui.define("csui/widgets/recentlyaccessed/impl/recentlyaccessedtable.view",["module","csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/utils/log","csui/utils/base","csui/utils/contexts/factories/recentlyaccessedcolumns","csui/utils/contexts/factories/recentlyaccessed","csui/widgets/recentlyaccessed/recentlyaccessed.columns","csui/controls/mixins/layoutview.events.propagation/layoutview.events.propagation.mixin","csui/widgets/nodestable/nodestable.view","csui/utils/commands","csui/controls/globalmessage/globalmessage","csui/widgets/recentlyaccessed/toolbaritems","csui/widgets/recentlyaccessed/toolbaritems.masks","hbs!csui/widgets/recentlyaccessed/impl/recentlyaccessedtable","i18n!csui/widgets/recentlyaccessed/impl/nls/lang","csui/behaviors/table.rowselection.toolbar/table.rowselection.toolbar.behavior","css!csui/widgets/recentlyaccessed/impl/recentlyaccessedtable"],function(e,i,t,s,n,o,l,r,a,c,u,d,h,p,m,f,g,b,v){"use strict";var w=d.extend({"template":g,"className":"","regions":{"toolbarRegion":".csui-rowselection-toolbar","tableRegion":"#tableviewRA","paginationRegion":"#paginationviewRA"},"constructor":function(e){d.prototype.constructor.apply(this,arguments),this.propagateEventsToRegions()},"behaviors":t.extend({"TableRowSelectionToolbar":{"behaviorClass":v}},d.prototype.behaviors),"initialize":function(){this.collection=this.options.collection||this.context.getCollection(a),this._allCommands=this.defaultActionController.actionItems.getAllCommandSignatures(h),this.collection.setResourceScope(a.getDefaultResourceScope()),this.collection.setDefaultActionCommands(this._allCommands),this.collection.setEnabledDelayRestCommands(!0),this.collection.delayedActions&&this.listenTo(this.collection.delayedActions,"error",function(e,i,t){var s=new l.Error(i);p.showMessage("error",s.message)}),this.columns=this.collection.columns||this.context.getCollection(r),t.defaults(this.options,{"orderBy":"access_date_last desc","tableColumns":c,"toolbarItems":m}),this.options.toolbarItemsMasks||(this.options.toolbarItemsMasks=new f),this.setTableView({"orderBy":this.options.orderBy,"filterBy":this.options.filterBy,"nameEdit":!1,"haveDetailsRowExpandCollapseColumn":!1,"tableColumns":this.options.tableColumns,"tableTexts":{"zeroRecords":b.emptyListText}}),this.setPagination(),this.options.collection&&(this.collection.fetched=!1)},"onRender":function(){this.options.collection&&!this.options.collection.fetched&&(this._originalScope=this.collection.getResourceScope(),this.collection.setResourceScope(a.getDefaultResourceScope()),this.collection.setExpand("properties",["parent_id","reserved_user_id"]),this.collection.setDefaultActionCommands(this._allCommands),this.collection.setEnabledDelayRestCommands(!0),this.collection.fetch({"reload":!0})),this.tableRegion.show(this.tableView),this.paginationRegion.show(this.paginationView)},"onDestroy":function(){this.options.collection&&this.collection.setResourceScope(this._originalScope),d.prototype.onDestroy.call(this)}});return t.extend(w.prototype,u),w}),csui.define("hbs!csui/widgets/permissions/impl/permissions.lookup/permissions.lookup",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){return'<div id="csui-permissions-user-picker" class="csui-permissions-user-picker"></div>\r\n<div id="user"></div>'}});return t.registerPartial("csui_widgets_permissions_impl_permissions.lookup_permissions.lookup",s),s}),csui.define("csui/widgets/permissions/impl/permissions.lookup/permissions.lookup.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/utils/base","i18n!csui/widgets/permissions/impl/nls/lang","hbs!csui/widgets/permissions/impl/permissions.lookup/permissions.lookup","css!csui/widgets/permissions/impl/permissions"],function(e,i,t,s,n,o){return t.ItemView.extend({"className":"cs-permissions-lookup","template":o,"initialize":function(e){this.options=e},"constructor":function(e){e||(e={}),e.data||(e.data={}),this.options=e,t.ItemView.prototype.constructor.call(this,e)},"onShow":function(){var i=this;csui.require(["csui/controls/userpicker/userpicker.view"],function(s){i.pickerView=new s({"context":i.options.context,"memberFilter":{"type":[0,1]},"widgetoptions":i.options,"placeholder":n.PermissionLookupPlaceHolder,"prettyScrolling":!0,"limit":20,"model":i.options.userPickerModel,"id_input":e.uniqueId("csui-permissions-user-picker-input")}),new t.Region({"el":i.$el.find("#csui-permissions-user-picker")}).show(i.pickerView),i.listenTo(i.pickerView,"item:change",i.processItemChange),i.listenTo(i.pickerView,"item:clear",i.processItemChange)})},"processItemChange":function(){var e=arguments.length>0&&arguments[0].item,i={"id":e?e.get("id"):"","name":e?e.get("name_formatted"):"","group_id":e&&e.get("group_id")?e.get("group_id").id:"","initials":e?e.get("initials"):"","photo_url":e?e.get("photo_url"):""};this.options.userPickerModel.set(i)}})}),csui.define("csui/widgets/permissions/impl/permissions.list/permissions.dropdown.menu.items",["csui/lib/underscore","i18n!csui/controls/tabletoolbar/impl/nls/localized.strings","csui/controls/toolbar/toolitems.factory","csui/controls/toolbar/toolitem.model","csui-ext!csui/widgets/permissions/impl/permissions.list/permissions.dropdown.menu.items"],function(e,i,t,s,n){"use strict";var o={"dropdownMenuList":new t({"main":[{"signature":"adduserorgroup","name":i.AddUserOrGroups},{"signature":"addownerorgroup","name":i.AddOwnerOrGroup},{"signature":"restorepublicaccess","name":i.RestorePublicAccess}]},{"maxItemsShown":0,"dropDownIcon":"icon icon-expandArrowDown"})};return n&&function(i){e.each(i,function(i){e.each(i,function(i,t){var n=o[t];if(!n)throw new Error("Invalid target toolbar: "+t);e.each(i,function(e){e=new s(e),n.addItem(e)})})})}(n),o}),csui.define("csui/utils/contexts/factories/permission.list.factory",["require","module","csui/lib/underscore","csui/lib/backbone","csui/utils/contexts/factories/factory","csui/utils/contexts/factories/connector","csui/models/permission/nodeuserpermissions","csui/utils/commands","csui/utils/base"],function(e,i,t,s,n,o,l,r,a){return n.extend({"propertyPrefix":"nodeUserPermissions","constructor":function(e,r){n.prototype.constructor.apply(this,arguments);var a=this.options.nodeUserPermissions||{};if(!(a instanceof s.Collection)){var c=e.getObject(o,r),u=r.nodeUserPermissions.memberFilter,d=i.config();a=new l(a.models,t.extend({"connector":c,"query":u,"nodeId":this.options.model.get("id")},a.options,d.options,{"autofetch":!0,"autoreset":!0}))}this.property=a},"isFetchable":function(){return this.property.isFetchable()},"fetch":function(e){this.property.fetch({"success":t.bind(this._onNodeUserPermissionsFetched,this,e),"error":t.bind(this._onNodeUserPermissionsFailed,this,e)})},"_onNodeUserPermissionsFetched":function(e){return!0},"_onNodeUserPermissionsFailed":function(e,i,t){var s=new a.RequestErrorMessage(t);csui.require(["csui/dialogs/modal.alert/modal.alert"],function(e){e.showError(s.toString())})}})}),csui.define("csui/widgets/permissions/impl/permissions.list/toolbaritems",["csui/lib/underscore","csui/utils/base","i18n!csui/controls/tabletoolbar/impl/nls/localized.strings","csui/controls/toolbar/toolitems.factory","csui/controls/toolbar/toolitem.model","csui-ext!csui/widgets/permissions/toolbaritems"],function(e,i,t,s,n,o){"use strict";var l={"inlineToolbar":new s({"other":[{"signature":"ChangeOwnerPermission","name":t.ToolbarItemChangeOwnerPermission,"icon":"icon icon-owner-change"},{"signature":"DeletePermission","name":t.ToolbarItemDeletePermission,"icon":"icon icon-toolbar-delete"},{"signature":"EditPermission","name":t.ToolbarItemEditPermission,"icon":"icon icon-toolbar-edit"},{"signature":"ApplyPermission","name":t.ToolbarItemApplyPermission,"icon":"icon icon-toolbar-share"}]},{"maxItemsShown":i.isTouchBrowser()?1:3,"dropDownText":t.ToolbarItemMore,"dropDownIcon":"icon icon-toolbar-more"})};return o&&function(i){e.each(i,function(i){e.each(i,function(i,t){var s=l[t];if(!s)throw new Error("Invalid target toolbar: "+t);e.each(i,function(e){e=new n(e),s.addItem(e)})})})}(o),l}),csui.define("csui/widgets/permissions/impl/permissions.list/toolbaritems.masks",["module","csui/lib/underscore","csui/controls/toolbar/toolitems.mask","csui/utils/toolitem.masks/global.toolitems.mask"],function(e,i,t,s){"use strict";function n(){var n=e.config(),l=new s;this.toolbars=i.reduce(o,function(e,s){var o=new t(l,{"normalize":!1});return i.each(n,function(e,i){(e=e[s])&&o.extendMask(e)}),o.storeMask(),e[s]=o,e},{})}var o=["inlineToolbar"];return n.toolbars=o,n}),csui.define("csui/widgets/permissions/impl/permissions.list/permission.table.columns",["csui/lib/underscore","csui/lib/backbone","csui/models/permission/permission.table.columns.model","i18n!csui/widgets/permissions/impl/nls/lang","csui-ext!csui/widgets/permissions/table.columns"],function(e,i,t,s,n){var o=i.Collection.extend({"model":t,"comparator":"sequence","getColumnKeys":function(){return this.pluck("key")},"deepClone":function(){return new o(this.map(function(e){return e.attributes}))}}),l=[{"key":"right_id","column_key":"right_id","column_name":s.right_id,"sequence":20,"permanentColumn":!0,"containsInlineActions":!0},{"key":"permissions","column_key":"permissions","column_name":s.permission_level,"sequence":40,"permanentColumn":!0},{"column_key":"addpermissions","key":"addpermissions","name":"","sortable":!1,"alignment":"center","permanentColumn":!0,"isToolbar":!0,"sequence":999,"className":"csui-inlinetoolbar-touch"}];return n&&e.each(n,function(i){e.each(i,function(e,i){l.push(e)})}),new o(l)}),csui.define("hbs!csui/widgets/permissions/impl/permissions.content",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){return'<div class="csui-permission-lookup-container"></div>\r\n<div class="csui-permissions-list-container"></div>\r\n<div class="csui-permissions-empty-actions binf-hidden">\r\n  <div class="csui-addMember-container">\r\n    <span class="csui-icon add_user"></span>\r\n    <span class="csui-addMember"></span>\r\n  </div>\r\n  <div class="csui-grantAccess-container binf-hidden">\r\n    <span class="csui-icon icon_permmision_owner"></span>\r\n    <span class="csui-grantAccess"></span>\r\n  </div>\r\n</div>'}});return t.registerPartial("csui_widgets_permissions_impl_permissions.content",s),s}),csui.define("hbs!csui/widgets/permissions/impl/permissions.list/permissions.empty",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){var n;return"<span>"+this.escapeExpression((n=null!=(n=i.message||(null!=e?e.message:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"message","hash":{}}):n))+"</span>"}});return t.registerPartial("csui_widgets_permissions_impl_permissions.list_permissions.empty",s),s}),csui.define("csui/widgets/permissions/impl/permissions.content.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/utils/base","csui/models/node/node.model","csui/widgets/permissions/impl/permissions.lookup/permissions.lookup.view","csui/controls/table.list/table.list.view","csui/widgets/permissions/impl/permissions.list/permissions.dropdown.menu.items","csui/controls/form/pub.sub","csui/utils/commands","csui/utils/contexts/factories/member","csui/utils/contexts/factories/permission.list.factory","csui/widgets/permissions/impl/permissions.list/toolbaritems","csui/widgets/permissions/impl/permissions.list/toolbaritems.masks","csui/widgets/permissions/impl/permissions.list/permission.table.columns","csui/controls/mixins/view.events.propagation/view.events.propagation.mixin","csui/controls/progressblocker/blocker","csui/dialogs/members.picker/members.picker.wizard","i18n!csui/widgets/permissions/impl/nls/lang","hbs!csui/widgets/permissions/impl/permissions.content","hbs!csui/widgets/permissions/impl/permissions.list/permissions.empty","css!csui/widgets/permissions/impl/permissions"],function(e,i,t,s,n,o,l,r,a,c,u,d,h,p,m,f,g,b,v,w,y){var _=t.ItemView.extend({"className":"csui-table-empty","template":y,"templateHelpers":function(){if(this.model.get("name")){return{"message":e.str.sformat(v.emptyPermissionListMsg,this.model.get("name"))}}},"constructor":function(e){t.ItemView.prototype.constructor.apply(this,arguments)}}),C=t.LayoutView.extend({"className":"cs-permissions-content","template":w,"regions":{"lookupRegion":".csui-permission-lookup-container","listRegion":".csui-permissions-list-container"},"ui":{"permissionList":".csui-permissions-list-container","emptyActionsContainer":".csui-permissions-empty-actions","addMemberToGroup":".csui-addMember","grantAccessToMember":".csui-grantAccess"},"events":{"click @ui.addMemberToGroup":"onClickAddMember"},"onClickAddMember":function(t){var s=this,n=i.Deferred(),o=s.options.originatingView,l=s.originalCollection&&s.originalCollection.models&&s.originalCollection.models.length>0?s.originalCollection.models:s.permissionCollection.models;l=e.filter(l,function(e){return e.get("right_id_expand")&&1===e.get("right_id_expand").type}),new b({"command":"adduserorgroup","context":o.context,"connector":o.model.connector,"dialogClass":"cs-permission-group-picker","displayName":v.allUsersAndGroups,"dialogTitle":v.addUsersAndGroups,"startLocation":"acl.groups","displayStartLocation":!0,"selectedMember":s.memberFilter,"showUserPicker":!0,"authUser":s.options.authUser,"hasEditPermissionAction":s.options.hasEditPermissionAction,"adduserorgroup":!0,"buttons":[{"id":"Add","label":v.addButtonLabel,"default":!0,"toolTip":v.addButtonTooltip},{"id":"Cancel","label":v.cancelButtonLabel,"disabled":!1,"close":!0,"toolTip":v.cancelButtonTooltip}],"nodeModel":o.model,"availablePermissions":s.options.collection.availablePermissions,"startLocations":["acl.groups"],"selectableMembers":l},s).show().done(function(){n.resolve.apply(n,arguments)}).fail(function(e){n.reject.apply(n,arguments)})},"constructor":function(i){i||(i={}),i.toolbarItems||(i.toolbarItems=h),i.toolbarItemsMasks||(i.toolbarItemsMasks=new p),this.options=i,t.LayoutView.prototype.constructor.call(this,i),g.imbue(this),this.memberFilter=this.options.context.getModel(u),this.collection=this.options.collection,this.listenTo(this.memberFilter,"change",function(){if(this.collection.isFetchable()){var i=this,t=(this.permissionsListView.tableHeaderView.options.userPermissionsModel.get("permissions"),this.options.hasEditPermissionAction&&"simple"!==this.model.get("permissions_model"));if(i.edit_permissions=t,this.memberFilter.get("id")){this.originalCollection||(this.originalCollection=this.options.collection.clone()),this.options.filteredPermissions=!0;var s=e.filter(this.originalCollection.models,function(e){return e.get("right_id")===this.memberFilter.get("id")},this),n=e.filter(i.originalCollection.models,function(e){return e.get("right_id_expand")&&1===e.get("right_id_expand").type},this);if(this.collection.models=s,this.permissionsListView)this.collection.options.memberId=this.memberFilter.get("id"),s.length>0?this.permissionsListView.trigger("update:table",this.collection):(this.collection.options.clearEmptyPermissionModel=!0,this.collection.fetch().then(function(t){if(t.results.data&&t.results.data.permissions&&0===t.results.data.permissions.length&&i.edit_permissions&&(i.ui.permissionList.addClass("empty-permission-list"),n.length>0)){i.ui.emptyActionsContainer.removeClass("binf-hidden");var s=e.str.sformat(v.addMemberToGroup,i.memberFilter.get("name")),o=e.str.sformat(v.grantAccessToMember,i.memberFilter.get("name"));i.ui.addMemberToGroup.text(s),i.ui.grantAccessToMember.text(o),i.ui.addMemberToGroup.attr("title",s),i.ui.grantAccessToMember.attr("title",o)}},this));else if(this.model.set("isNotFound",!0),this.collection.options.memberId=this.memberFilter.get("id"),this.collection.fetch(),t&&(this.ui.permissionList.addClass("empty-permission-list"),n.length>0)){this.ui.emptyActionsContainer.removeClass("binf-hidden");var o=e.str.sformat(v.addMemberToGroup,this.memberFilter.get("name")),l=e.str.sformat(v.grantAccessToMember,this.memberFilter.get("name"));this.ui.addMemberToGroup.text(o),this.ui.grantAccessToMember.text(l),this.ui.addMemberToGroup.attr("title",o),this.ui.grantAccessToMember.attr("title",l)}}else this.ui.emptyActionsContainer.addClass("binf-hidden"),this.ui.permissionList.removeClass("empty-permission-list"),this.model.set("isNotFound",!1),this.options.filteredPermissions=!1,this.originalCollection=void 0,this.collection.options.memberId=this.memberFilter.get("id"),this.collection.fetch()}}),this.permissionsLookupView=new o(e.extend({"originatingView":this.options.originatingView,"userPickerModel":this.memberFilter},this.options)),this.admin_permissions=this.options.hasEditPermissionAction&&"simple"!==this.model.get("permissions_model"),this.columnCollection=m.clone(),this.updateColumnsCollection(),this.permissionsListView=new l(e.extend({"originatingView":this.options.originatingView,"context":this.options.context,"memberFilter":this.memberFilter,"toolbarItems":this.options.toolbarItems,"toolbarItemsMasks":this.options.toolbarItemsMasks,"collection":this.collection,"tableColumns":this.columnCollection,"emptyView":_,"emptyViewModel":this.memberFilter,"applyTo":this.options.applyTo,"admin_permissions":this.admin_permissions,"authUser":this.options.authUser,"hasPermissionAction":this.options.hasPermissionAction},this.options)),this._isCollectionEditable()&&this.listenTo(this.permissionsListView,"render",this.createPermissionDropDown),this.listenTo(this.options.authenticatedUserPermissions,"change",this._updatePermissionTable),this.listenTo(this.permissionsListView,"render",this._resizePermissionTable),this.listenTo(this.permissionsListView,"scroll",this._handleScroll),this.listenTo(this.permissionsListView,"resizetable",this._resizePermissionTable),this.propagateEventsToViews(this.permissionsLookupView,this.permissionsListView)},"updateColumnsCollection":function(){var e;e=this.options.hasPermissionAction&&this.admin_permissions?m.models:m.filter(function(e){return!e.attributes.isToolbar}),this.columnCollection.set(e,{"remove":!0})},"_updatePermissionTable":function(){this._isCollectionEditable()||(this.permissionsListView.$el.find(".csui-add-permission").addClass("binf-hidden"),this.permissionsListView.$el.find(".csui-add-owner-or-group .csui-user-display-name").text(v.NoOwnerAssigned))},"_resizePermissionTable":function(e){var i=this.$el.find(".csui-table-body");i&&(i.parents(".csui-table-list").hasClass("csui-table-list-no-scrollable")&&i.parents(".csui-table-list").removeClass("csui-table-list-no-scrollable"),i.height()>i.parent().height()?i.parents(".csui-table-list").removeClass("csui-table-list-no-scrollable"):i.parents(".csui-table-list").addClass("csui-table-list-no-scrollable"))},"_isCollectionEditable":function(){return this.admin_permissions&&"simple"!==this.model.get("permissions_model")},"showAddPermissionDropDown":function(e){"true"!==e.target.getAttribute("aria-expanded")&&this.createMenuItems(e)},"createPermissionDropDown":function(){if(this._isCollectionEditable()){var i=this.permissionsListView.$el.find(".csui-add-permission").addClass("icon-toolbarAdd").addClass("binf-dropdown-toggle"),t=i.closest(".csui-table-header-cell");i.attr({"data-binf-toggle":"dropdown","aria-expanded":"false","tabindex":"-1","aria-label":v.AddUserOrGroup,"title":v.AddDropdownTitle,"role":"button"}),i.bind("click",e.bind(this.showAddPermissionDropDown,this)),this.dropDownEl=i,t.bind("keydown",e.bind(this.onKeyInView,this))}},"onKeyInView":function(e){32!==e.keyCode&&13!==e.keyCode||(this.$(e.target).hasClass("csui-toolitem")?this.$(e.target).click():this.$el.find(".csui-add-permission").click())},"createMenuItems":function(t){var s,n,o,l,a=i(t.target).parent().addClass("binf-dropdown"),u=r.dropdownMenuList,d={};s=i('<ul class="binf-dropdown-menu" role="menu"></ul>'),this.options.filteredPermissions?(e.extend(this.originalCollection.options,this.collection.options),d.permissionCollection=this.originalCollection):d.permissionCollection=this.collection,d.admin_permissions=this.options.hasEditPermissionAction,u.collection.models.forEach(function(e){o=e.get("signature");var i=c.findWhere({"signature":o});d.toolItem=e,i&&"disabled"!==o&&i.enabled(d)&&(i.set("startLocation",d.startLocation),n='<li data-csui-command="'+e.get("signature")+'"><a tabindex="-1" class="csui-toolitem">'+e.get("name")+"</a></li>",s.append(n))}),a.find("ul").remove(),a.append(s),l=this.permissionsListView.$el.find(".csui-add-permission").parent().find(".csui-toolitem"),l.bind("click",e.bind(this.executeToolItemAction,this))},"executeToolItemAction":function(i){var t=this;this.commands=c;var s=i.target.parentElement.getAttribute("data-csui-command"),n=this.commands.findWhere({"signature":s}),o=this.options.hasEditPermissionAction,l={"startLocation":n.get("startLocation"),"context":this.options.context,"permissionCollection":this.collection,"originalCollection":this.originalCollection,"nodeModel":this.model,"originatingView":this,"connector":this.model.connector,"nodeId":this.model.get("id"),"admin_permissions":o,"applyTo":this.options.applyTo};n&&n.enabled(l)&&(this._=e,n.execute(l).done(e.bind(function(e){if(t.permissionsLookupView.pickerView&&t.permissionsLookupView.pickerView.ui.searchclear.is(":visible")?t.permissionsLookupView.pickerView.ui.searchclear.click():e.get("addOwnerGroup")?t.collection.addOwnerOrGroup(e,!0):e.get("publicAccess")?t.collection.addPublicAccess(e):t.collection.add(e),t.originalCollection&&t.originalCollection.models){var i=this.collection.models.filter(function(e){for(var i in t.originalCollection.models)if(e.get("right_id")===t.originalCollection.models[i].get("right_id")&&e.get("type")===t.originalCollection.models[i].get("type")||null===e.get("type"))return!1;return!0});i.length>0&&"owner"===i[0].get("type")&&t.originalCollection.findWhere({"type":"owner"})&&t.originalCollection.remove(t.originalCollection.findWhere({"type":"owner"})),t.originalCollection.models.push(i[0])}},this)).always(function(){t.dropDownEl.focus()}))},"onRender":function(){this.lookupRegion.show(this.permissionsLookupView),this.listRegion.show(this.permissionsListView)},"onBeforeDestroy":function(){this.collection.options.memberId&&(delete this.collection.options.memberId,this.memberFilter.set({"id":"","group_id":"","name":""},{"silent":!0}))},"_blockActions":function(){var e=this.options.originatingView;e&&e.blockActions&&e.blockActions()},"_unblockActions":function(){var e=this.options.originatingView;e&&e.unblockActions&&e.unblockActions()},"_handleScroll":function(e){this.options.originatingView&&this.options.originatingView.trigger("scroll",e)}});return e.extend(C.prototype,f),C}),csui.define("hbs!csui/widgets/permissions/impl/no.permissions",["module","hbs","csui/lib/handlebars"],function(e,i,t){var s=t.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,t,s){var n;return'<div class="csui-no-permission">\r\n  '+this.escapeExpression((n=null!=(n=i.messages||(null!=e?e.messages:e))?n:i.helperMissing,"function"==typeof n?n.call(e,{"name":"messages","hash":{}}):n))+"\r\n</div>"}})
;return t.registerPartial("csui_widgets_permissions_impl_no.permissions",s),s}),csui.define("csui/widgets/permissions/permissions.view",["module","csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/utils/base","csui/models/node/node.model","csui/widgets/permissions/impl/permissions.content.view","csui/utils/contexts/factories/node","csui/utils/contexts/factories/user","csui/utils/contexts/factories/permission.list.factory","csui/controls/mixins/view.events.propagation/view.events.propagation.mixin","csui/utils/nodesprites","csui/utils/command.error","csui/controls/progressblocker/blocker","csui/models/nodechildren","csui/dialogs/modal.alert/modal.alert","csui/utils/commands","csui/utils/contexts/factories/usernodepermission","csui/behaviors/keyboard.navigation/tabable.region.behavior","csui/utils/taskqueue","csui/utils/permissions/permissions.precheck","hbs!csui/widgets/permissions/impl/no.permissions","i18n!csui/widgets/permissions/impl/nls/lang","css!csui/widgets/permissions/impl/permissions"],function(e,i,t,s,n,o,l,r,a,c,u,d,h,p,m,f,g,b,v,w,y,_,C){var T=e.config();i.defaults(T,{"parallelism":3});var x=s.ItemView.extend({"className":"cs-permissions","behaviors":{"TabablesBehavior":{"behaviorClass":v,"recursiveNavigation":!0,"containTabFocus":!0}},"isTabable":function(){return this.$("*[tabindex]").length>0},"currentlyFocusedElement":function(e){var i=this.$("*[tabindex]");return t(e&&e.shiftKey?i[i.length-1]:i[0])},"template":!1,"events":{"focusin .csui-permissions-user-picker":"onFocusInUserPicker"},"constructor":function(e){var t=this;if(e||(e={}),e.data||(e.data={}),e.model||(e.model=e.context.getModel(r,{"attributes":e.data.id&&{"id":e.data.id},"temporary":!0})),this.options=e,this.context=e.context,this.user=this.options.context.getModel(a),s.ItemView.prototype.constructor.call(this,e),p.imbue(this),this.hasPermissionAction=e.model&&e.model.actions&&!!e.model.actions.get({"signature":"permissions"}),this.hasPermissionAction){this.options.model&&this.options.model.models&&this.options.model.models.length>0&&(this.options.model=this.options.model.models[0]),this.collection=this.options.collection=this.options.context.getCollection(c,this.options),this.collection.options.node=this.options.model;var n=this.context.getModel(b);n.node=this.options.model,n.node.set("isNotFound",!1),n.fetch().done(function(){t.collection.options.authenticatedUserPermissions=n,t.collection.fetch({"success":i.bind(t.onPermissionsRequestSuccess,t,t.options),"error":i.bind(t.onPermissionsRequestFailed,t,t.options)})}).fail(function(e){new h(e)}),this._blockActions(),this.listenTo(this,"permission:inlineaction:clicked",this._hidePopovers)}},"onRender":function(){if(!this.hasPermissionAction){var e=this.model.get("type_name")?this.model.get("type_name"):this.model.get("shortcutNode")&&this.model.get("shortcutNode").get("type_name"),s=t("<div />",{"class":"csui-no-permissions-container","html":_({"messages":i.str.sformat(C.noPermissionsAvailable,e)})});this.$el.html(s)}},"_hidePopovers":function(){if(this.$el.parents("body")&&this.$el.parents("body").find(".csui-edit-permission-popover-container .binf-popover")){var e=this.$el.parents("body").find(".csui-edit-permission-popover-container .binf-popover");e.data("binf.popover")&&e.binf_popover("destroy")}},"onFocusInUserPicker":function(e){var i=this.$el.find(".binf-popover.binf-in");i.data("binf.popover")&&i.binf_popover("destroy")},"onPermissionsRequestSuccess":function(e){this.permissionsContentView&&(this.cancelEventsToViewsPropagation(this.permissionsContentView),this.permissionsContentView.destroy());var t=i.filter(e.model&&e.model.actions.models,function(e){return"editpermissions"===e.id}),s=e.model.get("container");t.length>0&&"simple"!==this.model.get("permissions_model")&&s&&(e.applyTo={},e.model=this.model,e.connector=this.model.connector,y.fetchPermissionsPreCheck(e)),this.permissionsContentView=new l(i.defaults({"originatingView":this,"context":e.context,"collection":e.collection,"applyTo":e.applyTo,"authUser":this.user,"authenticatedUserPermissions":e.collection&&e.collection.options.authenticatedUserPermissions,"hasPermissionAction":this.hasPermissionAction,"hasEditPermissionAction":t.length>0},e)),this.propagateEventsToViews(this.permissionsContentView),this.renderContent(),this._unblockActions()},"onPermissionsRequestFailed":function(e,i,t){var s=new n.RequestErrorMessage(t);f.showError(s.toString()),this._unblockActions()},"renderContent":function(){var e=this.options.model.fetching;if(e)return e.done(i.bind(this.render,this));if(this.permissionsContentView){var t=this.permissionsContentView.render();s.triggerMethodOn(t,"before:show",t,this),this.$el.append(t.el),s.triggerMethodOn(t,"show",t,this)}},"onBeforeDestroy":function(){this.permissionsContentView&&(this.cancelEventsToViewsPropagation(this.permissionsContentView),this.permissionsContentView.destroy())},"_closePermissions":function(){var e=this.options.model;1===e.get("type")&&e.original&&0===e.original.get("type")?this.trigger("permissions:close"):this.trigger("permissions:close:without:animation")},"_blockActions":function(){var e=this.options.originatingView&&this.options.originatingView.$el.is("visible")?this.options.originatingView:this;e&&e.blockActions&&e.blockActions()},"_unblockActions":function(){var e=this.options.originatingView&&this.options.originatingView.$el.is("visible")?this.options.originatingView:this;e&&e.unblockActions&&e.unblockActions()}});return i.extend(x.prototype,u),x}),csui.define("json!csui/widgets/nodestable/nodestable.manifest.json",{"$schema":"http://opentext.com/cs/json-schema/draft-04/schema#","title":"{{title}}","description":"{{description}}","kind":"fullpage","schema":{"type":"object","properties":{"containerId":{"title":"{{containerIdTitle}}","description":"{{containerIdDescription}}","type":"integer"},"pageSize":{"title":"{{pageSizeTitle}}","description":"{{pageSizeDescription}}","type":"integer","minimum":5,"maximum":100,"default":30},"pageSizes":{"title":"{{pageSizesTitle}}","description":"{{pageSizesDescription}}","type":"array","minItems":1,"maxItems":6,"items":{"type":"integer","minimum":5,"maximum":100},"default":[30,50,100]}}},"options":{"fields":{"containerId":{"type":"otcs_node_picker","type_control":{"parameters":{"select_types":[-1]}}}}},"actions":[{"toolItems":"csui/widgets/nodestable/toolbaritems","toolItemMasks":"csui/widgets/nodestable/toolbaritems.masks","toolbars":[{"id":"tableHeaderToolbar","title":"{{tableHeaderToolbarTitle}}","description":"{{tableHeaderToolbarDescription}}"},{"id":"inlineActionbar","title":"{{inlineActionbarTitle}}","description":"{{inlineActionbarDescription}}"},{"id":"leftToolbar","title":"{{leftToolbarTitle}}","description":"{{leftToolbarDescription}}"},{"id":"rightToolbar","title":"{{rightToolbarTitle}}","description":"{{rightToolbarDescription}}"}]},{"toolItems":"csui/widgets/nodestable/headermenuitems","toolItemMasks":"csui/widgets/nodestable/headermenuitems.mask","toolbars":[{"id":"headerMenuToolbar","title":"{{headerMenuTitle}}","description":"{{headerMenuDescription}}"}]}]}),csui.define("csui/widgets/nodestable/impl/nls/nodestable.manifest",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/widgets/nodestable/impl/nls/root/nodestable.manifest",{"title":"Node Browsing Table","description":"Provides a tabular view on objects stored in a container.","containerIdTitle":"Container","containerIdDescription":"A container object to browse children of.","pageSizeTitle":"Default Page Size","pageSizeDescription":"The maximum object count to be displayed in the table body by default.","pageSizesTitle":"Available Page Sizes","pageSizesDescription":"A list of maximum displayed object counts in the table body to be chosen from.","leftToolbarTitle":"Left Header Toolbar","leftToolbarDescription":"Toolbar on the left side of the name of the currently opened container.","rightToolbarTitle":"Right Header Toolbar","rightToolbarDescription":"Toolbar on the right side of the name of the currently opened container.","tableHeaderToolbarTitle":"Table Header Toolbar","tableHeaderToolbarDescription":"Toolbar, which is activated in the table header, once a table row is selected.","inlineActionbarTitle":"Inline Action Bar","inlineActionbarDescription":"Toolbar, which is displayed inside a table row, when the mouse cursor is moving above it.","headerMenuTitle":"Container Context Menu","headerMenuDescription":"Context menu, which is displayed when clicking on the arrow on the right side of the name of the currently opened container."}),csui.define("bundles/csui-browse",["csui/behaviors/item.name/item.name.behavior","csui/behaviors/table.rowselection.toolbar/table.rowselection.toolbar.behavior","csui/controls/conflict.resolver/impl/conflict.dialog/conflict.dialog","csui/controls/conflict.resolver/impl/collection.conflicts/collection.conflicts.view","csui/controls/conflict.resolver/conflict.resolver","csui/controls/dialog/dialog.view","csui/controls/draganddrop/draganddrop.view","csui/controls/fileupload/fileupload","csui/controls/fileupload/impl/addversion.controller","csui/controls/pagination/nodespagination.view","csui/controls/tableactionbar/tableactionbar.view","csui/controls/item.title/item.title.view","csui/controls/table/table.columns","csui/controls/table/table.view","csui/controls/table.list/table.list.view","csui/controls/table/inlineforms/inlineform.factory","csui/controls/tabletoolbar/tabletoolbar.view","csui/controls/table.configuration.toolbar/configuration.toolbar.dropdown.view","csui/controls/table.rowselection.toolbar/table.rowselection.toolbar.view","csui/controls/table/inlineforms/favorite/favorite.view","csui/controls/table/inlineforms/generic/generic.view","csui/controls/table/inlineforms/inlineform/impl/inlineform.view","csui/controls/table/inlineforms/inlineform.registry","csui/controls/table/inlineforms/permissions/user.picker/user.picker.view","csui/controls/table/cells/cell/cell.view","csui/controls/table/cells/celleditor/celleditor.view","csui/controls/table/cells/cell.factory","csui/controls/table/cells/cell.registry","csui/controls/table/cells/date/date.view","csui/controls/table/cells/datetime/datetime.view","csui/controls/table/cells/duedate/duedate.view","csui/controls/table/cells/favorite/favorite.view","csui/controls/table/cells/member/member.view","csui/controls/table/cells/name/name.view","csui/controls/table/cells/node.state/node.state.view","csui/controls/table/cells/parent/parent.view","csui/controls/table/cells/priority/priority.view","csui/controls/table/cells/reservation/reservation.view","csui/controls/table/cells/searchbox/searchbox.view","csui/controls/table/cells/select/select.view","csui/controls/table/cells/size/size.view","csui/controls/table/cells/status/status.view","csui/controls/table/cells/templated/templated.view","csui/controls/table/cells/text/text.view","csui/controls/table/cells/type.icon/type.icon.view","csui/controls/table/cells/user/user.view","csui/controls/table/cells/permission/permission.level.view","csui/controls/tree/tree.view","csui/controls/table/cells/node.state/impl/node.state.icons","csui/controls/table/rows/description/description.view","csui/controls/table/rows/metadata/metadatarow.view","csui/controls/thumbnail/thumbnail.view","csui/controls/thumbnail/thumbnail.content","csui/controls/thumbnail/content/content.registry","csui/controls/thumbnail/content/content.factory","csui/controls/thumbnail/content/favorite/favorite.view","csui/controls/thumbnail/content/node.state/node.state.view","csui/controls/thumbnail/content/name/name.view","csui/controls/thumbnail/content/member/member.view","csui/controls/thumbnail/content/thumbnail.icon/thumbnail.icon.view","csui/controls/thumbnail/content/overview/overview.view","csui/controls/thumbnail/content/select/select.view","csui/controls/thumbnail/content/size/size.view","csui/controls/thumbnail/content/date/date.view","csui/controls/thumbnail/content/node.state/node.state.view","csui/controls/thumbnail/content/node.state/impl/node.state.icons","csui/controls/thumbnail/content/node.state/impl/reservation/reservation.view","csui/controls/thumbnail/content/overview/overview.content","csui/controls/thumbnail/content/overview/properties.overview","csui/controls/zipanddownload/impl/preflight.dialog/preflight.dialog.view","csui/controls/zipanddownload/impl/download.dialog/download.dialog.view","csui/controls/wizard/wizard.view","csui/dialogs/node.picker/node.picker","csui/dialogs/multilingual.text.picker/multilingual.text.picker","csui/dialogs/node.picker/start.locations/location.base.factory","csui/dialogs/node.picker/start.locations/node.base.factory","csui/dialogs/node.picker/start.locations/start.location.collection","csui/dialogs/node.picker/start.locations/current.location/current.location.factory","csui/dialogs/node.picker/start.locations/enterprise.volume/enterprise.volume.factory","csui/dialogs/node.picker/start.locations/favorites/favorites.factory","csui/dialogs/node.picker/start.locations/personal.volume/personal.volume.factory","csui/dialogs/node.picker/start.locations/category.volume/category.volume.factory","csui/dialogs/node.picker/start.locations/perspective.assets.volume/perspective.assets.volume.factory","csui/dialogs/node.picker/start.locations/recent.containers/recent.containers.factory","csui/dialogs/node.picker/start.locations/search.location/search.location.factory","csui/dialogs/node.picker/start.locations/default.location/default.location.factory","csui/dialogs/members.picker/members.picker.wizard","csui/dialogs/members.picker/start.locations/location.base.factory","csui/dialogs/members.picker/start.locations/start.location.collection","csui/dialogs/members.picker/start.locations/current.group/current.group.factory","csui/dialogs/members.picker/start.locations/all.members/all.members.factory","csui/dialogs/members.picker/start.locations/member.groups/member.groups.factory","csui/dialogs/members.picker/start.locations/recent.groups/recent.groups.factory","csui/dialogs/members.picker/start.locations/all.groups/all.groups.factory","csui/dialogs/members.picker/start.locations/acl.groups/acl.groups.factory","csui/dialogs/members.picker/start.locations/acl.groups/impl/acl.groups.collection","csui/integration/folderbrowser/folderbrowser.widget","csui/integration/target.picker/target.picker","csui/integration/v1.widgets.wrapper","csui/integration/permission.header/permission.header.view","csui/integration/permission/table/cells/security.permission.cell","csui/integration/permission/table/permission.table.columns","csui/integration/folderbrowser/impl/nodestable.toolitems","csui/lib/jquery.dataTables.bootstrap/js/dataTables.bootstrap","csui/lib/jquery.dataTables/js/jquery.dataTables","csui/lib/jquery.dataTables.tableTools/js/dataTables.tableTools","csui/widgets/search.results/impl/search.results.factory","json!csui/utils/contexts/perspective/impl/perspectives/metadata.json","json!csui/utils/contexts/perspective/impl/perspectives/metadata.navigation.json","json!csui/utils/contexts/perspective/impl/perspectives/document.overview.json","csui/widgets/nodestable/nodestable.view","csui/utils/testutils/async.test.utils","csui/utils/toolitem.masks/children.toolitems.mask","csui/utils/toolitem.masks/creation.toolitems.mask","csui/widgets/favorites/toolbaritems","csui/widgets/favorites/toolbaritems.masks","csui/widgets/nodestable/headermenuitems","csui/widgets/nodestable/headermenuitems.mask","csui/widgets/nodestable/toolbaritems","csui/widgets/nodestable/toolbaritems.masks","csui/widgets/recentlyaccessed/toolbaritems","csui/widgets/recentlyaccessed/toolbaritems.masks","csui/widgets/favorites/tileview.toolbaritems","csui/widgets/recentlyaccessed/tileview.toolbaritems","csui/widgets/favorites/impl/favorites2.table.view","csui/widgets/favorites/favorite.star.view","csui/widgets/myassignments/impl/myassignmentstable.view","csui/widgets/recentlyaccessed/impl/recentlyaccessedtable.view","csui/widgets/permissions/permissions.view","csui/widgets/permissions/impl/edit/permission.level.selector/permission.level.selector.view","csui/widgets/permissions/impl/edit/edit.permission.helper","json!csui/widgets/nodestable/nodestable.manifest.json","i18n!csui/widgets/nodestable/impl/nls/nodestable.manifest","i18n!csui/controls/tabletoolbar/impl/nls/localized.strings","csui/controls/tabletoolbar/impl/nls/localized.strings","csui/controls/tabletoolbar/impl/nls/root/localized.strings","csui/utils/dragndrop.supported.subtypes"],{}),csui.require(["require","css"],function(e,i){i.styleLoad(e,"csui/bundles/csui-browse",!0)});
//# sourceMappingURL=csui-browse.js.map